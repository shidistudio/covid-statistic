var v8=Object.defineProperty,x8=Object.defineProperties,b8=Object.getOwnPropertyDescriptors,n2=Object.getOwnPropertySymbols,w8=Object.prototype.hasOwnProperty,C8=Object.prototype.propertyIsEnumerable,i2=(os,tr,gr)=>tr in os?v8(os,tr,{enumerable:!0,configurable:!0,writable:!0,value:gr}):os[tr]=gr,Qt=(os,tr)=>{for(var gr in tr||(tr={}))w8.call(tr,gr)&&i2(os,gr,tr[gr]);if(n2)for(var gr of n2(tr))C8.call(tr,gr)&&i2(os,gr,tr[gr]);return os},Vs=(os,tr)=>x8(os,b8(tr));(self.webpackChunketiqa=self.webpackChunketiqa||[]).push([[179],{651:(os,tr,gr)=>{"use strict";var Vn;function nr(te){return(nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(te)}function zt(te,o){if(!(te instanceof o))throw new TypeError("Cannot call a class as a function")}function v(te,o){for(var a=0;a<o.length;a++){var d=o[a];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(te,d.key,d)}}function St(te,o,a){return o&&v(te.prototype,o),a&&v(te,a),te}function Cs(te,o,a){return o in te?Object.defineProperty(te,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):te[o]=a,te}function Nr(te,o){var a=Object.keys(te);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(te);o&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(te,g).enumerable})),a.push.apply(a,d)}return a}function Je(te){for(var o=1;o<arguments.length;o++){var a=null!=arguments[o]?arguments[o]:{};o%2?Nr(Object(a),!0).forEach(function(d){Cs(te,d,a[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(a)):Nr(Object(a)).forEach(function(d){Object.defineProperty(te,d,Object.getOwnPropertyDescriptor(a,d))})}return te}function ht(te,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function");te.prototype=Object.create(o&&o.prototype,{constructor:{value:te,writable:!0,configurable:!0}}),o&&Ss(te,o)}function $t(te){return($t=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(te)}function Ss(te,o){return(Ss=Object.setPrototypeOf||function(a,d){return a.__proto__=d,a})(te,o)}function Ds(te,o){return!o||"object"!=typeof o&&"function"!=typeof o?function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(te):o}function co(te){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}();return function(){var a,d=$t(te);if(o){var g=$t(this).constructor;a=Reflect.construct(d,arguments,g)}else a=d.apply(this,arguments);return Ds(this,a)}}function wn(te){return function(o){if(Array.isArray(o))return Cr(o)}(te)||function(o){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(o))return Array.from(o)}(te)||function(o,a){if(o){if("string"==typeof o)return Cr(o,a);var d=Object.prototype.toString.call(o).slice(8,-1);if("Object"===d&&o.constructor&&(d=o.constructor.name),"Map"===d||"Set"===d)return Array.from(o);if("Arguments"===d||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d))return Cr(o,a)}}(te)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cr(te,o){(null==o||o>te.length)&&(o=te.length);for(var a=0,d=new Array(o);a<o;a++)d[a]=te[a];return d}var Xe=function(){function te(){zt(this,te)}return St(te,[{key:"shadeRGBColor",value:function(o,a){var d=a.split(","),g=o<0?0:255,_=o<0?-1*o:o,D=parseInt(d[0].slice(4),10),C=parseInt(d[1],10),T=parseInt(d[2],10);return"rgb("+(Math.round((g-D)*_)+D)+","+(Math.round((g-C)*_)+C)+","+(Math.round((g-T)*_)+T)+")"}},{key:"shadeHexColor",value:function(o,a){var d=parseInt(a.slice(1),16),g=o<0?0:255,_=o<0?-1*o:o,D=d>>16,C=d>>8&255,T=255&d;return"#"+(16777216+65536*(Math.round((g-D)*_)+D)+256*(Math.round((g-C)*_)+C)+(Math.round((g-T)*_)+T)).toString(16).slice(1)}},{key:"shadeColor",value:function(o,a){return te.isColorHex(a)?this.shadeHexColor(o,a):this.shadeRGBColor(o,a)}}],[{key:"bind",value:function(o,a){return function(){return o.apply(a,arguments)}}},{key:"isObject",value:function(o){return o&&"object"===nr(o)&&!Array.isArray(o)&&null!=o}},{key:"is",value:function(o,a){return Object.prototype.toString.call(a)==="[object "+o+"]"}},{key:"listToArray",value:function(o){var a,d=[];for(a=0;a<o.length;a++)d[a]=o[a];return d}},{key:"extend",value:function(o,a){var d=this;"function"!=typeof Object.assign&&(Object.assign=function(_){if(null==_)throw new TypeError("Cannot convert undefined or null to object");for(var D=Object(_),C=1;C<arguments.length;C++){var T=arguments[C];if(null!=T)for(var P in T)T.hasOwnProperty(P)&&(D[P]=T[P])}return D});var g=Object.assign({},o);return this.isObject(o)&&this.isObject(a)&&Object.keys(a).forEach(function(_){d.isObject(a[_])&&_ in o?g[_]=d.extend(o[_],a[_]):Object.assign(g,Cs({},_,a[_]))}),g}},{key:"extendArray",value:function(o,a){var d=[];return o.map(function(g){d.push(te.extend(a,g))}),d}},{key:"monthMod",value:function(o){return o%12}},{key:"clone",value:function(o){if(te.is("Array",o)){for(var a=[],d=0;d<o.length;d++)a[d]=this.clone(o[d]);return a}if(te.is("Null",o))return null;if(te.is("Date",o))return o;if("object"===nr(o)){var g={};for(var _ in o)o.hasOwnProperty(_)&&(g[_]=this.clone(o[_]));return g}return o}},{key:"log10",value:function(o){return Math.log(o)/Math.LN10}},{key:"roundToBase10",value:function(o){return Math.pow(10,Math.floor(Math.log10(o)))}},{key:"roundToBase",value:function(o,a){return Math.pow(a,Math.floor(Math.log(o)/Math.log(a)))}},{key:"parseNumber",value:function(o){return null===o?o:parseFloat(o)}},{key:"randomId",value:function(){return(Math.random()+1).toString(36).substring(4)}},{key:"noExponents",value:function(o){var a=String(o).split(/[eE]/);if(1===a.length)return a[0];var d="",g=o<0?"-":"",_=a[0].replace(".",""),D=Number(a[1])+1;if(D<0){for(d=g+"0.";D++;)d+="0";return d+_.replace(/^-/,"")}for(D-=_.length;D--;)d+="0";return _+d}},{key:"getDimensions",value:function(o){var a=getComputedStyle(o,null),d=o.clientHeight,g=o.clientWidth;return d-=parseFloat(a.paddingTop)+parseFloat(a.paddingBottom),[g-=parseFloat(a.paddingLeft)+parseFloat(a.paddingRight),d]}},{key:"getBoundingClientRect",value:function(o){var a=o.getBoundingClientRect();return{top:a.top,right:a.right,bottom:a.bottom,left:a.left,width:o.clientWidth,height:o.clientHeight,x:a.left,y:a.top}}},{key:"getLargestStringFromArr",value:function(o){return o.reduce(function(a,d){return Array.isArray(d)&&(d=d.reduce(function(g,_){return g.length>_.length?g:_})),a.length>d.length?a:d},0)}},{key:"hexToRgba",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#999999",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.6;"#"!==o.substring(0,1)&&(o="#999999");var d=o.replace("#","");d=d.match(new RegExp("(.{"+d.length/3+"})","g"));for(var g=0;g<d.length;g++)d[g]=parseInt(1===d[g].length?d[g]+d[g]:d[g],16);return void 0!==a&&d.push(a),"rgba("+d.join(",")+")"}},{key:"getOpacityFromRGBA",value:function(o){return parseFloat(o.replace(/^.*,(.+)\)/,"$1"))}},{key:"rgb2hex",value:function(o){return(o=o.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===o.length?"#"+("0"+parseInt(o[1],10).toString(16)).slice(-2)+("0"+parseInt(o[2],10).toString(16)).slice(-2)+("0"+parseInt(o[3],10).toString(16)).slice(-2):""}},{key:"isColorHex",value:function(o){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)|(^#[0-9A-F]{8}$)/i.test(o)}},{key:"getPolygonPos",value:function(o,a){for(var d=[],g=2*Math.PI/a,_=0;_<a;_++){var D={};D.x=o*Math.sin(_*g),D.y=-o*Math.cos(_*g),d.push(D)}return d}},{key:"polarToCartesian",value:function(o,a,d,g){var _=(g-90)*Math.PI/180;return{x:o+d*Math.cos(_),y:a+d*Math.sin(_)}}},{key:"escapeString",value:function(o){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x",d=o.toString().slice();return d.replace(/[` ~!@#$%^&*()_|+\-=?;:'",.<>{}[\]\\/]/gi,a)}},{key:"negToZero",value:function(o){return o<0?0:o}},{key:"moveIndexInArray",value:function(o,a,d){if(d>=o.length)for(var g=d-o.length+1;g--;)o.push(void 0);return o.splice(d,0,o.splice(a,1)[0]),o}},{key:"extractNumber",value:function(o){return parseFloat(o.replace(/[^\d.]*/g,""))}},{key:"findAncestor",value:function(o,a){for(;(o=o.parentElement)&&!o.classList.contains(a););return o}},{key:"setELstyles",value:function(o,a){for(var d in a)a.hasOwnProperty(d)&&(o.style.key=a[d])}},{key:"isNumber",value:function(o){return!isNaN(o)&&parseFloat(Number(o))===o&&!isNaN(parseInt(o,10))}},{key:"isFloat",value:function(o){return Number(o)===o&&o%1!=0}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"isFirefox",value:function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1}},{key:"isIE11",value:function(){if(-1!==window.navigator.userAgent.indexOf("MSIE")||window.navigator.appVersion.indexOf("Trident/")>-1)return!0}},{key:"isIE",value:function(){var o=window.navigator.userAgent,a=o.indexOf("MSIE ");if(a>0)return parseInt(o.substring(a+5,o.indexOf(".",a)),10);if(o.indexOf("Trident/")>0){var d=o.indexOf("rv:");return parseInt(o.substring(d+3,o.indexOf(".",d)),10)}var g=o.indexOf("Edge/");return g>0&&parseInt(o.substring(g+5,o.indexOf(".",g)),10)}}]),te}(),mr=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.setEasingFunctions()}return St(te,[{key:"setEasingFunctions",value:function(){var o;if(!this.w.globals.easing){switch(this.w.config.chart.animations.easing){case"linear":o="-";break;case"easein":o="<";break;case"easeout":o=">";break;default:o="<>";break;case"swing":o=function(a){var d=1.70158;return(a-=1)*a*((d+1)*a+d)+1};break;case"bounce":o=function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375};break;case"elastic":o=function(a){return a===!!a?a:Math.pow(2,-10*a)*Math.sin((a-.075)*(2*Math.PI)/.3)+1}}this.w.globals.easing=o}}},{key:"animateLine",value:function(o,a,d,g){o.attr(a).animate(g).attr(d)}},{key:"animateMarker",value:function(o,a,d,g,_,D){a||(a=0),o.attr({r:a,width:a,height:a}).animate(g,_).attr({r:d,width:d.width,height:d.height}).afterAll(function(){D()})}},{key:"animateCircle",value:function(o,a,d,g,_){o.attr({r:a.r,cx:a.cx,cy:a.cy}).animate(g,_).attr({r:d.r,cx:d.cx,cy:d.cy})}},{key:"animateRect",value:function(o,a,d,g,_){o.attr(a).animate(g).attr(d).afterAll(function(){return _()})}},{key:"animatePathsGradually",value:function(o){var L=this.w,B=0;L.config.chart.animations.animateGradually.enabled&&(B=L.config.chart.animations.animateGradually.delay),L.config.chart.animations.dynamicAnimation.enabled&&L.globals.dataChanged&&"bar"!==L.config.chart.type&&(B=0),this.morphSVG(o.el,o.realIndex,o.j,"line"!==L.config.chart.type||L.globals.comboCharts?o.fill:"stroke",o.pathFrom,o.pathTo,o.speed,o.delay*B)}},{key:"showDelayedElements",value:function(){this.w.globals.delayedElements.forEach(function(o){o.el.classList.remove("apexcharts-element-hidden")})}},{key:"animationCompleted",value:function(o){var a=this.w;a.globals.animationEnded||(a.globals.animationEnded=!0,this.showDelayedElements(),"function"==typeof a.config.chart.events.animationEnd&&a.config.chart.events.animationEnd(this.ctx,{el:o,w:a}))}},{key:"morphSVG",value:function(o,a,d,g,_,D,C,T){var P=this,L=this.w;_||(_=o.attr("pathFrom")),D||(D=o.attr("pathTo"));var B=function(V){return"radar"===L.config.chart.type&&(C=1),"M 0 ".concat(L.globals.gridHeight)};(!_||_.indexOf("undefined")>-1||_.indexOf("NaN")>-1)&&(_=B()),(!D||D.indexOf("undefined")>-1||D.indexOf("NaN")>-1)&&(D=B()),L.globals.shouldAnimate||(C=1),o.plot(_).animate(1,L.globals.easing,T).plot(_).animate(C,L.globals.easing,T).plot(D).afterAll(function(){Xe.isNumber(d)?d===L.globals.series[L.globals.maxValsInArrayIndex].length-2&&L.globals.shouldAnimate&&P.animationCompleted(o):"none"!==g&&L.globals.shouldAnimate&&(!L.globals.comboCharts&&a===L.globals.series.length-1||L.globals.comboCharts)&&P.animationCompleted(o),P.showDelayedElements()})}}]),te}(),pi=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"getDefaultFilter",value:function(o,a){var d=this.w;o.unfilter(!0),(new window.SVG.Filter).size("120%","180%","-5%","-40%"),"none"!==d.config.states.normal.filter?this.applyFilter(o,a,d.config.states.normal.filter.type,d.config.states.normal.filter.value):d.config.chart.dropShadow.enabled&&this.dropShadow(o,d.config.chart.dropShadow,a)}},{key:"addNormalFilter",value:function(o,a){var d=this.w;d.config.chart.dropShadow.enabled&&!o.node.classList.contains("apexcharts-marker")&&this.dropShadow(o,d.config.chart.dropShadow,a)}},{key:"addLightenFilter",value:function(o,a,d){var g=this,_=this.w,D=d.intensity;o.unfilter(!0),new window.SVG.Filter,o.filter(function(C){var T=_.config.chart.dropShadow;(T.enabled?g.addShadow(C,a,T):C).componentTransfer({rgb:{type:"linear",slope:1.5,intercept:D}})}),o.filterer.node.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize(o.filterer.node)}},{key:"addDarkenFilter",value:function(o,a,d){var g=this,_=this.w,D=d.intensity;o.unfilter(!0),new window.SVG.Filter,o.filter(function(C){var T=_.config.chart.dropShadow;(T.enabled?g.addShadow(C,a,T):C).componentTransfer({rgb:{type:"linear",slope:D}})}),o.filterer.node.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize(o.filterer.node)}},{key:"applyFilter",value:function(o,a,d){var g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;switch(d){case"none":this.addNormalFilter(o,a);break;case"lighten":this.addLightenFilter(o,a,{intensity:g});break;case"darken":this.addDarkenFilter(o,a,{intensity:g})}}},{key:"addShadow",value:function(o,a,d){var g=d.blur,_=d.top,D=d.left,C=d.color,T=d.opacity,P=o.flood(Array.isArray(C)?C[a]:C,T).composite(o.sourceAlpha,"in").offset(D,_).gaussianBlur(g).merge(o.source);return o.blend(o.source,P)}},{key:"dropShadow",value:function(o,a){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,g=a.top,_=a.left,D=a.blur,C=a.color,T=a.opacity,P=a.noUserSpaceOnUse,L=this.w;return o.unfilter(!0),Xe.isIE()&&"radialBar"===L.config.chart.type||(C=Array.isArray(C)?C[d]:C,o.filter(function(B){var V;V=Xe.isSafari()||Xe.isFirefox()||Xe.isIE()?B.flood(C,T).composite(B.sourceAlpha,"in").offset(_,g).gaussianBlur(D):B.flood(C,T).composite(B.sourceAlpha,"in").offset(_,g).gaussianBlur(D).merge(B.source),B.blend(B.source,V)}),P||o.filterer.node.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize(o.filterer.node)),o}},{key:"setSelectionFilter",value:function(o,a,d){var g=this.w;if(void 0!==g.globals.selectedDataPoints[a]&&g.globals.selectedDataPoints[a].indexOf(d)>-1){o.node.setAttribute("selected",!0);var _=g.config.states.active.filter;"none"!==_&&this.applyFilter(o,a,_.type,_.value)}}},{key:"_scaleFilterSize",value:function(o){!function(a){for(var d in a)a.hasOwnProperty(d)&&o.setAttribute(d,a[d])}({width:"200%",height:"200%",x:"-50%",y:"-50%"})}}]),te}(),yt=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"drawLine",value:function(o,a,d,g){var _=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#a8a8a8",D=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,C=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,T=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"butt",P=this.w,L=P.globals.dom.Paper.line().attr({x1:o,y1:a,x2:d,y2:g,stroke:_,"stroke-dasharray":D,"stroke-width":C,"stroke-linecap":T});return L}},{key:"drawRect",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,_=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,D=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#fefefe",C=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,T=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,P=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,L=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,B=this.w,V=B.globals.dom.Paper.rect();return V.attr({x:o,y:a,width:d>0?d:0,height:g>0?g:0,rx:_,ry:_,opacity:C,"stroke-width":null!==T?T:0,stroke:null!==P?P:"none","stroke-dasharray":L}),V.node.setAttribute("fill",D),V}},{key:"drawPolygon",value:function(o){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#e1e1e1",d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"none",_=this.w,D=_.globals.dom.Paper.polygon(o).attr({fill:g,stroke:a,"stroke-width":d});return D}},{key:"drawCircle",value:function(o){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=this.w;o<0&&(o=0);var g=d.globals.dom.Paper.circle(2*o);return null!==a&&g.attr(a),g}},{key:"drawPath",value:function(o){var a=o.d,d=void 0===a?"":a,g=o.stroke,_=void 0===g?"#a8a8a8":g,D=o.strokeWidth,C=void 0===D?1:D,T=o.fill,P=o.fillOpacity,L=void 0===P?1:P,B=o.strokeOpacity,V=void 0===B?1:B,$=o.classes,q=o.strokeLinecap,K=void 0===q?null:q,oe=o.strokeDashArray,ae=void 0===oe?0:oe,fe=this.w;return null===K&&(K=fe.config.stroke.lineCap),(d.indexOf("undefined")>-1||d.indexOf("NaN")>-1)&&(d="M 0 ".concat(fe.globals.gridHeight)),fe.globals.dom.Paper.path(d).attr({fill:T,"fill-opacity":L,stroke:_,"stroke-opacity":V,"stroke-linecap":K,"stroke-width":C,"stroke-dasharray":ae,class:$})}},{key:"group",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.w,d=a.globals.dom.Paper.group();return null!==o&&d.attr(o),d}},{key:"move",value:function(o,a){return["M",o,a].join(" ")}},{key:"line",value:function(o,a){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,g=null;return null===d?g=["L",o,a].join(" "):"H"===d?g=["H",o].join(" "):"V"===d&&(g=["V",a].join(" ")),g}},{key:"curve",value:function(o,a,d,g,_,D){return["C",o,a,d,g,_,D].join(" ")}},{key:"quadraticCurve",value:function(o,a,d,g){return["Q",o,a,d,g].join(" ")}},{key:"arc",value:function(o,a,d,g,_,D,C){var T=arguments.length>7&&void 0!==arguments[7]&&arguments[7],P="A";T&&(P="a");var L=[P,o,a,d,g,_,D,C].join(" ");return L}},{key:"renderPaths",value:function(o){var a,d=o.j,g=o.realIndex,_=o.pathFrom,D=o.pathTo,C=o.stroke,T=o.strokeWidth,P=o.strokeLinecap,L=o.fill,B=o.animationDelay,V=o.initialSpeed,$=o.dataChangeSpeed,q=o.className,K=o.shouldClipToGrid,oe=void 0===K||K,ae=o.bindEventsOnPaths,fe=void 0===ae||ae,ge=o.drawShadow,R=void 0===ge||ge,H=this.w,Q=new pi(this.ctx),le=new mr(this.ctx),Re=this.w.config.chart.animations.enabled,tt=Re&&this.w.config.chart.animations.dynamicAnimation.enabled,Ve=!!(Re&&!H.globals.resized||tt&&H.globals.dataChanged&&H.globals.shouldAnimate);Ve?a=_:(a=D,H.globals.animationEnded=!0);var pt,Dt=H.config.stroke.dashArray;pt=Array.isArray(Dt)?Dt[g]:H.config.stroke.dashArray;var qe=this.drawPath({d:a,stroke:C,strokeWidth:T,fill:L,fillOpacity:1,classes:q,strokeLinecap:P,strokeDashArray:pt});qe.attr("index",g),oe&&qe.attr({"clip-path":"url(#gridRectMask".concat(H.globals.cuid,")")}),"none"!==H.config.states.normal.filter.type?Q.getDefaultFilter(qe,g):H.config.chart.dropShadow.enabled&&R&&(!H.config.chart.dropShadow.enabledOnSeries||H.config.chart.dropShadow.enabledOnSeries&&-1!==H.config.chart.dropShadow.enabledOnSeries.indexOf(g))&&Q.dropShadow(qe,H.config.chart.dropShadow,g),fe&&(qe.node.addEventListener("mouseenter",this.pathMouseEnter.bind(this,qe)),qe.node.addEventListener("mouseleave",this.pathMouseLeave.bind(this,qe)),qe.node.addEventListener("mousedown",this.pathMouseDown.bind(this,qe))),qe.attr({pathTo:D,pathFrom:_});var Yn={el:qe,j:d,realIndex:g,pathFrom:_,pathTo:D,fill:L,strokeWidth:T,delay:B};return!Re||H.globals.resized||H.globals.dataChanged?!H.globals.resized&&H.globals.dataChanged||le.showDelayedElements():le.animatePathsGradually(Je(Je({},Yn),{},{speed:V})),H.globals.dataChanged&&tt&&Ve&&le.animatePathsGradually(Je(Je({},Yn),{},{speed:$})),qe}},{key:"drawPattern",value:function(o,a,d){var g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#a8a8a8",_=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,D=this.w,C=D.globals.dom.Paper.pattern(a,d,function(T){"horizontalLines"===o?T.line(0,0,d,0).stroke({color:g,width:_+1}):"verticalLines"===o?T.line(0,0,0,a).stroke({color:g,width:_+1}):"slantedLines"===o?T.line(0,0,a,d).stroke({color:g,width:_}):"squares"===o?T.rect(a,d).fill("none").stroke({color:g,width:_}):"circles"===o&&T.circle(a).fill("none").stroke({color:g,width:_})});return C}},{key:"drawGradient",value:function(o,a,d,g,_){var D,C=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,T=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,P=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,L=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,B=this.w;a.length<9&&0===a.indexOf("#")&&(a=Xe.hexToRgba(a,g)),d.length<9&&0===d.indexOf("#")&&(d=Xe.hexToRgba(d,_));var V=0,$=1,q=1,K=null;null!==T&&(V=void 0!==T[0]?T[0]/100:0,$=void 0!==T[1]?T[1]/100:1,q=void 0!==T[2]?T[2]/100:1,K=void 0!==T[3]?T[3]/100:null);var oe=!("donut"!==B.config.chart.type&&"pie"!==B.config.chart.type&&"polarArea"!==B.config.chart.type&&"bubble"!==B.config.chart.type);if(D=B.globals.dom.Paper.gradient(oe?"radial":"linear",null===P||0===P.length?function(ge){ge.at(V,a,g),ge.at($,d,_),ge.at(q,d,_),null!==K&&ge.at(K,a,g)}:function(ge){(Array.isArray(P[L])?P[L]:P).forEach(function(R){ge.at(R.offset/100,R.color,R.opacity)})}),oe){var ae=B.globals.gridWidth/2,fe=B.globals.gridHeight/2;D.attr("bubble"!==B.config.chart.type?{gradientUnits:"userSpaceOnUse",cx:ae,cy:fe,r:C}:{cx:.5,cy:.5,r:.8,fx:.2,fy:.2})}else"vertical"===o?D.from(0,0).to(0,1):"diagonal"===o?D.from(0,0).to(1,1):"horizontal"===o?D.from(0,1).to(1,1):"diagonal2"===o&&D.from(1,0).to(0,1);return D}},{key:"drawText",value:function(o){var a,d=o.x,g=o.y,_=o.text,D=o.textAnchor,C=o.fontSize,T=o.fontFamily,P=o.fontWeight,L=o.foreColor,B=o.opacity,V=o.cssClass,$=void 0===V?"":V,q=o.isPlainText,K=void 0===q||q,oe=this.w;return void 0===_&&(_=""),D||(D="start"),L&&L.length||(L=oe.config.chart.foreColor),T=T||oe.config.chart.fontFamily,P=P||"regular",(a=Array.isArray(_)?oe.globals.dom.Paper.text(function(ae){for(var fe=0;fe<_.length;fe++)0===fe?ae.tspan(_[fe]):ae.tspan(_[fe]).newLine()}):K?oe.globals.dom.Paper.plain(_):oe.globals.dom.Paper.text(function(ae){return ae.tspan(_)})).attr({x:d,y:g,"text-anchor":D,"dominant-baseline":"auto","font-size":C,"font-family":T,"font-weight":P,fill:L,class:"apexcharts-text "+$}),a.node.style.fontFamily=T,a.node.style.opacity=B,a}},{key:"drawMarker",value:function(o,a,d){o=o||0;var g=d.pSize||0,_=null;if("square"===d.shape||"rect"===d.shape){var D=void 0===d.pRadius?g/2:d.pRadius;null!==a&&g||(g=0,D=0);var C=1.2*g+D,T=this.drawRect(C,C,C,C,D);T.attr({x:o-C/2,y:a-C/2,cx:o,cy:a,class:d.class?d.class:"",fill:d.pointFillColor,"fill-opacity":d.pointFillOpacity?d.pointFillOpacity:1,stroke:d.pointStrokeColor,"stroke-width":d.pointStrokeWidth?d.pointStrokeWidth:0,"stroke-opacity":d.pointStrokeOpacity?d.pointStrokeOpacity:1}),_=T}else"circle"!==d.shape&&d.shape||(Xe.isNumber(a)||(g=0,a=0),_=this.drawCircle(g,{cx:o,cy:a,class:d.class?d.class:"",stroke:d.pointStrokeColor,fill:d.pointFillColor,"fill-opacity":d.pointFillOpacity?d.pointFillOpacity:1,"stroke-width":d.pointStrokeWidth?d.pointStrokeWidth:0,"stroke-opacity":d.pointStrokeOpacity?d.pointStrokeOpacity:1}));return _}},{key:"pathMouseEnter",value:function(o,a){var d=this.w,g=new pi(this.ctx),_=parseInt(o.node.getAttribute("index"),10),D=parseInt(o.node.getAttribute("j"),10);if("function"==typeof d.config.chart.events.dataPointMouseEnter&&d.config.chart.events.dataPointMouseEnter(a,this.ctx,{seriesIndex:_,dataPointIndex:D,w:d}),this.ctx.events.fireEvent("dataPointMouseEnter",[a,this.ctx,{seriesIndex:_,dataPointIndex:D,w:d}]),("none"===d.config.states.active.filter.type||"true"!==o.node.getAttribute("selected"))&&"none"!==d.config.states.hover.filter.type&&!d.globals.isTouchDevice){var C=d.config.states.hover.filter;g.applyFilter(o,_,C.type,C.value)}}},{key:"pathMouseLeave",value:function(o,a){var d=this.w,g=new pi(this.ctx),_=parseInt(o.node.getAttribute("index"),10),D=parseInt(o.node.getAttribute("j"),10);"function"==typeof d.config.chart.events.dataPointMouseLeave&&d.config.chart.events.dataPointMouseLeave(a,this.ctx,{seriesIndex:_,dataPointIndex:D,w:d}),this.ctx.events.fireEvent("dataPointMouseLeave",[a,this.ctx,{seriesIndex:_,dataPointIndex:D,w:d}]),"none"!==d.config.states.active.filter.type&&"true"===o.node.getAttribute("selected")||"none"!==d.config.states.hover.filter.type&&g.getDefaultFilter(o,_)}},{key:"pathMouseDown",value:function(o,a){var d=this.w,g=new pi(this.ctx),_=parseInt(o.node.getAttribute("index"),10),D=parseInt(o.node.getAttribute("j"),10),C="false";if("true"===o.node.getAttribute("selected")){if(o.node.setAttribute("selected","false"),d.globals.selectedDataPoints[_].indexOf(D)>-1){var T=d.globals.selectedDataPoints[_].indexOf(D);d.globals.selectedDataPoints[_].splice(T,1)}}else{if(!d.config.states.active.allowMultipleDataPointsSelection&&d.globals.selectedDataPoints.length>0){d.globals.selectedDataPoints=[];var P=d.globals.dom.Paper.select(".apexcharts-series path").members,L=d.globals.dom.Paper.select(".apexcharts-series circle, .apexcharts-series rect").members,B=function($){Array.prototype.forEach.call($,function(q){q.node.setAttribute("selected","false"),g.getDefaultFilter(q,_)})};B(P),B(L)}o.node.setAttribute("selected","true"),C="true",void 0===d.globals.selectedDataPoints[_]&&(d.globals.selectedDataPoints[_]=[]),d.globals.selectedDataPoints[_].push(D)}if("true"===C){var V=d.config.states.active.filter;"none"!==V&&g.applyFilter(o,_,V.type,V.value)}else"none"!==d.config.states.active.filter.type&&g.getDefaultFilter(o,_);"function"==typeof d.config.chart.events.dataPointSelection&&d.config.chart.events.dataPointSelection(a,this.ctx,{selectedDataPoints:d.globals.selectedDataPoints,seriesIndex:_,dataPointIndex:D,w:d}),a&&this.ctx.events.fireEvent("dataPointSelection",[a,this.ctx,{selectedDataPoints:d.globals.selectedDataPoints,seriesIndex:_,dataPointIndex:D,w:d}])}},{key:"rotateAroundCenter",value:function(o){var a={};return o&&"function"==typeof o.getBBox&&(a=o.getBBox()),{x:a.x+a.width/2,y:a.y+a.height/2}}},{key:"getTextRects",value:function(o,a,d,g){var _=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],D=this.w,C=this.drawText({x:-200,y:-200,text:o,textAnchor:"start",fontSize:a,fontFamily:d,foreColor:"#fff",opacity:0});g&&C.attr("transform",g),D.globals.dom.Paper.add(C);var T=C.bbox();return _||(T=C.node.getBoundingClientRect()),C.remove(),{width:T.width,height:T.height}}},{key:"placeTextWithEllipsis",value:function(o,a,d){if("function"==typeof o.getComputedTextLength&&(o.textContent=a,a.length>0&&o.getComputedTextLength()>=d/1.1)){for(var g=a.length-3;g>0;g-=3)if(o.getSubStringLength(0,g)<=d/1.1)return void(o.textContent=a.substring(0,g)+"...");o.textContent="."}}}],[{key:"setAttrs",value:function(o,a){for(var d in a)a.hasOwnProperty(d)&&o.setAttribute(d,a[d])}}]),te}(),On=function(){function te(o){zt(this,te),this.w=o.w,this.annoCtx=o}return St(te,[{key:"setOrientations",value:function(o){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=this.w;if("vertical"===o.label.orientation){var g=null!==a?a:0,_=d.globals.dom.baseEl.querySelector(".apexcharts-xaxis-annotations .apexcharts-xaxis-annotation-label[rel='".concat(g,"']"));if(null!==_){var D=_.getBoundingClientRect();_.setAttribute("x",parseFloat(_.getAttribute("x"))-D.height+4),_.setAttribute("y","top"===o.label.position?parseFloat(_.getAttribute("y"))+D.width:parseFloat(_.getAttribute("y"))-D.width);var C=this.annoCtx.graphics.rotateAroundCenter(_),T=C.x,P=C.y;_.setAttribute("transform","rotate(-90 ".concat(T," ").concat(P,")"))}}}},{key:"addBackgroundToAnno",value:function(o,a){var d=this.w;if(!o||!a.label.text||a.label.text&&!a.label.text.trim())return null;var g=d.globals.dom.baseEl.querySelector(".apexcharts-grid").getBoundingClientRect(),_=o.getBoundingClientRect(),D=a.label.style.padding.left,C=a.label.style.padding.right,T=a.label.style.padding.top,P=a.label.style.padding.bottom;"vertical"===a.label.orientation&&(T=a.label.style.padding.left,P=a.label.style.padding.right,D=a.label.style.padding.top,C=a.label.style.padding.bottom);var V=this.annoCtx.graphics.drawRect(_.left-g.left-D-d.globals.barPadForNumericAxis,_.top-g.top-T,_.width+D+C,_.height+T+P,a.label.borderRadius,a.label.style.background,1,a.label.borderWidth,a.label.borderColor,0);return a.id&&V.node.classList.add(a.id),V}},{key:"annotationsBackground",value:function(){var o=this,a=this.w,d=function(g,_,D){var C=a.globals.dom.baseEl.querySelector(".apexcharts-".concat(D,"-annotations .apexcharts-").concat(D,"-annotation-label[rel='").concat(_,"']"));if(C){var T=C.parentNode,P=o.addBackgroundToAnno(C,g);P&&T.insertBefore(P.node,C)}};a.config.annotations.xaxis.map(function(g,_){d(g,_,"xaxis")}),a.config.annotations.yaxis.map(function(g,_){d(g,_,"yaxis")}),a.config.annotations.points.map(function(g,_){d(g,_,"point")})}},{key:"getStringX",value:function(o){var a=this.w,d=o;a.config.xaxis.convertedCatToNumeric&&a.globals.categoryLabels.length&&(o=a.globals.categoryLabels.indexOf(o)+1);var g=a.globals.labels.indexOf(o),_=a.globals.dom.baseEl.querySelector(".apexcharts-xaxis-texts-g text:nth-child("+(g+1)+")");return _&&(d=parseFloat(_.getAttribute("x"))),d}}]),te}(),Ro=function(){function te(o){zt(this,te),this.w=o.w,this.annoCtx=o,this.invertAxis=this.annoCtx.invertAxis}return St(te,[{key:"addXaxisAnnotation",value:function(o,a,d){var g=this.w,_=this.invertAxis?g.globals.minY:g.globals.minX,D=this.invertAxis?g.globals.maxY:g.globals.maxX,C=this.invertAxis?g.globals.yRange[0]:g.globals.xRange,T=(o.x-_)/(C/g.globals.gridWidth);this.annoCtx.inversedReversedAxis&&(T=(D-o.x)/(C/g.globals.gridWidth));var P=o.label.text;"category"!==g.config.xaxis.type&&!g.config.xaxis.convertedCatToNumeric||this.invertAxis||g.globals.dataFormatXNumeric||(T=this.annoCtx.helpers.getStringX(o.x));var L=o.strokeDashArray;if(Xe.isNumber(T)){if(null==o.x2){var B=this.annoCtx.graphics.drawLine(T+o.offsetX,0+o.offsetY,T+o.offsetX,g.globals.gridHeight+o.offsetY,o.borderColor,L,o.borderWidth);a.appendChild(B.node),o.id&&B.node.classList.add(o.id)}else{var V=(o.x2-_)/(C/g.globals.gridWidth);if(this.annoCtx.inversedReversedAxis&&(V=(D-o.x2)/(C/g.globals.gridWidth)),"category"!==g.config.xaxis.type&&!g.config.xaxis.convertedCatToNumeric||this.invertAxis||g.globals.dataFormatXNumeric||(V=this.annoCtx.helpers.getStringX(o.x2)),V<T){var $=T;T=V,V=$}var q=this.annoCtx.graphics.drawRect(T+o.offsetX,0+o.offsetY,V-T,g.globals.gridHeight+o.offsetY,0,o.fillColor,o.opacity,1,o.borderColor,L);q.node.classList.add("apexcharts-annotation-rect"),q.attr("clip-path","url(#gridRectMask".concat(g.globals.cuid,")")),a.appendChild(q.node),o.id&&q.node.classList.add(o.id)}var K="top"===o.label.position?4:g.globals.gridHeight,oe=this.annoCtx.graphics.getTextRects(P,parseFloat(o.label.style.fontSize)),ae=this.annoCtx.graphics.drawText({x:T+o.label.offsetX,y:K+o.label.offsetY-("vertical"===o.label.orientation?"top"===o.label.position?oe.width/2-12:-oe.width/2:0),text:P,textAnchor:o.label.textAnchor,fontSize:o.label.style.fontSize,fontFamily:o.label.style.fontFamily,fontWeight:o.label.style.fontWeight,foreColor:o.label.style.color,cssClass:"apexcharts-xaxis-annotation-label ".concat(o.label.style.cssClass," ").concat(o.id?o.id:"")});ae.attr({rel:d}),a.appendChild(ae.node),this.annoCtx.helpers.setOrientations(o,d)}}},{key:"drawXAxisAnnotations",value:function(){var o=this,a=this.w,d=this.annoCtx.graphics.group({class:"apexcharts-xaxis-annotations"});return a.config.annotations.xaxis.map(function(g,_){o.addXaxisAnnotation(g,d.node,_)}),d}}]),te}(),fi=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"getStackedSeriesTotals",value:function(){var o=this.w,a=[];if(0===o.globals.series.length)return a;for(var d=0;d<o.globals.series[o.globals.maxValsInArrayIndex].length;d++){for(var g=0,_=0;_<o.globals.series.length;_++)void 0!==o.globals.series[_][d]&&(g+=o.globals.series[_][d]);a.push(g)}return o.globals.stackedSeriesTotals=a,a}},{key:"getSeriesTotalByIndex",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===o?this.w.config.series.reduce(function(a,d){return a+d},0):this.w.globals.series[o].reduce(function(a,d){return a+d},0)}},{key:"isSeriesNull",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return 0===(null===o?this.w.config.series.filter(function(a){return null!==a}):this.w.config.series[o].data.filter(function(a){return null!==a})).length}},{key:"seriesHaveSameValues",value:function(o){return this.w.globals.series[o].every(function(a,d,g){return a===g[0]})}},{key:"getCategoryLabels",value:function(o){var a=this.w,d=o.slice();return a.config.xaxis.convertedCatToNumeric&&(d=o.map(function(g,_){return a.config.xaxis.labels.formatter(g-a.globals.minX+1)})),d}},{key:"getLargestSeries",value:function(){var o=this.w;o.globals.maxValsInArrayIndex=o.globals.series.map(function(a){return a.length}).indexOf(Math.max.apply(Math,o.globals.series.map(function(a){return a.length})))}},{key:"getLargestMarkerSize",value:function(){var o=this.w,a=0;return o.globals.markers.size.forEach(function(d){a=Math.max(a,d)}),o.globals.markers.largestSize=a,a}},{key:"getSeriesTotals",value:function(){var o=this.w;o.globals.seriesTotals=o.globals.series.map(function(a,d){var g=0;if(Array.isArray(a))for(var _=0;_<a.length;_++)g+=a[_];else g+=a;return g})}},{key:"getSeriesTotalsXRange",value:function(o,a){var d=this.w;return d.globals.series.map(function(g,_){for(var D=0,C=0;C<g.length;C++)d.globals.seriesX[_][C]>o&&d.globals.seriesX[_][C]<a&&(D+=g[C]);return D})}},{key:"getPercentSeries",value:function(){var o=this.w;o.globals.seriesPercent=o.globals.series.map(function(a,d){var g=[];if(Array.isArray(a))for(var _=0;_<a.length;_++){var D=o.globals.stackedSeriesTotals[_],C=0;D&&(C=100*a[_]/D),g.push(C)}else{var T=100*a/o.globals.seriesTotals.reduce(function(P,L){return P+L},0);g.push(T)}return g})}},{key:"getCalculatedRatios",value:function(){var o,a,d,g,_=this.w.globals,D=[],C=0,T=[],P=.1,L=0;if(_.yRange=[],_.isMultipleYAxis)for(var B=0;B<_.minYArr.length;B++)_.yRange.push(Math.abs(_.minYArr[B]-_.maxYArr[B])),T.push(0);else _.yRange.push(Math.abs(_.minY-_.maxY));_.xRange=Math.abs(_.maxX-_.minX),_.zRange=Math.abs(_.maxZ-_.minZ);for(var V=0;V<_.yRange.length;V++)D.push(_.yRange[V]/_.gridHeight);if(a=_.xRange/_.gridWidth,d=Math.abs(_.initialMaxX-_.initialMinX)/_.gridWidth,o=_.yRange/_.gridWidth,g=_.xRange/_.gridHeight,(C=_.zRange/_.gridHeight*16)||(C=1),_.minY!==Number.MIN_VALUE&&0!==Math.abs(_.minY)&&(_.hasNegs=!0),_.isMultipleYAxis){T=[];for(var $=0;$<D.length;$++)T.push(-_.minYArr[$]/D[$])}else T.push(-_.minY/D[0]),_.minY!==Number.MIN_VALUE&&0!==Math.abs(_.minY)&&(P=-_.minY/o,L=_.minX/a);return{yRatio:D,invertedYRatio:o,zRatio:C,xRatio:a,initialXRatio:d,invertedXRatio:g,baseLineInvertedY:P,baseLineY:T,baseLineX:L}}},{key:"getLogSeries",value:function(o){var a=this,d=this.w;return d.globals.seriesLog=o.map(function(g,_){return d.config.yaxis[_]&&d.config.yaxis[_].logarithmic?g.map(function(D){return null===D?null:a.getLogVal(D,_)}):g}),d.globals.invalidLogScale?o:d.globals.seriesLog}},{key:"getLogVal",value:function(o,a){var d=this.w;return(Math.log(o)-Math.log(d.globals.minYArr[a]))/(Math.log(d.globals.maxYArr[a])-Math.log(d.globals.minYArr[a]))}},{key:"getLogYRatios",value:function(o){var a=this,d=this.w,g=this.w.globals;return g.yLogRatio=o.slice(),g.logYRange=g.yRange.map(function(_,D){if(d.config.yaxis[D]&&a.w.config.yaxis[D].logarithmic){var C,T=-Number.MAX_VALUE,P=Number.MIN_VALUE;return g.seriesLog.forEach(function(L,B){L.forEach(function(V){d.config.yaxis[B]&&d.config.yaxis[B].logarithmic&&(T=Math.max(V,T),P=Math.min(V,P))})}),C=Math.pow(g.yRange[D],Math.abs(P-T)/g.yRange[D]),g.yLogRatio[D]=C/g.gridHeight,C}}),g.invalidLogScale?o.slice():g.yLogRatio}}],[{key:"checkComboSeries",value:function(o){var a=!1,d=0,g=0;return o.length&&void 0!==o[0].type&&o.forEach(function(_){"bar"!==_.type&&"column"!==_.type&&"candlestick"!==_.type&&"boxPlot"!==_.type||d++,void 0!==_.type&&g++}),g>0&&(a=!0),{comboBarCount:d,comboCharts:a}}},{key:"extendArrayProps",value:function(o,a,d){return a.yaxis&&(a=o.extendYAxis(a,d)),a.annotations&&(a.annotations.yaxis&&(a=o.extendYAxisAnnotations(a)),a.annotations.xaxis&&(a=o.extendXAxisAnnotations(a)),a.annotations.points&&(a=o.extendPointAnnotations(a))),a}}]),te}(),va=function(){function te(o){zt(this,te),this.w=o.w,this.annoCtx=o}return St(te,[{key:"addYaxisAnnotation",value:function(o,a,d){var g,_=this.w,D=o.strokeDashArray,C=this._getY1Y2("y1",o),T=o.label.text;if(null==o.y2){var P=this.annoCtx.graphics.drawLine(0+o.offsetX,C+o.offsetY,this._getYAxisAnnotationWidth(o),C+o.offsetY,o.borderColor,D,o.borderWidth);a.appendChild(P.node),o.id&&P.node.classList.add(o.id)}else{if((g=this._getY1Y2("y2",o))>C){var L=C;C=g,g=L}var B=this.annoCtx.graphics.drawRect(0+o.offsetX,g+o.offsetY,this._getYAxisAnnotationWidth(o),C-g,0,o.fillColor,o.opacity,1,o.borderColor,D);B.node.classList.add("apexcharts-annotation-rect"),B.attr("clip-path","url(#gridRectMask".concat(_.globals.cuid,")")),a.appendChild(B.node),o.id&&B.node.classList.add(o.id)}var $=this.annoCtx.graphics.drawText({x:("right"===o.label.position?_.globals.gridWidth:0)+o.label.offsetX,y:(null!=g?g:C)+o.label.offsetY-3,text:T,textAnchor:o.label.textAnchor,fontSize:o.label.style.fontSize,fontFamily:o.label.style.fontFamily,fontWeight:o.label.style.fontWeight,foreColor:o.label.style.color,cssClass:"apexcharts-yaxis-annotation-label ".concat(o.label.style.cssClass," ").concat(o.id?o.id:"")});$.attr({rel:d}),a.appendChild($.node)}},{key:"_getY1Y2",value:function(o,a){var d,g="y1"===o?a.y:a.y2,_=this.w;if(this.annoCtx.invertAxis){var D=_.globals.labels.indexOf(g);_.config.xaxis.convertedCatToNumeric&&(D=_.globals.categoryLabels.indexOf(g));var C=_.globals.dom.baseEl.querySelector(".apexcharts-yaxis-texts-g text:nth-child("+(D+1)+")");C&&(d=parseFloat(C.getAttribute("y")))}else{var T;T=_.config.yaxis[a.yAxisIndex].logarithmic?(g=new fi(this.annoCtx.ctx).getLogVal(g,a.yAxisIndex))/_.globals.yLogRatio[a.yAxisIndex]:(g-_.globals.minYArr[a.yAxisIndex])/(_.globals.yRange[a.yAxisIndex]/_.globals.gridHeight),d=_.globals.gridHeight-T,_.config.yaxis[a.yAxisIndex]&&_.config.yaxis[a.yAxisIndex].reversed&&(d=T)}return d}},{key:"_getYAxisAnnotationWidth",value:function(o){var a=this.w;return(o.width.indexOf("%")>-1?a.globals.gridWidth*parseInt(o.width,10)/100:parseInt(o.width,10))+o.offsetX}},{key:"drawYAxisAnnotations",value:function(){var o=this,a=this.w,d=this.annoCtx.graphics.group({class:"apexcharts-yaxis-annotations"});return a.config.annotations.yaxis.map(function(g,_){o.addYaxisAnnotation(g,d.node,_)}),d}}]),te}(),Mi=function(){function te(o){zt(this,te),this.w=o.w,this.annoCtx=o}return St(te,[{key:"addPointAnnotation",value:function(o,a,d){var g=this.w,_=0,D=0,C=0;this.annoCtx.invertAxis&&console.warn("Point annotation is not supported in horizontal bar charts.");var T=parseFloat(o.y);if("string"==typeof o.x||"category"===g.config.xaxis.type||g.config.xaxis.convertedCatToNumeric){var P=g.globals.labels.indexOf(o.x);g.config.xaxis.convertedCatToNumeric&&(P=g.globals.categoryLabels.indexOf(o.x)),_=this.annoCtx.helpers.getStringX(o.x),null===o.y&&(T=g.globals.series[o.seriesIndex][P])}else _=(o.x-g.globals.minX)/(g.globals.xRange/g.globals.gridWidth);for(var L,B=[],V=0,$=0;$<=o.seriesIndex;$++){var q=g.config.yaxis[$].seriesName;if(q)for(var K=$+1;K<=o.seriesIndex;K++)g.config.yaxis[K].seriesName===q&&-1===B.indexOf(q)&&(V++,B.push(q))}if(g.config.yaxis[o.yAxisIndex].logarithmic)L=(T=new fi(this.annoCtx.ctx).getLogVal(T,o.yAxisIndex))/g.globals.yLogRatio[o.yAxisIndex];else{var oe=o.yAxisIndex+V;L=(T-g.globals.minYArr[oe])/(g.globals.yRange[oe]/g.globals.gridHeight)}if(D=g.globals.gridHeight-L-parseFloat(o.label.style.fontSize)-o.marker.size,C=g.globals.gridHeight-L,g.config.yaxis[o.yAxisIndex]&&g.config.yaxis[o.yAxisIndex].reversed&&(D=L+parseFloat(o.label.style.fontSize)+o.marker.size,C=L),Xe.isNumber(_)){var ae={pSize:o.marker.size,pointStrokeWidth:o.marker.strokeWidth,pointFillColor:o.marker.fillColor,pointStrokeColor:o.marker.strokeColor,shape:o.marker.shape,pRadius:o.marker.radius,class:"apexcharts-point-annotation-marker ".concat(o.marker.cssClass," ").concat(o.id?o.id:"")},fe=this.annoCtx.graphics.drawMarker(_+o.marker.offsetX,C+o.marker.offsetY,ae);a.appendChild(fe.node);var R=this.annoCtx.graphics.drawText({x:_+o.label.offsetX,y:D+o.label.offsetY,text:o.label.text?o.label.text:"",textAnchor:o.label.textAnchor,fontSize:o.label.style.fontSize,fontFamily:o.label.style.fontFamily,fontWeight:o.label.style.fontWeight,foreColor:o.label.style.color,cssClass:"apexcharts-point-annotation-label ".concat(o.label.style.cssClass," ").concat(o.id?o.id:"")});if(R.attr({rel:d}),a.appendChild(R.node),o.customSVG.SVG){var H=this.annoCtx.graphics.group({class:"apexcharts-point-annotations-custom-svg "+o.customSVG.cssClass});H.attr({transform:"translate(".concat(_+o.customSVG.offsetX,", ").concat(D+o.customSVG.offsetY,")")}),H.node.innerHTML=o.customSVG.SVG,a.appendChild(H.node)}if(o.image.path){var Q=o.image.width?o.image.width:20,le=o.image.height?o.image.height:20;this.annoCtx.addImage({x:_+o.image.offsetX-Q/2,y:D+o.image.offsetY-le/2,width:Q,height:le,path:o.image.path,appendTo:".apexcharts-point-annotations"})}}}},{key:"drawPointAnnotations",value:function(){var o=this,a=this.w,d=this.annoCtx.graphics.group({class:"apexcharts-point-annotations"});return a.config.annotations.points.map(function(g,_){o.addPointAnnotation(g,d.node,_)}),d}}]),te}(),cc={name:"en",options:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],toolbar:{exportToSVG:"Download SVG",exportToPNG:"Download PNG",exportToCSV:"Download CSV",menu:"Menu",selection:"Selection",selectionZoom:"Selection Zoom",zoomIn:"Zoom In",zoomOut:"Zoom Out",pan:"Panning",reset:"Reset Zoom"}}},Fr=function(){function te(){zt(this,te),this.yAxis={show:!0,showAlways:!1,showForNullSeries:!0,seriesName:void 0,opposite:!1,reversed:!1,logarithmic:!1,logBase:10,tickAmount:void 0,forceNiceScale:!1,max:void 0,min:void 0,floating:!1,decimalsInFloat:void 0,labels:{show:!0,minWidth:0,maxWidth:160,offsetX:0,offsetY:0,align:void 0,rotate:0,padding:20,style:{colors:[],fontSize:"11px",fontWeight:400,fontFamily:void 0,cssClass:""},formatter:void 0},axisBorder:{show:!1,color:"#e0e0e0",width:1,offsetX:0,offsetY:0},axisTicks:{show:!1,color:"#e0e0e0",width:6,offsetX:0,offsetY:0},title:{text:void 0,rotate:-90,offsetY:0,offsetX:0,style:{color:void 0,fontSize:"11px",fontWeight:900,fontFamily:void 0,cssClass:""}},tooltip:{enabled:!1,offsetX:0},crosshairs:{show:!0,position:"front",stroke:{color:"#b6b6b6",width:1,dashArray:0}}},this.pointAnnotation={x:0,y:null,yAxisIndex:0,seriesIndex:0,marker:{size:4,fillColor:"#fff",strokeWidth:2,strokeColor:"#333",shape:"circle",offsetX:0,offsetY:0,radius:2,cssClass:""},label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"middle",offsetX:0,offsetY:0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}},customSVG:{SVG:void 0,cssClass:void 0,offsetX:0,offsetY:0},image:{path:void 0,width:20,height:20,offsetX:0,offsetY:0}},this.yAxisAnnotation={y:0,y2:null,strokeDashArray:1,fillColor:"#c2c2c2",borderColor:"#c2c2c2",borderWidth:1,opacity:.3,offsetX:0,offsetY:0,width:"100%",yAxisIndex:0,label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"end",position:"right",offsetX:0,offsetY:-3,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}}},this.xAxisAnnotation={x:0,x2:null,strokeDashArray:1,fillColor:"#c2c2c2",borderColor:"#c2c2c2",borderWidth:1,opacity:.3,offsetX:0,offsetY:0,label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"middle",orientation:"vertical",position:"top",offsetX:0,offsetY:0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}}},this.text={x:0,y:0,text:"",textAnchor:"start",foreColor:void 0,fontSize:"13px",fontFamily:void 0,fontWeight:400,appendTo:".apexcharts-annotations",backgroundColor:"transparent",borderColor:"#c2c2c2",borderRadius:0,borderWidth:0,paddingLeft:4,paddingRight:4,paddingTop:2,paddingBottom:2}}return St(te,[{key:"init",value:function(){return{annotations:{position:"front",yaxis:[this.yAxisAnnotation],xaxis:[this.xAxisAnnotation],points:[this.pointAnnotation],texts:[],images:[],shapes:[]},chart:{animations:{enabled:!0,easing:"easeinout",speed:800,animateGradually:{delay:150,enabled:!0},dynamicAnimation:{enabled:!0,speed:350}},background:"transparent",locales:[cc],defaultLocale:"en",dropShadow:{enabled:!1,enabledOnSeries:void 0,top:2,left:2,blur:4,color:"#000",opacity:.35},events:{animationEnd:void 0,beforeMount:void 0,mounted:void 0,updated:void 0,click:void 0,mouseMove:void 0,mouseLeave:void 0,legendClick:void 0,markerClick:void 0,selection:void 0,dataPointSelection:void 0,dataPointMouseEnter:void 0,dataPointMouseLeave:void 0,beforeZoom:void 0,beforeResetZoom:void 0,zoomed:void 0,scrolled:void 0,brushScrolled:void 0},foreColor:"#373d3f",fontFamily:"Helvetica, Arial, sans-serif",height:"auto",parentHeightOffset:15,redrawOnParentResize:!0,redrawOnWindowResize:!0,id:void 0,group:void 0,offsetX:0,offsetY:0,selection:{enabled:!1,type:"x",fill:{color:"#24292e",opacity:.1},stroke:{width:1,color:"#24292e",opacity:.4,dashArray:3},xaxis:{min:void 0,max:void 0},yaxis:{min:void 0,max:void 0}},sparkline:{enabled:!1},brush:{enabled:!1,autoScaleYaxis:!0,target:void 0},stacked:!1,stackType:"normal",toolbar:{show:!0,offsetX:0,offsetY:0,tools:{download:!0,selection:!0,zoom:!0,zoomin:!0,zoomout:!0,pan:!0,reset:!0,customIcons:[]},export:{csv:{filename:void 0,columnDelimiter:",",headerCategory:"category",headerValue:"value",dateFormatter:function(o){return new Date(o).toDateString()}},png:{filename:void 0},svg:{filename:void 0}},autoSelected:"zoom"},type:"line",width:"100%",zoom:{enabled:!0,type:"x",autoScaleYaxis:!1,zoomedArea:{fill:{color:"#90CAF9",opacity:.4},stroke:{color:"#0D47A1",opacity:.4,width:1}}}},plotOptions:{area:{fillTo:"origin"},bar:{horizontal:!1,columnWidth:"70%",barHeight:"70%",distributed:!1,borderRadius:0,rangeBarOverlap:!0,rangeBarGroupRows:!1,colors:{ranges:[],backgroundBarColors:[],backgroundBarOpacity:1,backgroundBarRadius:0},dataLabels:{position:"top",maxItems:100,hideOverflowingLabels:!0,orientation:"horizontal"}},bubble:{minBubbleRadius:void 0,maxBubbleRadius:void 0},candlestick:{colors:{upward:"#00B746",downward:"#EF403C"},wick:{useFillColor:!0}},boxPlot:{colors:{upper:"#00E396",lower:"#008FFB"}},heatmap:{radius:2,enableShades:!0,shadeIntensity:.5,reverseNegativeShade:!1,distributed:!1,useFillColorAsStroke:!1,colorScale:{inverse:!1,ranges:[],min:void 0,max:void 0}},treemap:{enableShades:!0,shadeIntensity:.5,distributed:!1,reverseNegativeShade:!1,useFillColorAsStroke:!1,colorScale:{inverse:!1,ranges:[],min:void 0,max:void 0}},radialBar:{inverseOrder:!1,startAngle:0,endAngle:360,offsetX:0,offsetY:0,hollow:{margin:5,size:"50%",background:"transparent",image:void 0,imageWidth:150,imageHeight:150,imageOffsetX:0,imageOffsetY:0,imageClipped:!0,position:"front",dropShadow:{enabled:!1,top:0,left:0,blur:3,color:"#000",opacity:.5}},track:{show:!0,startAngle:void 0,endAngle:void 0,background:"#f2f2f2",strokeWidth:"97%",opacity:1,margin:5,dropShadow:{enabled:!1,top:0,left:0,blur:3,color:"#000",opacity:.5}},dataLabels:{show:!0,name:{show:!0,fontSize:"16px",fontFamily:void 0,fontWeight:600,color:void 0,offsetY:0,formatter:function(o){return o}},value:{show:!0,fontSize:"14px",fontFamily:void 0,fontWeight:400,color:void 0,offsetY:16,formatter:function(o){return o+"%"}},total:{show:!1,label:"Total",fontSize:"16px",fontWeight:600,fontFamily:void 0,color:void 0,formatter:function(o){return o.globals.seriesTotals.reduce(function(a,d){return a+d},0)/o.globals.series.length+"%"}}}},pie:{customScale:1,offsetX:0,offsetY:0,startAngle:0,endAngle:360,expandOnClick:!0,dataLabels:{offset:0,minAngleToShowLabel:10},donut:{size:"65%",background:"transparent",labels:{show:!1,name:{show:!0,fontSize:"16px",fontFamily:void 0,fontWeight:600,color:void 0,offsetY:-10,formatter:function(o){return o}},value:{show:!0,fontSize:"20px",fontFamily:void 0,fontWeight:400,color:void 0,offsetY:10,formatter:function(o){return o}},total:{show:!1,showAlways:!1,label:"Total",fontSize:"16px",fontWeight:400,fontFamily:void 0,color:void 0,formatter:function(o){return o.globals.seriesTotals.reduce(function(a,d){return a+d},0)}}}}},polarArea:{rings:{strokeWidth:1,strokeColor:"#e8e8e8"},spokes:{strokeWidth:1,connectorColors:"#e8e8e8"}},radar:{size:void 0,offsetX:0,offsetY:0,polygons:{strokeWidth:1,strokeColors:"#e8e8e8",connectorColors:"#e8e8e8",fill:{colors:void 0}}}},colors:void 0,dataLabels:{enabled:!0,enabledOnSeries:void 0,formatter:function(o){return null!==o?o:""},textAnchor:"middle",distributed:!1,offsetX:0,offsetY:0,style:{fontSize:"12px",fontFamily:void 0,fontWeight:600,colors:void 0},background:{enabled:!0,foreColor:"#fff",borderRadius:2,padding:4,opacity:.9,borderWidth:1,borderColor:"#fff",dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.45}},dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.45}},fill:{type:"solid",colors:void 0,opacity:.85,gradient:{shade:"dark",type:"horizontal",shadeIntensity:.5,gradientToColors:void 0,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,50,100],colorStops:[]},image:{src:[],width:void 0,height:void 0},pattern:{style:"squares",width:6,height:6,strokeWidth:2}},forecastDataPoints:{count:0,fillOpacity:.5,strokeWidth:void 0,dashArray:4},grid:{show:!0,borderColor:"#e0e0e0",strokeDashArray:0,position:"back",xaxis:{lines:{show:!1}},yaxis:{lines:{show:!0}},row:{colors:void 0,opacity:.5},column:{colors:void 0,opacity:.5},padding:{top:0,right:10,bottom:0,left:12}},labels:[],legend:{show:!0,showForSingleSeries:!1,showForNullSeries:!0,showForZeroSeries:!0,floating:!1,position:"bottom",horizontalAlign:"center",inverseOrder:!1,fontSize:"12px",fontFamily:void 0,fontWeight:400,width:void 0,height:void 0,formatter:void 0,tooltipHoverFormatter:void 0,offsetX:-20,offsetY:4,customLegendItems:[],labels:{colors:void 0,useSeriesColors:!1},markers:{width:12,height:12,strokeWidth:0,fillColors:void 0,strokeColor:"#fff",radius:12,customHTML:void 0,offsetX:0,offsetY:0,onClick:void 0},itemMargin:{horizontal:5,vertical:2},onItemClick:{toggleDataSeries:!0},onItemHover:{highlightDataSeries:!0}},markers:{discrete:[],size:0,colors:void 0,strokeColors:"#fff",strokeWidth:2,strokeOpacity:.9,strokeDashArray:0,fillOpacity:1,shape:"circle",width:8,height:8,radius:2,offsetX:0,offsetY:0,onClick:void 0,onDblClick:void 0,showNullDataPoints:!0,hover:{size:void 0,sizeOffset:3}},noData:{text:void 0,align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{color:void 0,fontSize:"14px",fontFamily:void 0}},responsive:[],series:void 0,states:{normal:{filter:{type:"none",value:0}},hover:{filter:{type:"lighten",value:.1}},active:{allowMultipleDataPointsSelection:!1,filter:{type:"darken",value:.5}}},title:{text:void 0,align:"left",margin:5,offsetX:0,offsetY:0,floating:!1,style:{fontSize:"14px",fontWeight:900,fontFamily:void 0,color:void 0}},subtitle:{text:void 0,align:"left",margin:5,offsetX:0,offsetY:30,floating:!1,style:{fontSize:"12px",fontWeight:400,fontFamily:void 0,color:void 0}},stroke:{show:!0,curve:"smooth",lineCap:"butt",width:2,colors:void 0,dashArray:0},tooltip:{enabled:!0,enabledOnSeries:void 0,shared:!0,followCursor:!1,intersect:!1,inverseOrder:!1,custom:void 0,fillSeriesColor:!1,theme:"light",style:{fontSize:"12px",fontFamily:void 0},onDatasetHover:{highlightDataSeries:!1},x:{show:!0,format:"dd MMM",formatter:void 0},y:{formatter:void 0,title:{formatter:function(o){return o?o+": ":""}}},z:{formatter:void 0,title:"Size: "},marker:{show:!0,fillColors:void 0},items:{display:"flex"},fixed:{enabled:!1,position:"topRight",offsetX:0,offsetY:0}},xaxis:{type:"category",categories:[],convertedCatToNumeric:!1,offsetX:0,offsetY:0,overwriteCategories:void 0,labels:{show:!0,rotate:-45,rotateAlways:!1,hideOverlappingLabels:!0,trim:!1,minHeight:void 0,maxHeight:120,showDuplicates:!0,style:{colors:[],fontSize:"12px",fontWeight:400,fontFamily:void 0,cssClass:""},offsetX:0,offsetY:0,format:void 0,formatter:void 0,datetimeUTC:!0,datetimeFormatter:{year:"yyyy",month:"MMM 'yy",day:"dd MMM",hour:"HH:mm",minute:"HH:mm:ss",second:"HH:mm:ss"}},axisBorder:{show:!0,color:"#e0e0e0",width:"100%",height:1,offsetX:0,offsetY:0},axisTicks:{show:!0,color:"#e0e0e0",height:6,offsetX:0,offsetY:0},tickAmount:void 0,tickPlacement:"on",min:void 0,max:void 0,range:void 0,floating:!1,decimalsInFloat:void 0,position:"bottom",title:{text:void 0,offsetX:0,offsetY:0,style:{color:void 0,fontSize:"12px",fontWeight:900,fontFamily:void 0,cssClass:""}},crosshairs:{show:!0,width:1,position:"back",opacity:.9,stroke:{color:"#b6b6b6",width:1,dashArray:3},fill:{type:"solid",color:"#B1B9C4",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}},dropShadow:{enabled:!1,left:0,top:0,blur:1,opacity:.4}},tooltip:{enabled:!0,offsetY:0,formatter:void 0,style:{fontSize:"12px",fontFamily:void 0}}},yaxis:this.yAxis,theme:{mode:"light",palette:"palette1",monochrome:{enabled:!1,color:"#008FFB",shadeTo:"light",shadeIntensity:.65}}}}}]),te}(),as=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.graphics=new yt(this.ctx),this.w.globals.isBarHorizontal&&(this.invertAxis=!0),this.helpers=new On(this),this.xAxisAnnotations=new Ro(this),this.yAxisAnnotations=new va(this),this.pointsAnnotations=new Mi(this),this.w.globals.isBarHorizontal&&this.w.config.yaxis[0].reversed&&(this.inversedReversedAxis=!0),this.xDivision=this.w.globals.gridWidth/this.w.globals.dataPoints}return St(te,[{key:"drawAxesAnnotations",value:function(){var o=this.w;if(o.globals.axisCharts){for(var a=this.yAxisAnnotations.drawYAxisAnnotations(),d=this.xAxisAnnotations.drawXAxisAnnotations(),g=this.pointsAnnotations.drawPointAnnotations(),_=o.config.chart.animations.enabled,D=[a,d,g],C=[d.node,a.node,g.node],T=0;T<3;T++)o.globals.dom.elGraphical.add(D[T]),!_||o.globals.resized||o.globals.dataChanged||"scatter"!==o.config.chart.type&&"bubble"!==o.config.chart.type&&o.globals.dataPoints>1&&C[T].classList.add("apexcharts-element-hidden"),o.globals.delayedElements.push({el:C[T],index:0});this.helpers.annotationsBackground()}}},{key:"drawImageAnnos",value:function(){var o=this;this.w.config.annotations.images.map(function(a,d){o.addImage(a,d)})}},{key:"drawTextAnnos",value:function(){var o=this;this.w.config.annotations.texts.map(function(a,d){o.addText(a,d)})}},{key:"addXaxisAnnotation",value:function(o,a,d){this.xAxisAnnotations.addXaxisAnnotation(o,a,d)}},{key:"addYaxisAnnotation",value:function(o,a,d){this.yAxisAnnotations.addYaxisAnnotation(o,a,d)}},{key:"addPointAnnotation",value:function(o,a,d){this.pointsAnnotations.addPointAnnotation(o,a,d)}},{key:"addText",value:function(o,a){var _=o.text,V=o.backgroundColor,$=o.borderWidth,q=o.strokeDashArray,K=o.borderRadius,oe=o.borderColor,ae=o.appendTo,fe=void 0===ae?".apexcharts-annotations":ae,ge=o.paddingLeft,R=void 0===ge?4:ge,H=o.paddingRight,Q=void 0===H?4:H,le=o.paddingBottom,Re=void 0===le?2:le,tt=o.paddingTop,Ve=void 0===tt?2:tt,Dt=this.w,pt=this.graphics.drawText({x:o.x,y:o.y,text:_,textAnchor:o.textAnchor||"start",fontSize:o.fontSize||"12px",fontWeight:o.fontWeight||"regular",fontFamily:o.fontFamily||Dt.config.chart.fontFamily,foreColor:o.foreColor||Dt.config.chart.foreColor,cssClass:o.cssClass}),qe=Dt.globals.dom.baseEl.querySelector(fe);qe&&qe.appendChild(pt.node);var Vt=pt.bbox();if(_){var Yn=this.graphics.drawRect(Vt.x-R,Vt.y-Ve,Vt.width+R+Q,Vt.height+Re+Ve,K,V||"transparent",1,$,oe,q);qe.insertBefore(Yn.node,pt.node)}}},{key:"addImage",value:function(o,a){var d=this.w,_=o.x,D=void 0===_?0:_,C=o.y,T=void 0===C?0:C,P=o.width,L=void 0===P?20:P,B=o.height,V=void 0===B?20:B,$=o.appendTo,q=void 0===$?".apexcharts-annotations":$,K=d.globals.dom.Paper.image(o.path);K.size(L,V).move(D,T);var oe=d.globals.dom.baseEl.querySelector(q);oe&&oe.appendChild(K.node)}},{key:"addXaxisAnnotationExternal",value:function(o,a,d){return this.addAnnotationExternal({params:o,pushToMemory:a,context:d,type:"xaxis",contextMethod:d.addXaxisAnnotation}),d}},{key:"addYaxisAnnotationExternal",value:function(o,a,d){return this.addAnnotationExternal({params:o,pushToMemory:a,context:d,type:"yaxis",contextMethod:d.addYaxisAnnotation}),d}},{key:"addPointAnnotationExternal",value:function(o,a,d){return void 0===this.invertAxis&&(this.invertAxis=d.w.globals.isBarHorizontal),this.addAnnotationExternal({params:o,pushToMemory:a,context:d,type:"point",contextMethod:d.addPointAnnotation}),d}},{key:"addAnnotationExternal",value:function(o){var a=o.params,d=o.pushToMemory,g=o.context,_=o.type,D=o.contextMethod,C=g,T=C.w,P=T.globals.dom.baseEl.querySelector(".apexcharts-".concat(_,"-annotations")),L=P.childNodes.length+1,B=new Fr,V=Object.assign({},"xaxis"===_?B.xAxisAnnotation:"yaxis"===_?B.yAxisAnnotation:B.pointAnnotation),$=Xe.extend(V,a);switch(_){case"xaxis":this.addXaxisAnnotation($,P,L);break;case"yaxis":this.addYaxisAnnotation($,P,L);break;case"point":this.addPointAnnotation($,P,L)}var q=T.globals.dom.baseEl.querySelector(".apexcharts-".concat(_,"-annotations .apexcharts-").concat(_,"-annotation-label[rel='").concat(L,"']")),K=this.helpers.addBackgroundToAnno(q,$);return K&&P.insertBefore(K.node,q),d&&T.globals.memory.methodsToExec.push({context:C,id:$.id?$.id:Xe.randomId(),method:D,label:"addAnnotation",params:a}),g}},{key:"clearAnnotations",value:function(o){var a=o.w,d=a.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis-annotations, .apexcharts-xaxis-annotations, .apexcharts-point-annotations");a.globals.memory.methodsToExec.map(function(g,_){"addText"!==g.label&&"addAnnotation"!==g.label||a.globals.memory.methodsToExec.splice(_,1)}),d=Xe.listToArray(d),Array.prototype.forEach.call(d,function(g){for(;g.firstChild;)g.removeChild(g.firstChild)})}},{key:"removeAnnotation",value:function(o,a){var d=o.w,g=d.globals.dom.baseEl.querySelectorAll(".".concat(a));g&&(d.globals.memory.methodsToExec.map(function(_,D){_.id===a&&d.globals.memory.methodsToExec.splice(D,1)}),Array.prototype.forEach.call(g,function(_){_.parentElement.removeChild(_)}))}}]),te}(),Xr=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.opts=null,this.seriesIndex=0}return St(te,[{key:"clippedImgArea",value:function(o){var a=this.w,d=a.config,g=parseInt(a.globals.gridWidth,10),_=parseInt(a.globals.gridHeight,10),D=g>_?g:_,C=o.image,T=0,P=0;void 0===o.width&&void 0===o.height?void 0!==d.fill.image.width&&void 0!==d.fill.image.height?(T=d.fill.image.width+1,P=d.fill.image.height):(T=D+1,P=D):(T=o.width,P=o.height);var L=document.createElementNS(a.globals.SVGNS,"pattern");yt.setAttrs(L,{id:o.patternID,patternUnits:o.patternUnits?o.patternUnits:"userSpaceOnUse",width:T+"px",height:P+"px"});var B=document.createElementNS(a.globals.SVGNS,"image");L.appendChild(B),B.setAttributeNS(window.SVG.xlink,"href",C),yt.setAttrs(B,{x:0,y:0,preserveAspectRatio:"none",width:T+"px",height:P+"px"}),B.style.opacity=o.opacity,a.globals.dom.elDefs.node.appendChild(L)}},{key:"getSeriesIndex",value:function(o){var a=this.w;return this.seriesIndex=("bar"===a.config.chart.type||"rangeBar"===a.config.chart.type)&&a.config.plotOptions.bar.distributed||"heatmap"===a.config.chart.type||"treemap"===a.config.chart.type?o.seriesNumber:o.seriesNumber%a.globals.series.length,this.seriesIndex}},{key:"fillPath",value:function(o){var a=this.w;this.opts=o;var d,g,_,D=this.w.config;this.seriesIndex=this.getSeriesIndex(o);var C=this.getFillColors()[this.seriesIndex];void 0!==a.globals.seriesColors[this.seriesIndex]&&(C=a.globals.seriesColors[this.seriesIndex]),"function"==typeof C&&(C=C({seriesIndex:this.seriesIndex,dataPointIndex:o.dataPointIndex,value:o.value,w:a}));var T=this.getFillType(this.seriesIndex),P=Array.isArray(D.fill.opacity)?D.fill.opacity[this.seriesIndex]:D.fill.opacity;o.color&&(C=o.color);var L=C;if(-1===C.indexOf("rgb")?C.length<9&&(L=Xe.hexToRgba(C,P)):C.indexOf("rgba")>-1&&(P=Xe.getOpacityFromRGBA(C)),o.opacity&&(P=o.opacity),"pattern"===T&&(g=this.handlePatternFill(g,C,P,L)),"gradient"===T&&(_=this.handleGradientFill(C,P,this.seriesIndex)),"image"===T){var B=D.fill.image.src,V=o.patternID?o.patternID:"";this.clippedImgArea({opacity:P,image:Array.isArray(B)?o.seriesNumber<B.length?B[o.seriesNumber]:B[0]:B,width:o.width?o.width:void 0,height:o.height?o.height:void 0,patternUnits:o.patternUnits,patternID:"pattern".concat(a.globals.cuid).concat(o.seriesNumber+1).concat(V)}),d="url(#pattern".concat(a.globals.cuid).concat(o.seriesNumber+1).concat(V,")")}else d="gradient"===T?_:"pattern"===T?g:L;return o.solid&&(d=L),d}},{key:"getFillType",value:function(o){var a=this.w;return Array.isArray(a.config.fill.type)?a.config.fill.type[o]:a.config.fill.type}},{key:"getFillColors",value:function(){var o=this.w,a=o.config,d=this.opts,g=[];return o.globals.comboCharts?"line"===o.config.series[this.seriesIndex].type?Array.isArray(o.globals.stroke.colors)?g=o.globals.stroke.colors:g.push(o.globals.stroke.colors):Array.isArray(o.globals.fill.colors)?g=o.globals.fill.colors:g.push(o.globals.fill.colors):"line"===a.chart.type?Array.isArray(o.globals.stroke.colors)?g=o.globals.stroke.colors:g.push(o.globals.stroke.colors):Array.isArray(o.globals.fill.colors)?g=o.globals.fill.colors:g.push(o.globals.fill.colors),void 0!==d.fillColors&&(g=[],Array.isArray(d.fillColors)?g=d.fillColors.slice():g.push(d.fillColors)),g}},{key:"handlePatternFill",value:function(o,a,d,g){var _=this.w.config,D=this.opts,C=new yt(this.ctx),T=void 0===_.fill.pattern.strokeWidth?Array.isArray(_.stroke.width)?_.stroke.width[this.seriesIndex]:_.stroke.width:Array.isArray(_.fill.pattern.strokeWidth)?_.fill.pattern.strokeWidth[this.seriesIndex]:_.fill.pattern.strokeWidth,P=a;return Array.isArray(_.fill.pattern.style)?void 0!==_.fill.pattern.style[D.seriesNumber]?C.drawPattern(_.fill.pattern.style[D.seriesNumber],_.fill.pattern.width,_.fill.pattern.height,P,T,d):g:C.drawPattern(_.fill.pattern.style,_.fill.pattern.width,_.fill.pattern.height,P,T,d)}},{key:"handleGradientFill",value:function(o,a,d){var g,_=this.w.config,D=this.opts,C=new yt(this.ctx),T=new Xe,P=_.fill.gradient.type,L=o,B=void 0===_.fill.gradient.opacityFrom?a:Array.isArray(_.fill.gradient.opacityFrom)?_.fill.gradient.opacityFrom[d]:_.fill.gradient.opacityFrom;L.indexOf("rgba")>-1&&(B=Xe.getOpacityFromRGBA(L));var V=void 0===_.fill.gradient.opacityTo?a:Array.isArray(_.fill.gradient.opacityTo)?_.fill.gradient.opacityTo[d]:_.fill.gradient.opacityTo;if(void 0===_.fill.gradient.gradientToColors||0===_.fill.gradient.gradientToColors.length)g=T.shadeColor("dark"===_.fill.gradient.shade?-1*parseFloat(_.fill.gradient.shadeIntensity):parseFloat(_.fill.gradient.shadeIntensity),o.indexOf("rgb")>-1?Xe.rgb2hex(o):o);else if(_.fill.gradient.gradientToColors[D.seriesNumber]){var $=_.fill.gradient.gradientToColors[D.seriesNumber];g=$,$.indexOf("rgba")>-1&&(V=Xe.getOpacityFromRGBA($))}else g=o;if(_.fill.gradient.inverseColors){var q=L;L=g,g=q}return L.indexOf("rgb")>-1&&(L=Xe.rgb2hex(L)),g.indexOf("rgb")>-1&&(g=Xe.rgb2hex(g)),C.drawGradient(P,L,g,B,V,D.size,_.fill.gradient.stops,_.fill.gradient.colorStops,d)}}]),te}(),uo=function(){function te(o,a){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"setGlobalMarkerSize",value:function(){var o=this.w;if(o.globals.markers.size=Array.isArray(o.config.markers.size)?o.config.markers.size:[o.config.markers.size],o.globals.markers.size.length>0){if(o.globals.markers.size.length<o.globals.series.length+1)for(var a=0;a<=o.globals.series.length;a++)void 0===o.globals.markers.size[a]&&o.globals.markers.size.push(o.globals.markers.size[0])}else o.globals.markers.size=o.config.series.map(function(d){return o.config.markers.size})}},{key:"plotChartMarkers",value:function(o,a,d,g){var _,D=arguments.length>4&&void 0!==arguments[4]&&arguments[4],C=this.w,T=a,P=o,L=null,B=new yt(this.ctx);if((C.globals.markers.size[a]>0||D)&&(L=B.group({class:D?"":"apexcharts-series-markers"})).attr("clip-path","url(#gridRectMarkerMask".concat(C.globals.cuid,")")),Array.isArray(P.x))for(var V=0;V<P.x.length;V++){var $=d;1===d&&0===V&&($=0),1===d&&1===V&&($=1);var q="apexcharts-marker";"line"!==C.config.chart.type&&"area"!==C.config.chart.type||C.globals.comboCharts||C.config.tooltip.intersect||(q+=" no-pointer-events");var K=Array.isArray(C.config.markers.size)?C.globals.markers.size[a]>0:C.config.markers.size>0;if(K||D){Xe.isNumber(P.y[V])?q+=" w".concat(Xe.randomId()):q="apexcharts-nullpoint";var oe=this.getMarkerConfig({cssClass:q,seriesIndex:a,dataPointIndex:$});C.config.series[T].data[$]&&(C.config.series[T].data[$].fillColor&&(oe.pointFillColor=C.config.series[T].data[$].fillColor),C.config.series[T].data[$].strokeColor&&(oe.pointStrokeColor=C.config.series[T].data[$].strokeColor)),g&&(oe.pSize=g),(_=B.drawMarker(P.x[V],P.y[V],oe)).attr("rel",$),_.attr("j",$),_.attr("index",a),_.node.setAttribute("default-marker-size",oe.pSize);var ae=new pi(this.ctx);ae.setSelectionFilter(_,a,$),this.addEvents(_),L&&L.add(_)}else void 0===C.globals.pointsArray[a]&&(C.globals.pointsArray[a]=[]),C.globals.pointsArray[a].push([P.x[V],P.y[V]])}return L}},{key:"getMarkerConfig",value:function(o){var a=o.cssClass,d=o.seriesIndex,g=o.dataPointIndex,_=void 0===g?null:g,D=o.finishRadius,C=void 0===D?null:D,T=this.w,P=this.getMarkerStyle(d),L=T.globals.markers.size[d],B=T.config.markers;return null!==_&&B.discrete.length&&B.discrete.map(function(V){V.seriesIndex===d&&V.dataPointIndex===_&&(P.pointStrokeColor=V.strokeColor,P.pointFillColor=V.fillColor,L=V.size,P.pointShape=V.shape)}),{pSize:null===C?L:C,pRadius:B.radius,width:Array.isArray(B.width)?B.width[d]:B.width,height:Array.isArray(B.height)?B.height[d]:B.height,pointStrokeWidth:Array.isArray(B.strokeWidth)?B.strokeWidth[d]:B.strokeWidth,pointStrokeColor:P.pointStrokeColor,pointFillColor:P.pointFillColor,shape:P.pointShape||(Array.isArray(B.shape)?B.shape[d]:B.shape),class:a,pointStrokeOpacity:Array.isArray(B.strokeOpacity)?B.strokeOpacity[d]:B.strokeOpacity,pointStrokeDashArray:Array.isArray(B.strokeDashArray)?B.strokeDashArray[d]:B.strokeDashArray,pointFillOpacity:Array.isArray(B.fillOpacity)?B.fillOpacity[d]:B.fillOpacity,seriesIndex:d}}},{key:"addEvents",value:function(o){var a=this.w,d=new yt(this.ctx);o.node.addEventListener("mouseenter",d.pathMouseEnter.bind(this.ctx,o)),o.node.addEventListener("mouseleave",d.pathMouseLeave.bind(this.ctx,o)),o.node.addEventListener("mousedown",d.pathMouseDown.bind(this.ctx,o)),o.node.addEventListener("click",a.config.markers.onClick),o.node.addEventListener("dblclick",a.config.markers.onDblClick),o.node.addEventListener("touchstart",d.pathMouseDown.bind(this.ctx,o),{passive:!0})}},{key:"getMarkerStyle",value:function(o){var a=this.w,d=a.globals.markers.colors,g=a.config.markers.strokeColor||a.config.markers.strokeColors;return{pointStrokeColor:Array.isArray(g)?g[o]:g,pointFillColor:Array.isArray(d)?d[o]:d}}}]),te}(),Cn=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.initialAnim=this.w.config.chart.animations.enabled,this.dynamicAnim=this.initialAnim&&this.w.config.chart.animations.dynamicAnimation.enabled}return St(te,[{key:"draw",value:function(o,a,d){var g=this.w,_=new yt(this.ctx),D=d.realIndex,C=d.pointsPos,T=d.zRatio,P=d.elParent,L=_.group({class:"apexcharts-series-markers apexcharts-series-".concat(g.config.chart.type)});if(L.attr("clip-path","url(#gridRectMarkerMask".concat(g.globals.cuid,")")),Array.isArray(C.x))for(var B=0;B<C.x.length;B++){var V=a+1,$=!0;0===a&&0===B&&(V=0),0===a&&1===B&&(V=1);var q=0,K=g.globals.markers.size[D];if(T!==1/0){K=g.globals.seriesZ[D][V]/T;var oe=g.config.plotOptions.bubble;oe.minBubbleRadius&&K<oe.minBubbleRadius&&(K=oe.minBubbleRadius),oe.maxBubbleRadius&&K>oe.maxBubbleRadius&&(K=oe.maxBubbleRadius)}g.config.chart.animations.enabled||(q=K);var fe=C.y[B];if(q=q||0,null!==fe&&void 0!==g.globals.series[D][V]||($=!1),$){var ge=this.drawPoint(C.x[B],fe,q,K,D,V,a);L.add(ge)}P.add(L)}}},{key:"drawPoint",value:function(o,a,d,g,_,D,C){var T=this.w,P=_,L=new mr(this.ctx),B=new pi(this.ctx),V=new Xr(this.ctx),$=new uo(this.ctx),q=new yt(this.ctx),K=$.getMarkerConfig({cssClass:"apexcharts-marker",seriesIndex:P,dataPointIndex:D,finishRadius:"bubble"===T.config.chart.type||T.globals.comboCharts&&T.config.series[_]&&"bubble"===T.config.series[_].type?g:null});g=K.pSize;var oe,ae=V.fillPath({seriesNumber:_,dataPointIndex:D,color:K.pointFillColor,patternUnits:"objectBoundingBox",value:T.globals.series[_][C]});if("circle"===K.shape?oe=q.drawCircle(d):"square"!==K.shape&&"rect"!==K.shape||(oe=q.drawRect(0,0,K.width-K.pointStrokeWidth/2,K.height-K.pointStrokeWidth/2,K.pRadius)),T.config.series[P].data[D]&&T.config.series[P].data[D].fillColor&&(ae=T.config.series[P].data[D].fillColor),oe.attr({x:o-K.width/2-K.pointStrokeWidth/2,y:a-K.height/2-K.pointStrokeWidth/2,cx:o,cy:a,fill:ae,"fill-opacity":K.pointFillOpacity,stroke:K.pointStrokeColor,r:g,"stroke-width":K.pointStrokeWidth,"stroke-dasharray":K.pointStrokeDashArray,"stroke-opacity":K.pointStrokeOpacity}),T.config.chart.dropShadow.enabled&&B.dropShadow(oe,T.config.chart.dropShadow,_),!this.initialAnim||T.globals.dataChanged||T.globals.resized?T.globals.animationEnded=!0:L.animateMarker(oe,0,"circle"===K.shape?g:{width:K.width,height:K.height},T.config.chart.animations.speed,T.globals.easing,function(){window.setTimeout(function(){L.animationCompleted(oe)},100)}),T.globals.dataChanged&&"circle"===K.shape)if(this.dynamicAnim){var R,H,Q,le,Re=T.config.chart.animations.dynamicAnimation.speed;null!=(le=T.globals.previousPaths[_]&&T.globals.previousPaths[_][C])&&(R=le.x,H=le.y,Q=void 0!==le.r?le.r:g);for(var tt=0;tt<T.globals.collapsedSeries.length;tt++)T.globals.collapsedSeries[tt].index===_&&(Re=1,g=0);0===o&&0===a&&(g=0),L.animateCircle(oe,{cx:R,cy:H,r:Q},{cx:o,cy:a,r:g},Re,T.globals.easing)}else oe.attr({r:g});return oe.attr({rel:D,j:D,index:_,"default-marker-size":g}),B.setSelectionFilter(oe,_,D),$.addEvents(oe),oe.node.classList.add("apexcharts-marker"),oe}},{key:"centerTextInBubble",value:function(o){return{y:o+=parseInt(this.w.config.dataLabels.style.fontSize,10)/4}}}]),te}(),ls=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"dataLabelsCorrection",value:function(o,a,d,g,_,D,C){var T=this.w,P=!1,L=new yt(this.ctx).getTextRects(d,C),B=L.width,V=L.height;if(a<0&&(a=0),a>T.globals.gridHeight+V&&(a=T.globals.gridHeight+V/2),void 0===T.globals.dataLabelsRects[g]&&(T.globals.dataLabelsRects[g]=[]),T.globals.dataLabelsRects[g].push({x:o,y:a,width:B,height:V}),void 0!==T.globals.dataLabelsRects[g][T.globals.dataLabelsRects[g].length-2]){var K=T.globals.dataLabelsRects[g][void 0!==T.globals.lastDrawnDataLabelsIndexes[g]?T.globals.lastDrawnDataLabelsIndexes[g][T.globals.lastDrawnDataLabelsIndexes[g].length-1]:0];(o>K.x+K.width+2||a>K.y+K.height+2||o+B<K.x)&&(P=!0)}return(0===_||D)&&(P=!0),{x:o,y:a,textRects:L,drawnextLabel:P}}},{key:"drawDataLabel",value:function(o,a,d){var g=this,_=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,D=this.w,C=new yt(this.ctx),T=D.config.dataLabels,P=0,L=0,B=d,V=null;if(!T.enabled||!Array.isArray(o.x))return V;V=C.group({class:"apexcharts-data-labels"});for(var $=0;$<o.x.length;$++)if(P=o.x[$]+T.offsetX,L=o.y[$]+T.offsetY+_,!isNaN(P)){1===d&&0===$&&(B=0),1===d&&1===$&&(B=1);var q=D.globals.series[a][B],K="",oe=function(ge){return D.config.dataLabels.formatter(ge,{ctx:g.ctx,seriesIndex:a,dataPointIndex:B,w:D})};if("bubble"===D.config.chart.type){K=oe(q=D.globals.seriesZ[a][B]),L=o.y[$];var ae=new Cn(this.ctx),fe=ae.centerTextInBubble(L,a,B);L=fe.y}else void 0!==q&&(K=oe(q));this.plotDataLabelsText({x:P,y:L,text:K,i:a,j:B,parent:V,offsetCorrection:!0,dataLabelsConfig:D.config.dataLabels})}return V}},{key:"plotDataLabelsText",value:function(o){var a=this.w,d=new yt(this.ctx),g=o.x,_=o.y,D=o.i,C=o.j,T=o.text,P=o.textAnchor,L=o.fontSize,B=o.parent,V=o.dataLabelsConfig,$=o.color,q=o.alwaysDrawDataLabel,K=o.offsetCorrection;if(!(Array.isArray(a.config.dataLabels.enabledOnSeries)&&a.config.dataLabels.enabledOnSeries.indexOf(D)<0)){var oe={x:g,y:_,drawnextLabel:!0};K&&(oe=this.dataLabelsCorrection(g,_,T,D,C,q,parseInt(V.style.fontSize,10))),a.globals.zoomed||(g=oe.x,_=oe.y),oe.textRects&&(g<-10-oe.textRects.width||g>a.globals.gridWidth+oe.textRects.width+10)&&(T="");var ae=a.globals.dataLabels.style.colors[D];(("bar"===a.config.chart.type||"rangeBar"===a.config.chart.type)&&a.config.plotOptions.bar.distributed||a.config.dataLabels.distributed)&&(ae=a.globals.dataLabels.style.colors[C]),"function"==typeof ae&&(ae=ae({series:a.globals.series,seriesIndex:D,dataPointIndex:C,w:a})),$&&(ae=$);var fe=V.offsetX,ge=V.offsetY;if("bar"!==a.config.chart.type&&"rangeBar"!==a.config.chart.type||(fe=0,ge=0),oe.drawnextLabel){var R=d.drawText({width:100,height:parseInt(V.style.fontSize,10),x:g+fe,y:_+ge,foreColor:ae,textAnchor:P||V.textAnchor,text:T,fontSize:L||V.style.fontSize,fontFamily:V.style.fontFamily,fontWeight:V.style.fontWeight||"normal"});if(R.attr({class:"apexcharts-datalabel",cx:g,cy:_}),V.dropShadow.enabled){var H=V.dropShadow;new pi(this.ctx).dropShadow(R,H)}B.add(R),void 0===a.globals.lastDrawnDataLabelsIndexes[D]&&(a.globals.lastDrawnDataLabelsIndexes[D]=[]),a.globals.lastDrawnDataLabelsIndexes[D].push(C)}}}},{key:"addBackgroundToDataLabel",value:function(o,a){var d=this.w,g=d.config.dataLabels.background,_=g.padding,D=g.padding/2,C=a.width,T=a.height,P=new yt(this.ctx).drawRect(a.x-_,a.y-D/2,C+2*_,T+D,g.borderRadius,"transparent"===d.config.chart.background?"#fff":d.config.chart.background,g.opacity,g.borderWidth,g.borderColor);return g.dropShadow.enabled&&new pi(this.ctx).dropShadow(P,g.dropShadow),P}},{key:"dataLabelsBackground",value:function(){var o=this.w;if("bubble"!==o.config.chart.type)for(var a=o.globals.dom.baseEl.querySelectorAll(".apexcharts-datalabels text"),d=0;d<a.length;d++){var g=a[d],_=g.getBBox(),D=null;if(_.width&&_.height&&(D=this.addBackgroundToDataLabel(g,_)),D){g.parentNode.insertBefore(D.node,g);var C=g.getAttribute("fill");!o.config.chart.animations.enabled||o.globals.resized||o.globals.dataChanged?D.attr({fill:C}):D.animate().attr({fill:C}),g.setAttribute("fill",o.config.dataLabels.background.foreColor)}}}},{key:"bringForward",value:function(){for(var o=this.w,a=o.globals.dom.baseEl.querySelectorAll(".apexcharts-datalabels"),d=o.globals.dom.baseEl.querySelector(".apexcharts-plot-series:last-child"),g=0;g<a.length;g++)d&&d.insertBefore(a[g],d.nextSibling)}}]),te}(),No=function(){function te(o){zt(this,te),this.w=o.w,this.barCtx=o}return St(te,[{key:"handleBarDataLabels",value:function(o){var a=o.x,d=o.y,g=o.y1,_=o.y2,D=o.i,C=o.j,T=o.realIndex,P=o.series,L=o.barHeight,B=o.barWidth,V=o.barYPosition,$=o.visibleSeries,q=o.renderedPath,K=this.w,oe=new yt(this.barCtx.ctx),ae=Array.isArray(this.barCtx.strokeWidth)?this.barCtx.strokeWidth[T]:this.barCtx.strokeWidth,fe=a+parseFloat(B*$),ge=d+parseFloat(L*$);K.globals.isXNumeric&&!K.globals.isBarHorizontal&&(fe=a+parseFloat(B*($+1)),ge=d+parseFloat(L*($+1))-ae);var Q,R=a,H=d,le=K.config.dataLabels,Re=this.barCtx.barOptions.dataLabels;void 0!==V&&this.barCtx.isRangeBar&&(ge=V,H=V);var tt=le.offsetX,Ve=le.offsetY,Dt={width:0,height:0};K.config.dataLabels.enabled&&(Dt=oe.getTextRects(K.globals.yLabelFormatters[0](this.barCtx.series[D][C]),parseFloat(le.style.fontSize)));var qe={x:a,y:d,i:D,j:C,renderedPath:q,bcx:fe,bcy:ge,barHeight:L,barWidth:B,textRects:Dt,strokeWidth:ae,dataLabelsX:R,dataLabelsY:H,barDataLabelsConfig:Re,offX:tt,offY:Ve};return Q=this.barCtx.isHorizontal?this.calculateBarsDataLabelsPosition(qe):this.calculateColumnsDataLabelsPosition(qe),q.attr({cy:Q.bcy,cx:Q.bcx,j:C,val:P[D][C],barHeight:L,barWidth:B}),this.drawCalculatedDataLabels({x:Q.dataLabelsX,y:Q.dataLabelsY,val:this.barCtx.isRangeBar?[g,_]:P[D][C],i:T,j:C,barWidth:B,barHeight:L,textRects:Dt,dataLabelsConfig:le})}},{key:"calculateColumnsDataLabelsPosition",value:function(o){var a,d=this.w,g=o.i,_=o.j,D=o.y,C=o.bcx,T=o.barWidth,P=o.barHeight,L=o.textRects,B=o.dataLabelsY,V=o.barDataLabelsConfig,$=o.strokeWidth,q=o.offX,K=o.offY;P=Math.abs(P);var oe="vertical"===d.config.plotOptions.bar.dataLabels.orientation;C-=$/2,a=d.globals.isXNumeric?C-T/2+q:C-d.globals.gridWidth/d.globals.dataPoints+T/2+q,oe&&(a=a+L.height/2-$/2-2);var fe=this.barCtx.series[g][_]<0,ge=D;switch(this.barCtx.isReversed&&(ge=D-P+(fe?2*P:0),D-=P),V.position){case"center":B=oe?fe?ge+P/2+K:ge+P/2-K:fe?ge-P/2+L.height/2+K:ge+P/2+L.height/2-K;break;case"bottom":B=oe?fe?ge+P+K:ge+P-K:fe?ge-P+L.height+$+K:ge+P-L.height/2+$-K;break;case"top":B=oe?fe?ge+K:ge-K:fe?ge-L.height/2-K:ge+L.height+K}return d.config.chart.stacked||(B<0?B=0+$:B+L.height/3>d.globals.gridHeight&&(B=d.globals.gridHeight-$)),{bcx:C,bcy:D,dataLabelsX:a,dataLabelsY:B}}},{key:"calculateBarsDataLabelsPosition",value:function(o){var a=this.w,d=o.x,g=o.i,_=o.j,D=o.bcy,C=o.barHeight,T=o.barWidth,P=o.textRects,L=o.dataLabelsX,B=o.strokeWidth,V=o.barDataLabelsConfig,$=o.offX,q=o.offY,K=a.globals.gridHeight/a.globals.dataPoints;T=Math.abs(T);var oe=D-(this.barCtx.isRangeBar?0:K)+C/2+P.height/2+q-3,ae=this.barCtx.series[g][_]<0,fe=d;switch(this.barCtx.isReversed&&(fe=d+T-(ae?2*T:0),d=a.globals.gridWidth-T),V.position){case"center":L=ae?fe+T/2-$:Math.max(P.width/2,fe-T/2)+$;break;case"bottom":L=ae?fe+T-B-Math.round(P.width/2)-$:fe-T+B+Math.round(P.width/2)+$;break;case"top":L=ae?fe-B+Math.round(P.width/2)-$:fe-B-Math.round(P.width/2)+$}return a.config.chart.stacked||(L<0?L=L+P.width+B:L+P.width/2>a.globals.gridWidth&&(L=a.globals.gridWidth-P.width-B)),{bcx:d,bcy:D,dataLabelsX:L,dataLabelsY:oe}}},{key:"drawCalculatedDataLabels",value:function(o){var a=o.x,d=o.y,g=o.val,_=o.i,D=o.j,C=o.textRects,T=o.barHeight,P=o.barWidth,L=o.dataLabelsConfig,B=this.w,V="rotate(0)";"vertical"===B.config.plotOptions.bar.dataLabels.orientation&&(V="rotate(-90, ".concat(a,", ").concat(d,")"));var $=new ls(this.barCtx.ctx),q=new yt(this.barCtx.ctx),K=L.formatter,oe=null,ae=B.globals.collapsedSeriesIndices.indexOf(_)>-1;if(L.enabled&&!ae){oe=q.group({class:"apexcharts-data-labels",transform:V});var fe="";void 0!==g&&(fe=K(g,{seriesIndex:_,dataPointIndex:D,w:B}));var ge=B.globals.series[_][D]<0,R=B.config.plotOptions.bar.dataLabels.position;"vertical"===B.config.plotOptions.bar.dataLabels.orientation&&("top"===R&&(L.textAnchor=ge?"end":"start"),"center"===R&&(L.textAnchor="middle"),"bottom"===R&&(L.textAnchor=ge?"end":"start")),this.barCtx.isRangeBar&&this.barCtx.barOptions.dataLabels.hideOverflowingLabels&&P<q.getTextRects(fe,parseFloat(L.style.fontSize)).width&&(fe=""),B.config.chart.stacked&&this.barCtx.barOptions.dataLabels.hideOverflowingLabels&&(this.barCtx.isHorizontal?C.width/1.6>Math.abs(P)&&(fe=""):C.height/1.6>Math.abs(T)&&(fe=""));var H=Je({},L);this.barCtx.isHorizontal&&g<0&&("start"===L.textAnchor?H.textAnchor="end":"end"===L.textAnchor&&(H.textAnchor="start")),$.plotDataLabelsText({x:a,y:d,text:fe,i:_,j:D,parent:oe,dataLabelsConfig:H,alwaysDrawDataLabel:!0,offsetCorrection:!0})}return oe}}]),te}(),Bi=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.legendInactiveClass="legend-mouseover-inactive"}return St(te,[{key:"getAllSeriesEls",value:function(){return this.w.globals.dom.baseEl.getElementsByClassName("apexcharts-series")}},{key:"getSeriesByName",value:function(o){return this.w.globals.dom.baseEl.querySelector(".apexcharts-inner .apexcharts-series[seriesName='".concat(Xe.escapeString(o),"']"))}},{key:"isSeriesHidden",value:function(o){var a=this.getSeriesByName(o),d=parseInt(a.getAttribute("data:realIndex"),10);return{isHidden:a.classList.contains("apexcharts-series-collapsed"),realIndex:d}}},{key:"addCollapsedClassToSeries",value:function(o,a){var d=this.w;function g(_){for(var D=0;D<_.length;D++)_[D].index===a&&o.node.classList.add("apexcharts-series-collapsed")}g(d.globals.collapsedSeries),g(d.globals.ancillaryCollapsedSeries)}},{key:"toggleSeries",value:function(o){var a=this.isSeriesHidden(o);return this.ctx.legend.legendHelpers.toggleDataSeries(a.realIndex,a.isHidden),a.isHidden}},{key:"showSeries",value:function(o){var a=this.isSeriesHidden(o);a.isHidden&&this.ctx.legend.legendHelpers.toggleDataSeries(a.realIndex,!0)}},{key:"hideSeries",value:function(o){var a=this.isSeriesHidden(o);a.isHidden||this.ctx.legend.legendHelpers.toggleDataSeries(a.realIndex,!1)}},{key:"resetSeries",value:function(){var o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],d=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],g=this.w,_=Xe.clone(g.globals.initialSeries);g.globals.previousPaths=[],d?(g.globals.collapsedSeries=[],g.globals.ancillaryCollapsedSeries=[],g.globals.collapsedSeriesIndices=[],g.globals.ancillaryCollapsedSeriesIndices=[]):_=this.emptyCollapsedSeries(_),g.config.series=_,o&&(a&&(g.globals.zoomed=!1,this.ctx.updateHelpers.revertDefaultAxisMinMax()),this.ctx.updateHelpers._updateSeries(_,g.config.chart.animations.dynamicAnimation.enabled))}},{key:"emptyCollapsedSeries",value:function(o){for(var a=this.w,d=0;d<o.length;d++)a.globals.collapsedSeriesIndices.indexOf(d)>-1&&(o[d].data=[]);return o}},{key:"toggleSeriesOnHover",value:function(o,a){var d=this.w;a||(a=o.target);var g=d.globals.dom.baseEl.querySelectorAll(".apexcharts-series, .apexcharts-datalabels");if("mousemove"===o.type){var _=parseInt(a.getAttribute("rel"),10)-1,D=null,C=null;d.globals.axisCharts||"radialBar"===d.config.chart.type?d.globals.axisCharts?(D=d.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(_,"']")),C=d.globals.dom.baseEl.querySelector(".apexcharts-datalabels[data\\:realIndex='".concat(_,"']"))):D=d.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(_+1,"']")):D=d.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(_+1,"'] path"));for(var T=0;T<g.length;T++)g[T].classList.add(this.legendInactiveClass);null!==D&&(d.globals.axisCharts||D.parentNode.classList.remove(this.legendInactiveClass),D.classList.remove(this.legendInactiveClass),null!==C&&C.classList.remove(this.legendInactiveClass))}else if("mouseout"===o.type)for(var P=0;P<g.length;P++)g[P].classList.remove(this.legendInactiveClass)}},{key:"highlightRangeInSeries",value:function(o,a){var d=this,g=this.w,_=g.globals.dom.baseEl.getElementsByClassName("apexcharts-heatmap-rect"),D=function(T){for(var P=0;P<_.length;P++)_[P].classList[T](d.legendInactiveClass)};if("mousemove"===o.type){var C=parseInt(a.getAttribute("rel"),10)-1;D("add"),function(T){for(var P=0;P<_.length;P++){var L=parseInt(_[P].getAttribute("val"),10);L>=T.from&&L<=T.to&&_[P].classList.remove(d.legendInactiveClass)}}(g.config.plotOptions.heatmap.colorScale.ranges[C])}else"mouseout"===o.type&&D("remove")}},{key:"getActiveConfigSeriesIndex",value:function(){var o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",d=this.w,g=0;if(d.config.series.length>1)for(var _=d.config.series.map(function(C,T){var P=!1;return o&&(P="bar"===d.config.series[T].type||"column"===d.config.series[T].type),C.data&&C.data.length>0&&!P?T:-1}),D="asc"===a?0:_.length-1;"asc"===a?D<_.length:D>=0;"asc"===a?D++:D--)if(-1!==_[D]){g=_[D];break}return g}},{key:"getPreviousPaths",value:function(){var o=this.w;function a(D,C,T){for(var P=D[C].childNodes,L={type:T,paths:[],realIndex:D[C].getAttribute("data:realIndex")},B=0;B<P.length;B++)if(P[B].hasAttribute("pathTo")){var V=P[B].getAttribute("pathTo");L.paths.push({d:V})}o.globals.previousPaths.push(L)}o.globals.previousPaths=[],["line","area","bar","rangebar","candlestick","radar"].forEach(function(D){for(var T=o.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(D,"-series .apexcharts-series")),P=0;P<T.length;P++)a(T,P,D)}),this.handlePrevBubbleScatterPaths("bubble"),this.handlePrevBubbleScatterPaths("scatter");var d=o.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(o.config.chart.type," .apexcharts-series"));if(d.length>0)for(var g=function(D){for(var C=o.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(o.config.chart.type," .apexcharts-series[data\\:realIndex='").concat(D,"'] rect")),T=[],P=function(B){var V=function(q){return C[B].getAttribute(q)},$={x:parseFloat(V("x")),y:parseFloat(V("y")),width:parseFloat(V("width")),height:parseFloat(V("height"))};T.push({rect:$,color:C[B].getAttribute("color")})},L=0;L<C.length;L++)P(L);o.globals.previousPaths.push(T)},_=0;_<d.length;_++)g(_);o.globals.axisCharts||(o.globals.previousPaths=o.globals.series)}},{key:"handlePrevBubbleScatterPaths",value:function(o){var a=this.w,d=a.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(o,"-series .apexcharts-series"));if(d.length>0)for(var g=0;g<d.length;g++){for(var _=a.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(o,"-series .apexcharts-series[data\\:realIndex='").concat(g,"'] circle")),D=[],C=0;C<_.length;C++)D.push({x:_[C].getAttribute("cx"),y:_[C].getAttribute("cy"),r:_[C].getAttribute("r")});a.globals.previousPaths.push(D)}}},{key:"clearPreviousPaths",value:function(){var o=this.w;o.globals.previousPaths=[],o.globals.allSeriesCollapsed=!1}},{key:"handleNoData",value:function(){var o=this.w,a=o.config.noData,d=new yt(this.ctx),g=o.globals.svgWidth/2,_=o.globals.svgHeight/2,D="middle";if(o.globals.noData=!0,o.globals.animationEnded=!0,"left"===a.align?(g=10,D="start"):"right"===a.align&&(g=o.globals.svgWidth-10,D="end"),"top"===a.verticalAlign?_=50:"bottom"===a.verticalAlign&&(_=o.globals.svgHeight-50),g+=a.offsetX,_=_+parseInt(a.style.fontSize,10)+2+a.offsetY,void 0!==a.text&&""!==a.text){var C=d.drawText({x:g,y:_,text:a.text,textAnchor:D,fontSize:a.style.fontSize,fontFamily:a.style.fontFamily,foreColor:a.style.color,opacity:1,class:"apexcharts-text-nodata"});o.globals.dom.Paper.add(C)}}},{key:"setNullSeriesToZeroValues",value:function(o){for(var a=this.w,d=0;d<o.length;d++)if(0===o[d].length)for(var g=0;g<o[a.globals.maxValsInArrayIndex].length;g++)o[d].push(0);return o}},{key:"hasAllSeriesEqualX",value:function(){for(var o=!0,a=this.w,d=this.filteredSeriesX(),g=0;g<d.length-1;g++)if(d[g][0]!==d[g+1][0]){o=!1;break}return a.globals.allSeriesHasEqualX=o,o}},{key:"filteredSeriesX",value:function(){return this.w.globals.seriesX.map(function(a){return a.length>0?a:[]})}}]),te}(),ir=function(){function te(o){zt(this,te),this.w=o.w,this.barCtx=o}return St(te,[{key:"initVariables",value:function(o){var a=this.w;this.barCtx.series=o,this.barCtx.totalItems=0,this.barCtx.seriesLen=0,this.barCtx.visibleI=-1,this.barCtx.visibleItems=1;for(var d=0;d<o.length;d++)if(o[d].length>0&&(this.barCtx.seriesLen=this.barCtx.seriesLen+1,this.barCtx.totalItems+=o[d].length),a.globals.isXNumeric)for(var g=0;g<o[d].length;g++)a.globals.seriesX[d][g]>a.globals.minX&&a.globals.seriesX[d][g]<a.globals.maxX&&this.barCtx.visibleItems++;else this.barCtx.visibleItems=a.globals.dataPoints;0===this.barCtx.seriesLen&&(this.barCtx.seriesLen=1),this.barCtx.zeroSerieses=[],this.barCtx.radiusOnSeriesNumber=o.length-1,a.globals.comboCharts||this.checkZeroSeries({series:o})}},{key:"initialPositions",value:function(){var o,a,d,g,_,D,C,T,P=this.w,L=P.globals.dataPoints;this.barCtx.isRangeBar&&(L=P.globals.labels.length);var B=this.barCtx.seriesLen;if(P.config.plotOptions.bar.rangeBarGroupRows&&(B=1),this.barCtx.isHorizontal)_=(d=P.globals.gridHeight/L)/B,P.globals.isXNumeric&&(_=(d=P.globals.gridHeight/this.barCtx.totalItems)/this.barCtx.seriesLen),_=_*parseInt(this.barCtx.barOptions.barHeight,10)/100,T=this.barCtx.baseLineInvertedY+P.globals.padHorizontal+(this.barCtx.isReversed?P.globals.gridWidth:0)-(this.barCtx.isReversed?2*this.barCtx.baseLineInvertedY:0),a=(d-_*this.barCtx.seriesLen)/2;else{if(g=P.globals.gridWidth/this.barCtx.visibleItems,P.config.xaxis.convertedCatToNumeric&&(g=P.globals.gridWidth/P.globals.dataPoints),D=g/this.barCtx.seriesLen*parseInt(this.barCtx.barOptions.columnWidth,10)/100,P.globals.isXNumeric){var V=this.barCtx.xRatio;P.config.xaxis.convertedCatToNumeric&&(V=this.barCtx.initialXRatio),P.globals.minXDiff&&.5!==P.globals.minXDiff&&P.globals.minXDiff/V>0&&(g=P.globals.minXDiff/V),(D=g/this.barCtx.seriesLen*parseInt(this.barCtx.barOptions.columnWidth,10)/100)<1&&(D=1)}C=P.globals.gridHeight-this.barCtx.baseLineY[this.barCtx.yaxisIndex]-(this.barCtx.isReversed?P.globals.gridHeight:0)+(this.barCtx.isReversed?2*this.barCtx.baseLineY[this.barCtx.yaxisIndex]:0),o=P.globals.padHorizontal+(g-D*this.barCtx.seriesLen)/2}return{x:o,y:a,yDivision:d,xDivision:g,barHeight:_,barWidth:D,zeroH:C,zeroW:T}}},{key:"getPathFillColor",value:function(o,a,d,g){var _=this.w,D=new Xr(this.barCtx.ctx),C=null,T=this.barCtx.barOptions.distributed?d:a;return this.barCtx.barOptions.colors.ranges.length>0&&this.barCtx.barOptions.colors.ranges.map(function(P){o[a][d]>=P.from&&o[a][d]<=P.to&&(C=P.color)}),_.config.series[a].data[d]&&_.config.series[a].data[d].fillColor&&(C=_.config.series[a].data[d].fillColor),D.fillPath({seriesNumber:this.barCtx.barOptions.distributed?T:g,dataPointIndex:d,color:C,value:o[a][d]})}},{key:"getStrokeWidth",value:function(o,a,d){var g=0,_=this.w;return this.barCtx.isNullValue=null==this.barCtx.series[o][a],_.config.stroke.show&&(this.barCtx.isNullValue||(g=Array.isArray(this.barCtx.strokeWidth)?this.barCtx.strokeWidth[d]:this.barCtx.strokeWidth)),g}},{key:"barBackground",value:function(o){var a=o.j,d=o.i,g=o.x1,_=o.x2,D=o.y1,C=o.y2,T=o.elSeries,P=this.w,L=new yt(this.barCtx.ctx),B=new Bi(this.barCtx.ctx).getActiveConfigSeriesIndex();if(this.barCtx.barOptions.colors.backgroundBarColors.length>0&&B===d){a>=this.barCtx.barOptions.colors.backgroundBarColors.length&&(a-=this.barCtx.barOptions.colors.backgroundBarColors.length);var $=L.drawRect(void 0!==g?g:0,void 0!==D?D:0,void 0!==_?_:P.globals.gridWidth,void 0!==C?C:P.globals.gridHeight,this.barCtx.barOptions.colors.backgroundBarRadius,this.barCtx.barOptions.colors.backgroundBarColors[a],this.barCtx.barOptions.colors.backgroundBarOpacity);T.add($),$.node.classList.add("apexcharts-backgroundBar")}}},{key:"getColumnPaths",value:function(o){var a=o.barWidth,d=o.barXPosition,g=o.yRatio,_=o.y1,D=o.y2,C=o.strokeWidth,T=o.series,P=o.realIndex,L=o.i,B=o.j,V=o.w,$=new yt(this.barCtx.ctx);(C=Array.isArray(C)?C[P]:C)||(C=0);var K=this.getRoundedBars(V,{barWidth:a,strokeWidth:C,yRatio:g,barXPosition:d,y1:_,y2:D},T,L,B),oe=d,ae=d+a,fe=$.move(oe,_),ge=$.move(oe,_),R=$.line(ae-C,_);return V.globals.previousPaths.length>0&&(ge=this.barCtx.getPreviousPath(P,B,!1)),fe=fe+$.line(oe,K.y2)+K.pathWithRadius+$.line(ae-C,K.y2)+R+R+"z",ge=ge+$.line(oe,_)+R+R+R+R+R+$.line(oe,_),V.config.chart.stacked&&(this.barCtx.yArrj.push(K.y2),this.barCtx.yArrjF.push(Math.abs(_-K.y2)),this.barCtx.yArrjVal.push(this.barCtx.series[L][B])),{pathTo:fe,pathFrom:ge}}},{key:"getBarpaths",value:function(o){var a=o.barYPosition,d=o.barHeight,g=o.x1,_=o.x2,D=o.strokeWidth,C=o.series,T=o.realIndex,P=o.i,L=o.j,B=o.w,V=new yt(this.barCtx.ctx);(D=Array.isArray(D)?D[T]:D)||(D=0);var q=this.getRoundedBars(B,{barHeight:d,strokeWidth:D,barYPosition:a,x2:_,x1:g},C,P,L),K=V.move(g,a),oe=V.move(g,a);B.globals.previousPaths.length>0&&(oe=this.barCtx.getPreviousPath(T,L,!1));var ae=a,fe=a+d,ge=V.line(g,fe-D);return K=K+V.line(q.x2,ae)+q.pathWithRadius+V.line(q.x2,fe-D)+ge+ge+"z",oe=oe+V.line(g,ae)+ge+ge+ge+ge+ge+V.line(g,ae),B.config.chart.stacked&&(this.barCtx.xArrj.push(q.x2),this.barCtx.xArrjF.push(Math.abs(g-q.x2)),this.barCtx.xArrjVal.push(this.barCtx.series[P][L])),{pathTo:K,pathFrom:oe}}},{key:"getRoundedBars",value:function(o,a,d,g,_){var D=new yt(this.barCtx.ctx),C=0,T=o.config.plotOptions.bar.borderRadius,P=Array.isArray(T);if(C=P?T[g>T.length-1?T.length-1:g]:T,o.config.chart.stacked&&d.length>1&&g!==this.barCtx.radiusOnSeriesNumber&&!P&&(C=0),this.barCtx.isHorizontal){var L="",B=a.x2;if(Math.abs(a.x1-a.x2)<C&&(C=Math.abs(a.x1-a.x2)),void 0!==d[g][_]||null!==d[g][_]){var V=this.barCtx.isReversed?d[g][_]>0:d[g][_]<0;V&&(C*=-1),L=D.quadraticCurve((B-=C)+C,a.barYPosition,B+C,a.barYPosition+(V?-1*C:C))+D.line(B+C,a.barYPosition+a.barHeight-a.strokeWidth-(V?-1*C:C))+D.quadraticCurve(B+C,a.barYPosition+a.barHeight-a.strokeWidth,B,a.barYPosition+a.barHeight-a.strokeWidth)}return{pathWithRadius:L,x2:B}}var $="",q=a.y2;if(Math.abs(a.y1-a.y2)<C&&(C=Math.abs(a.y1-a.y2)),void 0!==d[g][_]||null!==d[g][_]){var K=d[g][_]<0;K&&(C*=-1),$=D.quadraticCurve(a.barXPosition,(q+=C)-C,a.barXPosition+(K?-1*C:C),q-C)+D.line(a.barXPosition+a.barWidth-a.strokeWidth-(K?-1*C:C),q-C)+D.quadraticCurve(a.barXPosition+a.barWidth-a.strokeWidth,q-C,a.barXPosition+a.barWidth-a.strokeWidth,q)}return{pathWithRadius:$,y2:q}}},{key:"checkZeroSeries",value:function(o){for(var a=o.series,d=this.w,g=0;g<a.length;g++){for(var _=0,D=0;D<a[d.globals.maxValsInArrayIndex].length;D++)_+=a[g][D];0===_&&this.barCtx.zeroSerieses.push(g)}for(var C=a.length-1;C>=0;C--)this.barCtx.zeroSerieses.indexOf(C)>-1&&C===this.radiusOnSeriesNumber&&(this.barCtx.radiusOnSeriesNumber-=1);for(var T=a.length-1;T>=0;T--)d.globals.collapsedSeriesIndices.indexOf(this.barCtx.radiusOnSeriesNumber)>-1&&(this.barCtx.radiusOnSeriesNumber-=1)}},{key:"getXForValue",value:function(o,a){var d=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],g=d?a:null;return null!=o&&(g=a+o/this.barCtx.invertedYRatio-2*(this.barCtx.isReversed?o/this.barCtx.invertedYRatio:0)),g}},{key:"getYForValue",value:function(o,a){var d=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],g=d?a:null;return null!=o&&(g=a-o/this.barCtx.yRatio[this.barCtx.yaxisIndex]+2*(this.barCtx.isReversed?o/this.barCtx.yRatio[this.barCtx.yaxisIndex]:0)),g}},{key:"getGoalValues",value:function(o,a,d,g,_){var D=this,C=this.w,T=[];return C.globals.seriesGoals[g]&&C.globals.seriesGoals[g][_]&&Array.isArray(C.globals.seriesGoals[g][_])&&C.globals.seriesGoals[g][_].forEach(function(P){var L;T.push((Cs(L={},o,"x"===o?D.getXForValue(P.value,a,!1):D.getYForValue(P.value,d,!1)),Cs(L,"attrs",P),L))}),T}},{key:"drawGoalLine",value:function(o){var a=o.barXPosition,d=o.barYPosition,g=o.goalX,_=o.goalY,D=o.barWidth,C=o.barHeight,T=new yt(this.barCtx.ctx),P=T.group({className:"apexcharts-bar-goals-groups"}),L=null;return this.barCtx.isHorizontal?Array.isArray(g)&&g.forEach(function(B){var V=void 0!==B.attrs.strokeHeight?B.attrs.strokeHeight:C/2,$=d+V+C/2;L=T.drawLine(B.x,$-2*V,B.x,$,B.attrs.strokeColor?B.attrs.strokeColor:void 0,B.attrs.strokeDashArray,B.attrs.strokeWidth?B.attrs.strokeWidth:2,B.attrs.strokeLineCap),P.add(L)}):Array.isArray(_)&&_.forEach(function(B){var V=void 0!==B.attrs.strokeWidth?B.attrs.strokeWidth:D/2,$=a+V+D/2;L=T.drawLine($-2*V,B.y,$,B.y,B.attrs.strokeColor?B.attrs.strokeColor:void 0,B.attrs.strokeDashArray,B.attrs.strokeHeight?B.attrs.strokeHeight:2,B.attrs.strokeLineCap),P.add(L)}),P}}]),te}(),Dn=function(){function te(o,a){zt(this,te),this.ctx=o,this.w=o.w;var d=this.w;this.barOptions=d.config.plotOptions.bar,this.isHorizontal=this.barOptions.horizontal,this.strokeWidth=d.config.stroke.width,this.isNullValue=!1,this.isRangeBar=d.globals.seriesRangeBar.length&&this.isHorizontal,this.xyRatios=a,null!==this.xyRatios&&(this.xRatio=a.xRatio,this.initialXRatio=a.initialXRatio,this.yRatio=a.yRatio,this.invertedXRatio=a.invertedXRatio,this.invertedYRatio=a.invertedYRatio,this.baseLineY=a.baseLineY,this.baseLineInvertedY=a.baseLineInvertedY),this.yaxisIndex=0,this.seriesLen=0,this.barHelpers=new ir(this)}return St(te,[{key:"draw",value:function(o,a){var d=this.w,g=new yt(this.ctx),_=new fi(this.ctx,d);o=_.getLogSeries(o),this.series=o,this.yRatio=_.getLogYRatios(this.yRatio),this.barHelpers.initVariables(o);var D=g.group({class:"apexcharts-bar-series apexcharts-plot-series"});d.config.dataLabels.enabled&&this.totalItems>this.barOptions.dataLabels.maxItems&&console.warn("WARNING: DataLabels are enabled but there are too many to display. This may cause performance issue when rendering.");for(var C=0,T=0;C<o.length;C++,T++){var P,L,B,V,$=void 0,q=void 0,K=[],oe=[],ae=d.globals.comboCharts?a[C]:C,fe=g.group({class:"apexcharts-series",rel:C+1,seriesName:Xe.escapeString(d.globals.seriesNames[ae]),"data:realIndex":ae});this.ctx.series.addCollapsedClassToSeries(fe,ae),o[C].length>0&&(this.visibleI=this.visibleI+1);var ge=0,R=0;this.yRatio.length>1&&(this.yaxisIndex=ae),this.isReversed=d.config.yaxis[this.yaxisIndex]&&d.config.yaxis[this.yaxisIndex].reversed;var H=this.barHelpers.initialPositions();q=H.y,ge=H.barHeight,L=H.yDivision,V=H.zeroW,$=H.x,R=H.barWidth,P=H.xDivision,B=H.zeroH,this.horizontal||oe.push($+R/2);for(var Q=g.group({class:"apexcharts-datalabels","data:realIndex":ae}),le=g.group({class:"apexcharts-bar-goals-markers",style:"pointer-events: none"}),Re=0;Re<d.globals.dataPoints;Re++){var tt=this.barHelpers.getStrokeWidth(C,Re,ae),Ve=null,Dt={indexes:{i:C,j:Re,realIndex:ae,bc:T},x:$,y:q,strokeWidth:tt,elSeries:fe};this.isHorizontal?(Ve=this.drawBarPaths(Je(Je({},Dt),{},{barHeight:ge,zeroW:V,yDivision:L})),R=this.series[C][Re]/this.invertedYRatio):(Ve=this.drawColumnPaths(Je(Je({},Dt),{},{xDivision:P,barWidth:R,zeroH:B})),ge=this.series[C][Re]/this.yRatio[this.yaxisIndex]);var pt=this.barHelpers.drawGoalLine({barXPosition:Ve.barXPosition,barYPosition:Ve.barYPosition,goalX:Ve.goalX,goalY:Ve.goalY,barHeight:ge,barWidth:R});pt&&le.add(pt),q=Ve.y,$=Ve.x,Re>0&&oe.push($+R/2),K.push(q);var qe=this.barHelpers.getPathFillColor(o,C,Re,ae);this.renderSeries({realIndex:ae,pathFill:qe,j:Re,i:C,pathFrom:Ve.pathFrom,pathTo:Ve.pathTo,strokeWidth:tt,elSeries:fe,x:$,y:q,series:o,barHeight:ge,barWidth:R,elDataLabelsWrap:Q,elGoalsMarkers:le,visibleSeries:this.visibleI,type:"bar"})}d.globals.seriesXvalues[ae]=oe,d.globals.seriesYvalues[ae]=K,D.add(fe)}return D}},{key:"renderSeries",value:function(o){var a=o.realIndex,d=o.pathFill,g=o.lineFill,_=o.j,D=o.i,C=o.pathFrom,T=o.pathTo,P=o.strokeWidth,L=o.elSeries,B=o.x,V=o.y,$=o.y1,q=o.y2,K=o.series,oe=o.barHeight,ae=o.barWidth,fe=o.barYPosition,ge=o.elDataLabelsWrap,R=o.elGoalsMarkers,H=o.visibleSeries,Q=o.type,le=this.w,Re=new yt(this.ctx);g||(g=this.barOptions.distributed?le.globals.stroke.colors[_]:le.globals.stroke.colors[a]),le.config.series[D].data[_]&&le.config.series[D].data[_].strokeColor&&(g=le.config.series[D].data[_].strokeColor),this.isNullValue&&(d="none");var Ve=Re.renderPaths({i:D,j:_,realIndex:a,pathFrom:C,pathTo:T,stroke:g,strokeWidth:P,strokeLineCap:le.config.stroke.lineCap,fill:d,animationDelay:_/le.config.chart.animations.animateGradually.delay*(le.config.chart.animations.speed/le.globals.dataPoints)/2.4,initialSpeed:le.config.chart.animations.speed,dataChangeSpeed:le.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-".concat(Q,"-area")});Ve.attr("clip-path","url(#gridRectMask".concat(le.globals.cuid,")"));var Dt=le.config.forecastDataPoints;Dt.count>0&&_>=le.globals.dataPoints-Dt.count&&(Ve.node.setAttribute("stroke-dasharray",Dt.dashArray),Ve.node.setAttribute("stroke-width",Dt.strokeWidth),Ve.node.setAttribute("fill-opacity",Dt.fillOpacity)),void 0!==$&&void 0!==q&&(Ve.attr("data-range-y1",$),Ve.attr("data-range-y2",q)),new pi(this.ctx).setSelectionFilter(Ve,a,_),L.add(Ve);var pt=new No(this).handleBarDataLabels({x:B,y:V,y1:$,y2:q,i:D,j:_,series:K,realIndex:a,barHeight:oe,barWidth:ae,barYPosition:fe,renderedPath:Ve,visibleSeries:H});return null!==pt&&ge.add(pt),L.add(ge),R&&L.add(R),L}},{key:"drawBarPaths",value:function(o){var D,a=o.indexes,d=o.barHeight,g=o.strokeWidth,_=o.zeroW,C=o.y,T=o.yDivision,P=o.elSeries,L=this.w,B=a.i,V=a.j;L.globals.isXNumeric&&(C=(L.globals.seriesX[B][V]-L.globals.minX)/this.invertedXRatio-d);var $=C+d*this.visibleI;D=this.barHelpers.getXForValue(this.series[B][V],_);var q=this.barHelpers.getBarpaths({barYPosition:$,barHeight:d,x1:_,x2:D,strokeWidth:g,series:this.series,realIndex:a.realIndex,i:B,j:V,w:L});return L.globals.isXNumeric||(C+=T),this.barHelpers.barBackground({j:V,i:B,y1:$-d*this.visibleI,y2:d*this.seriesLen,elSeries:P}),{pathTo:q.pathTo,pathFrom:q.pathFrom,x:D,y:C,goalX:this.barHelpers.getGoalValues("x",_,null,B,V),barYPosition:$}}},{key:"drawColumnPaths",value:function(o){var g,a=o.indexes,d=o.x,_=o.xDivision,D=o.barWidth,C=o.zeroH,T=o.strokeWidth,P=o.elSeries,L=this.w,B=a.realIndex,V=a.i,$=a.j,q=a.bc;if(L.globals.isXNumeric){var K=B;L.globals.seriesX[B].length||(K=L.globals.maxValsInArrayIndex),d=(L.globals.seriesX[K][$]-L.globals.minX)/this.xRatio-D*this.seriesLen/2}var oe=d+D*this.visibleI;g=this.barHelpers.getYForValue(this.series[V][$],C);var ae=this.barHelpers.getColumnPaths({barXPosition:oe,barWidth:D,y1:C,y2:g,strokeWidth:T,series:this.series,realIndex:a.realIndex,i:V,j:$,w:L});return L.globals.isXNumeric||(d+=_),this.barHelpers.barBackground({bc:q,j:$,i:V,x1:oe-T/2-D*this.visibleI,x2:D*this.seriesLen+T/2,elSeries:P}),{pathTo:ae.pathTo,pathFrom:ae.pathFrom,x:d,y:g,goalY:this.barHelpers.getGoalValues("y",null,C,V,$),barXPosition:oe}}},{key:"getPreviousPath",value:function(o,a){for(var d,g=this.w,_=0;_<g.globals.previousPaths.length;_++){var D=g.globals.previousPaths[_];D.paths&&D.paths.length>0&&parseInt(D.realIndex,10)===parseInt(o,10)&&void 0!==g.globals.previousPaths[_].paths[a]&&(d=g.globals.previousPaths[_].paths[a].d)}return d}}]),te}(),mn=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.months31=[1,3,5,7,8,10,12],this.months30=[2,4,6,9,11],this.daysCntOfYear=[0,31,59,90,120,151,181,212,243,273,304,334]}return St(te,[{key:"isValidDate",value:function(o){return!isNaN(this.parseDate(o))}},{key:"getTimeStamp",value:function(o){return Date.parse(o)?this.w.config.xaxis.labels.datetimeUTC?new Date(new Date(o).toISOString().substr(0,25)).getTime():new Date(o).getTime():o}},{key:"getDate",value:function(o){return this.w.config.xaxis.labels.datetimeUTC?new Date(new Date(o).toUTCString()):new Date(o)}},{key:"parseDate",value:function(o){var a=Date.parse(o);if(!isNaN(a))return this.getTimeStamp(o);var d=Date.parse(o.replace(/-/g,"/").replace(/[a-z]+/gi," "));return this.getTimeStamp(d)}},{key:"parseDateWithTimezone",value:function(o){return Date.parse(o.replace(/-/g,"/").replace(/[a-z]+/gi," "))}},{key:"formatDate",value:function(o,a){var d=this.w.globals.locale,g=this.w.config.xaxis.labels.datetimeUTC,_=["\0"].concat(wn(d.months)),D=["\x01"].concat(wn(d.shortMonths)),C=["\x02"].concat(wn(d.days)),T=["\x03"].concat(wn(d.shortDays));function P(Re,tt){var Ve=Re+"";for(tt=tt||2;Ve.length<tt;)Ve="0"+Ve;return Ve}var L=g?o.getUTCFullYear():o.getFullYear();a=(a=(a=a.replace(/(^|[^\\])yyyy+/g,"$1"+L)).replace(/(^|[^\\])yy/g,"$1"+L.toString().substr(2,2))).replace(/(^|[^\\])y/g,"$1"+L);var B=(g?o.getUTCMonth():o.getMonth())+1;a=(a=(a=(a=a.replace(/(^|[^\\])MMMM+/g,"$1"+_[0])).replace(/(^|[^\\])MMM/g,"$1"+D[0])).replace(/(^|[^\\])MM/g,"$1"+P(B))).replace(/(^|[^\\])M/g,"$1"+B);var V=g?o.getUTCDate():o.getDate();a=(a=(a=(a=a.replace(/(^|[^\\])dddd+/g,"$1"+C[0])).replace(/(^|[^\\])ddd/g,"$1"+T[0])).replace(/(^|[^\\])dd/g,"$1"+P(V))).replace(/(^|[^\\])d/g,"$1"+V);var $=g?o.getUTCHours():o.getHours(),q=$>12?$-12:0===$?12:$;a=(a=(a=(a=a.replace(/(^|[^\\])HH+/g,"$1"+P($))).replace(/(^|[^\\])H/g,"$1"+$)).replace(/(^|[^\\])hh+/g,"$1"+P(q))).replace(/(^|[^\\])h/g,"$1"+q);var K=g?o.getUTCMinutes():o.getMinutes();a=(a=a.replace(/(^|[^\\])mm+/g,"$1"+P(K))).replace(/(^|[^\\])m/g,"$1"+K);var oe=g?o.getUTCSeconds():o.getSeconds();a=(a=a.replace(/(^|[^\\])ss+/g,"$1"+P(oe))).replace(/(^|[^\\])s/g,"$1"+oe);var ae=g?o.getUTCMilliseconds():o.getMilliseconds();a=a.replace(/(^|[^\\])fff+/g,"$1"+P(ae,3)),ae=Math.round(ae/10),a=a.replace(/(^|[^\\])ff/g,"$1"+P(ae)),ae=Math.round(ae/10);var fe=$<12?"AM":"PM";a=(a=(a=a.replace(/(^|[^\\])f/g,"$1"+ae)).replace(/(^|[^\\])TT+/g,"$1"+fe)).replace(/(^|[^\\])T/g,"$1"+fe.charAt(0));var ge=fe.toLowerCase();a=(a=a.replace(/(^|[^\\])tt+/g,"$1"+ge)).replace(/(^|[^\\])t/g,"$1"+ge.charAt(0));var R=-o.getTimezoneOffset(),H=g||!R?"Z":R>0?"+":"-";if(!g){var Q=(R=Math.abs(R))%60;H+=P(Math.floor(R/60))+":"+P(Q)}a=a.replace(/(^|[^\\])K/g,"$1"+H);var le=(g?o.getUTCDay():o.getDay())+1;return(a=(a=(a=(a=a.replace(new RegExp(C[0],"g"),C[le])).replace(new RegExp(T[0],"g"),T[le])).replace(new RegExp(_[0],"g"),_[B])).replace(new RegExp(D[0],"g"),D[B])).replace(/\\(.)/g,"$1")}},{key:"getTimeUnitsfromTimestamp",value:function(o,a,d){var g=this.w;void 0!==g.config.xaxis.min&&(o=g.config.xaxis.min),void 0!==g.config.xaxis.max&&(a=g.config.xaxis.max);var _=this.getDate(o),D=this.getDate(a),C=this.formatDate(_,"yyyy MM dd HH mm ss fff").split(" "),T=this.formatDate(D,"yyyy MM dd HH mm ss fff").split(" ");return{minMillisecond:parseInt(C[6],10),maxMillisecond:parseInt(T[6],10),minSecond:parseInt(C[5],10),maxSecond:parseInt(T[5],10),minMinute:parseInt(C[4],10),maxMinute:parseInt(T[4],10),minHour:parseInt(C[3],10),maxHour:parseInt(T[3],10),minDate:parseInt(C[2],10),maxDate:parseInt(T[2],10),minMonth:parseInt(C[1],10)-1,maxMonth:parseInt(T[1],10)-1,minYear:parseInt(C[0],10),maxYear:parseInt(T[0],10)}}},{key:"isLeapYear",value:function(o){return o%4==0&&o%100!=0||o%400==0}},{key:"calculcateLastDaysOfMonth",value:function(o,a,d){return this.determineDaysOfMonths(o,a)-d}},{key:"determineDaysOfYear",value:function(o){var a=365;return this.isLeapYear(o)&&(a=366),a}},{key:"determineRemainingDaysOfYear",value:function(o,a,d){var g=this.daysCntOfYear[a]+d;return a>1&&this.isLeapYear()&&g++,g}},{key:"determineDaysOfMonths",value:function(o,a){var d=30;switch(o=Xe.monthMod(o),!0){case this.months30.indexOf(o)>-1:2===o&&(d=this.isLeapYear(a)?29:28);break;case this.months31.indexOf(o)>-1:default:d=31}return d}}]),te}(),Or=function(te){ht(a,Dn);var o=co(a);function a(){return zt(this,a),o.apply(this,arguments)}return St(a,[{key:"draw",value:function(d,g){var _=this.w,D=new yt(this.ctx);this.rangeBarOptions=this.w.config.plotOptions.rangeBar,this.series=d,this.seriesRangeStart=_.globals.seriesRangeStart,this.seriesRangeEnd=_.globals.seriesRangeEnd,this.barHelpers.initVariables(d);for(var C=D.group({class:"apexcharts-rangebar-series apexcharts-plot-series"}),T=0;T<d.length;T++){var P,L,B,V=void 0,$=void 0,q=void 0,K=_.globals.comboCharts?g[T]:T,oe=D.group({class:"apexcharts-series",seriesName:Xe.escapeString(_.globals.seriesNames[K]),rel:T+1,"data:realIndex":K});this.ctx.series.addCollapsedClassToSeries(oe,K),d[T].length>0&&(this.visibleI=this.visibleI+1);var ae=0,fe=0;this.yRatio.length>1&&(this.yaxisIndex=K);var ge=this.barHelpers.initialPositions();$=ge.y,B=ge.zeroW,V=ge.x,fe=ge.barWidth,P=ge.xDivision,L=ge.zeroH;for(var R=D.group({class:"apexcharts-datalabels","data:realIndex":K}),H=D.group({class:"apexcharts-rangebar-goals-markers",style:"pointer-events: none"}),Q=0;Q<_.globals.dataPoints;Q++){var le=this.barHelpers.getStrokeWidth(T,Q,K),Re=this.seriesRangeStart[T][Q],tt=this.seriesRangeEnd[T][Q],Ve=null,Dt=null,pt={x:V,y:$,strokeWidth:le,elSeries:oe};if(q=ge.yDivision,ae=ge.barHeight,this.isHorizontal){Dt=$+ae*this.visibleI;var qe=this.seriesLen;_.config.plotOptions.bar.rangeBarGroupRows&&(qe=1);var Vt=(q-ae*qe)/2;if(void 0===_.config.series[T].data[Q])break;if(_.config.series[T].data[Q].x){var Yn=this.detectOverlappingBars({i:T,j:Q,barYPosition:Dt,srty:Vt,barHeight:ae,yDivision:q,initPositions:ge});ae=Yn.barHeight,Dt=Yn.barYPosition}fe=(Ve=this.drawRangeBarPaths(Je({indexes:{i:T,j:Q,realIndex:K},barHeight:ae,barYPosition:Dt,zeroW:B,yDivision:q,y1:Re,y2:tt},pt))).barWidth}else ae=(Ve=this.drawRangeColumnPaths(Je({indexes:{i:T,j:Q,realIndex:K},zeroH:L,barWidth:fe,xDivision:P},pt))).barHeight;var pn=this.barHelpers.drawGoalLine({barXPosition:Ve.barXPosition,barYPosition:Dt,goalX:Ve.goalX,goalY:Ve.goalY,barHeight:ae,barWidth:fe});pn&&H.add(pn),$=Ve.y,V=Ve.x;var xi=this.barHelpers.getPathFillColor(d,T,Q,K);this.renderSeries({realIndex:K,pathFill:xi,lineFill:_.globals.stroke.colors[K],j:Q,i:T,x:V,y:$,y1:Re,y2:tt,pathFrom:Ve.pathFrom,pathTo:Ve.pathTo,strokeWidth:le,elSeries:oe,series:d,barHeight:ae,barYPosition:Dt,barWidth:fe,elDataLabelsWrap:R,elGoalsMarkers:H,visibleSeries:this.visibleI,type:"rangebar"})}C.add(oe)}return C}},{key:"detectOverlappingBars",value:function(d){var g=d.i,_=d.j,D=d.barYPosition,C=d.srty,T=d.barHeight,P=d.yDivision,L=d.initPositions,B=this.w,V=[],$=B.config.series[g].data[_].rangeName,q=B.config.series[g].data[_].x,K=B.globals.labels.indexOf(q),oe=B.globals.seriesRangeBar[g].findIndex(function(ae){return ae.x===q&&ae.overlaps.length>0});return D=B.config.plotOptions.bar.rangeBarGroupRows?C+P*K:C+T*this.visibleI+P*K,oe>-1&&!B.config.plotOptions.bar.rangeBarOverlap&&(V=B.globals.seriesRangeBar[g][oe].overlaps).indexOf($)>-1&&(D=(T=L.barHeight/V.length)*this.visibleI+P*(100-parseInt(this.barOptions.barHeight,10))/100/2+T*(this.visibleI+V.indexOf($))+P*K),{barYPosition:D,barHeight:T}}},{key:"drawRangeColumnPaths",value:function(d){var g=d.indexes,_=d.x,D=d.xDivision,C=d.barWidth,T=d.zeroH,P=this.w,L=g.i,B=g.j,V=this.yRatio[this.yaxisIndex],$=g.realIndex,q=this.getRangeValue($,B),K=Math.min(q.start,q.end),oe=Math.max(q.start,q.end);P.globals.isXNumeric&&(_=(P.globals.seriesX[L][B]-P.globals.minX)/this.xRatio-C/2);var ae=_+C*this.visibleI;null==this.series[L][B]?K=T:(K=T-K/V,oe=T-oe/V);var fe=Math.abs(oe-K),ge=this.barHelpers.getColumnPaths({barXPosition:ae,barWidth:C,y1:K,y2:oe,strokeWidth:this.strokeWidth,series:this.seriesRangeEnd,realIndex:g.realIndex,i:$,j:B,w:P});return P.globals.isXNumeric||(_+=D),{pathTo:ge.pathTo,pathFrom:ge.pathFrom,barHeight:fe,x:_,y:oe,goalY:this.barHelpers.getGoalValues("y",null,T,L,B),barXPosition:ae}}},{key:"drawRangeBarPaths",value:function(d){var g=d.indexes,_=d.y,T=d.yDivision,P=d.barHeight,L=d.barYPosition,B=d.zeroW,V=this.w,$=B+d.y1/this.invertedYRatio,q=B+d.y2/this.invertedYRatio,K=Math.abs(q-$),oe=this.barHelpers.getBarpaths({barYPosition:L,barHeight:P,x1:$,x2:q,strokeWidth:this.strokeWidth,series:this.seriesRangeEnd,i:g.realIndex,realIndex:g.realIndex,j:g.j,w:V});return V.globals.isXNumeric||(_+=T),{pathTo:oe.pathTo,pathFrom:oe.pathFrom,barWidth:K,x:q,goalX:this.barHelpers.getGoalValues("x",B,null,g.realIndex,g.j),y:_}}},{key:"getRangeValue",value:function(d,g){var _=this.w;return{start:_.globals.seriesRangeStart[d][g],end:_.globals.seriesRangeEnd[d][g]}}},{key:"getTooltipValues",value:function(d){var g=d.ctx,_=d.seriesIndex,D=d.dataPointIndex,C=d.y1,T=d.y2,P=d.w,L=P.globals.seriesRangeStart[_][D],B=P.globals.seriesRangeEnd[_][D],V=P.globals.labels[D],$=P.config.series[_].name?P.config.series[_].name:"",q=P.config.tooltip.y.formatter,K=P.config.tooltip.y.title.formatter,oe={w:P,seriesIndex:_,dataPointIndex:D,start:L,end:B};"function"==typeof K&&($=K($,oe)),Number.isFinite(C)&&Number.isFinite(T)&&(L=C,B=T,P.config.series[_].data[D].x&&(V=P.config.series[_].data[D].x+":"),"function"==typeof q&&(V=q(V,oe)));var ae="",fe="",ge=P.globals.colors[_];if(void 0===P.config.tooltip.x.formatter)if("datetime"===P.config.xaxis.type){var R=new mn(g);ae=R.formatDate(R.getDate(L),P.config.tooltip.x.format),fe=R.formatDate(R.getDate(B),P.config.tooltip.x.format)}else ae=L,fe=B;else ae=P.config.tooltip.x.formatter(L),fe=P.config.tooltip.x.formatter(B);return{start:L,end:B,startVal:ae,endVal:fe,ylabel:V,color:ge,seriesName:$}}},{key:"buildCustomTooltipHTML",value:function(d){return'<div class="apexcharts-tooltip-rangebar"><div> <span class="series-name" style="color: '+d.color+'">'+(d.seriesName||"")+'</span></div><div> <span class="category">'+d.ylabel+' </span> <span class="value start-value">'+d.start+'</span> <span class="separator">-</span> <span class="value end-value">'+d.end+"</span></div></div>"}}]),a}(),ni=function(){function te(o){zt(this,te),this.opts=o}return St(te,[{key:"line",value:function(){return{chart:{animations:{easing:"swing"}},dataLabels:{enabled:!1},stroke:{width:5,curve:"straight"},markers:{size:0,hover:{sizeOffset:6}},xaxis:{crosshairs:{width:1}}}}},{key:"sparkline",value:function(o){return this.opts.yaxis[0].show=!1,this.opts.yaxis[0].title.text="",this.opts.yaxis[0].axisBorder.show=!1,this.opts.yaxis[0].axisTicks.show=!1,this.opts.yaxis[0].floating=!0,Xe.extend(o,{grid:{show:!1,padding:{left:0,right:0,top:0,bottom:0}},legend:{show:!1},xaxis:{labels:{show:!1},tooltip:{enabled:!1},axisBorder:{show:!1},axisTicks:{show:!1}},chart:{toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1}})}},{key:"bar",value:function(){return{chart:{stacked:!1,animations:{easing:"swing"}},plotOptions:{bar:{dataLabels:{position:"center"}}},dataLabels:{style:{colors:["#fff"]},background:{enabled:!1}},stroke:{width:0,lineCap:"round"},fill:{opacity:.85},legend:{markers:{shape:"square",radius:2,size:8}},tooltip:{shared:!1,intersect:!0},xaxis:{tooltip:{enabled:!1},tickPlacement:"between",crosshairs:{width:"barWidth",position:"back",fill:{type:"gradient"},dropShadow:{enabled:!1},stroke:{width:0}}}}}},{key:"candlestick",value:function(){var o=this;return{stroke:{width:1,colors:["#333"]},fill:{opacity:1},dataLabels:{enabled:!1},tooltip:{shared:!0,custom:function(a){return o._getBoxTooltip(a.w,a.seriesIndex,a.dataPointIndex,["Open","High","","Low","Close"],"candlestick")}},states:{active:{filter:{type:"none"}}},xaxis:{crosshairs:{width:1}}}}},{key:"boxPlot",value:function(){var o=this;return{chart:{animations:{dynamicAnimation:{enabled:!1}}},stroke:{width:1,colors:["#24292e"]},dataLabels:{enabled:!1},tooltip:{shared:!0,custom:function(a){return o._getBoxTooltip(a.w,a.seriesIndex,a.dataPointIndex,["Minimum","Q1","Median","Q3","Maximum"],"boxPlot")}},markers:{size:5,strokeWidth:1,strokeColors:"#111"},xaxis:{crosshairs:{width:1}}}}},{key:"rangeBar",value:function(){return{stroke:{width:0,lineCap:"square"},plotOptions:{bar:{borderRadius:0,dataLabels:{position:"center"}}},dataLabels:{enabled:!1,formatter:function(o,a){var d=a.seriesIndex,g=a.dataPointIndex,_=a.w;return _.globals.seriesRangeEnd[d][g]-_.globals.seriesRangeStart[d][g]},background:{enabled:!1},style:{colors:["#fff"]}},tooltip:{shared:!1,followCursor:!0,custom:function(o){return o.w.config.plotOptions&&o.w.config.plotOptions.bar&&o.w.config.plotOptions.bar.horizontal?(g=(d=new Or((a=o).ctx,null)).getTooltipValues(a),d.buildCustomTooltipHTML({color:g.color,seriesName:g.seriesName,ylabel:g.ylabel,start:g.startVal,end:g.endVal})):function(a){var d=new Or(a.ctx,null),g=d.getTooltipValues(a);return d.buildCustomTooltipHTML({color:g.color,seriesName:g.seriesName,ylabel:g.ylabel,start:g.start,end:g.end})}(o);var a,d,g}},xaxis:{tickPlacement:"between",tooltip:{enabled:!1},crosshairs:{stroke:{width:0}}}}}},{key:"area",value:function(){return{stroke:{width:4},fill:{type:"gradient",gradient:{inverseColors:!1,shade:"light",type:"vertical",opacityFrom:.65,opacityTo:.5,stops:[0,100,100]}},markers:{size:0,hover:{sizeOffset:6}},tooltip:{followCursor:!1}}}},{key:"brush",value:function(o){return Xe.extend(o,{chart:{toolbar:{autoSelected:"selection",show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{width:1},tooltip:{enabled:!1},xaxis:{tooltip:{enabled:!1}}})}},{key:"stacked100",value:function(o){o.dataLabels=o.dataLabels||{},o.dataLabels.formatter=o.dataLabels.formatter||void 0;var a=o.dataLabels.formatter;return o.yaxis.forEach(function(d,g){o.yaxis[g].min=0,o.yaxis[g].max=100}),"bar"===o.chart.type&&(o.dataLabels.formatter=a||function(d){return"number"==typeof d&&d?d.toFixed(0)+"%":d}),o}},{key:"convertCatToNumeric",value:function(o){return o.xaxis.convertedCatToNumeric=!0,o}},{key:"convertCatToNumericXaxis",value:function(o,a,d){o.xaxis.type="numeric",o.xaxis.labels=o.xaxis.labels||{},o.xaxis.labels.formatter=o.xaxis.labels.formatter||function(D){return Xe.isNumber(D)?Math.floor(D):D};var g=o.xaxis.labels.formatter,_=o.xaxis.categories&&o.xaxis.categories.length?o.xaxis.categories:o.labels;return d&&d.length&&(_=d.map(function(D){return Array.isArray(D)?D:String(D)})),_&&_.length&&(o.xaxis.labels.formatter=function(D){return Xe.isNumber(D)?g(_[Math.floor(D)-1]):g(D)}),o.xaxis.categories=[],o.labels=[],o.xaxis.tickAmount=o.xaxis.tickAmount||"dataPoints",o}},{key:"bubble",value:function(){return{dataLabels:{style:{colors:["#fff"]}},tooltip:{shared:!1,intersect:!0},xaxis:{crosshairs:{width:0}},fill:{type:"solid",gradient:{shade:"light",inverse:!0,shadeIntensity:.55,opacityFrom:.4,opacityTo:.8}}}}},{key:"scatter",value:function(){return{dataLabels:{enabled:!1},tooltip:{shared:!1,intersect:!0},markers:{size:6,strokeWidth:1,hover:{sizeOffset:2}}}}},{key:"heatmap",value:function(){return{chart:{stacked:!1},fill:{opacity:1},dataLabels:{style:{colors:["#fff"]}},stroke:{colors:["#fff"]},tooltip:{followCursor:!0,marker:{show:!1},x:{show:!1}},legend:{position:"top",markers:{shape:"square",size:10,offsetY:2}},grid:{padding:{right:20}}}}},{key:"treemap",value:function(){return{chart:{zoom:{enabled:!1}},dataLabels:{style:{fontSize:14,fontWeight:600,colors:["#fff"]}},stroke:{show:!0,width:2,colors:["#fff"]},legend:{show:!1},fill:{gradient:{stops:[0,100]}},tooltip:{followCursor:!0,x:{show:!1}},grid:{padding:{left:0,right:0}},xaxis:{crosshairs:{show:!1},tooltip:{enabled:!1}}}}},{key:"pie",value:function(){return{chart:{toolbar:{show:!1}},plotOptions:{pie:{donut:{labels:{show:!1}}}},dataLabels:{formatter:function(o){return o.toFixed(1)+"%"},style:{colors:["#fff"]},background:{enabled:!1},dropShadow:{enabled:!0}},stroke:{colors:["#fff"]},fill:{opacity:1,gradient:{shade:"light",stops:[0,100]}},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"}}}},{key:"donut",value:function(){return{chart:{toolbar:{show:!1}},dataLabels:{formatter:function(o){return o.toFixed(1)+"%"},style:{colors:["#fff"]},background:{enabled:!1},dropShadow:{enabled:!0}},stroke:{colors:["#fff"]},fill:{opacity:1,gradient:{shade:"light",shadeIntensity:.35,stops:[80,100],opacityFrom:1,opacityTo:1}},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"}}}},{key:"polarArea",value:function(){return this.opts.yaxis[0].tickAmount=this.opts.yaxis[0].tickAmount?this.opts.yaxis[0].tickAmount:6,{chart:{toolbar:{show:!1}},dataLabels:{formatter:function(o){return o.toFixed(1)+"%"},enabled:!1},stroke:{show:!0,width:2},fill:{opacity:.7},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"}}}},{key:"radar",value:function(){return this.opts.yaxis[0].labels.offsetY=this.opts.yaxis[0].labels.offsetY?this.opts.yaxis[0].labels.offsetY:6,{dataLabels:{enabled:!1,style:{fontSize:"11px"}},stroke:{width:2},markers:{size:3,strokeWidth:1,strokeOpacity:1},fill:{opacity:.2},tooltip:{shared:!1,intersect:!0,followCursor:!0},grid:{show:!1},xaxis:{labels:{formatter:function(o){return o},style:{colors:["#a8a8a8"],fontSize:"11px"}},tooltip:{enabled:!1},crosshairs:{show:!1}}}}},{key:"radialBar",value:function(){return{chart:{animations:{dynamicAnimation:{enabled:!0,speed:800}},toolbar:{show:!1}},fill:{gradient:{shade:"dark",shadeIntensity:.4,inverseColors:!1,type:"diagonal2",opacityFrom:1,opacityTo:1,stops:[70,98,100]}},legend:{show:!1,position:"right"},tooltip:{enabled:!1,fillSeriesColor:!0}}}},{key:"_getBoxTooltip",value:function(o,a,d,g,_){var D=o.globals.seriesCandleO[a][d],C=o.globals.seriesCandleH[a][d],T=o.globals.seriesCandleM[a][d],P=o.globals.seriesCandleL[a][d],L=o.globals.seriesCandleC[a][d];return o.config.series[a].type&&o.config.series[a].type!==_?'<div class="apexcharts-custom-tooltip">\n          '.concat(o.config.series[a].name?o.config.series[a].name:"series-"+(a+1),": <strong>").concat(o.globals.series[a][d],"</strong>\n        </div>"):'<div class="apexcharts-tooltip-box apexcharts-tooltip-'.concat(o.config.chart.type,'">')+"<div>".concat(g[0],': <span class="value">')+D+"</span></div>"+"<div>".concat(g[1],': <span class="value">')+C+"</span></div>"+(T?"<div>".concat(g[2],': <span class="value">')+T+"</span></div>":"")+"<div>".concat(g[3],': <span class="value">')+P+"</span></div>"+"<div>".concat(g[4],': <span class="value">')+L+"</span></div></div>"}}]),te}(),vn=function(){function te(o){zt(this,te),this.opts=o}return St(te,[{key:"init",value:function(o){var a=o.responsiveOverride,d=this.opts,g=new Fr,_=new ni(d);this.chartType=d.chart.type,"histogram"===this.chartType&&(d.chart.type="bar",d=Xe.extend({plotOptions:{bar:{columnWidth:"99.99%"}}},d)),d=this.extendYAxis(d),d=this.extendAnnotations(d);var D=g.init(),C={};if(d&&"object"===nr(d)){var T={};T=-1!==["line","area","bar","candlestick","boxPlot","rangeBar","histogram","bubble","scatter","heatmap","treemap","pie","polarArea","donut","radar","radialBar"].indexOf(d.chart.type)?_[d.chart.type]():_.line(),d.chart.brush&&d.chart.brush.enabled&&(T=_.brush(T)),d.chart.stacked&&"100%"===d.chart.stackType&&(d=_.stacked100(d)),this.checkForDarkTheme(window.Apex),this.checkForDarkTheme(d),d.xaxis=d.xaxis||window.Apex.xaxis||{},a||(d.xaxis.convertedCatToNumeric=!1),((d=this.checkForCatToNumericXAxis(this.chartType,T,d)).chart.sparkline&&d.chart.sparkline.enabled||window.Apex.chart&&window.Apex.chart.sparkline&&window.Apex.chart.sparkline.enabled)&&(T=_.sparkline(T)),C=Xe.extend(D,T)}var P=Xe.extend(C,window.Apex);return D=Xe.extend(P,d),this.handleUserInputErrors(D)}},{key:"checkForCatToNumericXAxis",value:function(o,a,d){var g=new ni(d);return"bar"===o&&d.plotOptions&&d.plotOptions.bar&&d.plotOptions.bar.horizontal||"pie"===o||"polarArea"===o||"donut"===o||"radar"===o||"radialBar"===o||"heatmap"===o||!("datetime"!==d.xaxis.type&&"numeric"!==d.xaxis.type)||"between"===(d.xaxis.tickPlacement?d.xaxis.tickPlacement:a.xaxis&&a.xaxis.tickPlacement)||(d=g.convertCatToNumeric(d)),d}},{key:"extendYAxis",value:function(o,a){var d=new Fr;(void 0===o.yaxis||!o.yaxis||Array.isArray(o.yaxis)&&0===o.yaxis.length)&&(o.yaxis={}),o.yaxis.constructor!==Array&&window.Apex.yaxis&&window.Apex.yaxis.constructor!==Array&&(o.yaxis=Xe.extend(o.yaxis,window.Apex.yaxis)),o.yaxis=o.yaxis.constructor!==Array?[Xe.extend(d.yAxis,o.yaxis)]:Xe.extendArray(o.yaxis,d.yAxis);var g=!1;o.yaxis.forEach(function(D){D.logarithmic&&(g=!0)});var _=o.series;return a&&!_&&(_=a.config.series),g&&_.length!==o.yaxis.length&&_.length&&(o.yaxis=_.map(function(D,C){if(D.name||(_[C].name="series-".concat(C+1)),o.yaxis[C])return o.yaxis[C].seriesName=_[C].name,o.yaxis[C];var T=Xe.extend(d.yAxis,o.yaxis[0]);return T.show=!1,T})),g&&_.length>1&&_.length!==o.yaxis.length&&console.warn("A multi-series logarithmic chart should have equal number of series and y-axes. Please make sure to equalize both."),o}},{key:"extendAnnotations",value:function(o){return void 0===o.annotations&&(o.annotations={},o.annotations.yaxis=[],o.annotations.xaxis=[],o.annotations.points=[]),o=this.extendYAxisAnnotations(o),o=this.extendXAxisAnnotations(o),this.extendPointAnnotations(o)}},{key:"extendYAxisAnnotations",value:function(o){var a=new Fr;return o.annotations.yaxis=Xe.extendArray(void 0!==o.annotations.yaxis?o.annotations.yaxis:[],a.yAxisAnnotation),o}},{key:"extendXAxisAnnotations",value:function(o){var a=new Fr;return o.annotations.xaxis=Xe.extendArray(void 0!==o.annotations.xaxis?o.annotations.xaxis:[],a.xAxisAnnotation),o}},{key:"extendPointAnnotations",value:function(o){var a=new Fr;return o.annotations.points=Xe.extendArray(void 0!==o.annotations.points?o.annotations.points:[],a.pointAnnotation),o}},{key:"checkForDarkTheme",value:function(o){o.theme&&"dark"===o.theme.mode&&(o.tooltip||(o.tooltip={}),"light"!==o.tooltip.theme&&(o.tooltip.theme="dark"),o.chart.foreColor||(o.chart.foreColor="#f6f7f8"),o.chart.background||(o.chart.background="#424242"),o.theme.palette||(o.theme.palette="palette4"))}},{key:"handleUserInputErrors",value:function(o){var a=o;if(a.tooltip.shared&&a.tooltip.intersect)throw new Error("tooltip.shared cannot be enabled when tooltip.intersect is true. Turn off any other option by setting it to false.");if("bar"===a.chart.type&&a.plotOptions.bar.horizontal){if(a.yaxis.length>1)throw new Error("Multiple Y Axis for bars are not supported. Switch to column chart by setting plotOptions.bar.horizontal=false");a.yaxis[0].reversed&&(a.yaxis[0].opposite=!0),a.xaxis.tooltip.enabled=!1,a.yaxis[0].tooltip.enabled=!1,a.chart.zoom.enabled=!1}return"bar"!==a.chart.type&&"rangeBar"!==a.chart.type||a.tooltip.shared&&"barWidth"===a.xaxis.crosshairs.width&&a.series.length>1&&(a.xaxis.crosshairs.width="tickWidth"),"candlestick"!==a.chart.type&&"boxPlot"!==a.chart.type||a.yaxis[0].reversed&&(console.warn("Reversed y-axis in ".concat(a.chart.type," chart is not supported.")),a.yaxis[0].reversed=!1),Array.isArray(a.stroke.width)&&"line"!==a.chart.type&&"area"!==a.chart.type&&(console.warn("stroke.width option accepts array only for line and area charts. Reverted back to Number"),a.stroke.width=a.stroke.width[0]),a}}]),te}(),Kt=function(){function te(){zt(this,te)}return St(te,[{key:"initGlobalVars",value:function(o){o.series=[],o.seriesCandleO=[],o.seriesCandleH=[],o.seriesCandleM=[],o.seriesCandleL=[],o.seriesCandleC=[],o.seriesRangeStart=[],o.seriesRangeEnd=[],o.seriesRangeBar=[],o.seriesPercent=[],o.seriesGoals=[],o.seriesX=[],o.seriesZ=[],o.seriesNames=[],o.seriesTotals=[],o.seriesLog=[],o.seriesColors=[],o.stackedSeriesTotals=[],o.seriesXvalues=[],o.seriesYvalues=[],o.labels=[],o.categoryLabels=[],o.timescaleLabels=[],o.noLabelsProvided=!1,o.resizeTimer=null,o.selectionResizeTimer=null,o.delayedElements=[],o.pointsArray=[],o.dataLabelsRects=[],o.isXNumeric=!1,o.xaxisLabelsCount=0,o.skipLastTimelinelabel=!1,o.skipFirstTimelinelabel=!1,o.isDataXYZ=!1,o.isMultiLineX=!1,o.isMultipleYAxis=!1,o.maxY=-Number.MAX_VALUE,o.minY=Number.MIN_VALUE,o.minYArr=[],o.maxYArr=[],o.maxX=-Number.MAX_VALUE,o.minX=Number.MAX_VALUE,o.initialMaxX=-Number.MAX_VALUE,o.initialMinX=Number.MAX_VALUE,o.maxDate=0,o.minDate=Number.MAX_VALUE,o.minZ=Number.MAX_VALUE,o.maxZ=-Number.MAX_VALUE,o.minXDiff=Number.MAX_VALUE,o.yAxisScale=[],o.xAxisScale=null,o.xAxisTicksPositions=[],o.yLabelsCoords=[],o.yTitleCoords=[],o.barPadForNumericAxis=0,o.padHorizontal=0,o.xRange=0,o.yRange=[],o.zRange=0,o.dataPoints=0,o.xTickAmount=0}},{key:"globalVars",value:function(o){return{chartID:null,cuid:null,events:{beforeMount:[],mounted:[],updated:[],clicked:[],selection:[],dataPointSelection:[],zoomed:[],scrolled:[]},colors:[],clientX:null,clientY:null,fill:{colors:[]},stroke:{colors:[]},dataLabels:{style:{colors:[]}},radarPolygons:{fill:{colors:[]}},markers:{colors:[],size:o.markers.size,largestSize:0},animationEnded:!1,isTouchDevice:"ontouchstart"in window||navigator.msMaxTouchPoints,isDirty:!1,isExecCalled:!1,initialConfig:null,initialSeries:[],lastXAxis:[],lastYAxis:[],columnSeries:null,labels:[],timescaleLabels:[],noLabelsProvided:!1,allSeriesCollapsed:!1,collapsedSeries:[],collapsedSeriesIndices:[],ancillaryCollapsedSeries:[],ancillaryCollapsedSeriesIndices:[],risingSeries:[],dataFormatXNumeric:!1,capturedSeriesIndex:-1,capturedDataPointIndex:-1,selectedDataPoints:[],goldenPadding:35,invalidLogScale:!1,ignoreYAxisIndexes:[],yAxisSameScaleIndices:[],maxValsInArrayIndex:0,radialSize:0,selection:void 0,zoomEnabled:"zoom"===o.chart.toolbar.autoSelected&&o.chart.toolbar.tools.zoom&&o.chart.zoom.enabled,panEnabled:"pan"===o.chart.toolbar.autoSelected&&o.chart.toolbar.tools.pan,selectionEnabled:"selection"===o.chart.toolbar.autoSelected&&o.chart.toolbar.tools.selection,yaxis:null,mousedown:!1,lastClientPosition:{},visibleXRange:void 0,yValueDecimal:0,total:0,SVGNS:"http://www.w3.org/2000/svg",svgWidth:0,svgHeight:0,noData:!1,locale:{},dom:{},memory:{methodsToExec:[]},shouldAnimate:!0,skipLastTimelinelabel:!1,skipFirstTimelinelabel:!1,delayedElements:[],axisCharts:!0,isDataXYZ:!1,resized:!1,resizeTimer:null,comboCharts:!1,dataChanged:!1,previousPaths:[],allSeriesHasEqualX:!0,pointsArray:[],dataLabelsRects:[],lastDrawnDataLabelsIndexes:[],hasNullValues:!1,easing:null,zoomed:!1,gridWidth:0,gridHeight:0,rotateXLabels:!1,defaultLabels:!1,xLabelFormatter:void 0,yLabelFormatters:[],xaxisTooltipFormatter:void 0,ttKeyFormatter:void 0,ttVal:void 0,ttZFormatter:void 0,LINE_HEIGHT_RATIO:1.618,xAxisLabelsHeight:0,xAxisLabelsWidth:0,yAxisLabelsWidth:0,scaleX:1,scaleY:1,translateX:0,translateY:0,translateYAxisX:[],yAxisWidths:[],translateXAxisY:0,translateXAxisX:0,tooltip:null}}},{key:"init",value:function(o){var a=this.globalVars(o);return this.initGlobalVars(a),a.initialConfig=Xe.extend({},o),a.initialSeries=Xe.clone(o.series),a.lastXAxis=Xe.clone(a.initialConfig.xaxis),a.lastYAxis=Xe.clone(a.initialConfig.yaxis),a}}]),te}(),ua=function(){function te(o){zt(this,te),this.opts=o}return St(te,[{key:"init",value:function(){var o=new vn(this.opts).init({responsiveOverride:!1});return{config:o,globals:(new Kt).init(o)}}}]),te}(),Tn=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.twoDSeries=[],this.threeDSeries=[],this.twoDSeriesX=[],this.seriesGoals=[],this.coreUtils=new fi(this.ctx)}return St(te,[{key:"isMultiFormat",value:function(){return this.isFormatXY()||this.isFormat2DArray()}},{key:"isFormatXY",value:function(){var o=this.w.config.series.slice(),a=new Bi(this.ctx);if(this.activeSeriesIndex=a.getActiveConfigSeriesIndex(),void 0!==o[this.activeSeriesIndex].data&&o[this.activeSeriesIndex].data.length>0&&null!==o[this.activeSeriesIndex].data[0]&&void 0!==o[this.activeSeriesIndex].data[0].x&&null!==o[this.activeSeriesIndex].data[0])return!0}},{key:"isFormat2DArray",value:function(){var o=this.w.config.series.slice(),a=new Bi(this.ctx);if(this.activeSeriesIndex=a.getActiveConfigSeriesIndex(),void 0!==o[this.activeSeriesIndex].data&&o[this.activeSeriesIndex].data.length>0&&null!=o[this.activeSeriesIndex].data[0]&&o[this.activeSeriesIndex].data[0].constructor===Array)return!0}},{key:"handleFormat2DArray",value:function(o,a){for(var d=this.w.config,g=this.w.globals,_="boxPlot"===d.chart.type||"boxPlot"===d.series[a].type,D=0;D<o[a].data.length;D++)if(void 0!==o[a].data[D][1]&&(Array.isArray(o[a].data[D][1])&&4===o[a].data[D][1].length&&!_?this.twoDSeries.push(Xe.parseNumber(o[a].data[D][1][3])):this.twoDSeries.push(Xe.parseNumber(o[a].data[D].length>=5?o[a].data[D][4]:o[a].data[D][1])),g.dataFormatXNumeric=!0),"datetime"===d.xaxis.type){var C=new Date(o[a].data[D][0]);C=new Date(C).getTime(),this.twoDSeriesX.push(C)}else this.twoDSeriesX.push(o[a].data[D][0]);for(var T=0;T<o[a].data.length;T++)void 0!==o[a].data[T][2]&&(this.threeDSeries.push(o[a].data[T][2]),g.isDataXYZ=!0)}},{key:"handleFormatXY",value:function(o,a){var d=this.w.config,g=this.w.globals,_=new mn(this.ctx),D=a;g.collapsedSeriesIndices.indexOf(a)>-1&&(D=this.activeSeriesIndex);for(var C=0;C<o[a].data.length;C++)void 0!==o[a].data[C].y&&(Array.isArray(o[a].data[C].y)?this.twoDSeries.push(Xe.parseNumber(o[a].data[C].y[o[a].data[C].y.length-1])):this.twoDSeries.push(Xe.parseNumber(o[a].data[C].y))),void 0!==o[a].data[C].goals&&Array.isArray(o[a].data[C].goals)?(void 0===this.seriesGoals[a]&&(this.seriesGoals[a]=[]),this.seriesGoals[a].push(o[a].data[C].goals)):(void 0===this.seriesGoals[a]&&(this.seriesGoals[a]=[]),this.seriesGoals[a].push(null));for(var T=0;T<o[D].data.length;T++){var P="string"==typeof o[D].data[T].x,L=Array.isArray(o[D].data[T].x),B=!L&&!!_.isValidDate(o[D].data[T].x.toString());P||B?P||d.xaxis.convertedCatToNumeric?"datetime"!==d.xaxis.type||g.isBarHorizontal&&g.isRangeData?(this.fallbackToCategory=!0,this.twoDSeriesX.push(o[D].data[T].x)):this.twoDSeriesX.push(_.parseDate(o[D].data[T].x)):"datetime"===d.xaxis.type?this.twoDSeriesX.push(_.parseDate(o[D].data[T].x.toString())):(g.dataFormatXNumeric=!0,g.isXNumeric=!0,this.twoDSeriesX.push(parseFloat(o[D].data[T].x))):L?(this.fallbackToCategory=!0,this.twoDSeriesX.push(o[D].data[T].x)):(g.isXNumeric=!0,g.dataFormatXNumeric=!0,this.twoDSeriesX.push(o[D].data[T].x))}if(o[a].data[0]&&void 0!==o[a].data[0].z){for(var $=0;$<o[a].data.length;$++)this.threeDSeries.push(o[a].data[$].z);g.isDataXYZ=!0}}},{key:"handleRangeData",value:function(o,a){var d=this.w.globals,g={};return this.isFormat2DArray()?g=this.handleRangeDataFormat("array",o,a):this.isFormatXY()&&(g=this.handleRangeDataFormat("xy",o,a)),d.seriesRangeStart.push(g.start),d.seriesRangeEnd.push(g.end),d.seriesRangeBar.push(g.rangeUniques),d.seriesRangeBar.forEach(function(_,D){_&&_.forEach(function(C,T){C.y.forEach(function(P,L){for(var B=0;B<C.y.length;B++)L!==B&&P.y1<=C.y[B].y2&&C.y[B].y1<=P.y2&&(C.overlaps.indexOf(P.rangeName)<0&&C.overlaps.push(P.rangeName),C.overlaps.indexOf(C.y[B].rangeName)<0&&C.overlaps.push(C.y[B].rangeName))})})}),g}},{key:"handleCandleStickBoxData",value:function(o,a){var d=this.w.globals,g={};return this.isFormat2DArray()?g=this.handleCandleStickBoxDataFormat("array",o,a):this.isFormatXY()&&(g=this.handleCandleStickBoxDataFormat("xy",o,a)),d.seriesCandleO[a]=g.o,d.seriesCandleH[a]=g.h,d.seriesCandleM[a]=g.m,d.seriesCandleL[a]=g.l,d.seriesCandleC[a]=g.c,g}},{key:"handleRangeDataFormat",value:function(o,a,d){var g=[],_=[],D=a[d].data.filter(function(V,$,q){return $===q.findIndex(function(K){return K.x===V.x})}).map(function(V,$){return{x:V.x,overlaps:[],y:[]}}),C="Please provide [Start, End] values in valid format. Read more https://apexcharts.com/docs/series/#rangecharts",T=new Bi(this.ctx).getActiveConfigSeriesIndex();if("array"===o){if(2!==a[T].data[0][1].length)throw new Error(C);for(var P=0;P<a[d].data.length;P++)g.push(a[d].data[P][1][0]),_.push(a[d].data[P][1][1])}else if("xy"===o){if(2!==a[T].data[0].y.length)throw new Error(C);for(var L=function(V){var $=Xe.randomId(),q=a[d].data[V].x,K={y1:a[d].data[V].y[0],y2:a[d].data[V].y[1],rangeName:$};a[d].data[V].rangeName=$;var oe=D.findIndex(function(ae){return ae.x===q});D[oe].y.push(K),g.push(K.y1),_.push(K.y2)},B=0;B<a[d].data.length;B++)L(B)}return{start:g,end:_,rangeUniques:D}}},{key:"handleCandleStickBoxDataFormat",value:function(o,a,d){var g=this.w,_="boxPlot"===g.config.chart.type||"boxPlot"===g.config.series[d].type,D=[],C=[],T=[],P=[],L=[];if("array"===o)if(_&&6===a[d].data[0].length||!_&&5===a[d].data[0].length)for(var B=0;B<a[d].data.length;B++)D.push(a[d].data[B][1]),C.push(a[d].data[B][2]),_?(T.push(a[d].data[B][3]),P.push(a[d].data[B][4]),L.push(a[d].data[B][5])):(P.push(a[d].data[B][3]),L.push(a[d].data[B][4]));else for(var V=0;V<a[d].data.length;V++)Array.isArray(a[d].data[V][1])&&(D.push(a[d].data[V][1][0]),C.push(a[d].data[V][1][1]),_?(T.push(a[d].data[V][1][2]),P.push(a[d].data[V][1][3]),L.push(a[d].data[V][1][4])):(P.push(a[d].data[V][1][2]),L.push(a[d].data[V][1][3])));else if("xy"===o)for(var $=0;$<a[d].data.length;$++)Array.isArray(a[d].data[$].y)&&(D.push(a[d].data[$].y[0]),C.push(a[d].data[$].y[1]),_?(T.push(a[d].data[$].y[2]),P.push(a[d].data[$].y[3]),L.push(a[d].data[$].y[4])):(P.push(a[d].data[$].y[2]),L.push(a[d].data[$].y[3])));return{o:D,h:C,m:T,l:P,c:L}}},{key:"parseDataAxisCharts",value:function(o){var a=this,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.ctx,g=this.w.config,_=this.w.globals,D=new mn(d),C=g.labels.length>0?g.labels.slice():g.xaxis.categories.slice();_.isRangeBar="rangeBar"===g.chart.type&&_.isBarHorizontal;for(var T=function(){for(var B=0;B<C.length;B++)if("string"==typeof C[B]){if(!D.isValidDate(C[B]))throw new Error("You have provided invalid Date format. Please provide a valid JavaScript Date");a.twoDSeriesX.push(D.parseDate(C[B]))}else a.twoDSeriesX.push(C[B])},P=0;P<o.length;P++){if(this.twoDSeries=[],this.twoDSeriesX=[],this.threeDSeries=[],void 0===o[P].data)return void console.error("It is a possibility that you may have not included 'data' property in series.");if("rangeBar"!==g.chart.type&&"rangeArea"!==g.chart.type&&"rangeBar"!==o[P].type&&"rangeArea"!==o[P].type||(_.isRangeData=!0,this.handleRangeData(o,P)),this.isMultiFormat())this.isFormat2DArray()?this.handleFormat2DArray(o,P):this.isFormatXY()&&this.handleFormatXY(o,P),"candlestick"!==g.chart.type&&"candlestick"!==o[P].type&&"boxPlot"!==g.chart.type&&"boxPlot"!==o[P].type||this.handleCandleStickBoxData(o,P),_.series.push(this.twoDSeries),_.labels.push(this.twoDSeriesX),_.seriesX.push(this.twoDSeriesX),_.seriesGoals=this.seriesGoals,P!==this.activeSeriesIndex||this.fallbackToCategory||(_.isXNumeric=!0);else{"datetime"===g.xaxis.type?(_.isXNumeric=!0,T(),_.seriesX.push(this.twoDSeriesX)):"numeric"===g.xaxis.type&&(_.isXNumeric=!0,C.length>0&&(this.twoDSeriesX=C,_.seriesX.push(this.twoDSeriesX))),_.labels.push(this.twoDSeriesX);var L=o[P].data.map(function(B){return Xe.parseNumber(B)});_.series.push(L)}_.seriesZ.push(this.threeDSeries),_.seriesNames.push(void 0!==o[P].name?o[P].name:"series-"+parseInt(P+1,10)),_.seriesColors.push(void 0!==o[P].color?o[P].color:void 0)}return this.w}},{key:"parseDataNonAxisCharts",value:function(o){var a=this.w.globals,d=this.w.config;a.series=o.slice(),a.seriesNames=d.labels.slice();for(var g=0;g<a.series.length;g++)void 0===a.seriesNames[g]&&a.seriesNames.push("series-"+(g+1));return this.w}},{key:"handleExternalLabelsData",value:function(o){var a=this.w.config,d=this.w.globals;a.xaxis.categories.length>0?d.labels=a.xaxis.categories:a.labels.length>0?d.labels=a.labels.slice():this.fallbackToCategory?(d.labels=d.labels[0],d.seriesRangeBar.length&&(d.seriesRangeBar.map(function(g){g.forEach(function(_){d.labels.indexOf(_.x)<0&&_.x&&d.labels.push(_.x)})}),d.labels=d.labels.filter(function(g,_,D){return D.indexOf(g)===_})),a.xaxis.convertedCatToNumeric&&(new ni(a).convertCatToNumericXaxis(a,this.ctx,d.seriesX[0]),this._generateExternalLabels(o))):this._generateExternalLabels(o)}},{key:"_generateExternalLabels",value:function(o){var a=this.w.globals,d=this.w.config,g=[];if(a.axisCharts){if(a.series.length>0)for(var _=0;_<a.series[a.maxValsInArrayIndex].length;_++)g.push(_+1);a.seriesX=[];for(var D=0;D<o.length;D++)a.seriesX.push(g);a.isXNumeric=!0}if(0===g.length){g=a.axisCharts?[]:a.series.map(function(T,P){return P+1});for(var C=0;C<o.length;C++)a.seriesX.push(g)}a.labels=g,d.xaxis.convertedCatToNumeric&&(a.categoryLabels=g.map(function(T){return d.xaxis.labels.formatter(T)})),a.noLabelsProvided=!0}},{key:"parseData",value:function(o){var a=this.w,d=a.config,g=a.globals;if(this.excludeCollapsedSeriesInYAxis(),this.fallbackToCategory=!1,this.ctx.core.resetGlobals(),this.ctx.core.isMultipleY(),g.axisCharts?this.parseDataAxisCharts(o):this.parseDataNonAxisCharts(o),this.coreUtils.getLargestSeries(),"bar"===d.chart.type&&d.chart.stacked){var _=new Bi(this.ctx);g.series=_.setNullSeriesToZeroValues(g.series)}this.coreUtils.getSeriesTotals(),g.axisCharts&&this.coreUtils.getStackedSeriesTotals(),this.coreUtils.getPercentSeries(),g.dataFormatXNumeric||g.isXNumeric&&("numeric"!==d.xaxis.type||0!==d.labels.length||0!==d.xaxis.categories.length)||this.handleExternalLabelsData(o);for(var D=this.coreUtils.getCategoryLabels(g.labels),C=0;C<D.length;C++)if(Array.isArray(D[C])){g.isMultiLineX=!0;break}}},{key:"excludeCollapsedSeriesInYAxis",value:function(){var o=this,a=this.w;a.globals.ignoreYAxisIndexes=a.globals.collapsedSeries.map(function(d,g){if(o.w.globals.isMultipleYAxis&&!a.config.chart.stacked)return d.index})}}]),te}(),ho=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.tooltipKeyFormat="dd MMM"}return St(te,[{key:"xLabelFormat",value:function(o,a,d,g){var _=this.w;if("datetime"===_.config.xaxis.type&&void 0===_.config.xaxis.labels.formatter&&void 0===_.config.tooltip.x.formatter){var D=new mn(this.ctx);return D.formatDate(D.getDate(a),_.config.tooltip.x.format)}return o(a,d,g)}},{key:"defaultGeneralFormatter",value:function(o){return Array.isArray(o)?o.map(function(a){return a}):o}},{key:"defaultYFormatter",value:function(o,a,d){var g=this.w;return Xe.isNumber(o)&&(o=o.toFixed(0!==g.globals.yValueDecimal?void 0!==a.decimalsInFloat?a.decimalsInFloat:g.globals.yValueDecimal:g.globals.maxYArr[d]-g.globals.minYArr[d]<5?1:0)),o}},{key:"setLabelFormatters",value:function(){var o=this,a=this.w;return a.globals.xaxisTooltipFormatter=function(d){return o.defaultGeneralFormatter(d)},a.globals.ttKeyFormatter=function(d){return o.defaultGeneralFormatter(d)},a.globals.ttZFormatter=function(d){return d},a.globals.legendFormatter=function(d){return o.defaultGeneralFormatter(d)},a.globals.xLabelFormatter=void 0!==a.config.xaxis.labels.formatter?a.config.xaxis.labels.formatter:function(d){if(Xe.isNumber(d)){if(!a.config.xaxis.convertedCatToNumeric&&"numeric"===a.config.xaxis.type){if(Xe.isNumber(a.config.xaxis.decimalsInFloat))return d.toFixed(a.config.xaxis.decimalsInFloat);var g=a.globals.maxX-a.globals.minX;return d.toFixed(g>0&&g<100?1:0)}return d.toFixed(a.globals.isBarHorizontal&&a.globals.maxY-a.globals.minYArr<4?1:0)}return d},a.globals.ttKeyFormatter="function"==typeof a.config.tooltip.x.formatter?a.config.tooltip.x.formatter:a.globals.xLabelFormatter,"function"==typeof a.config.xaxis.tooltip.formatter&&(a.globals.xaxisTooltipFormatter=a.config.xaxis.tooltip.formatter),(Array.isArray(a.config.tooltip.y)||void 0!==a.config.tooltip.y.formatter)&&(a.globals.ttVal=a.config.tooltip.y),void 0!==a.config.tooltip.z.formatter&&(a.globals.ttZFormatter=a.config.tooltip.z.formatter),void 0!==a.config.legend.formatter&&(a.globals.legendFormatter=a.config.legend.formatter),a.config.yaxis.forEach(function(d,g){a.globals.yLabelFormatters[g]=void 0!==d.labels.formatter?d.labels.formatter:function(_){return a.globals.xyCharts?Array.isArray(_)?_.map(function(D){return o.defaultYFormatter(D,d,g)}):o.defaultYFormatter(_,d,g):_}}),a.globals}},{key:"heatmapLabelFormatters",value:function(){var o=this.w;if("heatmap"===o.config.chart.type){o.globals.yAxisScale[0].result=o.globals.seriesNames.slice();var a=o.globals.seriesNames.reduce(function(d,g){return d.length>g.length?d:g},0);o.globals.yAxisScale[0].niceMax=a,o.globals.yAxisScale[0].niceMin=a}}}]),te}(),Us=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"getLabel",value:function(o,a,d,g){var _=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],D=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"12px",C=this.w,T=void 0===o[g]?"":o[g],P=T,L=C.globals.xLabelFormatter,B=C.config.xaxis.labels.formatter,V=!1,$=new ho(this.ctx),q=T;P=$.xLabelFormat(L,T,q,{i:g,dateFormatter:new mn(this.ctx).formatDate,w:C}),void 0!==B&&(P=B(T,o[g],{i:g,dateFormatter:new mn(this.ctx).formatDate,w:C}));var K=function(ge){var R=null;return a.forEach(function(H){"month"===H.unit?R="year":"day"===H.unit?R="month":"hour"===H.unit?R="day":"minute"===H.unit&&(R="hour")}),R===ge};a.length>0?(V=K(a[g].unit),d=a[g].position,P=a[g].value):"datetime"===C.config.xaxis.type&&void 0===B&&(P=""),void 0===P&&(P=""),P=Array.isArray(P)?P:P.toString();var oe=new yt(this.ctx),ae={};ae=C.globals.rotateXLabels?oe.getTextRects(P,parseInt(D,10),null,"rotate(".concat(C.config.xaxis.labels.rotate," 0 0)"),!1):oe.getTextRects(P,parseInt(D,10));var fe=!C.config.xaxis.labels.showDuplicates&&this.ctx.timeScale;return!Array.isArray(P)&&(0===P.indexOf("NaN")||0===P.toLowerCase().indexOf("invalid")||P.toLowerCase().indexOf("infinity")>=0||_.indexOf(P)>=0&&fe)&&(P=""),{x:d,text:P,textRect:ae,isBold:V}}},{key:"checkLabelBasedOnTickamount",value:function(o,a,d){var g=this.w,_=g.config.xaxis.tickAmount;return"dataPoints"===_&&(_=Math.round(g.globals.gridWidth/120)),_>d||o%Math.round(d/(_+1))==0||(a.text=""),a}},{key:"checkForOverflowingLabels",value:function(o,a,d,g,_){var D=this.w;if(0===o&&D.globals.skipFirstTimelinelabel&&(a.text=""),o===d-1&&D.globals.skipLastTimelinelabel&&(a.text=""),D.config.xaxis.labels.hideOverlappingLabels&&g.length>0){var C=_[_.length-1];a.x<C.textRect.width/(D.globals.rotateXLabels?Math.abs(D.config.xaxis.labels.rotate)/12:1.01)+C.x&&(a.text="")}return a}},{key:"checkForReversedLabels",value:function(o,a){var d=this.w;return d.config.yaxis[o]&&d.config.yaxis[o].reversed&&a.reverse(),a}},{key:"isYAxisHidden",value:function(o){var a=this.w,d=new fi(this.ctx);return!a.config.yaxis[o].show||!a.config.yaxis[o].showForNullSeries&&d.isSeriesNull(o)&&-1===a.globals.collapsedSeriesIndices.indexOf(o)}},{key:"getYAxisForeColor",value:function(o,a){var d=this.w;return Array.isArray(o)&&d.globals.yAxisScale[a]&&this.ctx.theme.pushExtraColors(o,d.globals.yAxisScale[a].result.length,!1),o}},{key:"drawYAxisTicks",value:function(o,a,d,g,_,D,C){var T=this.w,P=new yt(this.ctx),L=T.globals.translateY;if(g.show&&a>0){!0===T.config.yaxis[_].opposite&&(o+=g.width);for(var B=a;B>=0;B--){var V=L+a/10+T.config.yaxis[_].labels.offsetY-1;T.globals.isBarHorizontal&&(V=D*B),"heatmap"===T.config.chart.type&&(V+=D/2);var $=P.drawLine(o+d.offsetX-g.width+g.offsetX,V+g.offsetY,o+d.offsetX+g.offsetX,V+g.offsetY,g.color);C.add($),L+=D}}}}]),te}(),Va=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"scaleSvgNode",value:function(o,a){var d=parseFloat(o.getAttributeNS(null,"width")),g=parseFloat(o.getAttributeNS(null,"height"));o.setAttributeNS(null,"width",d*a),o.setAttributeNS(null,"height",g*a),o.setAttributeNS(null,"viewBox","0 0 "+d+" "+g)}},{key:"fixSvgStringForIe11",value:function(o){if(!Xe.isIE11())return o.replace(/&nbsp;/g,"&#160;");var a=0,d=o.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,function(g){return 2==++a?'xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev"':g});return(d=d.replace(/xmlns:NS\d+=""/g,"")).replace(/NS\d+:(\w+:\w+=")/g,"$1")}},{key:"getSvgString",value:function(o){var a=this.w.globals.dom.Paper.svg();if(1!==o){var d=this.w.globals.dom.Paper.node.cloneNode(!0);this.scaleSvgNode(d,o),a=(new XMLSerializer).serializeToString(d)}return this.fixSvgStringForIe11(a)}},{key:"cleanup",value:function(){var o=this.w,a=o.globals.dom.baseEl.getElementsByClassName("apexcharts-xcrosshairs"),d=o.globals.dom.baseEl.getElementsByClassName("apexcharts-ycrosshairs"),g=o.globals.dom.baseEl.querySelectorAll(".apexcharts-zoom-rect, .apexcharts-selection-rect");Array.prototype.forEach.call(g,function(_){_.setAttribute("width",0)}),a&&a[0]&&(a[0].setAttribute("x",-500),a[0].setAttribute("x1",-500),a[0].setAttribute("x2",-500)),d&&d[0]&&(d[0].setAttribute("y",-100),d[0].setAttribute("y1",-100),d[0].setAttribute("y2",-100))}},{key:"svgUrl",value:function(){this.cleanup();var o=this.getSvgString(),a=new Blob([o],{type:"image/svg+xml;charset=utf-8"});return URL.createObjectURL(a)}},{key:"dataURI",value:function(o){var a=this;return new Promise(function(d){var g=a.w,_=o?o.scale||o.width/g.globals.svgWidth:1;a.cleanup();var D=document.createElement("canvas");D.width=g.globals.svgWidth*_,D.height=parseInt(g.globals.dom.elWrap.style.height,10)*_;var C="transparent"===g.config.chart.background?"#fff":g.config.chart.background,T=D.getContext("2d");T.fillStyle=C,T.fillRect(0,0,D.width*_,D.height*_);var P=a.getSvgString(_);if(window.canvg&&Xe.isIE11()){var L=window.canvg.Canvg.fromString(T,P,{ignoreClear:!0,ignoreDimensions:!0});L.start();var B=D.msToBlob();L.stop(),d({blob:B})}else{var V="data:image/svg+xml,"+encodeURIComponent(P),$=new Image;$.crossOrigin="anonymous",$.onload=function(){if(T.drawImage($,0,0),D.msToBlob){var q=D.msToBlob();d({blob:q})}else{var K=D.toDataURL("image/png");d({imgURI:K})}},$.src=V}})}},{key:"exportToSVG",value:function(){this.triggerDownload(this.svgUrl(),this.w.config.chart.toolbar.export.svg.filename,".svg")}},{key:"exportToPng",value:function(){var o=this;this.dataURI().then(function(a){var d=a.imgURI,g=a.blob;g?navigator.msSaveOrOpenBlob(g,o.w.globals.chartID+".png"):o.triggerDownload(d,o.w.config.chart.toolbar.export.png.filename,".png")})}},{key:"exportToCSV",value:function(o){var a=this,d=o.series,g=o.columnDelimiter,_=o.lineDelimiter,D=void 0===_?"\n":_,C=this.w,T=[],P=[],L="",B=new Tn(this.ctx),V=new Us(this.ctx),$=function(q){var K="";if(C.globals.axisCharts){if("category"===C.config.xaxis.type||C.config.xaxis.convertedCatToNumeric)if(C.globals.isBarHorizontal){var oe=C.globals.yLabelFormatters[0],ae=new Bi(a.ctx).getActiveConfigSeriesIndex();K=oe(C.globals.labels[q],{seriesIndex:ae,dataPointIndex:q,w:C})}else K=V.getLabel(C.globals.labels,C.globals.timescaleLabels,0,q).text;"datetime"===C.config.xaxis.type&&(C.config.xaxis.categories.length?K=C.config.xaxis.categories[q]:C.config.labels.length&&(K=C.config.labels[q]))}else K=C.config.labels[q];return Array.isArray(K)&&(K=K.join(" ")),Xe.isNumber(K)?K:K.split(g).join("")};T.push(C.config.chart.toolbar.export.csv.headerCategory),d.map(function(q,K){var oe=q.name?q.name:"series-".concat(K);C.globals.axisCharts&&T.push(oe.split(g).join("")?oe.split(g).join(""):"series-".concat(K))}),C.globals.axisCharts||(T.push(C.config.chart.toolbar.export.csv.headerValue),P.push(T.join(g))),d.map(function(q,K){C.globals.axisCharts?function(oe,ae){if(T.length&&0===ae&&P.push(T.join(g)),oe.data&&oe.data.length)for(var fe=0;fe<oe.data.length;fe++){T=[];var ge=$(fe);if(ge||(B.isFormatXY()?ge=d[ae].data[fe].x:B.isFormat2DArray()&&(ge=d[ae].data[fe]?d[ae].data[fe][0]:"")),0===ae){T.push("datetime"===C.config.xaxis.type&&String(ge).length>=10?C.config.chart.toolbar.export.csv.dateFormatter(ge):Xe.isNumber(ge)?ge:ge.split(g).join(""));for(var R=0;R<C.globals.series.length;R++)T.push(C.globals.series[R][fe])}("candlestick"===C.config.chart.type||oe.type&&"candlestick"===oe.type)&&(T.pop(),T.push(C.globals.seriesCandleO[ae][fe]),T.push(C.globals.seriesCandleH[ae][fe]),T.push(C.globals.seriesCandleL[ae][fe]),T.push(C.globals.seriesCandleC[ae][fe])),("boxPlot"===C.config.chart.type||oe.type&&"boxPlot"===oe.type)&&(T.pop(),T.push(C.globals.seriesCandleO[ae][fe]),T.push(C.globals.seriesCandleH[ae][fe]),T.push(C.globals.seriesCandleM[ae][fe]),T.push(C.globals.seriesCandleL[ae][fe]),T.push(C.globals.seriesCandleC[ae][fe])),"rangeBar"===C.config.chart.type&&(T.pop(),T.push(C.globals.seriesRangeStart[ae][fe]),T.push(C.globals.seriesRangeEnd[ae][fe])),T.length&&P.push(T.join(g))}}(q,K):((T=[]).push(C.globals.labels[K].split(g).join("")),T.push(C.globals.series[K]),P.push(T.join(g)))}),L+=P.join(D),this.triggerDownload("data:text/csv; charset=utf-8,"+encodeURIComponent("\ufeff"+L),C.config.chart.toolbar.export.csv.filename,".csv")}},{key:"triggerDownload",value:function(o,a,d){var g=document.createElement("a");g.href=o,g.download=(a||this.w.globals.chartID)+d,document.body.appendChild(g),g.click(),document.body.removeChild(g)}}]),te}(),po=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w;var a=this.w;this.axesUtils=new Us(o),this.xaxisLabels=a.globals.labels.slice(),a.globals.timescaleLabels.length>0&&!a.globals.isBarHorizontal&&(this.xaxisLabels=a.globals.timescaleLabels.slice()),a.config.xaxis.overwriteCategories&&(this.xaxisLabels=a.config.xaxis.overwriteCategories),this.drawnLabels=[],this.drawnLabelsRects=[],this.offY="top"===a.config.xaxis.position?0:a.globals.gridHeight+1,this.offY=this.offY+a.config.xaxis.axisBorder.offsetY,this.isCategoryBarHorizontal="bar"===a.config.chart.type&&a.config.plotOptions.bar.horizontal,this.xaxisFontSize=a.config.xaxis.labels.style.fontSize,this.xaxisFontFamily=a.config.xaxis.labels.style.fontFamily,this.xaxisForeColors=a.config.xaxis.labels.style.colors,this.xaxisBorderWidth=a.config.xaxis.axisBorder.width,this.isCategoryBarHorizontal&&(this.xaxisBorderWidth=a.config.yaxis[0].axisBorder.width.toString()),this.xaxisBorderWidth=this.xaxisBorderWidth.indexOf("%")>-1?a.globals.gridWidth*parseInt(this.xaxisBorderWidth,10)/100:parseInt(this.xaxisBorderWidth,10),this.xaxisBorderHeight=a.config.xaxis.axisBorder.height,this.yaxis=a.config.yaxis[0]}return St(te,[{key:"drawXaxis",value:function(){var o,a=this,d=this.w,g=new yt(this.ctx),_=g.group({class:"apexcharts-xaxis",transform:"translate(".concat(d.config.xaxis.offsetX,", ").concat(d.config.xaxis.offsetY,")")}),D=g.group({class:"apexcharts-xaxis-texts-g",transform:"translate(".concat(d.globals.translateXAxisX,", ").concat(d.globals.translateXAxisY,")")});_.add(D);for(var C=d.globals.padHorizontal,T=[],P=0;P<this.xaxisLabels.length;P++)T.push(this.xaxisLabels[P]);var L=T.length;C=d.globals.isXNumeric?C+(o=d.globals.gridWidth/(L>1?L-1:L))/2+d.config.xaxis.labels.offsetX:C+(o=d.globals.gridWidth/T.length)+d.config.xaxis.labels.offsetX;for(var V=function(fe){var ge=C-o/2+d.config.xaxis.labels.offsetX;0===fe&&1===L&&o/2===C&&1===d.globals.dataPoints&&(ge=d.globals.gridWidth/2);var R=a.axesUtils.getLabel(T,d.globals.timescaleLabels,ge,fe,a.drawnLabels,a.xaxisFontSize),H=28;if(d.globals.rotateXLabels&&(H=22),(R=void 0!==d.config.xaxis.tickAmount&&"dataPoints"!==d.config.xaxis.tickAmount&&"datetime"!==d.config.xaxis.type?a.axesUtils.checkLabelBasedOnTickamount(fe,R,L):a.axesUtils.checkForOverflowingLabels(fe,R,L,a.drawnLabels,a.drawnLabelsRects)).text&&d.globals.xaxisLabelsCount++,d.config.xaxis.labels.show){var Q=g.drawText({x:R.x,y:a.offY+d.config.xaxis.labels.offsetY+H-("top"===d.config.xaxis.position?d.globals.xAxisHeight+d.config.xaxis.axisTicks.height-2:0),text:R.text,textAnchor:"middle",fontWeight:R.isBold?600:d.config.xaxis.labels.style.fontWeight,fontSize:a.xaxisFontSize,fontFamily:a.xaxisFontFamily,foreColor:Array.isArray(a.xaxisForeColors)?d.config.xaxis.convertedCatToNumeric?a.xaxisForeColors[d.globals.minX+fe-1]:a.xaxisForeColors[fe]:a.xaxisForeColors,isPlainText:!1,cssClass:"apexcharts-xaxis-label "+d.config.xaxis.labels.style.cssClass});D.add(Q);var le=document.createElementNS(d.globals.SVGNS,"title");le.textContent=Array.isArray(R.text)?R.text.join(" "):R.text,Q.node.appendChild(le),""!==R.text&&(a.drawnLabels.push(R.text),a.drawnLabelsRects.push(R))}C+=o},$=0;$<=L-1;$++)V($);if(void 0!==d.config.xaxis.title.text){var q=g.group({class:"apexcharts-xaxis-title"}),K=g.drawText({x:d.globals.gridWidth/2+d.config.xaxis.title.offsetX,y:this.offY+parseFloat(this.xaxisFontSize)+d.globals.xAxisLabelsHeight+d.config.xaxis.title.offsetY,text:d.config.xaxis.title.text,textAnchor:"middle",fontSize:d.config.xaxis.title.style.fontSize,fontFamily:d.config.xaxis.title.style.fontFamily,fontWeight:d.config.xaxis.title.style.fontWeight,foreColor:d.config.xaxis.title.style.color,cssClass:"apexcharts-xaxis-title-text "+d.config.xaxis.title.style.cssClass});q.add(K),_.add(q)}if(d.config.xaxis.axisBorder.show){var oe=d.globals.barPadForNumericAxis,ae=g.drawLine(d.globals.padHorizontal+d.config.xaxis.axisBorder.offsetX-oe,this.offY,this.xaxisBorderWidth+oe,this.offY,d.config.xaxis.axisBorder.color,0,this.xaxisBorderHeight);_.add(ae)}return _}},{key:"drawXaxisInversed",value:function(o){var a,d,g=this,_=this.w,D=new yt(this.ctx),C=_.config.yaxis[0].opposite?_.globals.translateYAxisX[o]:0,T=D.group({class:"apexcharts-yaxis apexcharts-xaxis-inversed",rel:o}),P=D.group({class:"apexcharts-yaxis-texts-g apexcharts-xaxis-inversed-texts-g",transform:"translate("+C+", 0)"});T.add(P);var L=[];if(_.config.yaxis[o].show)for(var B=0;B<this.xaxisLabels.length;B++)L.push(this.xaxisLabels[B]);d=-(a=_.globals.gridHeight/L.length)/2.2;var V=_.globals.yLabelFormatters[0],$=_.config.yaxis[0].labels;if($.show)for(var q=function(H){var Q=void 0===L[H]?"":L[H];Q=V(Q,{seriesIndex:o,dataPointIndex:H,w:_});var le=g.axesUtils.getYAxisForeColor($.style.colors,o),Re=0;Array.isArray(Q)&&(Re=Q.length/2*parseInt($.style.fontSize,10));var tt=D.drawText({x:$.offsetX-15,y:d+a+$.offsetY-Re,text:Q,textAnchor:g.yaxis.opposite?"start":"end",foreColor:Array.isArray(le)?le[H]:le,fontSize:$.style.fontSize,fontFamily:$.style.fontFamily,fontWeight:$.style.fontWeight,isPlainText:!1,cssClass:"apexcharts-yaxis-label "+$.style.cssClass});P.add(tt);var Ve=document.createElementNS(_.globals.SVGNS,"title");if(Ve.textContent=Array.isArray(Q)?Q.join(" "):Q,tt.node.appendChild(Ve),0!==_.config.yaxis[o].labels.rotate){var Dt=D.rotateAroundCenter(tt.node);tt.node.setAttribute("transform","rotate(".concat(_.config.yaxis[o].labels.rotate," 0 ").concat(Dt.y,")"))}d+=a},K=0;K<=L.length-1;K++)q(K);if(void 0!==_.config.yaxis[0].title.text){var oe=D.group({class:"apexcharts-yaxis-title apexcharts-xaxis-title-inversed",transform:"translate("+C+", 0)"}),ae=D.drawText({x:0,y:_.globals.gridHeight/2,text:_.config.yaxis[0].title.text,textAnchor:"middle",foreColor:_.config.yaxis[0].title.style.color,fontSize:_.config.yaxis[0].title.style.fontSize,fontWeight:_.config.yaxis[0].title.style.fontWeight,fontFamily:_.config.yaxis[0].title.style.fontFamily,cssClass:"apexcharts-yaxis-title-text "+_.config.yaxis[0].title.style.cssClass});oe.add(ae),T.add(oe)}var fe=0;this.isCategoryBarHorizontal&&_.config.yaxis[0].opposite&&(fe=_.globals.gridWidth);var ge=_.config.xaxis.axisBorder;if(ge.show){var R=D.drawLine(_.globals.padHorizontal+ge.offsetX+fe,1+ge.offsetY,_.globals.padHorizontal+ge.offsetX+fe,_.globals.gridHeight+ge.offsetY,ge.color,0);T.add(R)}return _.config.yaxis[0].axisTicks.show&&this.axesUtils.drawYAxisTicks(fe,L.length,_.config.yaxis[0].axisBorder,_.config.yaxis[0].axisTicks,0,a,T),T}},{key:"drawXaxisTicks",value:function(o,a){var d=this.w,g=o;if(!(o<0||o-2>d.globals.gridWidth)){var _=this.offY+d.config.xaxis.axisTicks.offsetY,D=_+d.config.xaxis.axisTicks.height;if("top"===d.config.xaxis.position&&(D=_-d.config.xaxis.axisTicks.height),d.config.xaxis.axisTicks.show){var C=new yt(this.ctx).drawLine(o+d.config.xaxis.axisTicks.offsetX,_+d.config.xaxis.offsetY,g+d.config.xaxis.axisTicks.offsetX,D+d.config.xaxis.offsetY,d.config.xaxis.axisTicks.color);a.add(C),C.node.classList.add("apexcharts-xaxis-tick")}}}},{key:"getXAxisTicksPositions",value:function(){var o=this.w,a=[],d=this.xaxisLabels.length,g=o.globals.padHorizontal;if(o.globals.timescaleLabels.length>0)for(var _=0;_<d;_++)a.push(g=this.xaxisLabels[_].position);else for(var D=d,C=0;C<D;C++){var T=D;o.globals.isXNumeric&&"bar"!==o.config.chart.type&&(T-=1),a.push(g+=o.globals.gridWidth/T)}return a}},{key:"xAxisLabelCorrections",value:function(){var o=this.w,a=new yt(this.ctx),d=o.globals.dom.baseEl.querySelector(".apexcharts-xaxis-texts-g"),g=o.globals.dom.baseEl.querySelectorAll(".apexcharts-xaxis-texts-g text"),_=o.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis-inversed text"),D=o.globals.dom.baseEl.querySelectorAll(".apexcharts-xaxis-inversed-texts-g text tspan");if(o.globals.rotateXLabels||o.config.xaxis.labels.rotateAlways)for(var C=0;C<g.length;C++){var T=a.rotateAroundCenter(g[C]);T.y=T.y-1,T.x=T.x+1,g[C].setAttribute("transform","rotate(".concat(o.config.xaxis.labels.rotate," ").concat(T.x," ").concat(T.y,")")),g[C].setAttribute("text-anchor","end"),d.setAttribute("transform","translate(0, ".concat(-10,")")),o.config.xaxis.labels.trim&&Array.prototype.forEach.call(g[C].childNodes,function($){a.placeTextWithEllipsis($,$.textContent,o.globals.xAxisLabelsHeight-("bottom"===o.config.legend.position?20:10))})}else!function(){for(var $=o.globals.gridWidth/(o.globals.labels.length+1),q=0;q<g.length;q++)o.config.xaxis.labels.trim&&"datetime"!==o.config.xaxis.type&&Array.prototype.forEach.call(g[q].childNodes,function(oe){a.placeTextWithEllipsis(oe,oe.textContent,$)})}();if(_.length>0){var L=_[_.length-1].getBBox(),B=_[0].getBBox();L.x<-20&&_[_.length-1].parentNode.removeChild(_[_.length-1]),B.x+B.width>o.globals.gridWidth&&!o.globals.isBarHorizontal&&_[0].parentNode.removeChild(_[0]);for(var V=0;V<D.length;V++)a.placeTextWithEllipsis(D[V],D[V].textContent,o.config.yaxis[0].labels.maxWidth-2*parseFloat(o.config.yaxis[0].title.style.fontSize)-20)}}}]),te}(),cs=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w;var a=this.w;this.xaxisLabels=a.globals.labels.slice(),this.axesUtils=new Us(o),this.isRangeBar=a.globals.seriesRangeBar.length,a.globals.timescaleLabels.length>0&&(this.xaxisLabels=a.globals.timescaleLabels.slice())}return St(te,[{key:"drawGridArea",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.w,d=new yt(this.ctx);null===o&&(o=d.group({class:"apexcharts-grid"}));var g=d.drawLine(a.globals.padHorizontal,1,a.globals.padHorizontal,a.globals.gridHeight,"transparent"),_=d.drawLine(a.globals.padHorizontal,a.globals.gridHeight,a.globals.gridWidth,a.globals.gridHeight,"transparent");return o.add(_),o.add(g),o}},{key:"drawGrid",value:function(){var o=null;return this.w.globals.axisCharts&&(o=this.renderGrid(),this.drawGridArea(o.el)),o}},{key:"createGridMask",value:function(){var o=this.w,a=o.globals,d=new yt(this.ctx),g=Array.isArray(o.config.stroke.width)?0:o.config.stroke.width;if(Array.isArray(o.config.stroke.width)){var _=0;o.config.stroke.width.forEach(function(B){_=Math.max(_,B)}),g=_}a.dom.elGridRectMask=document.createElementNS(a.SVGNS,"clipPath"),a.dom.elGridRectMask.setAttribute("id","gridRectMask".concat(a.cuid)),a.dom.elGridRectMarkerMask=document.createElementNS(a.SVGNS,"clipPath"),a.dom.elGridRectMarkerMask.setAttribute("id","gridRectMarkerMask".concat(a.cuid)),a.dom.elForecastMask=document.createElementNS(a.SVGNS,"clipPath"),a.dom.elForecastMask.setAttribute("id","forecastMask".concat(a.cuid)),a.dom.elNonForecastMask=document.createElementNS(a.SVGNS,"clipPath"),a.dom.elNonForecastMask.setAttribute("id","nonForecastMask".concat(a.cuid));var D=o.config.chart.type,C=0,T=0;("bar"===D||"rangeBar"===D||"candlestick"===D||"boxPlot"===D||o.globals.comboBarCount>0)&&o.globals.isXNumeric&&!o.globals.isBarHorizontal&&(T=o.config.grid.padding.right,a.barPadForNumericAxis>(C=o.config.grid.padding.left)&&(C=a.barPadForNumericAxis,T=a.barPadForNumericAxis)),a.dom.elGridRect=d.drawRect(-g/2-C-2,-g/2,a.gridWidth+g+T+C+4,a.gridHeight+g,0,"#fff"),new fi(this).getLargestMarkerSize();var P=o.globals.markers.largestSize+1;a.dom.elGridRectMarker=d.drawRect(2*-P,2*-P,a.gridWidth+4*P,a.gridHeight+4*P,0,"#fff"),a.dom.elGridRectMask.appendChild(a.dom.elGridRect.node),a.dom.elGridRectMarkerMask.appendChild(a.dom.elGridRectMarker.node);var L=a.dom.baseEl.querySelector("defs");L.appendChild(a.dom.elGridRectMask),L.appendChild(a.dom.elForecastMask),L.appendChild(a.dom.elNonForecastMask),L.appendChild(a.dom.elGridRectMarkerMask)}},{key:"_drawGridLines",value:function(o){var a=o.i,d=o.x1,P=this.w;0===a&&P.globals.skipFirstTimelinelabel||a===o.xCount-1&&P.globals.skipLastTimelinelabel&&!P.config.xaxis.labels.formatter||"radar"===P.config.chart.type||(P.config.grid.xaxis.lines.show&&this._drawGridLine({x1:d,y1:o.y1,x2:o.x2,y2:o.y2,parent:o.parent}),new po(this.ctx).drawXaxisTicks(d,this.elg))}},{key:"_drawGridLine",value:function(o){var a=o.x1,d=o.y1,g=o.x2,_=o.y2,D=o.parent,C=this.w,T=D.node.classList.contains("apexcharts-gridlines-horizontal"),P=C.config.grid.strokeDashArray,L=C.globals.barPadForNumericAxis,B=new yt(this).drawLine(a-(T?L:0),d,g+(T?L:0),_,C.config.grid.borderColor,P);B.node.classList.add("apexcharts-gridline"),D.add(B)}},{key:"_drawGridBandRect",value:function(o){var a=o.c,d=o.x1,g=o.y1,_=o.x2,D=o.y2,C=o.type,T=this.w,P=new yt(this.ctx),L=T.globals.barPadForNumericAxis;if("column"!==C||"datetime"!==T.config.xaxis.type){var V=P.drawRect(d-("row"===C?L:0),g,_+("row"===C?2*L:0),D,0,T.config.grid[C].colors[a],T.config.grid[C].opacity);this.elg.add(V),V.attr("clip-path","url(#gridRectMask".concat(T.globals.cuid,")")),V.node.classList.add("apexcharts-grid-".concat(C))}}},{key:"_drawXYLines",value:function(o){var a=this,d=o.xCount,g=o.tickAmount,_=this.w;if(_.config.grid.xaxis.lines.show||_.config.xaxis.axisTicks.show){var D,C=_.globals.padHorizontal,T=_.globals.gridHeight;_.globals.timescaleLabels.length?function(q){for(var K=q.xC,ae=q.y1,ge=q.y2,R=0;R<K;R++)a._drawGridLines({i:R,x1:a.xaxisLabels[R].position,y1:ae,x2:a.xaxisLabels[R].position,y2:ge,xCount:d,parent:a.elgridLinesV})}({xC:d,x1:C,y1:0,x2:D,y2:T}):(_.globals.isXNumeric&&(d=_.globals.xAxisScale.result.length),_.config.xaxis.convertedCatToNumeric&&(d=_.globals.xaxisLabelsCount),function(q){var K=q.xC,oe=q.x1,ae=q.y1,fe=q.x2,ge=q.y2;if(void 0!==_.config.xaxis.tickAmount&&"dataPoints"!==_.config.xaxis.tickAmount)_.globals.dom.baseEl.querySelectorAll(".apexcharts-text.apexcharts-xaxis-label tspan:not(:empty)").forEach(function(H,Q){var le=H.getBBox();a._drawGridLines({i:Q,x1:le.x+le.width/2,y1:ae,x2:le.x+le.width/2,y2:ge,xCount:d,parent:a.elgridLinesV})});else for(var R=0;R<K+(_.globals.isXNumeric?0:1);R++)0===R&&1===K&&1===_.globals.dataPoints&&(fe=oe=_.globals.gridWidth/2),a._drawGridLines({i:R,x1:oe,y1:ae,x2:fe,y2:ge,xCount:d,parent:a.elgridLinesV}),fe=oe+=_.globals.gridWidth/(_.globals.isXNumeric?K-1:K)}({xC:d,x1:C,y1:0,x2:D,y2:T}))}if(_.config.grid.yaxis.lines.show){var P=0,L=0,B=_.globals.gridWidth,V=g+1;this.isRangeBar&&(V=_.globals.labels.length);for(var $=0;$<V+(this.isRangeBar?1:0);$++)this._drawGridLine({x1:0,y1:P,x2:B,y2:L,parent:this.elgridLinesH}),L=P+=_.globals.gridHeight/(this.isRangeBar?V:g)}}},{key:"_drawInvertedXYLines",value:function(o){var a=o.xCount,d=this.w;if(d.config.grid.xaxis.lines.show||d.config.xaxis.axisTicks.show)for(var g,_=d.globals.padHorizontal,D=d.globals.gridHeight,C=0;C<a+1;C++)d.config.grid.xaxis.lines.show&&this._drawGridLine({x1:_,y1:0,x2:g,y2:D,parent:this.elgridLinesV}),new po(this.ctx).drawXaxisTicks(_,this.elg),g=_=_+d.globals.gridWidth/a+.3;if(d.config.grid.yaxis.lines.show)for(var T=0,P=0,L=d.globals.gridWidth,B=0;B<d.globals.dataPoints+1;B++)this._drawGridLine({x1:0,y1:T,x2:L,y2:P,parent:this.elgridLinesH}),P=T+=d.globals.gridHeight/d.globals.dataPoints}},{key:"renderGrid",value:function(){var o=this.w,a=new yt(this.ctx);this.elg=a.group({class:"apexcharts-grid"}),this.elgridLinesH=a.group({class:"apexcharts-gridlines-horizontal"}),this.elgridLinesV=a.group({class:"apexcharts-gridlines-vertical"}),this.elg.add(this.elgridLinesH),this.elg.add(this.elgridLinesV),o.config.grid.show||(this.elgridLinesV.hide(),this.elgridLinesH.hide());for(var d,g=o.globals.yAxisScale.length?o.globals.yAxisScale[0].result.length-1:5,_=0;_<o.globals.series.length&&(void 0!==o.globals.yAxisScale[_]&&(g=o.globals.yAxisScale[_].result.length-1),!(g>2));_++);return!o.globals.isBarHorizontal||this.isRangeBar?(d=this.xaxisLabels.length,this.isRangeBar&&(g=o.globals.labels.length,o.config.xaxis.tickAmount&&o.config.xaxis.labels.formatter&&(d=o.config.xaxis.tickAmount)),this._drawXYLines({xCount:d,tickAmount:g})):this._drawInvertedXYLines({xCount:d=g,tickAmount:g=o.globals.xTickAmount}),this.drawGridBands(d,g),{el:this.elg,xAxisTickWidth:o.globals.gridWidth/d}}},{key:"drawGridBands",value:function(o,a){var d=this.w;if(void 0!==d.config.grid.row.colors&&d.config.grid.row.colors.length>0)for(var g=0,_=d.globals.gridHeight/a,D=d.globals.gridWidth,C=0,T=0;C<a;C++,T++)T>=d.config.grid.row.colors.length&&(T=0),this._drawGridBandRect({c:T,x1:0,y1:g,x2:D,y2:_,type:"row"}),g+=d.globals.gridHeight/a;if(void 0!==d.config.grid.column.colors&&d.config.grid.column.colors.length>0)for(var P=d.globals.isBarHorizontal||"category"!==d.config.xaxis.type&&!d.config.xaxis.convertedCatToNumeric?o:o-1,L=d.globals.padHorizontal,B=d.globals.padHorizontal+d.globals.gridWidth/P,V=d.globals.gridHeight,$=0,q=0;$<o;$++,q++)q>=d.config.grid.column.colors.length&&(q=0),this._drawGridBandRect({c:q,x1:L,y1:0,x2:B,y2:V,type:"column"}),L+=d.globals.gridWidth/P}}]),te}(),Hs=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"niceScale",value:function(o,a){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,_=arguments.length>4?arguments[4]:void 0,D=this.w,C=Math.abs(a-o);if("dataPoints"===(d=this._adjustTicksForSmallRange(d,g,C))&&(d=D.globals.dataPoints-1),o===Number.MIN_VALUE&&0===a||!Xe.isNumber(o)&&!Xe.isNumber(a)||o===Number.MIN_VALUE&&a===-Number.MAX_VALUE){var T=this.linearScale(o=0,a=d,d);return T}o>a?(console.warn("axis.min cannot be greater than axis.max"),a=o+.1):o===a&&(o=0===o?0:o-.5,a=0===a?2:a+.5);var P=[];C<1&&_&&("candlestick"===D.config.chart.type||"candlestick"===D.config.series[g].type||"boxPlot"===D.config.chart.type||"boxPlot"===D.config.series[g].type||D.globals.isRangeData)&&(a*=1.01);var L=d+1;L<2?L=2:L>2&&(L-=2);var B=C/L,V=Math.floor(Xe.log10(B)),$=Math.pow(10,V),q=Math.round(B/$);q<1&&(q=1);var K=q*$,oe=K*Math.floor(o/K),ae=K*Math.ceil(a/K),fe=oe;if(_&&C>2){for(;P.push(fe),!((fe+=K)>ae););return{result:P,niceMin:P[0],niceMax:P[P.length-1]}}var ge=o;(P=[]).push(ge);for(var R=Math.abs(a-o)/d,H=0;H<=d;H++)P.push(ge+=R);return P[P.length-2]>=a&&P.pop(),{result:P,niceMin:P[0],niceMax:P[P.length-1]}}},{key:"linearScale",value:function(o,a){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,g=arguments.length>3?arguments[3]:void 0,_=Math.abs(a-o);"dataPoints"===(d=this._adjustTicksForSmallRange(d,g,_))&&(d=this.w.globals.dataPoints-1);var D=_/d;d===Number.MAX_VALUE&&(d=10,D=1);for(var C=[],T=o;d>=0;)C.push(T),T+=D,d-=1;return{result:C,niceMin:C[0],niceMax:C[C.length-1]}}},{key:"logarithmicScale",value:function(o,a){for(var d=[],g=Math.ceil(Math.log(o)/Math.log(a))+1,_=0;_<g;_++)d.push(Math.pow(a,_));return{result:d,niceMin:d[0],niceMax:d[d.length-1]}}},{key:"_adjustTicksForSmallRange",value:function(o,a,d){var g=o;if(void 0!==a&&this.w.config.yaxis[a].labels.formatter&&void 0===this.w.config.yaxis[a].tickAmount){var _=this.w.config.yaxis[a].labels.formatter(1);Xe.isNumber(Number(_))&&!Xe.isFloat(_)&&(g=Math.ceil(d))}return g<o?g:o}},{key:"setYScaleForIndex",value:function(o,a,d){var g=this.w.globals,_=this.w.config,D=g.isBarHorizontal?_.xaxis:_.yaxis[o];void 0===g.yAxisScale[o]&&(g.yAxisScale[o]=[]);var C=Math.abs(d-a);D.logarithmic&&C<=5&&(g.invalidLogScale=!0),D.logarithmic&&C>5?(g.allSeriesCollapsed=!1,g.yAxisScale[o]=this.logarithmicScale(d,D.logBase)):d!==-Number.MAX_VALUE&&Xe.isNumber(d)?(g.allSeriesCollapsed=!1,g.yAxisScale[o]=void 0===D.min&&void 0===D.max||D.forceNiceScale?this.niceScale(a,d,D.tickAmount?D.tickAmount:C<5&&C>1?C+1:5,o,void 0===_.yaxis[o].max&&void 0===_.yaxis[o].min||_.yaxis[o].forceNiceScale):this.linearScale(a,d,D.tickAmount,o)):g.yAxisScale[o]=this.linearScale(0,5,5)}},{key:"setXScale",value:function(o,a){var d=this.w,g=d.globals,_=d.config.xaxis,D=Math.abs(a-o);return g.xAxisScale=a!==-Number.MAX_VALUE&&Xe.isNumber(a)?this.linearScale(o,a,_.tickAmount?_.tickAmount:D<5&&D>1?D+1:5,0):this.linearScale(0,5,5),g.xAxisScale}},{key:"setMultipleYScales",value:function(){var o=this,a=this.w.globals,d=this.w.config,g=a.minYArr.concat([]),_=a.maxYArr.concat([]),D=[];d.yaxis.forEach(function(C,T){var P=T;d.series.forEach(function(V,$){V.name===C.seriesName&&(P=$,D.push(T!==$?{index:$,similarIndex:T,alreadyExists:!0}:{index:$}))}),o.setYScaleForIndex(T,g[P],_[P])}),this.sameScaleInMultipleAxes(g,_,D)}},{key:"sameScaleInMultipleAxes",value:function(o,a,d){var g=this,_=this.w.config,D=this.w.globals,C=[];d.forEach(function(K){K.alreadyExists&&(void 0===C[K.index]&&(C[K.index]=[]),C[K.index].push(K.index),C[K.index].push(K.similarIndex))}),D.yAxisSameScaleIndices=C,C.forEach(function(K,oe){C.forEach(function(ae,fe){var ge,R;oe!==fe&&(ge=K,R=ae,ge.filter(function(H){return-1!==R.indexOf(H)})).length>0&&(C[oe]=C[oe].concat(C[fe]))})});var T=C.map(function(K){return K.filter(function(oe,ae){return K.indexOf(oe)===ae})}).map(function(K){return K.sort()});C=C.filter(function(K){return!!K});var P=T.slice(),L=P.map(function(K){return JSON.stringify(K)});P=P.filter(function(K,oe){return L.indexOf(JSON.stringify(K))===oe});var B=[],V=[];o.forEach(function(K,oe){P.forEach(function(ae,fe){ae.indexOf(oe)>-1&&(void 0===B[fe]&&(B[fe]=[],V[fe]=[]),B[fe].push({key:oe,value:K}),V[fe].push({key:oe,value:a[oe]}))})});var $=Array.apply(null,Array(P.length)).map(Number.prototype.valueOf,Number.MIN_VALUE),q=Array.apply(null,Array(P.length)).map(Number.prototype.valueOf,-Number.MAX_VALUE);B.forEach(function(K,oe){K.forEach(function(ae,fe){$[oe]=Math.min(ae.value,$[oe])})}),V.forEach(function(K,oe){K.forEach(function(ae,fe){q[oe]=Math.max(ae.value,q[oe])})}),o.forEach(function(K,oe){V.forEach(function(ae,fe){var ge=$[fe],R=q[fe];_.chart.stacked&&(R=0,ae.forEach(function(H,Q){H.value!==-Number.MAX_VALUE&&(R+=H.value),ge!==Number.MIN_VALUE&&(ge+=B[fe][Q].value)})),ae.forEach(function(H,Q){ae[Q].key===oe&&(void 0!==_.yaxis[oe].min&&(ge="function"==typeof _.yaxis[oe].min?_.yaxis[oe].min(D.minY):_.yaxis[oe].min),void 0!==_.yaxis[oe].max&&(R="function"==typeof _.yaxis[oe].max?_.yaxis[oe].max(D.maxY):_.yaxis[oe].max),g.setYScaleForIndex(oe,ge,R))})})})}},{key:"autoScaleY",value:function(o,a,d){o||(o=this);var g=o.w;if(g.globals.isMultipleYAxis||g.globals.collapsedSeries.length)return console.warn("autoScaleYaxis is not supported in a multi-yaxis chart."),a;var _=g.globals.seriesX[0],D=g.config.chart.stacked;return a.forEach(function(C,T){for(var P=0,L=0;L<_.length;L++)if(_[L]>=d.xaxis.min){P=L;break}var B,V,$=g.globals.minYArr[T],q=g.globals.maxYArr[T],K=g.globals.stackedSeriesTotals;g.globals.series.forEach(function(oe,ae){var fe=oe[P];D?(B=V=fe=K[P],K.forEach(function(ge,R){_[R]<=d.xaxis.max&&_[R]>=d.xaxis.min&&(ge>V&&null!==ge&&(V=ge),oe[R]<B&&null!==oe[R]&&(B=oe[R]))})):(B=V=fe,oe.forEach(function(ge,R){if(_[R]<=d.xaxis.max&&_[R]>=d.xaxis.min){var H=ge,Q=ge;g.globals.series.forEach(function(le,Re){null!==ge&&(H=Math.min(le[R],H),Q=Math.max(le[R],Q))}),Q>V&&null!==Q&&(V=Q),H<B&&null!==H&&(B=H)}})),void 0===B&&void 0===V&&(B=$,V=q),(V*=V<0?.9:1.1)<0&&V<q&&(V=q),(B*=B<0?1.1:.9)<0&&B>$&&(B=$),a.length>1?(a[ae].min=void 0===C.min?B:C.min,a[ae].max=void 0===C.max?V:C.max):(a[0].min=void 0===C.min?B:C.min,a[0].max=void 0===C.max?V:C.max)})}),a}}]),te}(),xn=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.scales=new Hs(o)}return St(te,[{key:"init",value:function(){this.setYRange(),this.setXRange(),this.setZRange()}},{key:"getMinYMaxY",value:function(o){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-Number.MAX_VALUE,g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,_=this.w.config,D=this.w.globals,C=-Number.MAX_VALUE,T=Number.MIN_VALUE;null===g&&(g=o+1);var P=D.series,L=P,B=P;"candlestick"===_.chart.type?(L=D.seriesCandleL,B=D.seriesCandleH):"boxPlot"===_.chart.type?(L=D.seriesCandleO,B=D.seriesCandleC):D.isRangeData&&(L=D.seriesRangeStart,B=D.seriesRangeEnd);for(var V=o;V<g;V++){D.dataPoints=Math.max(D.dataPoints,P[V].length);for(var $=0;$<D.series[V].length;$++){var q=P[V][$];null!==q&&Xe.isNumber(q)?(void 0!==B[V][$]&&(C=Math.max(C,B[V][$]),a=Math.min(a,B[V][$])),void 0!==L[V][$]&&(a=Math.min(a,L[V][$]),d=Math.max(d,L[V][$])),"candlestick"!==this.w.config.chart.type&&"boxPlot"!==this.w.config.chart.type||(void 0!==D.seriesCandleC[V][$]&&(C=Math.max(C,D.seriesCandleO[V][$]),C=Math.max(C,D.seriesCandleH[V][$]),C=Math.max(C,D.seriesCandleL[V][$]),C=Math.max(C,D.seriesCandleC[V][$]),"boxPlot"===this.w.config.chart.type&&(C=Math.max(C,D.seriesCandleM[V][$]))),!_.series[V].type||"candlestick"===_.series[V].type&&"boxPlot"===_.series[V].type||(C=Math.max(C,D.series[V][$]),a=Math.min(a,D.series[V][$])),d=C),D.seriesGoals[V]&&D.seriesGoals[V][$]&&Array.isArray(D.seriesGoals[V][$])&&D.seriesGoals[V][$].forEach(function(K){T!==Number.MIN_VALUE&&(T=Math.min(T,K.value),a=T),C=Math.max(C,K.value),d=C}),Xe.isFloat(q)&&(q=Xe.noExponents(q),D.yValueDecimal=Math.max(D.yValueDecimal,q.toString().split(".")[1].length)),T>L[V][$]&&L[V][$]<0&&(T=L[V][$])):D.hasNullValues=!0}}return"rangeBar"===_.chart.type&&D.seriesRangeStart.length&&D.isBarHorizontal&&(T=a),"bar"===_.chart.type&&(T<0&&C<0&&(C=0),T===Number.MIN_VALUE&&(T=0)),{minY:T,maxY:C,lowestY:a,highestY:d}}},{key:"setYRange",value:function(){var o=this.w.globals,a=this.w.config;o.maxY=-Number.MAX_VALUE,o.minY=Number.MIN_VALUE;var d=Number.MAX_VALUE;if(o.isMultipleYAxis)for(var g=0;g<o.series.length;g++){var _=this.getMinYMaxY(g,d,null,g+1);o.minYArr.push(_.minY),o.maxYArr.push(_.maxY),d=_.lowestY}var D=this.getMinYMaxY(0,d,null,o.series.length);if(o.minY=D.minY,o.maxY=D.maxY,d=D.lowestY,a.chart.stacked&&this._setStackedMinMax(),("line"===a.chart.type||"area"===a.chart.type||"candlestick"===a.chart.type||"boxPlot"===a.chart.type||"rangeBar"===a.chart.type&&!o.isBarHorizontal)&&o.minY===Number.MIN_VALUE&&d!==-Number.MAX_VALUE&&d!==o.maxY){var C=o.maxY-d;(d>=0&&d<=10||void 0!==a.yaxis[0].min||void 0!==a.yaxis[0].max)&&(C=0),o.minY=d-5*C/100,d>0&&o.minY<0&&(o.minY=0),o.maxY=o.maxY+5*C/100}return a.yaxis.forEach(function(T,P){void 0!==T.max&&("number"==typeof T.max?o.maxYArr[P]=T.max:"function"==typeof T.max&&(o.maxYArr[P]=T.max(o.isMultipleYAxis?o.maxYArr[P]:o.maxY)),o.maxY=o.maxYArr[P]),void 0!==T.min&&("number"==typeof T.min?o.minYArr[P]=T.min:"function"==typeof T.min&&(o.minYArr[P]=T.min(o.isMultipleYAxis?o.minYArr[P]===Number.MIN_VALUE?0:o.minYArr[P]:o.minY)),o.minY=o.minYArr[P])}),o.isBarHorizontal&&["min","max"].forEach(function(T){void 0!==a.xaxis[T]&&"number"==typeof a.xaxis[T]&&("min"===T?o.minY=a.xaxis[T]:o.maxY=a.xaxis[T])}),o.isMultipleYAxis?(this.scales.setMultipleYScales(),o.minY=d,o.yAxisScale.forEach(function(T,P){o.minYArr[P]=T.niceMin,o.maxYArr[P]=T.niceMax})):(this.scales.setYScaleForIndex(0,o.minY,o.maxY),o.minY=o.yAxisScale[0].niceMin,o.maxY=o.yAxisScale[0].niceMax,o.minYArr[0]=o.yAxisScale[0].niceMin,o.maxYArr[0]=o.yAxisScale[0].niceMax),{minY:o.minY,maxY:o.maxY,minYArr:o.minYArr,maxYArr:o.maxYArr,yAxisScale:o.yAxisScale}}},{key:"setXRange",value:function(){var o=this.w.globals,a=this.w.config,d="numeric"===a.xaxis.type||"datetime"===a.xaxis.type||"category"===a.xaxis.type&&!o.noLabelsProvided||o.noLabelsProvided||o.isXNumeric;if(o.isXNumeric&&function(){for(var C=0;C<o.series.length;C++)if(o.labels[C])for(var T=0;T<o.labels[C].length;T++)null!==o.labels[C][T]&&Xe.isNumber(o.labels[C][T])&&(o.maxX=Math.max(o.maxX,o.labels[C][T]),o.initialMaxX=Math.max(o.maxX,o.labels[C][T]),o.minX=Math.min(o.minX,o.labels[C][T]),o.initialMinX=Math.min(o.minX,o.labels[C][T]))}(),o.noLabelsProvided&&0===a.xaxis.categories.length&&(o.maxX=o.labels[o.labels.length-1],o.initialMaxX=o.labels[o.labels.length-1],o.minX=1,o.initialMinX=1),o.isXNumeric||o.noLabelsProvided||o.dataFormatXNumeric){var g;if(void 0===a.xaxis.tickAmount?(g=Math.round(o.svgWidth/150),"numeric"===a.xaxis.type&&o.dataPoints<30&&(g=o.dataPoints-1),g>o.dataPoints&&0!==o.dataPoints&&(g=o.dataPoints-1)):"dataPoints"===a.xaxis.tickAmount?(o.series.length>1&&(g=o.series[o.maxValsInArrayIndex].length-1),o.isXNumeric&&(g=o.maxX-o.minX-1)):g=a.xaxis.tickAmount,o.xTickAmount=g,void 0!==a.xaxis.max&&"number"==typeof a.xaxis.max&&(o.maxX=a.xaxis.max),void 0!==a.xaxis.min&&"number"==typeof a.xaxis.min&&(o.minX=a.xaxis.min),void 0!==a.xaxis.range&&(o.minX=o.maxX-a.xaxis.range),o.minX!==Number.MAX_VALUE&&o.maxX!==-Number.MAX_VALUE)if(a.xaxis.convertedCatToNumeric&&!o.dataFormatXNumeric){for(var _=[],D=o.minX-1;D<o.maxX;D++)_.push(D+1);o.xAxisScale={result:_,niceMin:_[0],niceMax:_[_.length-1]}}else o.xAxisScale=this.scales.setXScale(o.minX,o.maxX);else o.xAxisScale=this.scales.linearScale(1,g,g),o.noLabelsProvided&&o.labels.length>0&&(o.xAxisScale=this.scales.linearScale(1,o.labels.length,g-1),o.seriesX=o.labels.slice());d&&(o.labels=o.xAxisScale.result.slice())}return o.isBarHorizontal&&o.labels.length&&(o.xTickAmount=o.labels.length),this._handleSingleDataPoint(),this._getMinXDiff(),{minX:o.minX,maxX:o.maxX}}},{key:"setZRange",value:function(){var o=this.w.globals;if(o.isDataXYZ)for(var a=0;a<o.series.length;a++)if(void 0!==o.seriesZ[a])for(var d=0;d<o.seriesZ[a].length;d++)null!==o.seriesZ[a][d]&&Xe.isNumber(o.seriesZ[a][d])&&(o.maxZ=Math.max(o.maxZ,o.seriesZ[a][d]),o.minZ=Math.min(o.minZ,o.seriesZ[a][d]))}},{key:"_handleSingleDataPoint",value:function(){var o=this.w.globals,a=this.w.config;if(o.minX===o.maxX){var d=new mn(this.ctx);if("datetime"===a.xaxis.type){var g=d.getDate(o.minX);g.setUTCDate(g.getDate()-2),o.minX=new Date(g).getTime();var _=d.getDate(o.maxX);_.setUTCDate(_.getDate()+2),o.maxX=new Date(_).getTime()}else("numeric"===a.xaxis.type||"category"===a.xaxis.type&&!o.noLabelsProvided)&&(o.minX=o.minX-2,o.initialMinX=o.minX,o.maxX=o.maxX+2,o.initialMaxX=o.maxX)}}},{key:"_getMinXDiff",value:function(){var o=this.w.globals;o.isXNumeric&&o.seriesX.forEach(function(a,d){1===a.length&&a.push(o.seriesX[o.maxValsInArrayIndex][o.seriesX[o.maxValsInArrayIndex].length-1]);var g=a.slice();g.sort(function(_,D){return _-D}),g.forEach(function(_,D){if(D>0){var C=_-g[D-1];C>0&&(o.minXDiff=Math.min(C,o.minXDiff))}}),1===o.dataPoints&&o.minXDiff===Number.MAX_VALUE&&(o.minXDiff=.5)})}},{key:"_setStackedMinMax",value:function(){var o=this.w.globals,a=[],d=[];if(o.series.length)for(var g=0;g<o.series[o.maxValsInArrayIndex].length;g++)for(var _=0,D=0,C=0;C<o.series.length;C++)null!==o.series[C][g]&&Xe.isNumber(o.series[C][g])&&(o.series[C][g]>0?_=_+parseFloat(o.series[C][g])+1e-4:D+=parseFloat(o.series[C][g])),C===o.series.length-1&&(a.push(_),d.push(D));for(var T=0;T<a.length;T++)o.maxY=Math.max(o.maxY,a[T]),o.minY=Math.min(o.minY,d[T])}}]),te}(),fo=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w;var a=this.w;this.xaxisFontSize=a.config.xaxis.labels.style.fontSize,this.axisFontFamily=a.config.xaxis.labels.style.fontFamily,this.xaxisForeColors=a.config.xaxis.labels.style.colors,this.isCategoryBarHorizontal="bar"===a.config.chart.type&&a.config.plotOptions.bar.horizontal,this.xAxisoffX=0,"bottom"===a.config.xaxis.position&&(this.xAxisoffX=a.globals.gridHeight),this.drawnLabels=[],this.axesUtils=new Us(o)}return St(te,[{key:"drawYaxis",value:function(o){var a=this,d=this.w,g=new yt(this.ctx),_=d.config.yaxis[o].labels.style,D=_.fontSize,C=_.fontFamily,T=_.fontWeight,P=g.group({class:"apexcharts-yaxis",rel:o,transform:"translate("+d.globals.translateYAxisX[o]+", 0)"});if(this.axesUtils.isYAxisHidden(o))return P;var L=g.group({class:"apexcharts-yaxis-texts-g"});P.add(L);var B=d.globals.yAxisScale[o].result.length-1,V=d.globals.gridHeight/B,$=d.globals.translateY,q=d.globals.yLabelFormatters[o],K=d.globals.yAxisScale[o].result.slice();K=this.axesUtils.checkForReversedLabels(o,K);var oe="";if(d.config.yaxis[o].labels.show)for(var ae=function(tt){var Ve=K[tt];Ve=q(Ve,tt,d);var Dt=d.config.yaxis[o].labels.padding;d.config.yaxis[o].opposite&&0!==d.config.yaxis.length&&(Dt*=-1);var pt=a.axesUtils.getYAxisForeColor(_.colors,o),qe=g.drawText({x:Dt,y:$+B/10+d.config.yaxis[o].labels.offsetY+1,text:Ve,textAnchor:d.config.yaxis[o].opposite?"start":"end",fontSize:D,fontFamily:C,fontWeight:T,foreColor:Array.isArray(pt)?pt[tt]:pt,isPlainText:!1,cssClass:"apexcharts-yaxis-label "+_.cssClass});tt===B&&(oe=qe),L.add(qe);var Vt=document.createElementNS(d.globals.SVGNS,"title");if(Vt.textContent=Array.isArray(Ve)?Ve.join(" "):Ve,qe.node.appendChild(Vt),0!==d.config.yaxis[o].labels.rotate){var Yn=g.rotateAroundCenter(oe.node),pn=g.rotateAroundCenter(qe.node);qe.node.setAttribute("transform","rotate(".concat(d.config.yaxis[o].labels.rotate," ").concat(Yn.x," ").concat(pn.y,")"))}$+=V},fe=B;fe>=0;fe--)ae(fe);if(void 0!==d.config.yaxis[o].title.text){var ge=g.group({class:"apexcharts-yaxis-title"}),R=0;d.config.yaxis[o].opposite&&(R=d.globals.translateYAxisX[o]);var H=g.drawText({x:R,y:d.globals.gridHeight/2+d.globals.translateY+d.config.yaxis[o].title.offsetY,text:d.config.yaxis[o].title.text,textAnchor:"end",foreColor:d.config.yaxis[o].title.style.color,fontSize:d.config.yaxis[o].title.style.fontSize,fontWeight:d.config.yaxis[o].title.style.fontWeight,fontFamily:d.config.yaxis[o].title.style.fontFamily,cssClass:"apexcharts-yaxis-title-text "+d.config.yaxis[o].title.style.cssClass});ge.add(H),P.add(ge)}var Q=d.config.yaxis[o].axisBorder,le=31+Q.offsetX;if(d.config.yaxis[o].opposite&&(le=-31-Q.offsetX),Q.show){var Re=g.drawLine(le,d.globals.translateY+Q.offsetY-2,le,d.globals.gridHeight+d.globals.translateY+Q.offsetY+2,Q.color,0,Q.width);P.add(Re)}return d.config.yaxis[o].axisTicks.show&&this.axesUtils.drawYAxisTicks(le,B,Q,d.config.yaxis[o].axisTicks,o,V,P),P}},{key:"drawYaxisInversed",value:function(o){var a=this.w,d=new yt(this.ctx),g=d.group({class:"apexcharts-xaxis apexcharts-yaxis-inversed"}),_=d.group({class:"apexcharts-xaxis-texts-g",transform:"translate(".concat(a.globals.translateXAxisX,", ").concat(a.globals.translateXAxisY,")")});g.add(_);var D=a.globals.yAxisScale[o].result.length-1,C=a.globals.gridWidth/D+.1,T=C+a.config.xaxis.labels.offsetX,P=a.globals.xLabelFormatter,L=a.globals.yAxisScale[o].result.slice(),B=a.globals.timescaleLabels;B.length>0&&(this.xaxisLabels=B.slice(),D=(L=B.slice()).length),L=this.axesUtils.checkForReversedLabels(o,L);var V=B.length;if(a.config.xaxis.labels.show)for(var $=V?0:D;V?$<V:$>=0;V?$++:$--){var q=L[$];q=P(q,$,a);var K=a.globals.gridWidth+a.globals.padHorizontal-(T-C+a.config.xaxis.labels.offsetX);if(B.length){var oe=this.axesUtils.getLabel(L,B,K,$,this.drawnLabels,this.xaxisFontSize);K=oe.x,q=oe.text,this.drawnLabels.push(oe.text),0===$&&a.globals.skipFirstTimelinelabel&&(q=""),$===L.length-1&&a.globals.skipLastTimelinelabel&&(q="")}var ae=d.drawText({x:K,y:this.xAxisoffX+a.config.xaxis.labels.offsetY+30-("top"===a.config.xaxis.position?a.globals.xAxisHeight+a.config.xaxis.axisTicks.height-2:0),text:q,textAnchor:"middle",foreColor:Array.isArray(this.xaxisForeColors)?this.xaxisForeColors[o]:this.xaxisForeColors,fontSize:this.xaxisFontSize,fontFamily:this.xaxisFontFamily,fontWeight:a.config.xaxis.labels.style.fontWeight,isPlainText:!1,cssClass:"apexcharts-xaxis-label "+a.config.xaxis.labels.style.cssClass});_.add(ae),ae.tspan(q);var fe=document.createElementNS(a.globals.SVGNS,"title");fe.textContent=q,ae.node.appendChild(fe),T+=C}return this.inversedYAxisTitleText(g),this.inversedYAxisBorder(g),g}},{key:"inversedYAxisBorder",value:function(o){var a=this.w,d=new yt(this.ctx),g=a.config.xaxis.axisBorder;if(g.show){var _=0;"bar"===a.config.chart.type&&a.globals.isXNumeric&&(_-=15);var D=d.drawLine(a.globals.padHorizontal+_+g.offsetX,this.xAxisoffX,a.globals.gridWidth,this.xAxisoffX,g.color,0,g.height);o.add(D)}}},{key:"inversedYAxisTitleText",value:function(o){var a=this.w,d=new yt(this.ctx);if(void 0!==a.config.xaxis.title.text){var g=d.group({class:"apexcharts-xaxis-title apexcharts-yaxis-title-inversed"}),_=d.drawText({x:a.globals.gridWidth/2+a.config.xaxis.title.offsetX,y:this.xAxisoffX+parseFloat(this.xaxisFontSize)+parseFloat(a.config.xaxis.title.style.fontSize)+a.config.xaxis.title.offsetY+20,text:a.config.xaxis.title.text,textAnchor:"middle",fontSize:a.config.xaxis.title.style.fontSize,fontFamily:a.config.xaxis.title.style.fontFamily,fontWeight:a.config.xaxis.title.style.fontWeight,foreColor:a.config.xaxis.title.style.color,cssClass:"apexcharts-xaxis-title-text "+a.config.xaxis.title.style.cssClass});g.add(_),o.add(g)}}},{key:"yAxisTitleRotate",value:function(o,a){var d=this.w,g=new yt(this.ctx),_={width:0,height:0},D={width:0,height:0},C=d.globals.dom.baseEl.querySelector(" .apexcharts-yaxis[rel='".concat(o,"'] .apexcharts-yaxis-texts-g"));null!==C&&(_=C.getBoundingClientRect());var T=d.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(o,"'] .apexcharts-yaxis-title text"));if(null!==T&&(D=T.getBoundingClientRect()),null!==T){var P=this.xPaddingForYAxisTitle(o,_,D,a);T.setAttribute("x",P.xPos-(a?10:0))}if(null!==T){var L=g.rotateAroundCenter(T);T.setAttribute("transform","rotate(".concat(a?-1*d.config.yaxis[o].title.rotate:d.config.yaxis[o].title.rotate," ").concat(L.x," ").concat(L.y,")"))}}},{key:"xPaddingForYAxisTitle",value:function(o,a,d,g){var _=this.w,D=0,C=0,T=10;return void 0===_.config.yaxis[o].title.text||o<0?{xPos:C,padd:0}:(g?(C=a.width+_.config.yaxis[o].title.offsetX+d.width/2+T/2,0===(D+=1)&&(C-=T/2)):(C=-1*a.width+_.config.yaxis[o].title.offsetX+T/2+d.width/2,_.globals.isBarHorizontal&&(C=-1*a.width-_.config.yaxis[o].title.offsetX-(T=25))),{xPos:C,padd:T})}},{key:"setYAxisXPosition",value:function(o,a){var d=this.w,g=0,_=0,D=18,C=1;d.config.yaxis.length>1&&(this.multipleYs=!0),d.config.yaxis.map(function(T,P){var L=d.globals.ignoreYAxisIndexes.indexOf(P)>-1||!T.show||T.floating||0===o[P].width,B=o[P].width+a[P].width;T.opposite?d.globals.isBarHorizontal?d.globals.translateYAxisX[P]=(_=d.globals.gridWidth+d.globals.translateX-1)-T.labels.offsetX:(_=d.globals.gridWidth+d.globals.translateX+C,L||(C=C+B+20),d.globals.translateYAxisX[P]=_-T.labels.offsetX+20):(g=d.globals.translateX-D,L||(D=D+B+20),d.globals.translateYAxisX[P]=g+T.labels.offsetX)})}},{key:"setYAxisTextAlignments",value:function(){var o=this.w,a=o.globals.dom.baseEl.getElementsByClassName("apexcharts-yaxis");(a=Xe.listToArray(a)).forEach(function(d,g){var _=o.config.yaxis[g];if(_&&void 0!==_.labels.align){var D=o.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(g,"'] .apexcharts-yaxis-texts-g")),C=o.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis[rel='".concat(g,"'] .apexcharts-yaxis-label"));C=Xe.listToArray(C);var T=D.getBoundingClientRect();"left"===_.labels.align?(C.forEach(function(P,L){P.setAttribute("text-anchor","start")}),_.opposite||D.setAttribute("transform","translate(-".concat(T.width,", 0)"))):"center"===_.labels.align?(C.forEach(function(P,L){P.setAttribute("text-anchor","middle")}),D.setAttribute("transform","translate(".concat(T.width/2*(_.opposite?1:-1),", 0)"))):"right"===_.labels.align&&(C.forEach(function(P,L){P.setAttribute("text-anchor","end")}),_.opposite&&D.setAttribute("transform","translate(".concat(T.width,", 0)")))}})}}]),te}(),xa=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.documentEvent=Xe.bind(this.documentEvent,this)}return St(te,[{key:"addEventListener",value:function(o,a){var d=this.w;d.globals.events.hasOwnProperty(o)?d.globals.events[o].push(a):d.globals.events[o]=[a]}},{key:"removeEventListener",value:function(o,a){var d=this.w;if(d.globals.events.hasOwnProperty(o)){var g=d.globals.events[o].indexOf(a);-1!==g&&d.globals.events[o].splice(g,1)}}},{key:"fireEvent",value:function(o,a){var d=this.w;if(d.globals.events.hasOwnProperty(o)){a&&a.length||(a=[]);for(var g=d.globals.events[o],_=g.length,D=0;D<_;D++)g[D].apply(null,a)}}},{key:"setupEventHandlers",value:function(){var o=this,a=this.w,d=this.ctx,g=a.globals.dom.baseEl.querySelector(a.globals.chartClass);this.ctx.eventList.forEach(function(_){g.addEventListener(_,function(D){var C=Object.assign({},a,{seriesIndex:a.globals.capturedSeriesIndex,dataPointIndex:a.globals.capturedDataPointIndex});"mousemove"===D.type||"touchmove"===D.type?"function"==typeof a.config.chart.events.mouseMove&&a.config.chart.events.mouseMove(D,d,C):"mouseleave"===D.type||"touchleave"===D.type?"function"==typeof a.config.chart.events.mouseLeave&&a.config.chart.events.mouseLeave(D,d,C):("mouseup"===D.type&&1===D.which||"touchend"===D.type)&&("function"==typeof a.config.chart.events.click&&a.config.chart.events.click(D,d,C),d.ctx.events.fireEvent("click",[D,d,C]))},{capture:!1,passive:!0})}),this.ctx.eventList.forEach(function(_){a.globals.dom.baseEl.addEventListener(_,o.documentEvent,{passive:!0})}),this.ctx.core.setupBrushHandler()}},{key:"documentEvent",value:function(o){var a=this.w,d=o.target.className;if("click"===o.type){var g=a.globals.dom.baseEl.querySelector(".apexcharts-menu");g&&g.classList.contains("apexcharts-menu-open")&&"apexcharts-menu-icon"!==d&&g.classList.remove("apexcharts-menu-open")}a.globals.clientX="touchmove"===o.type?o.touches[0].clientX:o.clientX,a.globals.clientY="touchmove"===o.type?o.touches[0].clientY:o.clientY}}]),te}(),js=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"setCurrentLocaleValues",value:function(o){var a=this.w.config.chart.locales;window.Apex.chart&&window.Apex.chart.locales&&window.Apex.chart.locales.length>0&&(a=this.w.config.chart.locales.concat(window.Apex.chart.locales));var d=a.filter(function(_){return _.name===o})[0];if(!d)throw new Error("Wrong locale name provided. Please make sure you set the correct locale name in options");var g=Xe.extend(cc,d);this.w.globals.locale=g.options}}]),te}(),hl=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"drawAxis",value:function(o,a){var d,g,_=this.w.globals,D=this.w.config,C=new po(this.ctx),T=new fo(this.ctx);_.axisCharts&&"radar"!==o&&(_.isBarHorizontal?(g=T.drawYaxisInversed(0),d=C.drawXaxisInversed(0),_.dom.elGraphical.add(d),_.dom.elGraphical.add(g)):(d=C.drawXaxis(),_.dom.elGraphical.add(d),D.yaxis.map(function(P,L){-1===_.ignoreYAxisIndexes.indexOf(L)&&(g=T.drawYaxis(L),_.dom.Paper.add(g))})))}}]),te}(),Fo=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"drawXCrosshairs",value:function(){var o=this.w,a=new yt(this.ctx),d=new pi(this.ctx),g=o.config.xaxis.crosshairs.fill.gradient,_=o.config.xaxis.crosshairs.dropShadow,V=_.enabled,$=_.left,q=_.top,K=_.blur,oe=_.color,ae=_.opacity,fe=o.config.xaxis.crosshairs.fill.color;if(o.config.xaxis.crosshairs.show){"gradient"===o.config.xaxis.crosshairs.fill.type&&(fe=a.drawGradient("vertical",g.colorFrom,g.colorTo,g.opacityFrom,g.opacityTo,null,g.stops,null));var ge=a.drawRect();1===o.config.xaxis.crosshairs.width&&(ge=a.drawLine());var R=o.globals.gridHeight;(!Xe.isNumber(R)||R<0)&&(R=0);var H=o.config.xaxis.crosshairs.width;(!Xe.isNumber(H)||H<0)&&(H=0),ge.attr({class:"apexcharts-xcrosshairs",x:0,y:0,y2:R,width:H,height:R,fill:fe,filter:"none","fill-opacity":o.config.xaxis.crosshairs.opacity,stroke:o.config.xaxis.crosshairs.stroke.color,"stroke-width":o.config.xaxis.crosshairs.stroke.width,"stroke-dasharray":o.config.xaxis.crosshairs.stroke.dashArray}),V&&(ge=d.dropShadow(ge,{left:$,top:q,blur:K,color:oe,opacity:ae})),o.globals.dom.elGraphical.add(ge)}}},{key:"drawYCrosshairs",value:function(){var o=this.w,a=new yt(this.ctx),d=o.config.yaxis[0].crosshairs,g=o.globals.barPadForNumericAxis;if(o.config.yaxis[0].crosshairs.show){var _=a.drawLine(-g,0,o.globals.gridWidth+g,0,d.stroke.color,d.stroke.dashArray,d.stroke.width);_.attr({class:"apexcharts-ycrosshairs"}),o.globals.dom.elGraphical.add(_)}var D=a.drawLine(-g,0,o.globals.gridWidth+g,0,d.stroke.color,0,0);D.attr({class:"apexcharts-ycrosshairs-hidden"}),o.globals.dom.elGraphical.add(D)}}]),te}(),dl=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"checkResponsiveConfig",value:function(o){var a=this,d=this.w,g=d.config;if(0!==g.responsive.length){var _=g.responsive.slice();_.sort(function(P,L){return P.breakpoint>L.breakpoint?1:L.breakpoint>P.breakpoint?-1:0}).reverse();var D=new vn({}),C=function(){var P=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},L=_[0].breakpoint,B=window.innerWidth>0?window.innerWidth:screen.width;if(B>L){var V=fi.extendArrayProps(D,d.globals.initialConfig,d);P=Xe.extend(V,P),P=Xe.extend(d.config,P),a.overrideResponsiveOptions(P)}else for(var $=0;$<_.length;$++)B<_[$].breakpoint&&(P=fi.extendArrayProps(D,_[$].options,d),P=Xe.extend(d.config,P),a.overrideResponsiveOptions(P))};if(o){var T=fi.extendArrayProps(D,o,d);T=Xe.extend(d.config,T),C(T=Xe.extend(T,o))}else C({})}}},{key:"overrideResponsiveOptions",value:function(o){var a=new vn(o).init({responsiveOverride:!0});this.w.config=a}}]),te}(),pl=function(){function te(o){zt(this,te),this.ctx=o,this.colors=[],this.w=o.w;var a=this.w;this.isColorFn=!1,this.isHeatmapDistributed="treemap"===a.config.chart.type&&a.config.plotOptions.treemap.distributed||"heatmap"===a.config.chart.type&&a.config.plotOptions.heatmap.distributed,this.isBarDistributed=a.config.plotOptions.bar.distributed&&("bar"===a.config.chart.type||"rangeBar"===a.config.chart.type)}return St(te,[{key:"init",value:function(){this.setDefaultColors()}},{key:"setDefaultColors",value:function(){var o=this,a=this.w,d=new Xe;if(a.globals.dom.elWrap.classList.add("apexcharts-theme-".concat(a.config.theme.mode)),void 0===a.config.colors?a.globals.colors=this.predefined():(a.globals.colors=a.config.colors,Array.isArray(a.config.colors)&&a.config.colors.length>0&&"function"==typeof a.config.colors[0]&&(a.globals.colors=a.config.series.map(function($,q){var K=a.config.colors[q];return K||(K=a.config.colors[0]),"function"==typeof K?(o.isColorFn=!0,K({value:a.globals.axisCharts?a.globals.series[q][0]?a.globals.series[q][0]:0:a.globals.series[q],seriesIndex:q,dataPointIndex:q,w:a})):K}))),a.globals.seriesColors.map(function($,q){$&&(a.globals.colors[q]=$)}),a.config.theme.monochrome.enabled){var g=[],_=a.globals.series.length;(this.isBarDistributed||this.isHeatmapDistributed)&&(_=a.globals.series[0].length*a.globals.series.length);for(var D=a.config.theme.monochrome.color,C=1/(_/a.config.theme.monochrome.shadeIntensity),T=a.config.theme.monochrome.shadeTo,P=0,L=0;L<_;L++){var B=void 0;"dark"===T?(B=d.shadeColor(-1*P,D),P+=C):(B=d.shadeColor(P,D),P+=C),g.push(B)}a.globals.colors=g.slice()}var V=a.globals.colors.slice();this.pushExtraColors(a.globals.colors),["fill","stroke"].forEach(function($){a.globals[$].colors=void 0===a.config[$].colors?o.isColorFn?a.config.colors:V:a.config[$].colors.slice(),o.pushExtraColors(a.globals[$].colors)}),a.globals.dataLabels.style.colors=void 0===a.config.dataLabels.style.colors?V:a.config.dataLabels.style.colors.slice(),this.pushExtraColors(a.globals.dataLabels.style.colors,50),a.globals.radarPolygons.fill.colors=void 0===a.config.plotOptions.radar.polygons.fill.colors?["dark"===a.config.theme.mode?"#424242":"none"]:a.config.plotOptions.radar.polygons.fill.colors.slice(),this.pushExtraColors(a.globals.radarPolygons.fill.colors,20),a.globals.markers.colors=void 0===a.config.markers.colors?V:a.config.markers.colors.slice(),this.pushExtraColors(a.globals.markers.colors)}},{key:"pushExtraColors",value:function(o,a){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,g=this.w,_=a||g.globals.series.length;if(null===d&&(d=this.isBarDistributed||this.isHeatmapDistributed||"heatmap"===g.config.chart.type&&g.config.plotOptions.heatmap.colorScale.inverse),d&&g.globals.series.length&&(_=g.globals.series[g.globals.maxValsInArrayIndex].length*g.globals.series.length),o.length<_)for(var D=_-o.length,C=0;C<D;C++)o.push(o[C])}},{key:"updateThemeOptions",value:function(o){o.chart=o.chart||{},o.tooltip=o.tooltip||{};var a=o.theme.mode||"light",d=o.theme.palette?o.theme.palette:"dark"===a?"palette4":"palette1",g=o.chart.foreColor?o.chart.foreColor:"dark"===a?"#f6f7f8":"#373d3f";return o.tooltip.theme=a,o.chart.foreColor=g,o.theme.palette=d,o}},{key:"predefined",value:function(){switch(this.w.config.theme.palette){default:this.colors=["#008FFB","#00E396","#FEB019","#FF4560","#775DD0"];break;case"palette2":this.colors=["#3f51b5","#03a9f4","#4caf50","#f9ce1d","#FF9800"];break;case"palette3":this.colors=["#33b2df","#546E7A","#d4526e","#13d8aa","#A5978B"];break;case"palette4":this.colors=["#4ecdc4","#c7f464","#81D4FA","#fd6a6a","#546E7A"];break;case"palette5":this.colors=["#2b908f","#f9a3a4","#90ee7e","#fa4443","#69d2e7"];break;case"palette6":this.colors=["#449DD1","#F86624","#EA3546","#662E9B","#C5D86D"];break;case"palette7":this.colors=["#D7263D","#1B998B","#2E294E","#F46036","#E2C044"];break;case"palette8":this.colors=["#662E9B","#F86624","#F9C80E","#EA3546","#43BCCD"];break;case"palette9":this.colors=["#5C4742","#A5978B","#8D5B4C","#5A2A27","#C4BBAF"];break;case"palette10":this.colors=["#A300D6","#7D02EB","#5653FE","#2983FF","#00B1F2"]}return this.colors}}]),te}(),Es=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"draw",value:function(){this.drawTitleSubtitle("title"),this.drawTitleSubtitle("subtitle")}},{key:"drawTitleSubtitle",value:function(o){var a=this.w,d="title"===o?a.config.title:a.config.subtitle,g=a.globals.svgWidth/2,_=d.offsetY,D="middle";if("left"===d.align?(g=10,D="start"):"right"===d.align&&(g=a.globals.svgWidth-10,D="end"),g+=d.offsetX,_=_+parseInt(d.style.fontSize,10)+d.margin/2,void 0!==d.text){var C=new yt(this.ctx).drawText({x:g,y:_,text:d.text,textAnchor:D,fontSize:d.style.fontSize,fontFamily:d.style.fontFamily,fontWeight:d.style.fontWeight,foreColor:d.style.color,opacity:1});C.node.setAttribute("class","apexcharts-".concat(o,"-text")),a.globals.dom.Paper.add(C)}}}]),te}(),As=function(){function te(o){zt(this,te),this.w=o.w,this.dCtx=o}return St(te,[{key:"getTitleSubtitleCoords",value:function(o){var a=this.w,d=0,g=0,_="title"===o?a.config.title.floating:a.config.subtitle.floating,D=a.globals.dom.baseEl.querySelector(".apexcharts-".concat(o,"-text"));if(null!==D&&!_){var C=D.getBoundingClientRect();d=C.width,g=a.globals.axisCharts?C.height+5:C.height}return{width:d,height:g}}},{key:"getLegendsRect",value:function(){var o=this.w,a=o.globals.dom.baseEl.querySelector(".apexcharts-legend");o.config.legend.height||"top"!==o.config.legend.position&&"bottom"!==o.config.legend.position||(a.style.maxHeight=o.globals.svgHeight/2+"px");var d=Object.assign({},Xe.getBoundingClientRect(a));return this.dCtx.lgRect=null!==a&&!o.config.legend.floating&&o.config.legend.show?{x:d.x,y:d.y,height:d.height,width:0===d.height?0:d.width}:{x:0,y:0,height:0,width:0},"left"!==o.config.legend.position&&"right"!==o.config.legend.position||1.5*this.dCtx.lgRect.width>o.globals.svgWidth&&(this.dCtx.lgRect.width=o.globals.svgWidth/1.5),this.dCtx.lgRect}},{key:"getLargestStringFromMultiArr",value:function(o,a){var d=o;if(this.w.globals.isMultiLineX){var g=a.map(function(D,C){return Array.isArray(D)?D.length:1}),_=Math.max.apply(Math,wn(g));d=a[g.indexOf(_)]}return d}}]),te}(),ba=function(){function te(o){zt(this,te),this.w=o.w,this.dCtx=o}return St(te,[{key:"getxAxisLabelsCoords",value:function(){var o,a=this.w,d=a.globals.labels.slice();if(a.config.xaxis.convertedCatToNumeric&&0===d.length&&(d=a.globals.categoryLabels),a.globals.timescaleLabels.length>0){var g=this.getxAxisTimeScaleLabelsCoords();o={width:g.width,height:g.height},a.globals.rotateXLabels=!1}else{this.dCtx.lgWidthForSideLegends="left"!==a.config.legend.position&&"right"!==a.config.legend.position||a.config.legend.floating?0:this.dCtx.lgRect.width;var _=a.globals.xLabelFormatter,D=Xe.getLargestStringFromArr(d),C=this.dCtx.dimHelpers.getLargestStringFromMultiArr(D,d);a.globals.isBarHorizontal&&(C=D=a.globals.yAxisScale[0].result.reduce(function(q,K){return q.length>K.length?q:K},0));var T=new ho(this.dCtx.ctx),P=D;D=T.xLabelFormat(_,D,P,{i:void 0,dateFormatter:new mn(this.dCtx.ctx).formatDate,w:a}),C=T.xLabelFormat(_,C,P,{i:void 0,dateFormatter:new mn(this.dCtx.ctx).formatDate,w:a}),(a.config.xaxis.convertedCatToNumeric&&void 0===D||""===String(D).trim())&&(C=D="1");var L=new yt(this.dCtx.ctx),B=L.getTextRects(D,a.config.xaxis.labels.style.fontSize),V=B;if(D!==C&&(V=L.getTextRects(C,a.config.xaxis.labels.style.fontSize)),(o={width:B.width>=V.width?B.width:V.width,height:B.height>=V.height?B.height:V.height}).width*d.length>a.globals.svgWidth-this.dCtx.lgWidthForSideLegends-this.dCtx.yAxisWidth-this.dCtx.gridPad.left-this.dCtx.gridPad.right&&0!==a.config.xaxis.labels.rotate||a.config.xaxis.labels.rotateAlways){if(!a.globals.isBarHorizontal){a.globals.rotateXLabels=!0;var $=function(q){return L.getTextRects(q,a.config.xaxis.labels.style.fontSize,a.config.xaxis.labels.style.fontFamily,"rotate(".concat(a.config.xaxis.labels.rotate," 0 0)"),!1)};B=$(D),D!==C&&(V=$(C)),o.height=(B.height>V.height?B.height:V.height)/1.5,o.width=B.width>V.width?B.width:V.width}}else a.globals.rotateXLabels=!1}return a.config.xaxis.labels.show||(o={width:0,height:0}),{width:o.width,height:o.height}}},{key:"getxAxisTitleCoords",value:function(){var o=this.w,a=0,d=0;if(void 0!==o.config.xaxis.title.text){var g=new yt(this.dCtx.ctx).getTextRects(o.config.xaxis.title.text,o.config.xaxis.title.style.fontSize);a=g.width,d=g.height}return{width:a,height:d}}},{key:"getxAxisTimeScaleLabelsCoords",value:function(){var o,a=this.w;this.dCtx.timescaleLabels=a.globals.timescaleLabels.slice();var d=this.dCtx.timescaleLabels.map(function(_){return _.value}),g=d.reduce(function(_,D){return void 0===_?(console.error("You have possibly supplied invalid Date format. Please supply a valid JavaScript Date"),0):_.length>D.length?_:D},0);return 1.05*(o=new yt(this.dCtx.ctx).getTextRects(g,a.config.xaxis.labels.style.fontSize)).width*d.length>a.globals.gridWidth&&0!==a.config.xaxis.labels.rotate&&(a.globals.overlappingXLabels=!0),o}},{key:"additionalPaddingXLabels",value:function(o){var a=this,d=this.w,g=d.globals,_=d.config,D=_.xaxis.type,C=o.width;g.skipLastTimelinelabel=!1,g.skipFirstTimelinelabel=!1;var T=d.config.yaxis[0].opposite&&d.globals.isBarHorizontal;_.yaxis.forEach(function(L,B){T?(a.dCtx.gridPad.left<C&&(a.dCtx.xPadLeft=C/2+1),a.dCtx.xPadRight=C/2+1):function(L,B){-1!==g.collapsedSeriesIndices.indexOf(B)||function(V){if(a.dCtx.timescaleLabels&&a.dCtx.timescaleLabels.length){var K=a.dCtx.timescaleLabels[0].position-C/1.75+a.dCtx.yAxisWidthLeft;a.dCtx.timescaleLabels[a.dCtx.timescaleLabels.length-1].position+C/1.75-a.dCtx.yAxisWidthRight>g.svgWidth-g.translateX-("right"===d.config.legend.position&&a.dCtx.lgRect.width>0?a.dCtx.lgRect.width:0)&&(g.skipLastTimelinelabel=!0),K<-(V.show&&!V.floating||"bar"!==_.chart.type&&"candlestick"!==_.chart.type&&"rangeBar"!==_.chart.type&&"boxPlot"!==_.chart.type?10:C/1.75)&&(g.skipFirstTimelinelabel=!0)}else"datetime"===D?a.dCtx.gridPad.right<C&&!g.rotateXLabels&&(g.skipLastTimelinelabel=!0):"datetime"!==D&&a.dCtx.gridPad.right<C/2-a.dCtx.yAxisWidthRight&&!g.rotateXLabels&&!d.config.xaxis.labels.trim&&("between"!==d.config.xaxis.tickPlacement||d.globals.isBarHorizontal)&&(a.dCtx.xPadRight=C/2+1)}(L)}(L,B)})}}]),te}(),uc=function(){function te(o){zt(this,te),this.w=o.w,this.dCtx=o}return St(te,[{key:"getyAxisLabelsCoords",value:function(){var o=this,a=this.w,d=[],g=10,_=new Us(this.dCtx.ctx);return a.config.yaxis.map(function(D,C){var T=a.globals.yAxisScale[C],P=0;if(!_.isYAxisHidden(C)&&D.labels.show&&void 0!==D.labels.minWidth&&(P=D.labels.minWidth),!_.isYAxisHidden(C)&&D.labels.show&&T.result.length){var L=a.globals.yLabelFormatters[C],B=T.niceMin===Number.MIN_VALUE?0:T.niceMin,V=String(B).length>String(T.niceMax).length?B:T.niceMax,$=L(V,{seriesIndex:C,dataPointIndex:-1,w:a}),q=$;if(void 0!==$&&0!==$.length||($=V),a.globals.isBarHorizontal){g=0;var K=a.globals.labels.slice();$=L($=Xe.getLargestStringFromArr(K),{seriesIndex:C,dataPointIndex:-1,w:a}),q=o.dCtx.dimHelpers.getLargestStringFromMultiArr($,K)}var oe=new yt(o.dCtx.ctx),ae="rotate(".concat(D.labels.rotate," 0 0)"),fe=oe.getTextRects($,D.labels.style.fontSize,D.labels.style.fontFamily,ae,!1),ge=fe;$!==q&&(ge=oe.getTextRects(q,D.labels.style.fontSize,D.labels.style.fontFamily,ae,!1)),d.push({width:(P>ge.width||P>fe.width?P:ge.width>fe.width?ge.width:fe.width)+g,height:ge.height>fe.height?ge.height:fe.height})}else d.push({width:0,height:0})}),d}},{key:"getyAxisTitleCoords",value:function(){var o=this,d=[];return this.w.config.yaxis.map(function(g,_){if(g.show&&void 0!==g.title.text){var D=new yt(o.dCtx.ctx),C="rotate(".concat(g.title.rotate," 0 0)"),T=D.getTextRects(g.title.text,g.title.style.fontSize,g.title.style.fontFamily,C,!1);d.push({width:T.width,height:T.height})}else d.push({width:0,height:0})}),d}},{key:"getTotalYAxisWidth",value:function(){var o=this.w,a=0,d=0,g=0,_=o.globals.yAxisScale.length>1?10:0,D=new Us(this.dCtx.ctx),C=function(T,P){var L=o.config.yaxis[P].floating,B=0;T.width>0&&!L?(B=T.width+_,o.globals.ignoreYAxisIndexes.indexOf(P)>-1&&(B=B-T.width-_)):B=L||D.isYAxisHidden(P)?0:5,o.config.yaxis[P].opposite?g+=B:d+=B,a+=B};return o.globals.yLabelsCoords.map(function(T,P){C(T,P)}),o.globals.yTitleCoords.map(function(T,P){C(T,P)}),o.globals.isBarHorizontal&&!o.config.yaxis[0].floating&&(a=o.globals.yLabelsCoords[0].width+o.globals.yTitleCoords[0].width+15),this.dCtx.yAxisWidthLeft=d,this.dCtx.yAxisWidthRight=g,a}}]),te}(),$s=function(){function te(o){zt(this,te),this.w=o.w,this.dCtx=o}return St(te,[{key:"gridPadForColumnsInNumericAxis",value:function(o){var a=this.w;if(a.globals.noData||a.globals.allSeriesCollapsed)return 0;var d=function(L){return"bar"===L||"rangeBar"===L||"candlestick"===L||"boxPlot"===L},g=a.config.chart.type,_=0,D=d(g)?a.config.series.length:1;if(a.globals.comboBarCount>0&&(D=a.globals.comboBarCount),a.globals.collapsedSeries.forEach(function(L){d(L.type)&&(D-=1)}),a.config.chart.stacked&&(D=1),(d(g)||a.globals.comboBarCount>0)&&a.globals.isXNumeric&&!a.globals.isBarHorizontal&&D>0){var C,T,P=Math.abs(a.globals.initialMaxX-a.globals.initialMinX);P<=3&&(P=a.globals.dataPoints),C=P/o,a.globals.minXDiff&&a.globals.minXDiff/C>0&&(T=a.globals.minXDiff/C),T>o/2&&(T/=2),(_=T/D*parseInt(a.config.plotOptions.bar.columnWidth,10)/100)<1&&(_=1),a.globals.barPadForNumericAxis=_=_/(D>1?1:1.5)+5}return _}},{key:"gridPadFortitleSubtitle",value:function(){var o=this,a=this.w,d=a.globals,g=this.dCtx.isSparkline||!a.globals.axisCharts?0:10;["title","subtitle"].forEach(function(C){g+=void 0!==a.config[C].text?a.config[C].margin:o.dCtx.isSparkline||!a.globals.axisCharts?0:5}),!a.config.legend.show||"bottom"!==a.config.legend.position||a.config.legend.floating||a.globals.axisCharts||(g+=10);var _=this.dCtx.dimHelpers.getTitleSubtitleCoords("title"),D=this.dCtx.dimHelpers.getTitleSubtitleCoords("subtitle");d.gridHeight=d.gridHeight-_.height-D.height-g,d.translateY=d.translateY+_.height+D.height+g}},{key:"setGridXPosForDualYAxis",value:function(o,a){var d=this.w,g=new Us(this.dCtx.ctx);d.config.yaxis.map(function(_,D){-1!==d.globals.ignoreYAxisIndexes.indexOf(D)||_.floating||g.isYAxisHidden(D)||(_.opposite&&(d.globals.translateX=d.globals.translateX-(a[D].width+o[D].width)-parseInt(d.config.yaxis[D].labels.style.fontSize,10)/1.2-12),d.globals.translateX<2&&(d.globals.translateX=2))})}}]),te}(),rr=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.lgRect={},this.yAxisWidth=0,this.yAxisWidthLeft=0,this.yAxisWidthRight=0,this.xAxisHeight=0,this.isSparkline=this.w.config.chart.sparkline.enabled,this.dimHelpers=new As(this),this.dimYAxis=new uc(this),this.dimXAxis=new ba(this),this.dimGrid=new $s(this),this.lgWidthForSideLegends=0,this.gridPad=this.w.config.grid.padding,this.xPadRight=0,this.xPadLeft=0}return St(te,[{key:"plotCoords",value:function(){var o=this.w.globals;this.lgRect=this.dimHelpers.getLegendsRect(),o.axisCharts?this.setDimensionsForAxisCharts():this.setDimensionsForNonAxisCharts(),this.dimGrid.gridPadFortitleSubtitle(),o.gridHeight=o.gridHeight-this.gridPad.top-this.gridPad.bottom,o.gridWidth=o.gridWidth-this.gridPad.left-this.gridPad.right-this.xPadRight-this.xPadLeft;var a=this.dimGrid.gridPadForColumnsInNumericAxis(o.gridWidth);o.gridWidth=o.gridWidth-2*a,o.translateX=o.translateX+this.gridPad.left+this.xPadLeft+(a>0?a+4:0),o.translateY=o.translateY+this.gridPad.top}},{key:"setDimensionsForAxisCharts",value:function(){var o=this,a=this.w,d=a.globals,g=this.dimYAxis.getyAxisLabelsCoords(),_=this.dimYAxis.getyAxisTitleCoords();a.globals.yLabelsCoords=[],a.globals.yTitleCoords=[],a.config.yaxis.map(function(V,$){a.globals.yLabelsCoords.push({width:g[$].width,index:$}),a.globals.yTitleCoords.push({width:_[$].width,index:$})}),this.yAxisWidth=this.dimYAxis.getTotalYAxisWidth();var D=this.dimXAxis.getxAxisLabelsCoords(),C=this.dimXAxis.getxAxisTitleCoords();this.conditionalChecksForAxisCoords(D,C),d.translateXAxisY=a.globals.rotateXLabels?this.xAxisHeight/8:-4,d.translateXAxisX=a.globals.rotateXLabels&&a.globals.isXNumeric&&a.config.xaxis.labels.rotate<=-45?-this.xAxisWidth/4:0,a.globals.isBarHorizontal&&(d.rotateXLabels=!1,d.translateXAxisY=parseInt(a.config.xaxis.labels.style.fontSize,10)/1.5*-1),d.translateXAxisY=d.translateXAxisY+a.config.xaxis.labels.offsetY,d.translateXAxisX=d.translateXAxisX+a.config.xaxis.labels.offsetX;var T=this.yAxisWidth,P=this.xAxisHeight;d.xAxisLabelsHeight=this.xAxisHeight-C.height,d.xAxisLabelsWidth=this.xAxisWidth,d.xAxisHeight=this.xAxisHeight;var L=10;("radar"===a.config.chart.type||this.isSparkline)&&(T=0,P=d.goldenPadding),this.isSparkline&&(this.lgRect={height:0,width:0}),(this.isSparkline||"treemap"===a.config.chart.type)&&(T=0,P=0,L=0),this.isSparkline||this.dimXAxis.additionalPaddingXLabels(D);var B=function(){d.translateX=T,d.gridHeight=d.svgHeight-o.lgRect.height-P-(o.isSparkline||"treemap"===a.config.chart.type?0:a.globals.rotateXLabels?10:15),d.gridWidth=d.svgWidth-T};switch("top"===a.config.xaxis.position&&(L=d.xAxisHeight-a.config.xaxis.axisTicks.height-5),a.config.legend.position){case"bottom":d.translateY=L,B();break;case"top":d.translateY=this.lgRect.height+L,B();break;case"left":d.translateY=L,d.translateX=this.lgRect.width+T,d.gridHeight=d.svgHeight-P-12,d.gridWidth=d.svgWidth-this.lgRect.width-T;break;case"right":d.translateY=L,d.translateX=T,d.gridHeight=d.svgHeight-P-12,d.gridWidth=d.svgWidth-this.lgRect.width-T-5;break;default:throw new Error("Legend position not supported")}this.dimGrid.setGridXPosForDualYAxis(_,g),new fo(this.ctx).setYAxisXPosition(g,_)}},{key:"setDimensionsForNonAxisCharts",value:function(){var o=this.w,a=o.globals,d=o.config,g=0;o.config.legend.show&&!o.config.legend.floating&&(g=20);var _="pie"===d.chart.type||"polarArea"===d.chart.type||"donut"===d.chart.type?"pie":"radialBar",D=d.plotOptions[_].offsetY,C=d.plotOptions[_].offsetX;if(!d.legend.show||d.legend.floating)return a.gridHeight=a.svgHeight-d.grid.padding.left+d.grid.padding.right,a.gridWidth=a.gridHeight,a.translateY=D,void(a.translateX=C+(a.svgWidth-a.gridWidth)/2);switch(d.legend.position){case"bottom":a.gridHeight=a.svgHeight-this.lgRect.height-a.goldenPadding,a.gridWidth=a.svgWidth,a.translateY=D-10,a.translateX=C+(a.svgWidth-a.gridWidth)/2;break;case"top":a.gridHeight=a.svgHeight-this.lgRect.height-a.goldenPadding,a.gridWidth=a.svgWidth,a.translateY=this.lgRect.height+D+10,a.translateX=C+(a.svgWidth-a.gridWidth)/2;break;case"left":a.gridWidth=a.svgWidth-this.lgRect.width-g,a.gridHeight="auto"!==d.chart.height?a.svgHeight:a.gridWidth,a.translateY=D,a.translateX=C+this.lgRect.width+g;break;case"right":a.gridWidth=a.svgWidth-this.lgRect.width-g-5,a.gridHeight="auto"!==d.chart.height?a.svgHeight:a.gridWidth,a.translateY=D,a.translateX=C+10;break;default:throw new Error("Legend position not supported")}}},{key:"conditionalChecksForAxisCoords",value:function(o,a){var d=this.w;this.xAxisHeight=(o.height+a.height)*(d.globals.isMultiLineX?1.2:d.globals.LINE_HEIGHT_RATIO)+(d.globals.rotateXLabels?22:10)+(d.globals.rotateXLabels&&"bottom"===d.config.legend.position?10:0),this.xAxisWidth=o.width,this.xAxisHeight-a.height>d.config.xaxis.labels.maxHeight&&(this.xAxisHeight=d.config.xaxis.labels.maxHeight),d.config.xaxis.labels.minHeight&&this.xAxisHeight<d.config.xaxis.labels.minHeight&&(this.xAxisHeight=d.config.xaxis.labels.minHeight),d.config.xaxis.floating&&(this.xAxisHeight=0);var T=0,P=0;d.config.yaxis.forEach(function(L){T+=L.labels.minWidth,P+=L.labels.maxWidth}),this.yAxisWidth<T&&(this.yAxisWidth=T),this.yAxisWidth>P&&(this.yAxisWidth=P)}}]),te}(),tu=function(){function te(o){zt(this,te),this.w=o.w,this.lgCtx=o}return St(te,[{key:"getLegendStyles",value:function(){var o=document.createElement("style");o.setAttribute("type","text/css");var a=document.createTextNode("\t\n    \t\n      .apexcharts-legend {\t\n        display: flex;\t\n        overflow: auto;\t\n        padding: 0 10px;\t\n      }\t\n      .apexcharts-legend.apx-legend-position-bottom, .apexcharts-legend.apx-legend-position-top {\t\n        flex-wrap: wrap\t\n      }\t\n      .apexcharts-legend.apx-legend-position-right, .apexcharts-legend.apx-legend-position-left {\t\n        flex-direction: column;\t\n        bottom: 0;\t\n      }\t\n      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-left, .apexcharts-legend.apx-legend-position-top.apexcharts-align-left, .apexcharts-legend.apx-legend-position-right, .apexcharts-legend.apx-legend-position-left {\t\n        justify-content: flex-start;\t\n      }\t\n      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-center, .apexcharts-legend.apx-legend-position-top.apexcharts-align-center {\t\n        justify-content: center;  \t\n      }\t\n      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-right, .apexcharts-legend.apx-legend-position-top.apexcharts-align-right {\t\n        justify-content: flex-end;\t\n      }\t\n      .apexcharts-legend-series {\t\n        cursor: pointer;\t\n        line-height: normal;\t\n      }\t\n      .apexcharts-legend.apx-legend-position-bottom .apexcharts-legend-series, .apexcharts-legend.apx-legend-position-top .apexcharts-legend-series{\t\n        display: flex;\t\n        align-items: center;\t\n      }\t\n      .apexcharts-legend-text {\t\n        position: relative;\t\n        font-size: 14px;\t\n      }\t\n      .apexcharts-legend-text *, .apexcharts-legend-marker * {\t\n        pointer-events: none;\t\n      }\t\n      .apexcharts-legend-marker {\t\n        position: relative;\t\n        display: inline-block;\t\n        cursor: pointer;\t\n        margin-right: 3px;\t\n        border-style: solid;\n      }\t\n      \t\n      .apexcharts-legend.apexcharts-align-right .apexcharts-legend-series, .apexcharts-legend.apexcharts-align-left .apexcharts-legend-series{\t\n        display: inline-block;\t\n      }\t\n      .apexcharts-legend-series.apexcharts-no-click {\t\n        cursor: auto;\t\n      }\t\n      .apexcharts-legend .apexcharts-hidden-zero-series, .apexcharts-legend .apexcharts-hidden-null-series {\t\n        display: none !important;\t\n      }\t\n      .apexcharts-inactive-legend {\t\n        opacity: 0.45;\t\n      }");return o.appendChild(a),o}},{key:"getLegendBBox",value:function(){var o=this.w.globals.dom.baseEl.querySelector(".apexcharts-legend").getBoundingClientRect();return{clwh:o.height,clww:o.width}}},{key:"appendToForeignObject",value:function(){var o=this.w.globals;o.dom.elLegendForeign=document.createElementNS(o.SVGNS,"foreignObject");var a=o.dom.elLegendForeign;a.setAttribute("x",0),a.setAttribute("y",0),a.setAttribute("width",o.svgWidth),a.setAttribute("height",o.svgHeight),o.dom.elLegendWrap.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),a.appendChild(o.dom.elLegendWrap),a.appendChild(this.getLegendStyles()),o.dom.Paper.node.insertBefore(a,o.dom.elGraphical.node)}},{key:"toggleDataSeries",value:function(o,a){var d=this,g=this.w;if(g.globals.axisCharts||"radialBar"===g.config.chart.type){g.globals.resized=!0;var _=null,D=null;g.globals.risingSeries=[],g.globals.axisCharts?(_=g.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(o,"']")),D=parseInt(_.getAttribute("data:realIndex"),10)):(_=g.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(o+1,"']")),D=parseInt(_.getAttribute("rel"),10)-1),a?[{cs:g.globals.collapsedSeries,csi:g.globals.collapsedSeriesIndices},{cs:g.globals.ancillaryCollapsedSeries,csi:g.globals.ancillaryCollapsedSeriesIndices}].forEach(function(L){d.riseCollapsedSeries(L.cs,L.csi,D)}):this.hideSeries({seriesEl:_,realIndex:D})}else{var C=g.globals.dom.Paper.select(" .apexcharts-series[rel='".concat(o+1,"'] path")),T=g.config.chart.type;if("pie"===T||"polarArea"===T||"donut"===T){var P=g.config.plotOptions.pie.donut.labels;new yt(this.lgCtx.ctx).pathMouseDown(C.members[0],null),this.lgCtx.ctx.pie.printDataLabelsInner(C.members[0].node,P)}C.fire("click")}}},{key:"hideSeries",value:function(o){var a=o.seriesEl,d=o.realIndex,g=this.w,_=Xe.clone(g.config.series);if(g.globals.axisCharts){var D=!1;if(g.config.yaxis[d]&&g.config.yaxis[d].show&&g.config.yaxis[d].showAlways&&(D=!0,g.globals.ancillaryCollapsedSeriesIndices.indexOf(d)<0&&(g.globals.ancillaryCollapsedSeries.push({index:d,data:_[d].data.slice(),type:a.parentNode.className.baseVal.split("-")[1]}),g.globals.ancillaryCollapsedSeriesIndices.push(d))),!D){g.globals.collapsedSeries.push({index:d,data:_[d].data.slice(),type:a.parentNode.className.baseVal.split("-")[1]}),g.globals.collapsedSeriesIndices.push(d);var C=g.globals.risingSeries.indexOf(d);g.globals.risingSeries.splice(C,1)}}else g.globals.collapsedSeries.push({index:d,data:_[d]}),g.globals.collapsedSeriesIndices.push(d);for(var T=a.childNodes,P=0;P<T.length;P++)T[P].classList.contains("apexcharts-series-markers-wrap")&&(T[P].classList.contains("apexcharts-hide")?T[P].classList.remove("apexcharts-hide"):T[P].classList.add("apexcharts-hide"));g.globals.allSeriesCollapsed=g.globals.collapsedSeries.length===g.config.series.length,_=this._getSeriesBasedOnCollapsedState(_),this.lgCtx.ctx.updateHelpers._updateSeries(_,g.config.chart.animations.dynamicAnimation.enabled)}},{key:"riseCollapsedSeries",value:function(o,a,d){var g=this.w,_=Xe.clone(g.config.series);if(o.length>0){for(var D=0;D<o.length;D++)o[D].index===d&&(g.globals.axisCharts?(_[d].data=o[D].data.slice(),o.splice(D,1),a.splice(D,1),g.globals.risingSeries.push(d)):(_[d]=o[D].data,o.splice(D,1),a.splice(D,1),g.globals.risingSeries.push(d)));_=this._getSeriesBasedOnCollapsedState(_),this.lgCtx.ctx.updateHelpers._updateSeries(_,g.config.chart.animations.dynamicAnimation.enabled)}}},{key:"_getSeriesBasedOnCollapsedState",value:function(o){var a=this.w;return o.forEach(a.globals.axisCharts?function(d,g){a.globals.collapsedSeriesIndices.indexOf(g)>-1&&(o[g].data=[])}:function(d,g){a.globals.collapsedSeriesIndices.indexOf(g)>-1&&(o[g]=0)}),o}}]),te}(),Ua=function(){function te(o,a){zt(this,te),this.ctx=o,this.w=o.w,this.onLegendClick=this.onLegendClick.bind(this),this.onLegendHovered=this.onLegendHovered.bind(this),this.isBarsDistributed="bar"===this.w.config.chart.type&&this.w.config.plotOptions.bar.distributed&&1===this.w.config.series.length,this.legendHelpers=new tu(this)}return St(te,[{key:"init",value:function(){var o=this.w,a=o.globals,d=o.config;if((d.legend.showForSingleSeries&&1===a.series.length||this.isBarsDistributed||a.series.length>1||!a.axisCharts)&&d.legend.show){for(;a.dom.elLegendWrap.firstChild;)a.dom.elLegendWrap.removeChild(a.dom.elLegendWrap.firstChild);this.drawLegends(),Xe.isIE11()?document.getElementsByTagName("head")[0].appendChild(this.legendHelpers.getLegendStyles()):this.legendHelpers.appendToForeignObject(),"bottom"===d.legend.position||"top"===d.legend.position?this.legendAlignHorizontal():"right"!==d.legend.position&&"left"!==d.legend.position||this.legendAlignVertical()}}},{key:"drawLegends",value:function(){var o=this,a=this.w,d=a.config.legend.fontFamily,g=a.globals.seriesNames,_=a.globals.colors.slice();if("heatmap"===a.config.chart.type){var D=a.config.plotOptions.heatmap.colorScale.ranges;g=D.map(function(pt){return pt.name?pt.name:pt.from+" - "+pt.to}),_=D.map(function(pt){return pt.color})}else this.isBarsDistributed&&(g=a.globals.labels.slice());a.config.legend.customLegendItems.length&&(g=a.config.legend.customLegendItems);for(var C=a.globals.legendFormatter,T=a.config.legend.inverseOrder,P=T?g.length-1:0;T?P>=0:P<=g.length-1;T?P--:P++){var L=C(g[P],{seriesIndex:P,w:a}),B=!1,V=!1;if(a.globals.collapsedSeries.length>0)for(var $=0;$<a.globals.collapsedSeries.length;$++)a.globals.collapsedSeries[$].index===P&&(B=!0);if(a.globals.ancillaryCollapsedSeriesIndices.length>0)for(var q=0;q<a.globals.ancillaryCollapsedSeriesIndices.length;q++)a.globals.ancillaryCollapsedSeriesIndices[q]===P&&(V=!0);var K=document.createElement("span");K.classList.add("apexcharts-legend-marker");var oe=a.config.legend.markers.offsetX,ae=a.config.legend.markers.offsetY,fe=a.config.legend.markers.height,ge=a.config.legend.markers.width,R=a.config.legend.markers.strokeWidth,H=a.config.legend.markers.strokeColor,Q=a.config.legend.markers.radius,le=K.style;le.background=_[P],le.color=_[P],le.setProperty("background",_[P],"important"),a.config.legend.markers.fillColors&&a.config.legend.markers.fillColors[P]&&(le.background=a.config.legend.markers.fillColors[P]),void 0!==a.globals.seriesColors[P]&&(le.background=a.globals.seriesColors[P],le.color=a.globals.seriesColors[P]),le.height=Array.isArray(fe)?parseFloat(fe[P])+"px":parseFloat(fe)+"px",le.width=Array.isArray(ge)?parseFloat(ge[P])+"px":parseFloat(ge)+"px",le.left=(Array.isArray(oe)?parseFloat(oe[P]):parseFloat(oe))+"px",le.top=(Array.isArray(ae)?parseFloat(ae[P]):parseFloat(ae))+"px",le.borderWidth=Array.isArray(R)?R[P]:R,le.borderColor=Array.isArray(H)?H[P]:H,le.borderRadius=Array.isArray(Q)?parseFloat(Q[P])+"px":parseFloat(Q)+"px",a.config.legend.markers.customHTML&&(Array.isArray(a.config.legend.markers.customHTML)?a.config.legend.markers.customHTML[P]&&(K.innerHTML=a.config.legend.markers.customHTML[P]()):K.innerHTML=a.config.legend.markers.customHTML()),yt.setAttrs(K,{rel:P+1,"data:collapsed":B||V}),(B||V)&&K.classList.add("apexcharts-inactive-legend");var Re=document.createElement("div"),tt=document.createElement("span");tt.classList.add("apexcharts-legend-text"),tt.innerHTML=Array.isArray(L)?L.join(" "):L;var Ve=a.config.legend.labels.useSeriesColors?a.globals.colors[P]:a.config.legend.labels.colors;Ve||(Ve=a.config.chart.foreColor),tt.style.color=Ve,tt.style.fontSize=parseFloat(a.config.legend.fontSize)+"px",tt.style.fontWeight=a.config.legend.fontWeight,tt.style.fontFamily=d||a.config.chart.fontFamily,yt.setAttrs(tt,{rel:P+1,i:P,"data:default-text":encodeURIComponent(L),"data:collapsed":B||V}),Re.appendChild(K),Re.appendChild(tt);var Dt=new fi(this.ctx);a.config.legend.showForZeroSeries||0===Dt.getSeriesTotalByIndex(P)&&Dt.seriesHaveSameValues(P)&&!Dt.isSeriesNull(P)&&-1===a.globals.collapsedSeriesIndices.indexOf(P)&&-1===a.globals.ancillaryCollapsedSeriesIndices.indexOf(P)&&Re.classList.add("apexcharts-hidden-zero-series"),a.config.legend.showForNullSeries||Dt.isSeriesNull(P)&&-1===a.globals.collapsedSeriesIndices.indexOf(P)&&-1===a.globals.ancillaryCollapsedSeriesIndices.indexOf(P)&&Re.classList.add("apexcharts-hidden-null-series"),a.globals.dom.elLegendWrap.appendChild(Re),a.globals.dom.elLegendWrap.classList.add("apexcharts-align-".concat(a.config.legend.horizontalAlign)),a.globals.dom.elLegendWrap.classList.add("apx-legend-position-"+a.config.legend.position),Re.classList.add("apexcharts-legend-series"),Re.style.margin="".concat(a.config.legend.itemMargin.vertical,"px ").concat(a.config.legend.itemMargin.horizontal,"px"),a.globals.dom.elLegendWrap.style.width=a.config.legend.width?a.config.legend.width+"px":"",a.globals.dom.elLegendWrap.style.height=a.config.legend.height?a.config.legend.height+"px":"",yt.setAttrs(Re,{rel:P+1,seriesName:Xe.escapeString(g[P]),"data:collapsed":B||V}),(B||V)&&Re.classList.add("apexcharts-inactive-legend"),a.config.legend.onItemClick.toggleDataSeries||Re.classList.add("apexcharts-no-click")}a.globals.dom.elWrap.addEventListener("click",o.onLegendClick,!0),a.config.legend.onItemHover.highlightDataSeries&&0===a.config.legend.customLegendItems.length&&(a.globals.dom.elWrap.addEventListener("mousemove",o.onLegendHovered,!0),a.globals.dom.elWrap.addEventListener("mouseout",o.onLegendHovered,!0))}},{key:"setLegendWrapXY",value:function(o,a){var d=this.w,g=d.globals.dom.baseEl.querySelector(".apexcharts-legend"),_=g.getBoundingClientRect(),D=0,C=0;if("bottom"===d.config.legend.position)C+=d.globals.svgHeight-_.height/2;else if("top"===d.config.legend.position){var T=new rr(this.ctx),P=T.dimHelpers.getTitleSubtitleCoords("title").height,L=T.dimHelpers.getTitleSubtitleCoords("subtitle").height;C=C+(P>0?P-10:0)+(L>0?L-10:0)}g.style.position="absolute",C=C+a+d.config.legend.offsetY,g.style.left=(D=D+o+d.config.legend.offsetX)+"px",g.style.top=C+"px","bottom"===d.config.legend.position?(g.style.top="auto",g.style.bottom=5-d.config.legend.offsetY+"px"):"right"===d.config.legend.position&&(g.style.left="auto",g.style.right=25+d.config.legend.offsetX+"px"),["width","height"].forEach(function(B){g.style[B]&&(g.style[B]=parseInt(d.config.legend[B],10)+"px")})}},{key:"legendAlignHorizontal",value:function(){var o=this.w;o.globals.dom.baseEl.querySelector(".apexcharts-legend").style.right=0;var a=this.legendHelpers.getLegendBBox(),d=new rr(this.ctx),g=d.dimHelpers.getTitleSubtitleCoords("title"),_=d.dimHelpers.getTitleSubtitleCoords("subtitle"),D=0;"bottom"===o.config.legend.position?D=-a.clwh/1.8:"top"===o.config.legend.position&&(D=g.height+_.height+o.config.title.margin+o.config.subtitle.margin-10),this.setLegendWrapXY(20,D)}},{key:"legendAlignVertical",value:function(){var o=this.w,a=this.legendHelpers.getLegendBBox(),d=0;"left"===o.config.legend.position&&(d=20),"right"===o.config.legend.position&&(d=o.globals.svgWidth-a.clww-10),this.setLegendWrapXY(d,20)}},{key:"onLegendHovered",value:function(o){var a=this.w,d=o.target.classList.contains("apexcharts-legend-text")||o.target.classList.contains("apexcharts-legend-marker");if("heatmap"===a.config.chart.type||this.isBarsDistributed){if(d){var g=parseInt(o.target.getAttribute("rel"),10)-1;this.ctx.events.fireEvent("legendHover",[this.ctx,g,this.w]),new Bi(this.ctx).highlightRangeInSeries(o,o.target)}}else!o.target.classList.contains("apexcharts-inactive-legend")&&d&&new Bi(this.ctx).toggleSeriesOnHover(o,o.target)}},{key:"onLegendClick",value:function(o){var a=this.w;if(!a.config.legend.customLegendItems.length&&(o.target.classList.contains("apexcharts-legend-text")||o.target.classList.contains("apexcharts-legend-marker"))){var d=parseInt(o.target.getAttribute("rel"),10)-1,g="true"===o.target.getAttribute("data:collapsed"),_=this.w.config.chart.events.legendClick;"function"==typeof _&&_(this.ctx,d,this.w),this.ctx.events.fireEvent("legendClick",[this.ctx,d,this.w]);var D=this.w.config.legend.markers.onClick;"function"==typeof D&&o.target.classList.contains("apexcharts-legend-marker")&&(D(this.ctx,d,this.w),this.ctx.events.fireEvent("legendMarkerClick",[this.ctx,d,this.w])),"treemap"!==a.config.chart.type&&"heatmap"!==a.config.chart.type&&!this.isBarsDistributed&&a.config.legend.onItemClick.toggleDataSeries&&this.legendHelpers.toggleDataSeries(d,g)}}}]),te}(),fl=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w;var a=this.w;this.ev=this.w.config.chart.events,this.selectedClass="apexcharts-selected",this.localeValues=this.w.globals.locale.toolbar,this.minX=a.globals.minX,this.maxX=a.globals.maxX}return St(te,[{key:"createToolbar",value:function(){var o=this,a=this.w,d=function(){return document.createElement("div")},g=d();if(g.setAttribute("class","apexcharts-toolbar"),g.style.top=a.config.chart.toolbar.offsetY+"px",g.style.right=3-a.config.chart.toolbar.offsetX+"px",a.globals.dom.elWrap.appendChild(g),this.elZoom=d(),this.elZoomIn=d(),this.elZoomOut=d(),this.elPan=d(),this.elSelection=d(),this.elZoomReset=d(),this.elMenuIcon=d(),this.elMenu=d(),this.elCustomIcons=[],this.t=a.config.chart.toolbar.tools,Array.isArray(this.t.customIcons))for(var _=0;_<this.t.customIcons.length;_++)this.elCustomIcons.push(d());var D=[],C=function(B,V,$){var q=B.toLowerCase();o.t[q]&&a.config.chart.zoom.enabled&&D.push({el:V,icon:"string"==typeof o.t[q]?o.t[q]:$,title:o.localeValues[B],class:"apexcharts-".concat(q,"-icon")})};C("zoomIn",this.elZoomIn,'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n</svg>\n'),C("zoomOut",this.elZoomOut,'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n</svg>\n');var T=function(B){o.t[B]&&a.config.chart[B].enabled&&D.push({el:"zoom"===B?o.elZoom:o.elSelection,icon:"string"==typeof o.t[B]?o.t[B]:"zoom"===B?'<svg xmlns="http://www.w3.org/2000/svg" fill="#000000" height="24" viewBox="0 0 24 24" width="24">\n    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>\n    <path d="M0 0h24v24H0V0z" fill="none"/>\n    <path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"/>\n</svg>':'<svg fill="#6E8192" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M3 5h2V3c-1.1 0-2 .9-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2c0-1.1-.9-2-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2z"/>\n</svg>',title:o.localeValues["zoom"===B?"selectionZoom":"selection"],class:a.globals.isTouchDevice?"apexcharts-element-hidden":"apexcharts-".concat(B,"-icon")})};T("zoom"),T("selection"),this.t.pan&&a.config.chart.zoom.enabled&&D.push({el:this.elPan,icon:"string"==typeof this.t.pan?this.t.pan:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000" height="24" viewBox="0 0 24 24" width="24">\n    <defs>\n        <path d="M0 0h24v24H0z" id="a"/>\n    </defs>\n    <clipPath id="b">\n        <use overflow="visible" xlink:href="#a"/>\n    </clipPath>\n    <path clip-path="url(#b)" d="M23 5.5V20c0 2.2-1.8 4-4 4h-7.3c-1.08 0-2.1-.43-2.85-1.19L1 14.83s1.26-1.23 1.3-1.25c.22-.19.49-.29.79-.29.22 0 .42.06.6.16.04.01 4.31 2.46 4.31 2.46V4c0-.83.67-1.5 1.5-1.5S11 3.17 11 4v7h1V1.5c0-.83.67-1.5 1.5-1.5S15 .67 15 1.5V11h1V2.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5V11h1V5.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5z"/>\n</svg>',title:this.localeValues.pan,class:a.globals.isTouchDevice?"apexcharts-element-hidden":"apexcharts-pan-icon"}),C("reset",this.elZoomReset,'<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>\n    <path d="M0 0h24v24H0z" fill="none"/>\n</svg>'),this.t.download&&D.push({el:this.elMenuIcon,icon:"string"==typeof this.t.download?this.t.download:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>',title:this.localeValues.menu,class:"apexcharts-menu-icon"});for(var P=0;P<this.elCustomIcons.length;P++)D.push({el:this.elCustomIcons[P],icon:this.t.customIcons[P].icon,title:this.t.customIcons[P].title,index:this.t.customIcons[P].index,class:"apexcharts-toolbar-custom-icon "+this.t.customIcons[P].class});D.forEach(function(B,V){B.index&&Xe.moveIndexInArray(D,V,B.index)});for(var L=0;L<D.length;L++)yt.setAttrs(D[L].el,{class:D[L].class,title:D[L].title}),D[L].el.innerHTML=D[L].icon,g.appendChild(D[L].el);this._createHamburgerMenu(g),a.globals.zoomEnabled?this.elZoom.classList.add(this.selectedClass):a.globals.panEnabled?this.elPan.classList.add(this.selectedClass):a.globals.selectionEnabled&&this.elSelection.classList.add(this.selectedClass),this.addToolbarEventListeners()}},{key:"_createHamburgerMenu",value:function(o){this.elMenuItems=[],o.appendChild(this.elMenu),yt.setAttrs(this.elMenu,{class:"apexcharts-menu"});var a=[{name:"exportSVG",title:this.localeValues.exportToSVG},{name:"exportPNG",title:this.localeValues.exportToPNG},{name:"exportCSV",title:this.localeValues.exportToCSV}];this.w.globals.allSeriesHasEqualX||a.splice(2,1);for(var d=0;d<a.length;d++)this.elMenuItems.push(document.createElement("div")),this.elMenuItems[d].innerHTML=a[d].title,yt.setAttrs(this.elMenuItems[d],{class:"apexcharts-menu-item ".concat(a[d].name),title:a[d].title}),this.elMenu.appendChild(this.elMenuItems[d])}},{key:"addToolbarEventListeners",value:function(){var o=this;this.elZoomReset.addEventListener("click",this.handleZoomReset.bind(this)),this.elSelection.addEventListener("click",this.toggleZoomSelection.bind(this,"selection")),this.elZoom.addEventListener("click",this.toggleZoomSelection.bind(this,"zoom")),this.elZoomIn.addEventListener("click",this.handleZoomIn.bind(this)),this.elZoomOut.addEventListener("click",this.handleZoomOut.bind(this)),this.elPan.addEventListener("click",this.togglePanning.bind(this)),this.elMenuIcon.addEventListener("click",this.toggleMenu.bind(this)),this.elMenuItems.forEach(function(d){d.classList.contains("exportSVG")?d.addEventListener("click",o.handleDownload.bind(o,"svg")):d.classList.contains("exportPNG")?d.addEventListener("click",o.handleDownload.bind(o,"png")):d.classList.contains("exportCSV")&&d.addEventListener("click",o.handleDownload.bind(o,"csv"))});for(var a=0;a<this.t.customIcons.length;a++)this.elCustomIcons[a].addEventListener("click",this.t.customIcons[a].click.bind(this,this.ctx,this.ctx.w))}},{key:"toggleZoomSelection",value:function(o){this.ctx.getSyncedCharts().forEach(function(a){a.ctx.toolbar.toggleOtherControls();var d="selection"===o?a.ctx.toolbar.elSelection:a.ctx.toolbar.elZoom,g="selection"===o?"selectionEnabled":"zoomEnabled";a.w.globals[g]=!a.w.globals[g],d.classList.contains(a.ctx.toolbar.selectedClass)?d.classList.remove(a.ctx.toolbar.selectedClass):d.classList.add(a.ctx.toolbar.selectedClass)})}},{key:"getToolbarIconsReference",value:function(){var o=this.w;this.elZoom||(this.elZoom=o.globals.dom.baseEl.querySelector(".apexcharts-zoom-icon")),this.elPan||(this.elPan=o.globals.dom.baseEl.querySelector(".apexcharts-pan-icon")),this.elSelection||(this.elSelection=o.globals.dom.baseEl.querySelector(".apexcharts-selection-icon"))}},{key:"enableZoomPanFromToolbar",value:function(o){this.toggleOtherControls(),"pan"===o?this.w.globals.panEnabled=!0:this.w.globals.zoomEnabled=!0;var a="pan"===o?this.elPan:this.elZoom,d="pan"===o?this.elZoom:this.elPan;a&&a.classList.add(this.selectedClass),d&&d.classList.remove(this.selectedClass)}},{key:"togglePanning",value:function(){this.ctx.getSyncedCharts().forEach(function(o){o.ctx.toolbar.toggleOtherControls(),o.w.globals.panEnabled=!o.w.globals.panEnabled,o.ctx.toolbar.elPan.classList.contains(o.ctx.toolbar.selectedClass)?o.ctx.toolbar.elPan.classList.remove(o.ctx.toolbar.selectedClass):o.ctx.toolbar.elPan.classList.add(o.ctx.toolbar.selectedClass)})}},{key:"toggleOtherControls",value:function(){var o=this,a=this.w;a.globals.panEnabled=!1,a.globals.zoomEnabled=!1,a.globals.selectionEnabled=!1,this.getToolbarIconsReference(),[this.elPan,this.elSelection,this.elZoom].forEach(function(d){d&&d.classList.remove(o.selectedClass)})}},{key:"handleZoomIn",value:function(){var o=this.w;o.globals.isRangeBar&&(this.minX=o.globals.minY,this.maxX=o.globals.maxY);var a=(this.minX+this.maxX)/2,_=this._getNewMinXMaxX((this.minX+a)/2,(this.maxX+a)/2);o.globals.disableZoomIn||this.zoomUpdateOptions(_.minX,_.maxX)}},{key:"handleZoomOut",value:function(){var o=this.w;if(o.globals.isRangeBar&&(this.minX=o.globals.minY,this.maxX=o.globals.maxY),!("datetime"===o.config.xaxis.type&&new Date(this.minX).getUTCFullYear()<1e3)){var a=(this.minX+this.maxX)/2,_=this._getNewMinXMaxX(this.minX-(a-this.minX),this.maxX-(a-this.maxX));o.globals.disableZoomOut||this.zoomUpdateOptions(_.minX,_.maxX)}}},{key:"_getNewMinXMaxX",value:function(o,a){var d=this.w.config.xaxis.convertedCatToNumeric;return{minX:d?Math.floor(o):o,maxX:d?Math.floor(a):a}}},{key:"zoomUpdateOptions",value:function(o,a){var d=this.w;if(void 0!==o||void 0!==a){if(!(d.config.xaxis.convertedCatToNumeric&&(o<1&&(o=1,a=d.globals.dataPoints),a-o<2))){var g={min:o,max:a},_=this.getBeforeZoomRange(g);_&&(g=_.xaxis);var D={xaxis:g},C=Xe.clone(d.globals.initialConfig.yaxis);d.config.chart.zoom.autoScaleYaxis&&(C=new Hs(this.ctx).autoScaleY(this.ctx,C,{xaxis:g})),d.config.chart.group||(D.yaxis=C),this.w.globals.zoomed=!0,this.ctx.updateHelpers._updateOptions(D,!1,this.w.config.chart.animations.dynamicAnimation.enabled),this.zoomCallback(g,C)}}else this.handleZoomReset()}},{key:"zoomCallback",value:function(o,a){"function"==typeof this.ev.zoomed&&this.ev.zoomed(this.ctx,{xaxis:o,yaxis:a})}},{key:"getBeforeZoomRange",value:function(o,a){var d=null;return"function"==typeof this.ev.beforeZoom&&(d=this.ev.beforeZoom(this,{xaxis:o,yaxis:a})),d}},{key:"toggleMenu",value:function(){var o=this;window.setTimeout(function(){o.elMenu.classList.contains("apexcharts-menu-open")?o.elMenu.classList.remove("apexcharts-menu-open"):o.elMenu.classList.add("apexcharts-menu-open")},0)}},{key:"handleDownload",value:function(o){var a=this.w,d=new Va(this.ctx);switch(o){case"svg":d.exportToSVG(this.ctx);break;case"png":d.exportToPng(this.ctx);break;case"csv":d.exportToCSV({series:a.config.series,columnDelimiter:a.config.chart.toolbar.export.csv.columnDelimiter})}}},{key:"handleZoomReset",value:function(o){this.ctx.getSyncedCharts().forEach(function(a){var d=a.w;if(d.globals.lastXAxis.min=void 0,d.globals.lastXAxis.max=void 0,a.updateHelpers.revertDefaultAxisMinMax(),"function"==typeof d.config.chart.events.beforeResetZoom){var g=d.config.chart.events.beforeResetZoom(a,d);g&&a.updateHelpers.revertDefaultAxisMinMax(g)}"function"==typeof d.config.chart.events.zoomed&&a.ctx.toolbar.zoomCallback({min:d.config.xaxis.min,max:d.config.xaxis.max}),d.globals.zoomed=!1;var _=a.ctx.series.emptyCollapsedSeries(Xe.clone(d.globals.initialSeries));a.updateHelpers._updateSeries(_,d.config.chart.animations.dynamicAnimation.enabled)})}},{key:"destroy",value:function(){this.elZoom=null,this.elZoomIn=null,this.elZoomOut=null,this.elPan=null,this.elSelection=null,this.elZoomReset=null,this.elMenuIcon=null}}]),te}(),hc=function(te){ht(a,fl);var o=co(a);function a(d){var g;return zt(this,a),(g=o.call(this,d)).ctx=d,g.w=d.w,g.dragged=!1,g.graphics=new yt(g.ctx),g.eventList=["mousedown","mouseleave","mousemove","touchstart","touchmove","mouseup","touchend"],g.clientX=0,g.clientY=0,g.startX=0,g.endX=0,g.dragX=0,g.startY=0,g.endY=0,g.dragY=0,g.moveDirection="none",g}return St(a,[{key:"init",value:function(d){var g=this,_=d.xyRatios,D=this.w,C=this;this.xyRatios=_,this.zoomRect=this.graphics.drawRect(0,0,0,0),this.selectionRect=this.graphics.drawRect(0,0,0,0),this.gridRect=D.globals.dom.baseEl.querySelector(".apexcharts-grid"),this.zoomRect.node.classList.add("apexcharts-zoom-rect"),this.selectionRect.node.classList.add("apexcharts-selection-rect"),D.globals.dom.elGraphical.add(this.zoomRect),D.globals.dom.elGraphical.add(this.selectionRect),this.slDraggableRect="x"===D.config.chart.selection.type?this.selectionRect.draggable({minX:0,minY:0,maxX:D.globals.gridWidth,maxY:D.globals.gridHeight}).on("dragmove",this.selectionDragging.bind(this,"dragging")):"y"===D.config.chart.selection.type?this.selectionRect.draggable({minX:0,maxX:D.globals.gridWidth}).on("dragmove",this.selectionDragging.bind(this,"dragging")):this.selectionRect.draggable().on("dragmove",this.selectionDragging.bind(this,"dragging")),this.preselectedSelection(),this.hoverArea=D.globals.dom.baseEl.querySelector("".concat(D.globals.chartClass," .apexcharts-svg")),this.hoverArea.classList.add("apexcharts-zoomable"),this.eventList.forEach(function(T){g.hoverArea.addEventListener(T,C.svgMouseEvents.bind(C,_),{capture:!1,passive:!0})})}},{key:"destroy",value:function(){this.slDraggableRect&&(this.slDraggableRect.draggable(!1),this.slDraggableRect.off(),this.selectionRect.off()),this.selectionRect=null,this.zoomRect=null,this.gridRect=null}},{key:"svgMouseEvents",value:function(d,g){var _=this.w,D=this,C=this.ctx.toolbar,T=_.globals.zoomEnabled?_.config.chart.zoom.type:_.config.chart.selection.type,P=_.config.chart.toolbar.autoSelected;if(g.shiftKey?(this.shiftWasPressed=!0,C.enableZoomPanFromToolbar("pan"===P?"zoom":"pan")):this.shiftWasPressed&&(C.enableZoomPanFromToolbar(P),this.shiftWasPressed=!1),g.target){var L,B=g.target.classList;if(g.target.parentNode&&null!==g.target.parentNode&&(L=g.target.parentNode.classList),!(B.contains("apexcharts-selection-rect")||B.contains("apexcharts-legend-marker")||B.contains("apexcharts-legend-text")||L&&L.contains("apexcharts-toolbar"))){if(D.clientX="touchmove"===g.type||"touchstart"===g.type?g.touches[0].clientX:"touchend"===g.type?g.changedTouches[0].clientX:g.clientX,D.clientY="touchmove"===g.type||"touchstart"===g.type?g.touches[0].clientY:"touchend"===g.type?g.changedTouches[0].clientY:g.clientY,"mousedown"===g.type&&1===g.which){var V=D.gridRect.getBoundingClientRect();D.startX=D.clientX-V.left,D.startY=D.clientY-V.top,D.dragged=!1,D.w.globals.mousedown=!0}if(("mousemove"===g.type&&1===g.which||"touchmove"===g.type)&&(D.dragged=!0,_.globals.panEnabled?(_.globals.selection=null,D.w.globals.mousedown&&D.panDragging({context:D,zoomtype:T,xyRatios:d})):(D.w.globals.mousedown&&_.globals.zoomEnabled||D.w.globals.mousedown&&_.globals.selectionEnabled)&&(D.selection=D.selectionDrawing({context:D,zoomtype:T}))),"mouseup"===g.type||"touchend"===g.type||"mouseleave"===g.type){var $=D.gridRect.getBoundingClientRect();D.w.globals.mousedown&&(D.endX=D.clientX-$.left,D.endY=D.clientY-$.top,D.dragX=Math.abs(D.endX-D.startX),D.dragY=Math.abs(D.endY-D.startY),(_.globals.zoomEnabled||_.globals.selectionEnabled)&&D.selectionDrawn({context:D,zoomtype:T}),_.globals.panEnabled&&_.config.xaxis.convertedCatToNumeric&&D.delayedPanScrolled()),_.globals.zoomEnabled&&D.hideSelectionRect(this.selectionRect),D.dragged=!1,D.w.globals.mousedown=!1}this.makeSelectionRectDraggable()}}}},{key:"makeSelectionRectDraggable",value:function(){var d=this.w;if(this.selectionRect){var g=this.selectionRect.node.getBoundingClientRect();g.width>0&&g.height>0&&this.slDraggableRect.selectize({points:"l, r",pointSize:8,pointType:"rect"}).resize({constraint:{minX:0,minY:0,maxX:d.globals.gridWidth,maxY:d.globals.gridHeight}}).on("resizing",this.selectionDragging.bind(this,"resizing"))}}},{key:"preselectedSelection",value:function(){var d=this.w,g=this.xyRatios;if(!d.globals.zoomEnabled)if(null!=d.globals.selection)this.drawSelectionRect(d.globals.selection);else if(void 0!==d.config.chart.selection.xaxis.min&&void 0!==d.config.chart.selection.xaxis.max){var _=(d.config.chart.selection.xaxis.min-d.globals.minX)/g.xRatio;this.drawSelectionRect({x:_,y:0,width:d.globals.gridWidth-(d.globals.maxX-d.config.chart.selection.xaxis.max)/g.xRatio-_,height:d.globals.gridHeight,translateX:0,translateY:0,selectionEnabled:!0}),this.makeSelectionRectDraggable(),"function"==typeof d.config.chart.events.selection&&d.config.chart.events.selection(this.ctx,{xaxis:{min:d.config.chart.selection.xaxis.min,max:d.config.chart.selection.xaxis.max},yaxis:{}})}}},{key:"drawSelectionRect",value:function(d){var g=d.x,_=d.y,D=d.width,C=d.height,T=d.translateX,L=d.translateY,V=this.w,$=this.zoomRect,q=this.selectionRect;if(this.dragged||null!==V.globals.selection){var K={transform:"translate("+(void 0===T?0:T)+", "+(void 0===L?0:L)+")"};V.globals.zoomEnabled&&this.dragged&&(D<0&&(D=1),$.attr({x:g,y:_,width:D,height:C,fill:V.config.chart.zoom.zoomedArea.fill.color,"fill-opacity":V.config.chart.zoom.zoomedArea.fill.opacity,stroke:V.config.chart.zoom.zoomedArea.stroke.color,"stroke-width":V.config.chart.zoom.zoomedArea.stroke.width,"stroke-opacity":V.config.chart.zoom.zoomedArea.stroke.opacity}),yt.setAttrs($.node,K)),V.globals.selectionEnabled&&(q.attr({x:g,y:_,width:D>0?D:0,height:C>0?C:0,fill:V.config.chart.selection.fill.color,"fill-opacity":V.config.chart.selection.fill.opacity,stroke:V.config.chart.selection.stroke.color,"stroke-width":V.config.chart.selection.stroke.width,"stroke-dasharray":V.config.chart.selection.stroke.dashArray,"stroke-opacity":V.config.chart.selection.stroke.opacity}),yt.setAttrs(q.node,K))}}},{key:"hideSelectionRect",value:function(d){d&&d.attr({x:0,y:0,width:0,height:0})}},{key:"selectionDrawing",value:function(d){var K,_=d.zoomtype,D=this.w,C=d.context,T=this.gridRect.getBoundingClientRect(),P=C.startX-1,L=C.startY,B=!1,V=!1,$=C.clientX-T.left-P,q=C.clientY-T.top-L;return Math.abs($+P)>D.globals.gridWidth?$=D.globals.gridWidth-P:C.clientX-T.left<0&&($=P),P>C.clientX-T.left&&(B=!0,$=Math.abs($)),L>C.clientY-T.top&&(V=!0,q=Math.abs(q)),C.drawSelectionRect(K="x"===_?{x:B?P-$:P,y:0,width:$,height:D.globals.gridHeight}:"y"===_?{x:0,y:V?L-q:L,width:D.globals.gridWidth,height:q}:{x:B?P-$:P,y:V?L-q:L,width:$,height:q}),C.selectionDragging("resizing"),K}},{key:"selectionDragging",value:function(d,g){var _=this,D=this.w,C=this.xyRatios,T=this.selectionRect,P=0;"resizing"===d&&(P=30);var L=function(V){return parseFloat(T.node.getAttribute(V))},B={x:L("x"),y:L("y"),width:L("width"),height:L("height")};D.globals.selection=B,"function"==typeof D.config.chart.events.selection&&D.globals.selectionEnabled&&(clearTimeout(this.w.globals.selectionResizeTimer),this.w.globals.selectionResizeTimer=window.setTimeout(function(){var V=_.gridRect.getBoundingClientRect(),$=T.node.getBoundingClientRect(),q={xaxis:{min:D.globals.xAxisScale.niceMin+($.left-V.left)*C.xRatio,max:D.globals.xAxisScale.niceMin+($.right-V.left)*C.xRatio},yaxis:{min:D.globals.yAxisScale[0].niceMin+(V.bottom-$.bottom)*C.yRatio[0],max:D.globals.yAxisScale[0].niceMax-($.top-V.top)*C.yRatio[0]}};D.config.chart.events.selection(_.ctx,q),D.config.chart.brush.enabled&&void 0!==D.config.chart.events.brushScrolled&&D.config.chart.events.brushScrolled(_.ctx,q)},P))}},{key:"selectionDrawn",value:function(d){var _=d.zoomtype,D=this.w,C=d.context,T=this.xyRatios,P=this.ctx.toolbar;if(C.startX>C.endX){var L=C.startX;C.startX=C.endX,C.endX=L}if(C.startY>C.endY){var B=C.startY;C.startY=C.endY,C.endY=B}var V=void 0,$=void 0;D.globals.isRangeBar?(V=D.globals.yAxisScale[0].niceMin+C.startX*T.invertedYRatio,$=D.globals.yAxisScale[0].niceMin+C.endX*T.invertedYRatio):(V=D.globals.xAxisScale.niceMin+C.startX*T.xRatio,$=D.globals.xAxisScale.niceMin+C.endX*T.xRatio);var q=[],K=[];if(D.config.yaxis.forEach(function(le,Re){q.push(D.globals.yAxisScale[Re].niceMax-T.yRatio[Re]*C.startY),K.push(D.globals.yAxisScale[Re].niceMax-T.yRatio[Re]*C.endY)}),C.dragged&&(C.dragX>10||C.dragY>10)&&V!==$)if(D.globals.zoomEnabled){var oe=Xe.clone(D.globals.initialConfig.yaxis),ae=Xe.clone(D.globals.initialConfig.xaxis);if(D.globals.zoomed=!0,D.config.xaxis.convertedCatToNumeric&&(V=Math.floor(V),$=Math.floor($),V<1&&(V=1,$=D.globals.dataPoints),$-V<2&&($=V+1)),"xy"!==_&&"x"!==_||(ae={min:V,max:$}),"xy"!==_&&"y"!==_||oe.forEach(function(le,Re){oe[Re].min=K[Re],oe[Re].max=q[Re]}),D.config.chart.zoom.autoScaleYaxis){var fe=new Hs(C.ctx);oe=fe.autoScaleY(C.ctx,oe,{xaxis:ae})}if(P){var ge=P.getBeforeZoomRange(ae,oe);ge&&(ae=ge.xaxis?ge.xaxis:ae,oe=ge.yaxis?ge.yaxis:oe)}var R={xaxis:ae};D.config.chart.group||(R.yaxis=oe),C.ctx.updateHelpers._updateOptions(R,!1,C.w.config.chart.animations.dynamicAnimation.enabled),"function"==typeof D.config.chart.events.zoomed&&P.zoomCallback(ae,oe)}else if(D.globals.selectionEnabled){var H,Q=null;H={min:V,max:$},"xy"!==_&&"y"!==_||(Q=Xe.clone(D.config.yaxis)).forEach(function(le,Re){Q[Re].min=K[Re],Q[Re].max=q[Re]}),D.globals.selection=C.selection,"function"==typeof D.config.chart.events.selection&&D.config.chart.events.selection(C.ctx,{xaxis:H,yaxis:Q})}}},{key:"panDragging",value:function(d){var _=this.w,D=d.context;if(void 0!==_.globals.lastClientPosition.x){var C=_.globals.lastClientPosition.x-D.clientX,T=_.globals.lastClientPosition.y-D.clientY;Math.abs(C)>Math.abs(T)&&C>0?this.moveDirection="left":Math.abs(C)>Math.abs(T)&&C<0?this.moveDirection="right":Math.abs(T)>Math.abs(C)&&T>0?this.moveDirection="up":Math.abs(T)>Math.abs(C)&&T<0&&(this.moveDirection="down")}_.globals.lastClientPosition={x:D.clientX,y:D.clientY},_.config.xaxis.convertedCatToNumeric||D.panScrolled(_.globals.isRangeBar?_.globals.minY:_.globals.minX,_.globals.isRangeBar?_.globals.maxY:_.globals.maxX)}},{key:"delayedPanScrolled",value:function(){var d=this.w,g=d.globals.minX,_=d.globals.maxX,D=(d.globals.maxX-d.globals.minX)/2;"left"===this.moveDirection?(g=d.globals.minX+D,_=d.globals.maxX+D):"right"===this.moveDirection&&(g=d.globals.minX-D,_=d.globals.maxX-D),g=Math.floor(g),_=Math.floor(_),this.updateScrolledChart({xaxis:{min:g,max:_}},g,_)}},{key:"panScrolled",value:function(d,g){var _=this.w,D=this.xyRatios,C=Xe.clone(_.globals.initialConfig.yaxis),T=D.xRatio,P=_.globals.minX,L=_.globals.maxX;_.globals.isRangeBar&&(T=D.invertedYRatio,P=_.globals.minY,L=_.globals.maxY),"left"===this.moveDirection?(d=P+_.globals.gridWidth/15*T,g=L+_.globals.gridWidth/15*T):"right"===this.moveDirection&&(d=P-_.globals.gridWidth/15*T,g=L-_.globals.gridWidth/15*T),_.globals.isRangeBar||(d<_.globals.initialMinX||g>_.globals.initialMaxX)&&(d=P,g=L);var B={min:d,max:g};_.config.chart.zoom.autoScaleYaxis&&(C=new Hs(this.ctx).autoScaleY(this.ctx,C,{xaxis:B}));var V={xaxis:{min:d,max:g}};_.config.chart.group||(V.yaxis=C),this.updateScrolledChart(V,d,g)}},{key:"updateScrolledChart",value:function(d,g,_){var D=this.w;this.ctx.updateHelpers._updateOptions(d,!1,!1),"function"==typeof D.config.chart.events.scrolled&&D.config.chart.events.scrolled(this.ctx,{xaxis:{min:g,max:_}})}}]),a}(),Oo=function(){function te(o){zt(this,te),this.w=o.w,this.ttCtx=o,this.ctx=o.ctx}return St(te,[{key:"getNearestValues",value:function(o){var a=o.hoverArea,g=o.clientX,_=o.clientY,D=this.w,C=o.elGrid.getBoundingClientRect(),T=C.width,P=C.height,L=T/(D.globals.dataPoints-1),B=P/D.globals.dataPoints,V=this.hasBars();!D.globals.comboCharts&&!V||D.config.xaxis.convertedCatToNumeric||(L=T/D.globals.dataPoints);var $=g-C.left-D.globals.barPadForNumericAxis,q=_-C.top;$<0||q<0||$>T||q>P?(a.classList.remove("hovering-zoom"),a.classList.remove("hovering-pan")):D.globals.zoomEnabled?(a.classList.remove("hovering-pan"),a.classList.add("hovering-zoom")):D.globals.panEnabled&&(a.classList.remove("hovering-zoom"),a.classList.add("hovering-pan"));var K=Math.round($/L),oe=Math.floor(q/B);V&&!D.config.xaxis.convertedCatToNumeric&&(K=Math.ceil($/L),K-=1);for(var ae,fe=null,ge=null,R=[],H=0;H<D.globals.seriesXvalues.length;H++)R.push([D.globals.seriesXvalues[H][0]-1e-6].concat(D.globals.seriesXvalues[H]));if(R=R.map(function(tt){return tt.filter(function(Ve){return Ve})}),ae=D.globals.seriesYvalues.map(function(tt){return tt.filter(function(Ve){return Xe.isNumber(Ve)})}),D.globals.isXNumeric){var Q=this.ttCtx.getElGrid().getBoundingClientRect(),le=$*(Q.width/T);fe=(ge=this.closestInMultiArray(le,q*(Q.height/P),R,ae)).index,K=ge.j,null!==fe&&(K=(ge=this.closestInArray(le,R=D.globals.seriesXvalues[fe])).index)}return D.globals.capturedSeriesIndex=null===fe?-1:fe,(!K||K<1)&&(K=0),D.globals.capturedDataPointIndex=D.globals.isBarHorizontal?oe:K,{capturedSeries:fe,j:D.globals.isBarHorizontal?oe:K,hoverX:$,hoverY:q}}},{key:"closestInMultiArray",value:function(o,a,d,g){var D=0,C=null,T=-1;this.w.globals.series.length>1?D=this.getFirstActiveXArray(d):C=0;var P=g[D][0],B=Math.abs(o-d[D][0]),V=Math.abs(a-P),$=V+B;return g.map(function(q,K){q.map(function(oe,ae){var fe=Math.abs(a-g[K][ae]),ge=Math.abs(o-d[K][ae]),R=ge+fe;R<$&&($=R,B=ge,V=fe,C=K,T=ae)})}),{index:C,j:T}}},{key:"getFirstActiveXArray",value:function(o){for(var a=0,d=o.map(function(_,D){return _.length>0?D:-1}),g=0;g<d.length;g++)if(-1!==d[g]){a=d[g];break}return a}},{key:"closestInArray",value:function(o,a){for(var g=null,_=Math.abs(o-a[0]),D=0;D<a.length;D++){var C=Math.abs(o-a[D]);C<_&&(_=C,g=D)}return{index:g}}},{key:"isXoverlap",value:function(o){var a=[],d=this.w.globals.seriesX.filter(function(_){return void 0!==_[0]});if(d.length>0)for(var g=0;g<d.length-1;g++)void 0!==d[g][o]&&void 0!==d[g+1][o]&&d[g][o]!==d[g+1][o]&&a.push("unEqual");return 0===a.length}},{key:"isInitialSeriesSameLen",value:function(){for(var o=!0,a=this.w.globals.initialSeries,d=0;d<a.length-1;d++)if(a[d].data.length!==a[d+1].data.length){o=!1;break}return o}},{key:"getBarsHeight",value:function(o){return wn(o).reduce(function(a,d){return a+d.getBBox().height},0)}},{key:"getElMarkers",value:function(){return this.w.globals.dom.baseEl.querySelectorAll(" .apexcharts-series-markers")}},{key:"getAllMarkers",value:function(){var o=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers-wrap");(o=wn(o)).sort(function(d,g){return Number(g.getAttribute("data:realIndex"))<Number(d.getAttribute("data:realIndex"))?0:-1});var a=[];return o.forEach(function(d){a.push(d.querySelector(".apexcharts-marker"))}),a}},{key:"hasMarkers",value:function(){return this.getElMarkers().length>0}},{key:"getElBars",value:function(){return this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-bar-series,  .apexcharts-candlestick-series, .apexcharts-boxPlot-series, .apexcharts-rangebar-series")}},{key:"hasBars",value:function(){return this.getElBars().length>0}},{key:"getHoverMarkerSize",value:function(o){var a=this.w,d=a.config.markers.hover.size;return void 0===d&&(d=a.globals.markers.size[o]+a.config.markers.hover.sizeOffset),d}},{key:"toggleAllTooltipSeriesGroups",value:function(o){var a=this.w,d=this.ttCtx;0===d.allTooltipSeriesGroups.length&&(d.allTooltipSeriesGroups=a.globals.dom.baseEl.querySelectorAll(".apexcharts-tooltip-series-group"));for(var g=d.allTooltipSeriesGroups,_=0;_<g.length;_++)"enable"===o?(g[_].classList.add("apexcharts-active"),g[_].style.display=a.config.tooltip.items.display):(g[_].classList.remove("apexcharts-active"),g[_].style.display="none")}}]),te}(),dc=function(){function te(o){zt(this,te),this.w=o.w,this.ctx=o.ctx,this.ttCtx=o,this.tooltipUtil=new Oo(o)}return St(te,[{key:"drawSeriesTexts",value:function(o){var a=o.shared,d=void 0===a||a,g=o.ttItems,_=o.i,D=void 0===_?0:_,C=o.j,T=void 0===C?null:C,B=o.e,V=this.w;void 0!==V.config.tooltip.custom?this.handleCustomTooltip({i:D,j:T,y1:o.y1,y2:o.y2,w:V}):this.toggleActiveInactiveSeries(d);var $=this.getValuesToPrint({i:D,j:T});this.printLabels({i:D,j:T,values:$,ttItems:g,shared:d,e:B});var q=this.ttCtx.getElTooltip();this.ttCtx.tooltipRect.ttWidth=q.getBoundingClientRect().width,this.ttCtx.tooltipRect.ttHeight=q.getBoundingClientRect().height}},{key:"printLabels",value:function(o){var a,d=this,g=o.i,_=o.j,D=o.values,C=o.ttItems,T=o.shared,P=o.e,L=this.w,B=[],V=function(H){return L.globals.seriesGoals[H]&&L.globals.seriesGoals[H][_]&&Array.isArray(L.globals.seriesGoals[H][_])},$=D.xVal,q=D.zVal,K=D.xAxisTTVal,oe="",ae=L.globals.colors[g];null!==_&&L.config.plotOptions.bar.distributed&&(ae=L.globals.colors[_]);for(var fe=function(H,Q){var le=d.getFormatters(g);oe=d.getSeriesName({fn:le.yLbTitleFormatter,index:g,seriesIndex:g,j:_}),"treemap"===L.config.chart.type&&(oe=le.yLbTitleFormatter(String(L.config.series[g].data[_].x),{series:L.globals.series,seriesIndex:g,dataPointIndex:_,w:L}));var Re=L.config.tooltip.inverseOrder?Q:H;if(L.globals.axisCharts){var tt=function(Ve){return le.yLbFormatter(L.globals.series[Ve][_],{series:L.globals.series,seriesIndex:Ve,dataPointIndex:_,w:L})};T?(le=d.getFormatters(Re),oe=d.getSeriesName({fn:le.yLbTitleFormatter,index:Re,seriesIndex:g,j:_}),ae=L.globals.colors[Re],a=tt(Re),V(Re)&&(B=L.globals.seriesGoals[Re][_].map(function(Ve){return{attrs:Ve,val:le.yLbFormatter(Ve.value,{seriesIndex:Re,dataPointIndex:_,w:L})}}))):(P&&P.target&&P.target.getAttribute("fill")&&(ae=P.target.getAttribute("fill")),a=tt(g),V(g)&&Array.isArray(L.globals.seriesGoals[g][_])&&(B=L.globals.seriesGoals[g][_].map(function(Ve){return{attrs:Ve,val:le.yLbFormatter(Ve.value,{seriesIndex:g,dataPointIndex:_,w:L})}})))}null===_&&(a=le.yLbFormatter(L.globals.series[g],Je(Je({},L),{},{seriesIndex:g,dataPointIndex:g}))),d.DOMHandling({i:g,t:Re,j:_,ttItems:C,values:{val:a,goalVals:B,xVal:$,xAxisTTVal:K,zVal:q},seriesName:oe,shared:T,pColor:ae})},ge=0,R=L.globals.series.length-1;ge<L.globals.series.length;ge++,R--)fe(ge,R)}},{key:"getFormatters",value:function(o){var a,d=this.w,g=d.globals.yLabelFormatters[o];return void 0!==d.globals.ttVal?Array.isArray(d.globals.ttVal)?(g=d.globals.ttVal[o]&&d.globals.ttVal[o].formatter,a=d.globals.ttVal[o]&&d.globals.ttVal[o].title&&d.globals.ttVal[o].title.formatter):(g=d.globals.ttVal.formatter,"function"==typeof d.globals.ttVal.title.formatter&&(a=d.globals.ttVal.title.formatter)):a=d.config.tooltip.y.title.formatter,"function"!=typeof g&&(g=d.globals.yLabelFormatters[0]?d.globals.yLabelFormatters[0]:function(_){return _}),"function"!=typeof a&&(a=function(_){return _}),{yLbFormatter:g,yLbTitleFormatter:a}}},{key:"getSeriesName",value:function(o){var g=o.seriesIndex,_=o.j,D=this.w;return(0,o.fn)(String(D.globals.seriesNames[o.index]),{series:D.globals.series,seriesIndex:g,dataPointIndex:_,w:D})}},{key:"DOMHandling",value:function(o){var a=o.t,d=o.j,g=o.ttItems,_=o.values,D=o.seriesName,C=o.shared,T=o.pColor,P=this.w,L=this.ttCtx,B=_.val,V=_.goalVals,$=_.xVal,q=_.xAxisTTVal,K=_.zVal,oe=null;oe=g[a].children,P.config.tooltip.fillSeriesColor&&(g[a].style.backgroundColor=T,oe[0].style.display="none"),L.showTooltipTitle&&(null===L.tooltipTitle&&(L.tooltipTitle=P.globals.dom.baseEl.querySelector(".apexcharts-tooltip-title")),L.tooltipTitle.innerHTML=$),L.blxaxisTooltip&&(L.xaxisTooltipText.innerHTML=""!==q?q:$);var ae=g[a].querySelector(".apexcharts-tooltip-text-y-label");ae&&(ae.innerHTML=D||"");var fe=g[a].querySelector(".apexcharts-tooltip-text-y-value");fe&&(fe.innerHTML=void 0!==B?B:""),oe[0]&&oe[0].classList.contains("apexcharts-tooltip-marker")&&(P.config.tooltip.marker.fillColors&&Array.isArray(P.config.tooltip.marker.fillColors)&&(T=P.config.tooltip.marker.fillColors[a]),oe[0].style.backgroundColor=T),P.config.tooltip.marker.show||(oe[0].style.display="none");var ge=g[a].querySelector(".apexcharts-tooltip-text-goals-label"),R=g[a].querySelector(".apexcharts-tooltip-text-goals-value");if(V.length&&P.globals.seriesGoals[a]){var H=function(){var Q="<div >",le="<div>";V.forEach(function(Re,tt){Q+=' <div style="display: flex"><span class="apexcharts-tooltip-marker" style="background-color: '.concat(Re.attrs.strokeColor,'; height: 3px; border-radius: 0; top: 5px;"></span> ').concat(Re.attrs.name,"</div>"),le+="<div>".concat(Re.val,"</div>")}),ge.innerHTML=Q+"</div>",R.innerHTML=le+"</div>"};C?P.globals.seriesGoals[a][d]&&Array.isArray(P.globals.seriesGoals[a][d])?H():(ge.innerHTML="",R.innerHTML=""):H()}else ge.innerHTML="",R.innerHTML="";null!==K&&(g[a].querySelector(".apexcharts-tooltip-text-z-label").innerHTML=P.config.tooltip.z.title,g[a].querySelector(".apexcharts-tooltip-text-z-value").innerHTML=void 0!==K?K:""),C&&oe[0]&&(oe[0].parentNode.style.display=null==B||P.globals.collapsedSeriesIndices.indexOf(a)>-1?"none":P.config.tooltip.items.display)}},{key:"toggleActiveInactiveSeries",value:function(o){var a=this.w;if(o)this.tooltipUtil.toggleAllTooltipSeriesGroups("enable");else{this.tooltipUtil.toggleAllTooltipSeriesGroups("disable");var d=a.globals.dom.baseEl.querySelector(".apexcharts-tooltip-series-group");d&&(d.classList.add("apexcharts-active"),d.style.display=a.config.tooltip.items.display)}}},{key:"getValuesToPrint",value:function(o){var a=o.i,d=o.j,g=this.w,_=this.ctx.series.filteredSeriesX(),D="",C="",T=null,P=null,L={series:g.globals.series,seriesIndex:a,dataPointIndex:d,w:g},B=g.globals.ttZFormatter;null===d?P=g.globals.series[a]:g.globals.isXNumeric&&"treemap"!==g.config.chart.type?(D=_[a][d],0===_[a].length&&(D=_[this.tooltipUtil.getFirstActiveXArray(_)][d])):D=void 0!==g.globals.labels[d]?g.globals.labels[d]:"";var V=D;return D=g.globals.isXNumeric&&"datetime"===g.config.xaxis.type?new ho(this.ctx).xLabelFormat(g.globals.ttKeyFormatter,V,V,{i:void 0,dateFormatter:new mn(this.ctx).formatDate,w:this.w}):g.globals.isBarHorizontal?g.globals.yLabelFormatters[0](V,L):g.globals.xLabelFormatter(V,L),void 0!==g.config.tooltip.x.formatter&&(D=g.globals.ttKeyFormatter(V,L)),g.globals.seriesZ.length>0&&g.globals.seriesZ[a].length>0&&(T=B(g.globals.seriesZ[a][d],g)),C="function"==typeof g.config.xaxis.tooltip.formatter?g.globals.xaxisTooltipFormatter(V,L):D,{val:Array.isArray(P)?P.join(" "):P,xVal:Array.isArray(D)?D.join(" "):D,xAxisTTVal:Array.isArray(C)?C.join(" "):C,zVal:T}}},{key:"handleCustomTooltip",value:function(o){var a=o.i,d=o.j,g=o.y1,_=o.y2,D=o.w,C=this.ttCtx.getElTooltip(),T=D.config.tooltip.custom;Array.isArray(T)&&T[a]&&(T=T[a]),C.innerHTML=T({ctx:this.ctx,series:D.globals.series,seriesIndex:a,dataPointIndex:d,y1:g,y2:_,w:D})}}]),te}(),Ha=function(){function te(o){zt(this,te),this.ttCtx=o,this.ctx=o.ctx,this.w=o.w}return St(te,[{key:"moveXCrosshairs",value:function(o){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=this.ttCtx,g=this.w,_=d.getElXCrosshairs(),D=o-d.xcrosshairsWidth/2,C=g.globals.labels.slice().length;if(null!==a&&(D=g.globals.gridWidth/C*a),null!==_&&(_.setAttribute("x",D),_.setAttribute("x1",D),_.setAttribute("x2",D),_.setAttribute("y2",g.globals.gridHeight),_.classList.add("apexcharts-active")),D<0&&(D=0),D>g.globals.gridWidth&&(D=g.globals.gridWidth),d.blxaxisTooltip){var T=D;"tickWidth"!==g.config.xaxis.crosshairs.width&&"barWidth"!==g.config.xaxis.crosshairs.width||(T=D+d.xcrosshairsWidth/2),this.moveXAxisTooltip(T)}}},{key:"moveYCrosshairs",value:function(o){var a=this.ttCtx;null!==a.ycrosshairs&&yt.setAttrs(a.ycrosshairs,{y1:o,y2:o}),null!==a.ycrosshairsHidden&&yt.setAttrs(a.ycrosshairsHidden,{y1:o,y2:o})}},{key:"moveXAxisTooltip",value:function(o){var a=this.w,d=this.ttCtx;if(null!==d.xaxisTooltip){d.xaxisTooltip.classList.add("apexcharts-active");var _,g=d.xaxisOffY+a.config.xaxis.tooltip.offsetY+a.globals.translateY+1+a.config.xaxis.offsetY;o-=d.xaxisTooltip.getBoundingClientRect().width/2,isNaN(o)||(o+=a.globals.translateX,_=new yt(this.ctx).getTextRects(d.xaxisTooltipText.innerHTML),d.xaxisTooltipText.style.minWidth=_.width+"px",d.xaxisTooltip.style.left=o+"px",d.xaxisTooltip.style.top=g+"px")}}},{key:"moveYAxisTooltip",value:function(o){var a=this.w,d=this.ttCtx;null===d.yaxisTTEls&&(d.yaxisTTEls=a.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxistooltip"));var g=parseInt(d.ycrosshairsHidden.getAttribute("y1"),10),_=a.globals.translateY+g,D=d.yaxisTTEls[o].getBoundingClientRect().height,C=a.globals.translateYAxisX[o]-2;a.config.yaxis[o].opposite&&(C-=26),_-=D/2,-1===a.globals.ignoreYAxisIndexes.indexOf(o)?(d.yaxisTTEls[o].classList.add("apexcharts-active"),d.yaxisTTEls[o].style.top=_+"px",d.yaxisTTEls[o].style.left=C+a.config.yaxis[o].tooltip.offsetX+"px"):d.yaxisTTEls[o].classList.remove("apexcharts-active")}},{key:"moveTooltip",value:function(o,a){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,g=this.w,_=this.ttCtx,D=_.getElTooltip(),C=_.tooltipRect,T=null!==d?parseFloat(d):1,P=parseFloat(o)+T+5,L=parseFloat(a)+T/2;if(P>g.globals.gridWidth/2&&(P=P-C.ttWidth-T-15),P>g.globals.gridWidth-C.ttWidth-10&&(P=g.globals.gridWidth-C.ttWidth),P<-20&&(P=-20),g.config.tooltip.followCursor){var B=_.getElGrid(),V=B.getBoundingClientRect();L=_.e.clientY+g.globals.translateY-V.top-C.ttHeight/2}else g.globals.isBarHorizontal?L-=C.ttHeight:(C.ttHeight/2+L>g.globals.gridHeight&&(L=g.globals.gridHeight-C.ttHeight+g.globals.translateY),L<0&&(L=0));isNaN(P)||(D.style.left=(P+=g.globals.translateX)+"px",D.style.top=L+"px")}},{key:"moveMarkers",value:function(o,a){var d=this.w,g=this.ttCtx;if(d.globals.markers.size[o]>0)for(var _=d.globals.dom.baseEl.querySelectorAll(" .apexcharts-series[data\\:realIndex='".concat(o,"'] .apexcharts-marker")),D=0;D<_.length;D++)parseInt(_[D].getAttribute("rel"),10)===a&&(g.marker.resetPointsSize(),g.marker.enlargeCurrentPoint(a,_[D]));else g.marker.resetPointsSize(),this.moveDynamicPointOnHover(a,o)}},{key:"moveDynamicPointOnHover",value:function(o,a){var d,g,_=this.w,D=this.ttCtx,C=_.globals.pointsArray,T=D.tooltipUtil.getHoverMarkerSize(a),P=_.config.series[a].type;if(!P||"column"!==P&&"candlestick"!==P&&"boxPlot"!==P){d=C[a][o][0],g=C[a][o][1]?C[a][o][1]:0;var L=_.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(a,"'] .apexcharts-series-markers circle"));L&&g<_.globals.gridHeight&&g>0&&(L.setAttribute("r",T),L.setAttribute("cx",d),L.setAttribute("cy",g)),this.moveXCrosshairs(d),D.fixedTooltip||this.moveTooltip(d,g,T)}}},{key:"moveDynamicPointsOnHover",value:function(o){var a,d=this.ttCtx,g=d.w,_=0,D=0,C=g.globals.pointsArray;a=new Bi(this.ctx).getActiveConfigSeriesIndex(!0);var T=d.tooltipUtil.getHoverMarkerSize(a);C[a]&&(_=C[a][o][0],D=C[a][o][1]);var P=d.tooltipUtil.getAllMarkers();if(null!==P)for(var L=0;L<g.globals.series.length;L++){var B=C[L];if(g.globals.comboCharts&&void 0===B&&P.splice(L,0,null),B&&B.length){var V=C[L][o][1];P[L].setAttribute("cx",_),null!==V&&!isNaN(V)&&V<g.globals.gridHeight&&V>0?(P[L]&&P[L].setAttribute("r",T),P[L]&&P[L].setAttribute("cy",V)):P[L]&&P[L].setAttribute("r",0)}}this.moveXCrosshairs(_),d.fixedTooltip||this.moveTooltip(_,D||g.globals.gridHeight,T)}},{key:"moveStickyTooltipOverBars",value:function(o){var a=this.w,d=this.ttCtx,g=a.globals.columnSeries?a.globals.columnSeries.length:a.globals.series.length,_=g>=2&&g%2==0?Math.floor(g/2):Math.floor(g/2)+1;a.globals.isBarHorizontal&&(_=new Bi(this.ctx).getActiveConfigSeriesIndex(!1,"desc")+1);var D=a.globals.dom.baseEl.querySelector(".apexcharts-bar-series .apexcharts-series[rel='".concat(_,"'] path[j='").concat(o,"'], .apexcharts-candlestick-series .apexcharts-series[rel='").concat(_,"'] path[j='").concat(o,"'], .apexcharts-boxPlot-series .apexcharts-series[rel='").concat(_,"'] path[j='").concat(o,"'], .apexcharts-rangebar-series .apexcharts-series[rel='").concat(_,"'] path[j='").concat(o,"']")),C=D?parseFloat(D.getAttribute("cx")):0,T=D?parseFloat(D.getAttribute("cy")):0,P=D?parseFloat(D.getAttribute("barWidth")):0,L=D?parseFloat(D.getAttribute("barHeight")):0,B=d.getElGrid().getBoundingClientRect();a.globals.isXNumeric?(C-=g%2!=0?P/2:0,D&&(D.classList.contains("apexcharts-candlestick-area")||D.classList.contains("apexcharts-boxPlot-area"))&&a.globals.comboCharts&&(C-=P/2)):a.globals.isBarHorizontal||(C=d.xAxisTicksPositions[o-1]+d.dataPointsDividedWidth/2,isNaN(C)&&(C=d.xAxisTicksPositions[o]-d.dataPointsDividedWidth/2)),a.globals.isBarHorizontal?T+=L/3:T=d.e.clientY-B.top-d.tooltipRect.ttHeight/2,a.globals.isBarHorizontal||this.moveXCrosshairs(C),d.fixedTooltip||this.moveTooltip(C,T||a.globals.gridHeight)}}]),te}(),gl=function(){function te(o){zt(this,te),this.w=o.w,this.ttCtx=o,this.ctx=o.ctx,this.tooltipPosition=new Ha(o)}return St(te,[{key:"drawDynamicPoints",value:function(){var o=this.w,a=new yt(this.ctx),d=new uo(this.ctx),g=o.globals.dom.baseEl.querySelectorAll(".apexcharts-series");g=wn(g),o.config.chart.stacked&&g.sort(function(B,V){return parseFloat(B.getAttribute("data:realIndex"))-parseFloat(V.getAttribute("data:realIndex"))});for(var _=0;_<g.length;_++){var D=g[_].querySelector(".apexcharts-series-markers-wrap");if(null!==D){var C=void 0,T="apexcharts-marker w".concat((Math.random()+1).toString(36).substring(4));"line"!==o.config.chart.type&&"area"!==o.config.chart.type||o.globals.comboCharts||o.config.tooltip.intersect||(T+=" no-pointer-events");var P=d.getMarkerConfig({cssClass:T,seriesIndex:Number(D.getAttribute("data:realIndex"))});(C=a.drawMarker(0,0,P)).node.setAttribute("default-marker-size",0);var L=document.createElementNS(o.globals.SVGNS,"g");L.classList.add("apexcharts-series-markers"),L.appendChild(C.node),D.appendChild(L)}}}},{key:"enlargeCurrentPoint",value:function(o,a){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,_=this.w;"bubble"!==_.config.chart.type&&this.newPointSize(o,a);var D=a.getAttribute("cx"),C=a.getAttribute("cy");if(null!==d&&null!==g&&(D=d,C=g),this.tooltipPosition.moveXCrosshairs(D),!this.fixedTooltip){if("radar"===_.config.chart.type){var T=this.ttCtx.getElGrid(),P=T.getBoundingClientRect();D=this.ttCtx.e.clientX-P.left}this.tooltipPosition.moveTooltip(D,C,_.config.markers.hover.size)}}},{key:"enlargePoints",value:function(o){for(var a=this.w,d=this,g=this.ttCtx,_=o,D=a.globals.dom.baseEl.querySelectorAll(".apexcharts-series:not(.apexcharts-series-collapsed) .apexcharts-marker"),C=a.config.markers.hover.size,T=0;T<D.length;T++){var P=D[T].getAttribute("rel"),L=D[T].getAttribute("index");if(void 0===C&&(C=a.globals.markers.size[L]+a.config.markers.hover.sizeOffset),_===parseInt(P,10)){d.newPointSize(_,D[T]);var B=D[T].getAttribute("cx"),V=D[T].getAttribute("cy");d.tooltipPosition.moveXCrosshairs(B),g.fixedTooltip||d.tooltipPosition.moveTooltip(B,V,C)}else d.oldPointSize(D[T])}}},{key:"newPointSize",value:function(o,a){var d=this.w,g=d.config.markers.hover.size,_=0===o?a.parentNode.firstChild:a.parentNode.lastChild;if("0"!==_.getAttribute("default-marker-size")){var D=parseInt(_.getAttribute("index"),10);void 0===g&&(g=d.globals.markers.size[D]+d.config.markers.hover.sizeOffset),g<0&&(g=0),_.setAttribute("r",g)}}},{key:"oldPointSize",value:function(o){var a=parseFloat(o.getAttribute("default-marker-size"));o.setAttribute("r",a)}},{key:"resetPointsSize",value:function(){for(var o=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series:not(.apexcharts-series-collapsed) .apexcharts-marker"),a=0;a<o.length;a++){var d=parseFloat(o[a].getAttribute("default-marker-size"));Xe.isNumber(d)&&d>=0?o[a].setAttribute("r",d):o[a].setAttribute("r",0)}}}]),te}(),Lo=function(){function te(o){zt(this,te),this.w=o.w,this.ttCtx=o}return St(te,[{key:"getAttr",value:function(o,a){return parseFloat(o.target.getAttribute(a))}},{key:"handleHeatTreeTooltip",value:function(o){var a=o.e,d=o.opt,g=o.x,_=o.y,C=this.ttCtx,T=this.w;if(a.target.classList.contains("apexcharts-".concat(o.type,"-rect"))){var P=this.getAttr(a,"i"),L=this.getAttr(a,"j"),B=this.getAttr(a,"cx"),V=this.getAttr(a,"cy"),$=this.getAttr(a,"width"),q=this.getAttr(a,"height");if(C.tooltipLabels.drawSeriesTexts({ttItems:d.ttItems,i:P,j:L,shared:!1,e:a}),T.globals.capturedSeriesIndex=P,T.globals.capturedDataPointIndex=L,g=B+C.tooltipRect.ttWidth/2+$,_=V+C.tooltipRect.ttHeight/2-q/2,C.tooltipPosition.moveXCrosshairs(B+$/2),g>T.globals.gridWidth/2&&(g=B-C.tooltipRect.ttWidth/2+$),C.w.config.tooltip.followCursor){var K=T.globals.dom.elWrap.getBoundingClientRect();g=T.globals.clientX-K.left-C.tooltipRect.ttWidth/2,_=T.globals.clientY-K.top-C.tooltipRect.ttHeight-5}}return{x:g,y:_}}},{key:"handleMarkerTooltip",value:function(o){var a,d,g=o.e,_=o.opt,D=o.x,C=o.y,T=this.w,P=this.ttCtx;if(g.target.classList.contains("apexcharts-marker")){var L=parseInt(_.paths.getAttribute("cx"),10),B=parseInt(_.paths.getAttribute("cy"),10),V=parseFloat(_.paths.getAttribute("val"));if(d=parseInt(_.paths.getAttribute("rel"),10),a=parseInt(_.paths.parentNode.parentNode.parentNode.getAttribute("rel"),10)-1,P.intersect){var $=Xe.findAncestor(_.paths,"apexcharts-series");$&&(a=parseInt($.getAttribute("data:realIndex"),10))}if(P.tooltipLabels.drawSeriesTexts({ttItems:_.ttItems,i:a,j:d,shared:!P.showOnIntersect&&T.config.tooltip.shared,e:g}),"mouseup"===g.type&&P.markerClick(g,a,d),T.globals.capturedSeriesIndex=a,T.globals.capturedDataPointIndex=d,D=L,C=B+T.globals.translateY-1.4*P.tooltipRect.ttHeight,P.w.config.tooltip.followCursor){var q=P.getElGrid().getBoundingClientRect();C=P.e.clientY+T.globals.translateY-q.top}V<0&&(C=B),P.marker.enlargeCurrentPoint(d,_.paths,D,C)}return{x:D,y:C}}},{key:"handleBarTooltip",value:function(o){var a,d,g=o.e,_=o.opt,D=this.w,C=this.ttCtx,T=C.getElTooltip(),P=0,L=0,B=0,V=this.getBarTooltipXY({e:g,opt:_}),$=V.barHeight,q=V.j;D.globals.capturedSeriesIndex=a=V.i,D.globals.capturedDataPointIndex=q,D.globals.isBarHorizontal&&C.tooltipUtil.hasBars()||!D.config.tooltip.shared?(L=V.x,B=V.y,d=Array.isArray(D.config.stroke.width)?D.config.stroke.width[a]:D.config.stroke.width,P=L):D.globals.comboCharts||D.config.tooltip.shared||(P/=2),isNaN(B)?B=D.globals.svgHeight-C.tooltipRect.ttHeight:B<0&&(B=0);var K=parseInt(_.paths.parentNode.getAttribute("data:realIndex"),10),oe=D.globals.isMultipleYAxis?D.config.yaxis[K]&&D.config.yaxis[K].reversed:D.config.yaxis[0].reversed;if(L+C.tooltipRect.ttWidth>D.globals.gridWidth&&!oe?L-=C.tooltipRect.ttWidth:L<0&&(L=0),C.w.config.tooltip.followCursor){var ae=C.getElGrid().getBoundingClientRect();B=C.e.clientY-ae.top}null===C.tooltip&&(C.tooltip=D.globals.dom.baseEl.querySelector(".apexcharts-tooltip")),D.config.tooltip.shared||C.tooltipPosition.moveXCrosshairs(D.globals.comboBarCount>0?P+d/2:P),!C.fixedTooltip&&(!D.config.tooltip.shared||D.globals.isBarHorizontal&&C.tooltipUtil.hasBars())&&(oe&&(L-=C.tooltipRect.ttWidth)<0&&(L=0),T.style.left=L+D.globals.translateX+"px",!oe||D.globals.isBarHorizontal&&C.tooltipUtil.hasBars()||(B=B+$-2*(D.globals.series[a][q]<0?$:0)),T.style.top=C.tooltipRect.ttHeight+B>D.globals.gridHeight?(B=D.globals.gridHeight-C.tooltipRect.ttHeight+D.globals.translateY)+"px":B+D.globals.translateY-C.tooltipRect.ttHeight/2+"px")}},{key:"getBarTooltipXY",value:function(o){var a=o.e,d=o.opt,g=this.w,_=null,D=this.ttCtx,C=0,T=0,P=0,L=0,B=0,V=a.target.classList;if(V.contains("apexcharts-bar-area")||V.contains("apexcharts-candlestick-area")||V.contains("apexcharts-boxPlot-area")||V.contains("apexcharts-rangebar-area")){var $=a.target,q=$.getBoundingClientRect(),K=d.elGrid.getBoundingClientRect(),oe=q.height;B=q.height;var ae=q.width,fe=parseInt($.getAttribute("cx"),10),ge=parseInt($.getAttribute("cy"),10);L=parseFloat($.getAttribute("barWidth"));var R="touchmove"===a.type?a.touches[0].clientX:a.clientX;_=parseInt($.getAttribute("j"),10),C=parseInt($.parentNode.getAttribute("rel"),10)-1;var H=$.getAttribute("data-range-y1"),Q=$.getAttribute("data-range-y2");g.globals.comboCharts&&(C=parseInt($.parentNode.getAttribute("data:realIndex"),10)),D.tooltipLabels.drawSeriesTexts({ttItems:d.ttItems,i:C,j:_,y1:H?parseInt(H,10):null,y2:Q?parseInt(Q,10):null,shared:!D.showOnIntersect&&g.config.tooltip.shared,e:a}),g.config.tooltip.followCursor?g.globals.isBarHorizontal?(T=R-K.left+15,P=ge-D.dataPointsDividedHeight+oe/2-D.tooltipRect.ttHeight/2):(T=g.globals.isXNumeric?fe-ae/2:fe-D.dataPointsDividedWidth+ae/2,P=a.clientY-K.top-D.tooltipRect.ttHeight/2-15):g.globals.isBarHorizontal?((T=fe)<D.xyRatios.baseLineInvertedY&&(T=fe-D.tooltipRect.ttWidth),P=ge-D.dataPointsDividedHeight+oe/2-D.tooltipRect.ttHeight/2):(T=g.globals.isXNumeric?fe-ae/2:fe-D.dataPointsDividedWidth+ae/2,P=ge)}return{x:T,y:P,barHeight:B,barWidth:L,i:C,j:_}}}]),te}(),ml=function(){function te(o){zt(this,te),this.w=o.w,this.ttCtx=o}return St(te,[{key:"drawXaxisTooltip",value:function(){var o=this.w,a=this.ttCtx,d="bottom"===o.config.xaxis.position;a.xaxisOffY=d?o.globals.gridHeight+1:-o.globals.xAxisHeight-o.config.xaxis.axisTicks.height+3;var g=d?"apexcharts-xaxistooltip apexcharts-xaxistooltip-bottom":"apexcharts-xaxistooltip apexcharts-xaxistooltip-top",_=o.globals.dom.elWrap;a.blxaxisTooltip&&null===o.globals.dom.baseEl.querySelector(".apexcharts-xaxistooltip")&&(a.xaxisTooltip=document.createElement("div"),a.xaxisTooltip.setAttribute("class",g+" apexcharts-theme-"+o.config.tooltip.theme),_.appendChild(a.xaxisTooltip),a.xaxisTooltipText=document.createElement("div"),a.xaxisTooltipText.classList.add("apexcharts-xaxistooltip-text"),a.xaxisTooltipText.style.fontFamily=o.config.xaxis.tooltip.style.fontFamily||o.config.chart.fontFamily,a.xaxisTooltipText.style.fontSize=o.config.xaxis.tooltip.style.fontSize,a.xaxisTooltip.appendChild(a.xaxisTooltipText))}},{key:"drawYaxisTooltip",value:function(){for(var o=this.w,a=this.ttCtx,d=function(_){var D=o.config.yaxis[_].opposite||o.config.yaxis[_].crosshairs.opposite;a.yaxisOffX=D?o.globals.gridWidth+1:1;var C="apexcharts-yaxistooltip apexcharts-yaxistooltip-".concat(_,D?" apexcharts-yaxistooltip-right":" apexcharts-yaxistooltip-left");o.globals.yAxisSameScaleIndices.map(function(P,L){P.map(function(B,V){V===_&&(C+=o.config.yaxis[V].show?" ":" apexcharts-yaxistooltip-hidden")})});var T=o.globals.dom.elWrap;null===o.globals.dom.baseEl.querySelector(".apexcharts-yaxistooltip apexcharts-yaxistooltip-".concat(_))&&(a.yaxisTooltip=document.createElement("div"),a.yaxisTooltip.setAttribute("class",C+" apexcharts-theme-"+o.config.tooltip.theme),T.appendChild(a.yaxisTooltip),0===_&&(a.yaxisTooltipText=[]),a.yaxisTooltipText[_]=document.createElement("div"),a.yaxisTooltipText[_].classList.add("apexcharts-yaxistooltip-text"),a.yaxisTooltip.appendChild(a.yaxisTooltipText[_]))},g=0;g<o.config.yaxis.length;g++)d(g)}},{key:"setXCrosshairWidth",value:function(){var o=this.w,a=this.ttCtx,d=a.getElXCrosshairs();if(a.xcrosshairsWidth=parseInt(o.config.xaxis.crosshairs.width,10),o.globals.comboCharts){var g=o.globals.dom.baseEl.querySelector(".apexcharts-bar-area");if(null!==g&&"barWidth"===o.config.xaxis.crosshairs.width){var _=parseFloat(g.getAttribute("barWidth"));a.xcrosshairsWidth=_}else"tickWidth"===o.config.xaxis.crosshairs.width&&(a.xcrosshairsWidth=o.globals.gridWidth/o.globals.labels.length)}else if("tickWidth"===o.config.xaxis.crosshairs.width)a.xcrosshairsWidth=o.globals.gridWidth/o.globals.labels.length;else if("barWidth"===o.config.xaxis.crosshairs.width){var T=o.globals.dom.baseEl.querySelector(".apexcharts-bar-area");if(null!==T){var P=parseFloat(T.getAttribute("barWidth"));a.xcrosshairsWidth=P}else a.xcrosshairsWidth=1}o.globals.isBarHorizontal&&(a.xcrosshairsWidth=0),null!==d&&a.xcrosshairsWidth>0&&d.setAttribute("width",a.xcrosshairsWidth)}},{key:"handleYCrosshair",value:function(){var o=this.w,a=this.ttCtx;a.ycrosshairs=o.globals.dom.baseEl.querySelector(".apexcharts-ycrosshairs"),a.ycrosshairsHidden=o.globals.dom.baseEl.querySelector(".apexcharts-ycrosshairs-hidden")}},{key:"drawYaxisTooltipText",value:function(o,a,d){var g=this.ttCtx,_=this.w,D=_.globals.yLabelFormatters[o];if(g.yaxisTooltips[o]){var C=g.getElGrid().getBoundingClientRect(),L=_.globals.minYArr[o]+(_.globals.maxYArr[o]-_.globals.minYArr[o]-(a-C.top)*d.yRatio[o]);g.tooltipPosition.moveYCrosshairs(a-C.top),g.yaxisTooltipText[o].innerHTML=D(L),g.tooltipPosition.moveYAxisTooltip(o)}}}]),te}(),us=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w;var a=this.w;this.tConfig=a.config.tooltip,this.tooltipUtil=new Oo(this),this.tooltipLabels=new dc(this),this.tooltipPosition=new Ha(this),this.marker=new gl(this),this.intersect=new Lo(this),this.axesTooltip=new ml(this),this.showOnIntersect=this.tConfig.intersect,this.showTooltipTitle=this.tConfig.x.show,this.fixedTooltip=this.tConfig.fixed.enabled,this.xaxisTooltip=null,this.yaxisTTEls=null,this.isBarShared=!a.globals.isBarHorizontal&&this.tConfig.shared,this.lastHoverTime=Date.now()}return St(te,[{key:"getElTooltip",value:function(o){return o||(o=this),o.w.globals.dom.baseEl.querySelector(".apexcharts-tooltip")}},{key:"getElXCrosshairs",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-xcrosshairs")}},{key:"getElGrid",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-grid")}},{key:"drawTooltip",value:function(o){var a=this.w;this.xyRatios=o,this.blxaxisTooltip=a.config.xaxis.tooltip.enabled&&a.globals.axisCharts,this.yaxisTooltips=a.config.yaxis.map(function(D,C){return!!(D.show&&D.tooltip.enabled&&a.globals.axisCharts)}),this.allTooltipSeriesGroups=[],a.globals.axisCharts||(this.showTooltipTitle=!1);var d=document.createElement("div");if(d.classList.add("apexcharts-tooltip"),d.classList.add("apexcharts-theme-".concat(this.tConfig.theme)),a.globals.dom.elWrap.appendChild(d),a.globals.axisCharts){this.axesTooltip.drawXaxisTooltip(),this.axesTooltip.drawYaxisTooltip(),this.axesTooltip.setXCrosshairWidth(),this.axesTooltip.handleYCrosshair();var g=new po(this.ctx);this.xAxisTicksPositions=g.getXAxisTicksPositions()}if(!a.globals.comboCharts&&!this.tConfig.intersect&&"rangeBar"!==a.config.chart.type||this.tConfig.shared||(this.showOnIntersect=!0),0!==a.config.markers.size&&0!==a.globals.markers.largestSize||this.marker.drawDynamicPoints(this),a.globals.collapsedSeries.length!==a.globals.series.length){this.dataPointsDividedHeight=a.globals.gridHeight/a.globals.dataPoints,this.dataPointsDividedWidth=a.globals.gridWidth/a.globals.dataPoints,this.showTooltipTitle&&(this.tooltipTitle=document.createElement("div"),this.tooltipTitle.classList.add("apexcharts-tooltip-title"),this.tooltipTitle.style.fontFamily=this.tConfig.style.fontFamily||a.config.chart.fontFamily,this.tooltipTitle.style.fontSize=this.tConfig.style.fontSize,d.appendChild(this.tooltipTitle));var _=a.globals.series.length;(a.globals.xyCharts||a.globals.comboCharts)&&this.tConfig.shared&&(_=this.showOnIntersect?1:a.globals.series.length),this.legendLabels=a.globals.dom.baseEl.querySelectorAll(".apexcharts-legend-text"),this.ttItems=this.createTTElements(_),this.addSVGEvents()}}},{key:"createTTElements",value:function(o){for(var a=this,d=this.w,g=[],_=this.getElTooltip(),D=function(T){var P=document.createElement("div");P.classList.add("apexcharts-tooltip-series-group"),P.style.order=d.config.tooltip.inverseOrder?o-T:T+1,a.tConfig.shared&&a.tConfig.enabledOnSeries&&Array.isArray(a.tConfig.enabledOnSeries)&&a.tConfig.enabledOnSeries.indexOf(T)<0&&P.classList.add("apexcharts-tooltip-series-group-hidden");var L=document.createElement("span");L.classList.add("apexcharts-tooltip-marker"),L.style.backgroundColor=d.globals.colors[T],P.appendChild(L);var B=document.createElement("div");B.classList.add("apexcharts-tooltip-text"),B.style.fontFamily=a.tConfig.style.fontFamily||d.config.chart.fontFamily,B.style.fontSize=a.tConfig.style.fontSize,["y","goals","z"].forEach(function(V){var $=document.createElement("div");$.classList.add("apexcharts-tooltip-".concat(V,"-group"));var q=document.createElement("span");q.classList.add("apexcharts-tooltip-text-".concat(V,"-label")),$.appendChild(q);var K=document.createElement("span");K.classList.add("apexcharts-tooltip-text-".concat(V,"-value")),$.appendChild(K),B.appendChild($)}),P.appendChild(B),_.appendChild(P),g.push(P)},C=0;C<o;C++)D(C);return g}},{key:"addSVGEvents",value:function(){var o=this.w,a=o.config.chart.type,d=this.getElTooltip(),g=!("bar"!==a&&"candlestick"!==a&&"boxPlot"!==a&&"rangeBar"!==a),_="area"===a||"line"===a||"scatter"===a||"bubble"===a||"radar"===a,D=o.globals.dom.Paper.node,C=this.getElGrid();C&&(this.seriesBound=C.getBoundingClientRect());var T,P=[],L=[],B={hoverArea:D,elGrid:C,tooltipEl:d,tooltipY:P,tooltipX:L,ttItems:this.ttItems};if(o.globals.axisCharts&&(_?T=o.globals.dom.baseEl.querySelectorAll(".apexcharts-series[data\\:longestSeries='true'] .apexcharts-marker"):g?T=o.globals.dom.baseEl.querySelectorAll(".apexcharts-series .apexcharts-bar-area, .apexcharts-series .apexcharts-candlestick-area, .apexcharts-series .apexcharts-boxPlot-area, .apexcharts-series .apexcharts-rangebar-area"):"heatmap"!==a&&"treemap"!==a||(T=o.globals.dom.baseEl.querySelectorAll(".apexcharts-series .apexcharts-heatmap, .apexcharts-series .apexcharts-treemap")),T&&T.length))for(var V=0;V<T.length;V++)P.push(T[V].getAttribute("cy")),L.push(T[V].getAttribute("cx"));if(o.globals.xyCharts&&!this.showOnIntersect||o.globals.comboCharts&&!this.showOnIntersect||g&&this.tooltipUtil.hasBars()&&this.tConfig.shared)this.addPathsEventListeners([D],B);else if(g&&!o.globals.comboCharts||_&&this.showOnIntersect)this.addDatapointEventsListeners(B);else if(!o.globals.axisCharts||"heatmap"===a||"treemap"===a){var $=o.globals.dom.baseEl.querySelectorAll(".apexcharts-series");this.addPathsEventListeners($,B)}if(this.showOnIntersect){var q=o.globals.dom.baseEl.querySelectorAll(".apexcharts-line-series .apexcharts-marker, .apexcharts-area-series .apexcharts-marker");q.length>0&&this.addPathsEventListeners(q,B),this.tooltipUtil.hasBars()&&!this.tConfig.shared&&this.addDatapointEventsListeners(B)}}},{key:"drawFixedTooltipRect",value:function(){var o=this.w,a=this.getElTooltip(),d=a.getBoundingClientRect(),g=d.width+10,_=d.height+10,D=this.tConfig.fixed.offsetX,C=this.tConfig.fixed.offsetY,T=this.tConfig.fixed.position.toLowerCase();return T.indexOf("right")>-1&&(D=D+o.globals.svgWidth-g+10),T.indexOf("bottom")>-1&&(C=C+o.globals.svgHeight-_-10),a.style.left=D+"px",a.style.top=C+"px",{x:D,y:C,ttWidth:g,ttHeight:_}}},{key:"addDatapointEventsListeners",value:function(o){var a=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers .apexcharts-marker, .apexcharts-bar-area, .apexcharts-candlestick-area, .apexcharts-boxPlot-area, .apexcharts-rangebar-area");this.addPathsEventListeners(a,o)}},{key:"addPathsEventListeners",value:function(o,a){for(var d=this,g=function(D){var C={paths:o[D],tooltipEl:a.tooltipEl,tooltipY:a.tooltipY,tooltipX:a.tooltipX,elGrid:a.elGrid,hoverArea:a.hoverArea,ttItems:a.ttItems};["mousemove","mouseup","touchmove","mouseout","touchend"].map(function(T){return o[D].addEventListener(T,d.onSeriesHover.bind(d,C),{capture:!1,passive:!0})})},_=0;_<o.length;_++)g(_)}},{key:"onSeriesHover",value:function(o,a){var d=this,g=Date.now()-this.lastHoverTime;g>=100?this.seriesHover(o,a):(clearTimeout(this.seriesHoverTimeout),this.seriesHoverTimeout=setTimeout(function(){d.seriesHover(o,a)},100-g))}},{key:"seriesHover",value:function(o,a){var d=this;this.lastHoverTime=Date.now();var g=[],_=this.w;_.config.chart.group&&(g=this.ctx.getGroupedCharts()),_.globals.axisCharts&&(_.globals.minX===-1/0&&_.globals.maxX===1/0||0===_.globals.dataPoints)||(g.length?g.forEach(function(D){var C=d.getElTooltip(D);D.w.globals.minX===d.w.globals.minX&&D.w.globals.maxX===d.w.globals.maxX&&D.w.globals.tooltip.seriesHoverByContext({chartCtx:D,ttCtx:D.w.globals.tooltip,opt:{paths:o.paths,tooltipEl:C,tooltipY:o.tooltipY,tooltipX:o.tooltipX,elGrid:o.elGrid,hoverArea:o.hoverArea,ttItems:D.w.globals.tooltip.ttItems},e:a})}):this.seriesHoverByContext({chartCtx:this.ctx,ttCtx:this.w.globals.tooltip,opt:o,e:a}))}},{key:"seriesHoverByContext",value:function(o){var a=o.chartCtx,d=o.ttCtx,g=o.opt,_=o.e,D=a.w,C=this.getElTooltip();d.tooltipRect={x:0,y:0,ttWidth:C.getBoundingClientRect().width,ttHeight:C.getBoundingClientRect().height},d.e=_,!d.tooltipUtil.hasBars()||D.globals.comboCharts||d.isBarShared||this.tConfig.onDatasetHover.highlightDataSeries&&new Bi(a).toggleSeriesOnHover(_,_.target.parentNode),d.fixedTooltip&&d.drawFixedTooltipRect(),D.globals.axisCharts?d.axisChartsTooltips({e:_,opt:g,tooltipRect:d.tooltipRect}):d.nonAxisChartsTooltips({e:_,opt:g,tooltipRect:d.tooltipRect})}},{key:"axisChartsTooltips",value:function(o){var a,d,g=o.e,_=o.opt,D=this.w,C=_.elGrid.getBoundingClientRect(),T="touchmove"===g.type?g.touches[0].clientX:g.clientX,P="touchmove"===g.type?g.touches[0].clientY:g.clientY;if(this.clientY=P,this.clientX=T,D.globals.capturedSeriesIndex=-1,D.globals.capturedDataPointIndex=-1,P<C.top||P>C.top+C.height)this.handleMouseOut(_);else{if(Array.isArray(this.tConfig.enabledOnSeries)&&!D.config.tooltip.shared){var L=parseInt(_.paths.getAttribute("index"),10);if(this.tConfig.enabledOnSeries.indexOf(L)<0)return void this.handleMouseOut(_)}var B=this.getElTooltip(),V=this.getElXCrosshairs(),$=D.globals.xyCharts||"bar"===D.config.chart.type&&!D.globals.isBarHorizontal&&this.tooltipUtil.hasBars()&&this.tConfig.shared||D.globals.comboCharts&&this.tooltipUtil.hasBars();if("mousemove"===g.type||"touchmove"===g.type||"mouseup"===g.type){null!==V&&V.classList.add("apexcharts-active");var q=this.yaxisTooltips.filter(function(ae){return!0===ae});if(null!==this.ycrosshairs&&q.length&&this.ycrosshairs.classList.add("apexcharts-active"),$&&!this.showOnIntersect)this.handleStickyTooltip(g,T,P,_);else if("heatmap"===D.config.chart.type||"treemap"===D.config.chart.type){var K=this.intersect.handleHeatTreeTooltip({e:g,opt:_,x:a,y:d,type:D.config.chart.type});d=K.y,B.style.left=(a=K.x)+"px",B.style.top=d+"px"}else this.tooltipUtil.hasBars()&&this.intersect.handleBarTooltip({e:g,opt:_}),this.tooltipUtil.hasMarkers()&&this.intersect.handleMarkerTooltip({e:g,opt:_,x:a,y:d});if(this.yaxisTooltips.length)for(var oe=0;oe<D.config.yaxis.length;oe++)this.axesTooltip.drawYaxisTooltipText(oe,P,this.xyRatios);_.tooltipEl.classList.add("apexcharts-active")}else"mouseout"!==g.type&&"touchend"!==g.type||this.handleMouseOut(_)}}},{key:"nonAxisChartsTooltips",value:function(o){var a=o.e,d=o.opt,g=o.tooltipRect,_=this.w,D=d.paths.getAttribute("rel"),C=this.getElTooltip(),T=_.globals.dom.elWrap.getBoundingClientRect();if("mousemove"===a.type||"touchmove"===a.type){C.classList.add("apexcharts-active"),this.tooltipLabels.drawSeriesTexts({ttItems:d.ttItems,i:parseInt(D,10)-1,shared:!1});var L=_.globals.clientY-T.top-g.ttHeight-10;if(C.style.left=_.globals.clientX-T.left-g.ttWidth/2+"px",C.style.top=L+"px",_.config.legend.tooltipHoverFormatter){var B=D-1,V=(0,_.config.legend.tooltipHoverFormatter)(this.legendLabels[B].getAttribute("data:default-text"),{seriesIndex:B,dataPointIndex:B,w:_});this.legendLabels[B].innerHTML=V}}else"mouseout"!==a.type&&"touchend"!==a.type||(C.classList.remove("apexcharts-active"),_.config.legend.tooltipHoverFormatter&&this.legendLabels.forEach(function($){var q=$.getAttribute("data:default-text");$.innerHTML=decodeURIComponent(q)}))}},{key:"handleStickyTooltip",value:function(o,a,d,g){var _=this.w,D=this.tooltipUtil.getNearestValues({context:this,hoverArea:g.hoverArea,elGrid:g.elGrid,clientX:a,clientY:d}),C=D.j,T=D.capturedSeries,P=g.elGrid.getBoundingClientRect();D.hoverX<0||D.hoverX>P.width?this.handleMouseOut(g):null!==T?this.handleStickyCapturedSeries(o,T,g,C):(this.tooltipUtil.isXoverlap(C)||_.globals.isBarHorizontal)&&this.create(o,this,0,C,g.ttItems)}},{key:"handleStickyCapturedSeries",value:function(o,a,d,g){var _=this.w;this.tConfig.shared||null!==_.globals.series[a][g]?void 0!==_.globals.series[a][g]?this.tConfig.shared&&this.tooltipUtil.isXoverlap(g)&&this.tooltipUtil.isInitialSeriesSameLen()?this.create(o,this,a,g,d.ttItems):this.create(o,this,a,g,d.ttItems,!1):this.tooltipUtil.isXoverlap(g)&&this.create(o,this,0,g,d.ttItems):this.handleMouseOut(d)}},{key:"deactivateHoverFilter",value:function(){for(var o=this.w,a=new yt(this.ctx),d=o.globals.dom.Paper.select(".apexcharts-bar-area"),g=0;g<d.length;g++)a.pathMouseLeave(d[g])}},{key:"handleMouseOut",value:function(o){var a=this.w,d=this.getElXCrosshairs();if(o.tooltipEl.classList.remove("apexcharts-active"),this.deactivateHoverFilter(),"bubble"!==a.config.chart.type&&this.marker.resetPointsSize(),null!==d&&d.classList.remove("apexcharts-active"),null!==this.ycrosshairs&&this.ycrosshairs.classList.remove("apexcharts-active"),this.blxaxisTooltip&&this.xaxisTooltip.classList.remove("apexcharts-active"),this.yaxisTooltips.length){null===this.yaxisTTEls&&(this.yaxisTTEls=a.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxistooltip"));for(var g=0;g<this.yaxisTTEls.length;g++)this.yaxisTTEls[g].classList.remove("apexcharts-active")}a.config.legend.tooltipHoverFormatter&&this.legendLabels.forEach(function(_){var D=_.getAttribute("data:default-text");_.innerHTML=decodeURIComponent(D)})}},{key:"markerClick",value:function(o,a,d){var g=this.w;"function"==typeof g.config.chart.events.markerClick&&g.config.chart.events.markerClick(o,this.ctx,{seriesIndex:a,dataPointIndex:d,w:g}),this.ctx.events.fireEvent("markerClick",[o,this.ctx,{seriesIndex:a,dataPointIndex:d,w:g}])}},{key:"create",value:function(o,a,d,g,_){var D=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,C=this.w,T=a;"mouseup"===o.type&&this.markerClick(o,d,g),null===D&&(D=this.tConfig.shared);var P=this.tooltipUtil.hasMarkers(),L=this.tooltipUtil.getElBars();if(C.config.legend.tooltipHoverFormatter){var B=C.config.legend.tooltipHoverFormatter,V=Array.from(this.legendLabels);V.forEach(function(H){var Q=H.getAttribute("data:default-text");H.innerHTML=decodeURIComponent(Q)});for(var $=0;$<V.length;$++){var q=V[$],K=parseInt(q.getAttribute("i"),10),oe=decodeURIComponent(q.getAttribute("data:default-text")),ae=B(oe,{seriesIndex:D?K:d,dataPointIndex:g,w:C});if(D)q.innerHTML=C.globals.collapsedSeriesIndices.indexOf(K)<0?ae:oe;else if(q.innerHTML=K===d?ae:oe,d===K)break}}if(D){if(T.tooltipLabels.drawSeriesTexts({ttItems:_,i:d,j:g,shared:!this.showOnIntersect&&this.tConfig.shared}),P&&(C.globals.markers.largestSize>0?T.marker.enlargePoints(g):T.tooltipPosition.moveDynamicPointsOnHover(g)),this.tooltipUtil.hasBars()&&(this.barSeriesHeight=this.tooltipUtil.getBarsHeight(L),this.barSeriesHeight>0)){var fe=new yt(this.ctx),ge=C.globals.dom.Paper.select(".apexcharts-bar-area[j='".concat(g,"']"));this.deactivateHoverFilter(),this.tooltipPosition.moveStickyTooltipOverBars(g);for(var R=0;R<ge.length;R++)fe.pathMouseEnter(ge[R])}}else T.tooltipLabels.drawSeriesTexts({shared:!1,ttItems:_,i:d,j:g}),this.tooltipUtil.hasBars()&&T.tooltipPosition.moveStickyTooltipOverBars(g),P&&T.tooltipPosition.moveMarkers(d,g)}}]),te}(),zo=function(te){ht(a,Dn);var o=co(a);function a(){return zt(this,a),o.apply(this,arguments)}return St(a,[{key:"draw",value:function(d,g){var _=this,D=this.w;this.graphics=new yt(this.ctx),this.bar=new Dn(this.ctx,this.xyRatios);var C=new fi(this.ctx,D);d=C.getLogSeries(d),this.yRatio=C.getLogYRatios(this.yRatio),this.barHelpers.initVariables(d),"100%"===D.config.chart.stackType&&(d=D.globals.seriesPercent.slice()),this.series=d,this.totalItems=0,this.prevY=[],this.prevX=[],this.prevYF=[],this.prevXF=[],this.prevYVal=[],this.prevXVal=[],this.xArrj=[],this.xArrjF=[],this.xArrjVal=[],this.yArrj=[],this.yArrjF=[],this.yArrjVal=[];for(var T=0;T<d.length;T++)d[T].length>0&&(this.totalItems+=d[T].length);for(var P=this.graphics.group({class:"apexcharts-bar-series apexcharts-plot-series"}),L=0,B=0,V=function(K,oe){var ae=void 0,fe=void 0,ge=void 0,R=void 0,H=[],Q=[],le=D.globals.comboCharts?g[K]:K;_.yRatio.length>1&&(_.yaxisIndex=le),_.isReversed=D.config.yaxis[_.yaxisIndex]&&D.config.yaxis[_.yaxisIndex].reversed;var Re=_.graphics.group({class:"apexcharts-series",seriesName:Xe.escapeString(D.globals.seriesNames[le]),rel:K+1,"data:realIndex":le});_.ctx.series.addCollapsedClassToSeries(Re,le);var tt=_.graphics.group({class:"apexcharts-datalabels","data:realIndex":le}),Ve=0,Dt=0,pt=_.initialPositions(L,B,ae,fe,ge,R);B=pt.y,Ve=pt.barHeight,fe=pt.yDivision,R=pt.zeroW,L=pt.x,Dt=pt.barWidth,ae=pt.xDivision,ge=pt.zeroH,_.yArrj=[],_.yArrjF=[],_.yArrjVal=[],_.xArrj=[],_.xArrjF=[],_.xArrjVal=[],1===_.prevY.length&&_.prevY[0].every(function(sr){return isNaN(sr)})&&(_.prevY[0]=_.prevY[0].map(function(sr){return ge}),_.prevYF[0]=_.prevYF[0].map(function(sr){return 0}));for(var qe=0;qe<D.globals.dataPoints;qe++){var Vt=_.barHelpers.getStrokeWidth(K,qe,le),Yn={indexes:{i:K,j:qe,realIndex:le,bc:oe},strokeWidth:Vt,x:L,y:B,elSeries:Re},pn=null;_.isHorizontal?(pn=_.drawStackedBarPaths(Je(Je({},Yn),{},{zeroW:R,barHeight:Ve,yDivision:fe})),Dt=_.series[K][qe]/_.invertedYRatio):(pn=_.drawStackedColumnPaths(Je(Je({},Yn),{},{xDivision:ae,barWidth:Dt,zeroH:ge})),Ve=_.series[K][qe]/_.yRatio[_.yaxisIndex]),B=pn.y,H.push(L=pn.x),Q.push(B);var xi=_.barHelpers.getPathFillColor(d,K,qe,le);Re=_.renderSeries({realIndex:le,pathFill:xi,j:qe,i:K,pathFrom:pn.pathFrom,pathTo:pn.pathTo,strokeWidth:Vt,elSeries:Re,x:L,y:B,series:d,barHeight:Ve,barWidth:Dt,elDataLabelsWrap:tt,type:"bar",visibleSeries:0})}D.globals.seriesXvalues[le]=H,D.globals.seriesYvalues[le]=Q,_.prevY.push(_.yArrj),_.prevYF.push(_.yArrjF),_.prevYVal.push(_.yArrjVal),_.prevX.push(_.xArrj),_.prevXF.push(_.xArrjF),_.prevXVal.push(_.xArrjVal),P.add(Re)},$=0,q=0;$<d.length;$++,q++)V($,q);return P}},{key:"initialPositions",value:function(d,g,_,D,C,T){var P,L,B=this.w;return this.isHorizontal?(P=(P=D=B.globals.gridHeight/B.globals.dataPoints)*parseInt(B.config.plotOptions.bar.barHeight,10)/100,T=this.baseLineInvertedY+B.globals.padHorizontal+(this.isReversed?B.globals.gridWidth:0)-(this.isReversed?2*this.baseLineInvertedY:0),g=(D-P)/2):(L=_=B.globals.gridWidth/B.globals.dataPoints,L=B.globals.isXNumeric&&B.globals.dataPoints>1?(_=B.globals.minXDiff/this.xRatio)*parseInt(this.barOptions.columnWidth,10)/100:L*parseInt(B.config.plotOptions.bar.columnWidth,10)/100,C=this.baseLineY[this.yaxisIndex]+(this.isReversed?B.globals.gridHeight:0)-(this.isReversed?2*this.baseLineY[this.yaxisIndex]:0),d=B.globals.padHorizontal+(_-L)/2),{x:d,y:g,yDivision:D,xDivision:_,barHeight:P,barWidth:L,zeroH:C,zeroW:T}}},{key:"drawStackedBarPaths",value:function(d){for(var g,P,_=d.indexes,D=d.barHeight,C=d.strokeWidth,T=d.zeroW,L=d.y,B=d.yDivision,V=d.elSeries,$=this.w,q=L,K=_.i,oe=_.j,ae=0,fe=0;fe<this.prevXF.length;fe++)ae+=this.prevXF[fe][oe];if(K>0){var ge=T;this.prevXVal[K-1][oe]<0?ge=this.series[K][oe]>=0?this.prevX[K-1][oe]+ae-2*(this.isReversed?ae:0):this.prevX[K-1][oe]:this.prevXVal[K-1][oe]>=0&&(ge=this.series[K][oe]>=0?this.prevX[K-1][oe]:this.prevX[K-1][oe]-ae+2*(this.isReversed?ae:0)),g=ge}else g=T;var R=this.barHelpers.getBarpaths({barYPosition:q,barHeight:D,x1:g,x2:P=null===this.series[K][oe]?g:g+this.series[K][oe]/this.invertedYRatio-2*(this.isReversed?this.series[K][oe]/this.invertedYRatio:0),strokeWidth:C,series:this.series,realIndex:_.realIndex,i:K,j:oe,w:$});return this.barHelpers.barBackground({j:oe,i:K,y1:q,y2:D,elSeries:V}),{pathTo:R.pathTo,pathFrom:R.pathFrom,x:P,y:L+=B}}},{key:"drawStackedColumnPaths",value:function(d){var D,g=d.indexes,_=d.x,C=d.xDivision,T=d.barWidth,P=d.zeroH,L=d.elSeries,B=this.w,V=g.i,$=g.j,q=g.bc;if(B.globals.isXNumeric){var K=B.globals.seriesX[V][$];K||(K=0),_=(K-B.globals.minX)/this.xRatio-T/2}for(var oe,ae=_,fe=0,ge=0;ge<this.prevYF.length;ge++)fe+=isNaN(this.prevYF[ge][$])?0:this.prevYF[ge][$];if(V>0&&!B.globals.isXNumeric||V>0&&B.globals.isXNumeric&&B.globals.seriesX[V-1][$]===B.globals.seriesX[V][$]){var R,H,Q=Math.min(this.yRatio.length+1,V+1);if(void 0!==this.prevY[V-1])for(var le=1;le<Q;le++)if(!isNaN(this.prevY[V-le][$])){H=this.prevY[V-le][$];break}for(var Re=1;Re<Q;Re++){if(this.prevYVal[V-Re][$]<0){R=this.series[V][$]>=0?H-fe+2*(this.isReversed?fe:0):H;break}if(this.prevYVal[V-Re][$]>=0){R=this.series[V][$]>=0?H:H+fe-2*(this.isReversed?fe:0);break}}void 0===R&&(R=B.globals.gridHeight),oe=this.prevYF[0].every(function(Ve){return 0===Ve})&&this.prevYF.slice(1,V).every(function(Ve){return Ve.every(function(Dt){return isNaN(Dt)})})?B.globals.gridHeight-P:R}else oe=B.globals.gridHeight-P;var tt=this.barHelpers.getColumnPaths({barXPosition:ae,barWidth:T,y1:oe,y2:D=oe-this.series[V][$]/this.yRatio[this.yaxisIndex]+2*(this.isReversed?this.series[V][$]/this.yRatio[this.yaxisIndex]:0),yRatio:this.yRatio[this.yaxisIndex],strokeWidth:this.strokeWidth,series:this.series,realIndex:g.realIndex,i:V,j:$,w:B});return this.barHelpers.barBackground({bc:q,j:$,i:V,x1:ae,x2:T,elSeries:L}),_+=C,{pathTo:tt.pathTo,pathFrom:tt.pathFrom,x:B.globals.isXNumeric?_-C:_,y:D}}}]),a}(),wa=function(te){ht(a,Dn);var o=co(a);function a(){return zt(this,a),o.apply(this,arguments)}return St(a,[{key:"draw",value:function(d,g){var _=this,D=this.w,C=new yt(this.ctx),T=new Xr(this.ctx);this.candlestickOptions=this.w.config.plotOptions.candlestick,this.boxOptions=this.w.config.plotOptions.boxPlot;var P=new fi(this.ctx,D);d=P.getLogSeries(d),this.series=d,this.yRatio=P.getLogYRatios(this.yRatio),this.barHelpers.initVariables(d);for(var L=C.group({class:"apexcharts-".concat(D.config.chart.type,"-series apexcharts-plot-series")}),B=function($){_.isBoxPlot="boxPlot"===D.config.chart.type||"boxPlot"===D.config.series[$].type;var q,K,Q,le,oe=void 0,ae=void 0,fe=[],ge=[],R=D.globals.comboCharts?g[$]:$,H=C.group({class:"apexcharts-series",seriesName:Xe.escapeString(D.globals.seriesNames[R]),rel:$+1,"data:realIndex":R});_.ctx.series.addCollapsedClassToSeries(H,R),d[$].length>0&&(_.visibleI=_.visibleI+1),_.yRatio.length>1&&(_.yaxisIndex=R);var Re=_.barHelpers.initialPositions();ae=Re.y,Q=Re.barHeight,q=Re.xDivision,K=Re.zeroH,ge.push((oe=Re.x)+(le=Re.barWidth)/2);for(var tt=C.group({class:"apexcharts-datalabels","data:realIndex":R}),Ve=function(pt){var qe=_.barHelpers.getStrokeWidth($,pt,R),Vt=_.drawBoxPaths({indexes:{i:$,j:pt,realIndex:R},x:oe,y:ae,xDivision:q,barWidth:le,zeroH:K,strokeWidth:qe,elSeries:H});ae=Vt.y,oe=Vt.x,pt>0&&ge.push(oe+le/2),fe.push(ae),Vt.pathTo.forEach(function(Yn,pn){var xi=!_.isBoxPlot&&_.candlestickOptions.wick.useFillColor?Vt.color[pn]:D.globals.stroke.colors[$],sr=T.fillPath({seriesNumber:R,dataPointIndex:pt,color:Vt.color[pn],value:d[$][pt]});_.renderSeries({realIndex:R,pathFill:sr,lineFill:xi,j:pt,i:$,pathFrom:Vt.pathFrom,pathTo:Yn,strokeWidth:qe,elSeries:H,x:oe,y:ae,series:d,barHeight:Q,barWidth:le,elDataLabelsWrap:tt,visibleSeries:_.visibleI,type:D.config.chart.type})})},Dt=0;Dt<D.globals.dataPoints;Dt++)Ve(Dt);D.globals.seriesXvalues[R]=ge,D.globals.seriesYvalues[R]=fe,L.add(H)},V=0;V<d.length;V++)B(V);return L}},{key:"drawBoxPaths",value:function(d){var g=d.indexes,_=d.x,D=d.xDivision,C=d.barWidth,T=d.zeroH,P=d.strokeWidth,L=this.w,B=new yt(this.ctx),V=g.i,$=g.j,q=!0,K=L.config.plotOptions.candlestick.colors.upward,oe=L.config.plotOptions.candlestick.colors.downward,ae="";this.isBoxPlot&&(ae=[this.boxOptions.colors.lower,this.boxOptions.colors.upper]);var fe=this.yRatio[this.yaxisIndex],ge=g.realIndex,R=this.getOHLCValue(ge,$),H=T,Q=T;R.o>R.c&&(q=!1);var le=Math.min(R.o,R.c),Re=Math.max(R.o,R.c),tt=R.m;L.globals.isXNumeric&&(_=(L.globals.seriesX[ge][$]-L.globals.minX)/this.xRatio-C/2);var Ve=_+C*this.visibleI;null==this.series[V][$]?(le=T,Re=T):(le=T-le/fe,Re=T-Re/fe,H=T-R.h/fe,Q=T-R.l/fe,tt=T-R.m/fe);var Dt=B.move(Ve,T),pt=B.move(Ve+C/2,le);return L.globals.previousPaths.length>0&&(pt=this.getPreviousPath(ge,$,!0)),Dt=this.isBoxPlot?[B.move(Ve,le)+B.line(Ve+C/2,le)+B.line(Ve+C/2,H)+B.line(Ve+C/4,H)+B.line(Ve+C-C/4,H)+B.line(Ve+C/2,H)+B.line(Ve+C/2,le)+B.line(Ve+C,le)+B.line(Ve+C,tt)+B.line(Ve,tt)+B.line(Ve,le+P/2),B.move(Ve,tt)+B.line(Ve+C,tt)+B.line(Ve+C,Re)+B.line(Ve+C/2,Re)+B.line(Ve+C/2,Q)+B.line(Ve+C-C/4,Q)+B.line(Ve+C/4,Q)+B.line(Ve+C/2,Q)+B.line(Ve+C/2,Re)+B.line(Ve,Re)+B.line(Ve,tt)+"z"]:[B.move(Ve,Re)+B.line(Ve+C/2,Re)+B.line(Ve+C/2,H)+B.line(Ve+C/2,Re)+B.line(Ve+C,Re)+B.line(Ve+C,le)+B.line(Ve+C/2,le)+B.line(Ve+C/2,Q)+B.line(Ve+C/2,le)+B.line(Ve,le)+B.line(Ve,Re-P/2)],pt+=B.move(Ve,le),L.globals.isXNumeric||(_+=D),{pathTo:Dt,pathFrom:pt,x:_,y:Re,barXPosition:Ve,color:this.isBoxPlot?ae:q?[K]:[oe]}}},{key:"getOHLCValue",value:function(d,g){var _=this.w;return{o:this.isBoxPlot?_.globals.seriesCandleH[d][g]:_.globals.seriesCandleO[d][g],h:this.isBoxPlot?_.globals.seriesCandleO[d][g]:_.globals.seriesCandleH[d][g],m:_.globals.seriesCandleM[d][g],l:this.isBoxPlot?_.globals.seriesCandleC[d][g]:_.globals.seriesCandleL[d][g],c:this.isBoxPlot?_.globals.seriesCandleL[d][g]:_.globals.seriesCandleC[d][g]}}}]),a}(),Bo=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"checkColorRange",value:function(){var o=this.w,a=!1,d=o.config.plotOptions[o.config.chart.type];return d.colorScale.ranges.length>0&&d.colorScale.ranges.map(function(g,_){g.from<=0&&(a=!0)}),a}},{key:"getShadeColor",value:function(o,a,d,g){var _=this.w,D=1,C=_.config.plotOptions[o].shadeIntensity,T=this.determineColor(o,a,d);_.globals.hasNegs||g?D=_.config.plotOptions[o].reverseNegativeShade?T.percent<0?T.percent/100*(1.25*C):1.25*C*(1-T.percent/100):T.percent<=0?1-(1+T.percent/100)*C:(1-T.percent/100)*C:(D=1-T.percent/100,"treemap"===o&&(D=1.25*C*(1-T.percent/100)));var P=T.color,L=new Xe;return _.config.plotOptions[o].enableShades&&(P=Xe.hexToRgba(L.shadeColor("dark"===this.w.config.theme.mode?-1*D:D,T.color),_.config.fill.opacity)),{color:P,colorProps:T}}},{key:"determineColor",value:function(o,a,d){var g=this.w,_=g.globals.series[a][d],D=g.config.plotOptions[o],C=D.colorScale.inverse?d:a;g.config.plotOptions[o].distributed&&(C=d);var T=g.globals.colors[C],P=null,L=Math.min.apply(Math,wn(g.globals.series[a])),B=Math.max.apply(Math,wn(g.globals.series[a]));D.distributed||"heatmap"!==o||(L=g.globals.minY,B=g.globals.maxY),void 0!==D.colorScale.min&&(L=D.colorScale.min<g.globals.minY?D.colorScale.min:g.globals.minY,B=D.colorScale.max>g.globals.maxY?D.colorScale.max:g.globals.maxY);var V=Math.abs(B)+Math.abs(L),$=100*_/(0===V?V-1e-6:V);return D.colorScale.ranges.length>0&&D.colorScale.ranges.map(function(q,K){if(_>=q.from&&_<=q.to){T=q.color,P=q.foreColor?q.foreColor:null,L=q.from,B=q.to;var oe=Math.abs(B)+Math.abs(L);$=100*_/(0===oe?oe-1e-6:oe)}}),{color:T,foreColor:P,percent:$}}},{key:"calculateDataLabels",value:function(o){var a=o.text,d=o.x,g=o.y,_=o.i,D=o.j,C=o.colorProps,T=o.fontSize,P=this.w.config.dataLabels,L=new yt(this.ctx),B=new ls(this.ctx),V=null;if(P.enabled){V=L.group({class:"apexcharts-data-labels"});var q=P.offsetY,K=d+P.offsetX,oe=g+parseFloat(P.style.fontSize)/3+q;B.plotDataLabelsText({x:K,y:oe,text:a,i:_,j:D,color:C.foreColor,parent:V,fontSize:T,dataLabelsConfig:P})}return V}},{key:"addListeners",value:function(o){var a=new yt(this.ctx);o.node.addEventListener("mouseenter",a.pathMouseEnter.bind(this,o)),o.node.addEventListener("mouseleave",a.pathMouseLeave.bind(this,o)),o.node.addEventListener("mousedown",a.pathMouseDown.bind(this,o))}}]),te}(),Ei=function(){function te(o,a){zt(this,te),this.ctx=o,this.w=o.w,this.xRatio=a.xRatio,this.yRatio=a.yRatio,this.dynamicAnim=this.w.config.chart.animations.dynamicAnimation,this.helpers=new Bo(o),this.rectRadius=this.w.config.plotOptions.heatmap.radius,this.strokeWidth=this.w.config.stroke.show?this.w.config.stroke.width:0}return St(te,[{key:"draw",value:function(o){var a=this.w,d=new yt(this.ctx),g=d.group({class:"apexcharts-heatmap"});g.attr("clip-path","url(#gridRectMask".concat(a.globals.cuid,")"));var _=a.globals.gridWidth/a.globals.dataPoints,D=a.globals.gridHeight/a.globals.series.length,C=0,T=!1;this.negRange=this.helpers.checkColorRange();var P=o.slice();a.config.yaxis[0].reversed&&(T=!0,P.reverse());for(var L=T?0:P.length-1;T?L<P.length:L>=0;T?L++:L--){var B=d.group({class:"apexcharts-series apexcharts-heatmap-series",seriesName:Xe.escapeString(a.globals.seriesNames[L]),rel:L+1,"data:realIndex":L});if(this.ctx.series.addCollapsedClassToSeries(B,L),a.config.chart.dropShadow.enabled){var V=a.config.chart.dropShadow;new pi(this.ctx).dropShadow(B,V,L)}for(var $=0,q=a.config.plotOptions.heatmap.shadeIntensity,K=0;K<P[L].length;K++){var oe=this.helpers.getShadeColor(a.config.chart.type,L,K,this.negRange),ae=oe.color,fe=oe.colorProps;"image"===a.config.fill.type&&(ae=new Xr(this.ctx).fillPath({seriesNumber:L,dataPointIndex:K,opacity:a.globals.hasNegs?fe.percent<0?1-(1+fe.percent/100):q+fe.percent/100:fe.percent/100,patternID:Xe.randomId(),width:a.config.fill.image.width?a.config.fill.image.width:_,height:a.config.fill.image.height?a.config.fill.image.height:D}));var R=d.drawRect($,C,_,D,this.rectRadius);if(R.attr({cx:$,cy:C}),R.node.classList.add("apexcharts-heatmap-rect"),B.add(R),R.attr({fill:ae,i:L,index:L,j:K,val:P[L][K],"stroke-width":this.strokeWidth,stroke:a.config.plotOptions.heatmap.useFillColorAsStroke?ae:a.globals.stroke.colors[0],color:ae}),this.helpers.addListeners(R),a.config.chart.animations.enabled&&!a.globals.dataChanged){var H=1;a.globals.resized||(H=a.config.chart.animations.speed),this.animateHeatMap(R,$,C,_,D,H)}if(a.globals.dataChanged){var Q=1;if(this.dynamicAnim.enabled&&a.globals.shouldAnimate){Q=this.dynamicAnim.speed;var le=a.globals.previousPaths[L]&&a.globals.previousPaths[L][K]&&a.globals.previousPaths[L][K].color;le||(le="rgba(255, 255, 255, 0)"),this.animateHeatColor(R,Xe.isColorHex(le)?le:Xe.rgb2hex(le),Xe.isColorHex(ae)?ae:Xe.rgb2hex(ae),Q)}}var Re=(0,a.config.dataLabels.formatter)(a.globals.series[L][K],{value:a.globals.series[L][K],seriesIndex:L,dataPointIndex:K,w:a}),tt=this.helpers.calculateDataLabels({text:Re,x:$+_/2,y:C+D/2,i:L,j:K,colorProps:fe,series:P});null!==tt&&B.add(tt),$+=_}C+=D,g.add(B)}var Ve=a.globals.yAxisScale[0].result.slice();return a.config.yaxis[0].reversed?Ve.unshift(""):Ve.push(""),a.globals.yAxisScale[0].result=Ve,a.config.yaxis[0].labels.offsetY=-a.globals.gridHeight/a.globals.series.length/2,g}},{key:"animateHeatMap",value:function(o,a,d,g,_,D){var C=new mr(this.ctx);C.animateRect(o,{x:a+g/2,y:d+_/2,width:0,height:0},{x:a,y:d,width:g,height:_},D,function(){C.animationCompleted(o)})}},{key:"animateHeatColor",value:function(o,a,d,g){o.attr({fill:a}).animate(g).attr({fill:d})}}]),te}(),Ca=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"drawYAxisTexts",value:function(o,a,d,g){var _=this.w,D=_.config.yaxis[0],C=_.globals.yLabelFormatters[0];return new yt(this.ctx).drawText({x:o+D.labels.offsetX,y:a+D.labels.offsetY,text:C(g,d),textAnchor:"middle",fontSize:D.labels.style.fontSize,fontFamily:D.labels.style.fontFamily,foreColor:Array.isArray(D.labels.style.colors)?D.labels.style.colors[d]:D.labels.style.colors})}}]),te}(),ja=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w;var a=this.w;this.chartType=this.w.config.chart.type,this.initialAnim=this.w.config.chart.animations.enabled,this.dynamicAnim=this.initialAnim&&this.w.config.chart.animations.dynamicAnimation.enabled,this.animBeginArr=[0],this.animDur=0,this.donutDataLabels=this.w.config.plotOptions.pie.donut.labels,this.lineColorArr=void 0!==a.globals.stroke.colors?a.globals.stroke.colors:a.globals.colors,this.defaultSize=Math.min(a.globals.gridWidth,a.globals.gridHeight),this.centerY=this.defaultSize/2,this.centerX=a.globals.gridWidth/2,this.fullAngle="radialBar"===a.config.chart.type?360:Math.abs(a.config.plotOptions.pie.endAngle-a.config.plotOptions.pie.startAngle),this.initialAngle=a.config.plotOptions.pie.startAngle%this.fullAngle,a.globals.radialSize=this.defaultSize/2.05-a.config.stroke.width-(a.config.chart.sparkline.enabled?0:a.config.chart.dropShadow.blur),this.donutSize=a.globals.radialSize*parseInt(a.config.plotOptions.pie.donut.size,10)/100,this.maxY=0,this.sliceLabels=[],this.sliceSizes=[],this.prevSectorAngleArr=[]}return St(te,[{key:"draw",value:function(o){var a=this,d=this.w,g=new yt(this.ctx);if(this.ret=g.group({class:"apexcharts-pie"}),d.globals.noData)return this.ret;for(var _=0,D=0;D<o.length;D++)_+=Xe.negToZero(o[D]);var C=[],T=g.group();0===_&&(_=1e-5),o.forEach(function(le){a.maxY=Math.max(a.maxY,le)}),d.config.yaxis[0].max&&(this.maxY=d.config.yaxis[0].max),"back"===d.config.grid.position&&"polarArea"===this.chartType&&this.drawPolarElements(this.ret);for(var P=0;P<o.length;P++){var L=this.fullAngle*Xe.negToZero(o[P])/_;C.push(L),"polarArea"===this.chartType?(C[P]=this.fullAngle/o.length,this.sliceSizes.push(d.globals.radialSize*o[P]/this.maxY)):this.sliceSizes.push(d.globals.radialSize)}if(d.globals.dataChanged){for(var B,V=0,$=0;$<d.globals.previousPaths.length;$++)V+=Xe.negToZero(d.globals.previousPaths[$]);for(var q=0;q<d.globals.previousPaths.length;q++)B=this.fullAngle*Xe.negToZero(d.globals.previousPaths[q])/V,this.prevSectorAngleArr.push(B)}this.donutSize<0&&(this.donutSize=0);var K=d.config.plotOptions.pie.customScale,fe=d.globals.gridWidth/2-d.globals.gridWidth/2*K,ge=d.globals.gridHeight/2-d.globals.gridHeight/2*K;if("donut"===this.chartType){var R=g.drawCircle(this.donutSize);R.attr({cx:this.centerX,cy:this.centerY,fill:d.config.plotOptions.pie.donut.background?d.config.plotOptions.pie.donut.background:"transparent"}),T.add(R)}var H=this.drawArcs(C,o);if(this.sliceLabels.forEach(function(le){H.add(le)}),T.attr({transform:"translate(".concat(fe,", ").concat(ge,") scale(").concat(K,")")}),T.add(H),this.ret.add(T),this.donutDataLabels.show){var Q=this.renderInnerDataLabels(this.donutDataLabels,{hollowSize:this.donutSize,centerX:this.centerX,centerY:this.centerY,opacity:this.donutDataLabels.show,translateX:fe,translateY:ge});this.ret.add(Q)}return"front"===d.config.grid.position&&"polarArea"===this.chartType&&this.drawPolarElements(this.ret),this.ret}},{key:"drawArcs",value:function(o,a){var d=this.w,g=new pi(this.ctx),_=new yt(this.ctx),D=new Xr(this.ctx),C=_.group({class:"apexcharts-slices"}),T=this.initialAngle,P=this.initialAngle,L=this.initialAngle,B=this.initialAngle;this.strokeWidth=d.config.stroke.show?d.config.stroke.width:0;for(var V=0;V<o.length;V++){var $=_.group({class:"apexcharts-series apexcharts-pie-series",seriesName:Xe.escapeString(d.globals.seriesNames[V]),rel:V+1,"data:realIndex":V});C.add($),L=(T=L)+o[V],B=(P=B)+this.prevSectorAngleArr[V];var q=L<T?this.fullAngle+L-T:L-T,K=D.fillPath({seriesNumber:V,size:this.sliceSizes[V],value:a[V]}),oe=this.getChangedPath(P,B),ae=_.drawPath({d:oe,stroke:Array.isArray(this.lineColorArr)?this.lineColorArr[V]:this.lineColorArr,strokeWidth:0,fill:K,fillOpacity:d.config.fill.opacity,classes:"apexcharts-pie-area apexcharts-".concat(this.chartType.toLowerCase(),"-slice-").concat(V)});ae.attr({index:0,j:V}),g.setSelectionFilter(ae,0,V),d.config.chart.dropShadow.enabled&&g.dropShadow(ae,d.config.chart.dropShadow,V),this.addListeners(ae,this.donutDataLabels),yt.setAttrs(ae.node,{"data:angle":q,"data:startAngle":T,"data:strokeWidth":this.strokeWidth,"data:value":a[V]});var ge={x:0,y:0};"pie"===this.chartType||"polarArea"===this.chartType?ge=Xe.polarToCartesian(this.centerX,this.centerY,d.globals.radialSize/1.25+d.config.plotOptions.pie.dataLabels.offset,(T+q/2)%this.fullAngle):"donut"===this.chartType&&(ge=Xe.polarToCartesian(this.centerX,this.centerY,(d.globals.radialSize+this.donutSize)/2+d.config.plotOptions.pie.dataLabels.offset,(T+q/2)%this.fullAngle)),$.add(ae);var R=0;if(!this.initialAnim||d.globals.resized||d.globals.dataChanged?this.animBeginArr.push(0):(0==(R=q/this.fullAngle*d.config.chart.animations.speed)&&(R=1),this.animDur=R+this.animDur,this.animBeginArr.push(this.animDur)),this.animatePaths(ae,this.dynamicAnim&&d.globals.dataChanged?{size:this.sliceSizes[V],endAngle:L,startAngle:T,prevStartAngle:P,prevEndAngle:B,animateStartingPos:!0,i:V,animBeginArr:this.animBeginArr,shouldSetPrevPaths:!0,dur:d.config.chart.animations.dynamicAnimation.speed}:{size:this.sliceSizes[V],endAngle:L,startAngle:T,i:V,totalItems:o.length-1,animBeginArr:this.animBeginArr,dur:R}),d.config.plotOptions.pie.expandOnClick&&"polarArea"!==this.chartType&&ae.click(this.pieClicked.bind(this,V)),void 0!==d.globals.selectedDataPoints[0]&&d.globals.selectedDataPoints[0].indexOf(V)>-1&&this.pieClicked(V),d.config.dataLabels.enabled){var H=ge.x,Q=ge.y,le=100*q/this.fullAngle+"%";if(0!==q&&d.config.plotOptions.pie.dataLabels.minAngleToShowLabel<o[V]){var Re=d.config.dataLabels.formatter;void 0!==Re&&(le=Re(d.globals.seriesPercent[V][0],{seriesIndex:V,w:d}));var tt=d.globals.dataLabels.style.colors[V],Ve=_.group({class:"apexcharts-datalabels"}),Dt=_.drawText({x:H,y:Q,text:le,textAnchor:"middle",fontSize:d.config.dataLabels.style.fontSize,fontFamily:d.config.dataLabels.style.fontFamily,fontWeight:d.config.dataLabels.style.fontWeight,foreColor:tt});Ve.add(Dt),d.config.dataLabels.dropShadow.enabled&&g.dropShadow(Dt,d.config.dataLabels.dropShadow),Dt.node.classList.add("apexcharts-pie-label"),d.config.chart.animations.animate&&!1===d.globals.resized&&(Dt.node.classList.add("apexcharts-pie-label-delay"),Dt.node.style.animationDelay=d.config.chart.animations.speed/940+"s"),this.sliceLabels.push(Ve)}}}return C}},{key:"addListeners",value:function(o,a){var d=new yt(this.ctx);o.node.addEventListener("mouseenter",d.pathMouseEnter.bind(this,o)),o.node.addEventListener("mouseleave",d.pathMouseLeave.bind(this,o)),o.node.addEventListener("mouseleave",this.revertDataLabelsInner.bind(this,o.node,a)),o.node.addEventListener("mousedown",d.pathMouseDown.bind(this,o)),this.donutDataLabels.total.showAlways||(o.node.addEventListener("mouseenter",this.printDataLabelsInner.bind(this,o.node,a)),o.node.addEventListener("mousedown",this.printDataLabelsInner.bind(this,o.node,a)))}},{key:"animatePaths",value:function(o,a){var g=a.endAngle<a.startAngle?this.fullAngle+a.endAngle-a.startAngle:a.endAngle-a.startAngle,_=g,D=a.startAngle,C=a.startAngle;void 0!==a.prevStartAngle&&void 0!==a.prevEndAngle&&(D=a.prevEndAngle,_=a.prevEndAngle<a.prevStartAngle?this.fullAngle+a.prevEndAngle-a.prevStartAngle:a.prevEndAngle-a.prevStartAngle),a.i===this.w.config.series.length-1&&(g+C>this.fullAngle?a.endAngle=a.endAngle-(g+C):g+C<this.fullAngle&&(a.endAngle=a.endAngle+(this.fullAngle-(g+C)))),g===this.fullAngle&&(g=this.fullAngle-.01),this.animateArc(o,D,C,g,_,a)}},{key:"animateArc",value:function(o,a,d,g,_,D){var C,T=this,P=this.w,L=new mr(this.ctx),B=D.size;(isNaN(a)||isNaN(_))&&(a=d,_=g,D.dur=0);var V=g,$=d,q=a<d?this.fullAngle+a-d:a-d;P.globals.dataChanged&&D.shouldSetPrevPaths&&D.prevEndAngle&&(C=T.getPiePath({me:T,startAngle:D.prevStartAngle,angle:D.prevEndAngle<D.prevStartAngle?this.fullAngle+D.prevEndAngle-D.prevStartAngle:D.prevEndAngle-D.prevStartAngle,size:B}),o.attr({d:C})),0!==D.dur?o.animate(D.dur,P.globals.easing,D.animBeginArr[D.i]).afterAll(function(){"pie"!==T.chartType&&"donut"!==T.chartType&&"polarArea"!==T.chartType||this.animate(P.config.chart.animations.dynamicAnimation.speed).attr({"stroke-width":T.strokeWidth}),D.i===P.config.series.length-1&&L.animationCompleted(o)}).during(function(K){V=q+(g-q)*K,D.animateStartingPos&&(V=_+(g-_)*K,$=a-_+(d-(a-_))*K),C=T.getPiePath({me:T,startAngle:$,angle:V,size:B}),o.node.setAttribute("data:pathOrig",C),o.attr({d:C})}):(C=T.getPiePath({me:T,startAngle:$,angle:g,size:B}),D.isTrack||(P.globals.animationEnded=!0),o.node.setAttribute("data:pathOrig",C),o.attr({d:C,"stroke-width":T.strokeWidth}))}},{key:"pieClicked",value:function(o){var a,d=this.w,g=this,_=g.sliceSizes[o]+(d.config.plotOptions.pie.expandOnClick?4:0),D=d.globals.dom.Paper.select(".apexcharts-".concat(g.chartType.toLowerCase(),"-slice-").concat(o)).members[0];if("true"!==D.attr("data:pieClicked")){var C=d.globals.dom.baseEl.getElementsByClassName("apexcharts-pie-area");Array.prototype.forEach.call(C,function(B){B.setAttribute("data:pieClicked","false");var V=B.getAttribute("data:pathOrig");B.setAttribute("d",V)}),D.attr("data:pieClicked","true");var T=parseInt(D.attr("data:startAngle"),10),P=parseInt(D.attr("data:angle"),10);a=g.getPiePath({me:g,startAngle:T,angle:P,size:_}),360!==P&&D.plot(a)}else{D.attr({"data:pieClicked":"false"}),this.revertDataLabelsInner(D.node,this.donutDataLabels);var L=D.attr("data:pathOrig");D.attr({d:L})}}},{key:"getChangedPath",value:function(o,a){var d="";return this.dynamicAnim&&this.w.globals.dataChanged&&(d=this.getPiePath({me:this,startAngle:o,angle:a-o,size:this.size})),d}},{key:"getPiePath",value:function(o){var a=o.me,d=o.startAngle,g=o.angle,_=o.size,D=d,C=Math.PI*(D-90)/180,T=g+d;Math.ceil(T)>=this.fullAngle+this.w.config.plotOptions.pie.startAngle%this.fullAngle&&(T=this.fullAngle+this.w.config.plotOptions.pie.startAngle%this.fullAngle-.01),Math.ceil(T)>this.fullAngle&&(T-=this.fullAngle);var P=Math.PI*(T-90)/180,L=a.centerX+_*Math.cos(C),B=a.centerY+_*Math.sin(C),V=a.centerX+_*Math.cos(P),$=a.centerY+_*Math.sin(P),q=Xe.polarToCartesian(a.centerX,a.centerY,a.donutSize,T),K=Xe.polarToCartesian(a.centerX,a.centerY,a.donutSize,D),oe=g>180?1:0,ae=["M",L,B,"A",_,_,0,oe,1,V,$];return"donut"===a.chartType?[].concat(ae,["L",q.x,q.y,"A",a.donutSize,a.donutSize,0,oe,0,K.x,K.y,"L",L,B,"z"]).join(" "):"pie"===a.chartType||"polarArea"===a.chartType?[].concat(ae,["L",a.centerX,a.centerY,"L",L,B]).join(" "):[].concat(ae).join(" ")}},{key:"drawPolarElements",value:function(o){var a=this.w,d=new Hs(this.ctx),g=new yt(this.ctx),_=new Ca(this.ctx),D=g.group(),C=g.group(),T=d.niceScale(0,Math.ceil(this.maxY),a.config.yaxis[0].tickAmount,0,!0),P=T.result.reverse(),L=T.result.length;this.maxY=T.niceMax;for(var B=a.globals.radialSize,V=B/(L-1),$=0;$<L-1;$++){var q=g.drawCircle(B);if(q.attr({cx:this.centerX,cy:this.centerY,fill:"none","stroke-width":a.config.plotOptions.polarArea.rings.strokeWidth,stroke:a.config.plotOptions.polarArea.rings.strokeColor}),a.config.yaxis[0].show){var K=_.drawYAxisTexts(this.centerX,this.centerY-B+parseInt(a.config.yaxis[0].labels.style.fontSize,10)/2,$,P[$]);C.add(K)}D.add(q),B-=V}this.drawSpokes(o),o.add(D),o.add(C)}},{key:"renderInnerDataLabels",value:function(o,a){var d=this.w,g=new yt(this.ctx),_=g.group({class:"apexcharts-datalabels-group",transform:"translate(".concat(a.translateX?a.translateX:0,", ").concat(a.translateY?a.translateY:0,") scale(").concat(d.config.plotOptions.pie.customScale,")")}),D=o.total.show;_.node.style.opacity=a.opacity;var C,T,P=a.centerX,L=a.centerY;C=void 0===o.name.color?d.globals.colors[0]:o.name.color;var B=o.name.fontSize,V=o.name.fontFamily,$=o.name.fontWeight;T=void 0===o.value.color?d.config.chart.foreColor:o.value.color;var q=o.value.formatter,K="",oe="";if(D?(C=o.total.color,B=o.total.fontSize,V=o.total.fontFamily,$=o.total.fontWeight,oe=o.total.label,K=o.total.formatter(d)):1===d.globals.series.length&&(K=q(d.globals.series[0],d),oe=d.globals.seriesNames[0]),oe&&(oe=o.name.formatter(oe,o.total.show,d)),o.name.show){var ae=g.drawText({x:P,y:L+parseFloat(o.name.offsetY),text:oe,textAnchor:"middle",foreColor:C,fontSize:B,fontWeight:$,fontFamily:V});ae.node.classList.add("apexcharts-datalabel-label"),_.add(ae)}if(o.value.show){var fe=o.name.show?parseFloat(o.value.offsetY)+16:o.value.offsetY,ge=g.drawText({x:P,y:L+fe,text:K,textAnchor:"middle",foreColor:T,fontWeight:o.value.fontWeight,fontSize:o.value.fontSize,fontFamily:o.value.fontFamily});ge.node.classList.add("apexcharts-datalabel-value"),_.add(ge)}return _}},{key:"printInnerLabels",value:function(o,a,d,g){var _,D=this.w;g?_=void 0===o.name.color?D.globals.colors[parseInt(g.parentNode.getAttribute("rel"),10)-1]:o.name.color:D.globals.series.length>1&&o.total.show&&(_=o.total.color);var C=D.globals.dom.baseEl.querySelector(".apexcharts-datalabel-label"),T=D.globals.dom.baseEl.querySelector(".apexcharts-datalabel-value");d=(0,o.value.formatter)(d,D),g||"function"!=typeof o.total.formatter||(d=o.total.formatter(D)),a=o.name.formatter(a,a===o.total.label,D),null!==C&&(C.textContent=a),null!==T&&(T.textContent=d),null!==C&&(C.style.fill=_)}},{key:"printDataLabelsInner",value:function(o,a){var d=this.w,g=o.getAttribute("data:value"),_=d.globals.seriesNames[parseInt(o.parentNode.getAttribute("rel"),10)-1];d.globals.series.length>1&&this.printInnerLabels(a,_,g,o);var D=d.globals.dom.baseEl.querySelector(".apexcharts-datalabels-group");null!==D&&(D.style.opacity=1)}},{key:"drawSpokes",value:function(o){var a=this,d=this.w,g=new yt(this.ctx),_=d.config.plotOptions.polarArea.spokes;if(0!==_.strokeWidth){for(var D=[],C=360/d.globals.series.length,T=0;T<d.globals.series.length;T++)D.push(Xe.polarToCartesian(this.centerX,this.centerY,d.globals.radialSize,d.config.plotOptions.pie.startAngle+C*T));D.forEach(function(P,L){var B=g.drawLine(P.x,P.y,a.centerX,a.centerY,Array.isArray(_.connectorColors)?_.connectorColors[L]:_.connectorColors);o.add(B)})}}},{key:"revertDataLabelsInner",value:function(o,a,d){var g=this,_=this.w,D=_.globals.dom.baseEl.querySelector(".apexcharts-datalabels-group"),C=!1,T=_.globals.dom.baseEl.getElementsByClassName("apexcharts-pie-area"),P=function(V){var $=V.makeSliceOut,q=V.printLabel;Array.prototype.forEach.call(T,function(K){"true"===K.getAttribute("data:pieClicked")&&($&&(C=!0),q&&g.printDataLabelsInner(K,a))})};if(P({makeSliceOut:!0,printLabel:!1}),a.total.show&&_.globals.series.length>1)C&&!a.total.showAlways?P({makeSliceOut:!1,printLabel:!0}):this.printInnerLabels(a,a.total.label,a.total.formatter(_));else if(P({makeSliceOut:!1,printLabel:!0}),!C)if(_.globals.selectedDataPoints.length&&_.globals.series.length>1)if(_.globals.selectedDataPoints[0].length>0){var L=_.globals.selectedDataPoints[0],B=_.globals.dom.baseEl.querySelector(".apexcharts-".concat(this.chartType.toLowerCase(),"-slice-").concat(L));this.printDataLabelsInner(B,a)}else D&&_.globals.selectedDataPoints.length&&0===_.globals.selectedDataPoints[0].length&&(D.style.opacity=0);else D&&_.globals.series.length>1&&(D.style.opacity=0)}}]),te}(),Sa=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.chartType=this.w.config.chart.type,this.initialAnim=this.w.config.chart.animations.enabled,this.dynamicAnim=this.initialAnim&&this.w.config.chart.animations.dynamicAnimation.enabled,this.animDur=0;var a=this.w;this.graphics=new yt(this.ctx),this.lineColorArr=void 0!==a.globals.stroke.colors?a.globals.stroke.colors:a.globals.colors,this.defaultSize=a.globals.svgHeight<a.globals.svgWidth?a.globals.gridHeight+1.5*a.globals.goldenPadding:a.globals.gridWidth,this.isLog=a.config.yaxis[0].logarithmic,this.coreUtils=new fi(this.ctx),this.maxValue=this.isLog?this.coreUtils.getLogVal(a.globals.maxY,0):a.globals.maxY,this.minValue=this.isLog?this.coreUtils.getLogVal(this.w.globals.minY,0):a.globals.minY,this.polygons=a.config.plotOptions.radar.polygons,this.strokeWidth=a.config.stroke.show?a.config.stroke.width:0,this.size=this.defaultSize/2.1-this.strokeWidth-a.config.chart.dropShadow.blur,a.config.xaxis.labels.show&&(this.size=this.size-a.globals.xAxisLabelsWidth/1.75),void 0!==a.config.plotOptions.radar.size&&(this.size=a.config.plotOptions.radar.size),this.dataRadiusOfPercent=[],this.dataRadius=[],this.angleArr=[],this.yaxisLabelsTextsPos=[]}return St(te,[{key:"draw",value:function(o){var a=this,d=this.w,g=new Xr(this.ctx),_=[],D=new ls(this.ctx);o.length&&(this.dataPointsLen=o[d.globals.maxValsInArrayIndex].length),this.disAngle=2*Math.PI/this.dataPointsLen;var L=d.globals.gridHeight/2+d.config.plotOptions.radar.offsetY,B=this.graphics.group({class:"apexcharts-radar-series apexcharts-plot-series",transform:"translate(".concat(d.globals.gridWidth/2+d.config.plotOptions.radar.offsetX||0,", ").concat(L||0,")")}),V=[],$=null,q=null;if(this.yaxisLabels=this.graphics.group({class:"apexcharts-yaxis"}),o.forEach(function(oe,ae){var fe=oe.length===d.globals.dataPoints,ge=a.graphics.group().attr({class:"apexcharts-series","data:longestSeries":fe,seriesName:Xe.escapeString(d.globals.seriesNames[ae]),rel:ae+1,"data:realIndex":ae});a.dataRadiusOfPercent[ae]=[],a.dataRadius[ae]=[],a.angleArr[ae]=[],oe.forEach(function(qe,Vt){var Yn=Math.abs(a.maxValue-a.minValue);qe+=Math.abs(a.minValue),a.isLog&&(qe=a.coreUtils.getLogVal(qe,0)),a.dataRadiusOfPercent[ae][Vt]=qe/Yn,a.dataRadius[ae][Vt]=a.dataRadiusOfPercent[ae][Vt]*a.size,a.angleArr[ae][Vt]=Vt*a.disAngle}),V=a.getDataPointsPos(a.dataRadius[ae],a.angleArr[ae]);var R=a.createPaths(V,{x:0,y:0});$=a.graphics.group({class:"apexcharts-series-markers-wrap apexcharts-element-hidden"}),q=a.graphics.group({class:"apexcharts-datalabels","data:realIndex":ae}),d.globals.delayedElements.push({el:$.node,index:ae});var H={i:ae,realIndex:ae,animationDelay:ae,initialSpeed:d.config.chart.animations.speed,dataChangeSpeed:d.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-radar",shouldClipToGrid:!1,bindEventsOnPaths:!1,stroke:d.globals.stroke.colors[ae],strokeLineCap:d.config.stroke.lineCap},Q=null;d.globals.previousPaths.length>0&&(Q=a.getPreviousPath(ae));for(var le=0;le<R.linePathsTo.length;le++){var Re=a.graphics.renderPaths(Je(Je({},H),{},{pathFrom:null===Q?R.linePathsFrom[le]:Q,pathTo:R.linePathsTo[le],strokeWidth:Array.isArray(a.strokeWidth)?a.strokeWidth[ae]:a.strokeWidth,fill:"none",drawShadow:!1}));ge.add(Re);var tt=g.fillPath({seriesNumber:ae}),Ve=a.graphics.renderPaths(Je(Je({},H),{},{pathFrom:null===Q?R.areaPathsFrom[le]:Q,pathTo:R.areaPathsTo[le],strokeWidth:0,fill:tt,drawShadow:!1}));d.config.chart.dropShadow.enabled&&new pi(a.ctx).dropShadow(Ve,Object.assign({},d.config.chart.dropShadow,{noUserSpaceOnUse:!0}),ae),ge.add(Ve)}oe.forEach(function(qe,Vt){var Yn=new uo(a.ctx).getMarkerConfig({cssClass:"apexcharts-marker",seriesIndex:ae,dataPointIndex:Vt}),pn=a.graphics.drawMarker(V[Vt].x,V[Vt].y,Yn);pn.attr("rel",Vt),pn.attr("j",Vt),pn.attr("index",ae),pn.node.setAttribute("default-marker-size",Yn.pSize);var xi=a.graphics.group({class:"apexcharts-series-markers"});xi&&xi.add(pn),$.add(xi),ge.add($);var sr=d.config.dataLabels;if(sr.enabled){var ki=sr.formatter(d.globals.series[ae][Vt],{seriesIndex:ae,dataPointIndex:Vt,w:d});D.plotDataLabelsText({x:V[Vt].x,y:V[Vt].y,text:ki,textAnchor:"middle",i:ae,j:ae,parent:q,offsetCorrection:!1,dataLabelsConfig:Je({},sr)})}ge.add(q)}),_.push(ge)}),this.drawPolygons({parent:B}),d.config.xaxis.labels.show){var K=this.drawXAxisTexts();B.add(K)}return _.forEach(function(oe){B.add(oe)}),B.add(this.yaxisLabels),B}},{key:"drawPolygons",value:function(o){for(var a=this,d=this.w,g=o.parent,_=new Ca(this.ctx),D=d.globals.yAxisScale[0].result.reverse(),C=D.length,T=[],P=this.size/(C-1),L=0;L<C;L++)T[L]=P*L;T.reverse();var B=[],V=[];T.forEach(function($,q){var K=Xe.getPolygonPos($,a.dataPointsLen),oe="";K.forEach(function(ae,fe){if(0===q){var ge=a.graphics.drawLine(ae.x,ae.y,0,0,Array.isArray(a.polygons.connectorColors)?a.polygons.connectorColors[fe]:a.polygons.connectorColors);V.push(ge)}0===fe&&a.yaxisLabelsTextsPos.push({x:ae.x,y:ae.y}),oe+=ae.x+","+ae.y+" "}),B.push(oe)}),B.forEach(function($,q){var K=a.polygons.strokeColors,oe=a.polygons.strokeWidth,ae=a.graphics.drawPolygon($,Array.isArray(K)?K[q]:K,Array.isArray(oe)?oe[q]:oe,d.globals.radarPolygons.fill.colors[q]);g.add(ae)}),V.forEach(function($){g.add($)}),d.config.yaxis[0].show&&this.yaxisLabelsTextsPos.forEach(function($,q){var K=_.drawYAxisTexts($.x,$.y,q,D[q]);a.yaxisLabels.add(K)})}},{key:"drawXAxisTexts",value:function(){var o=this,a=this.w,d=a.config.xaxis.labels,g=this.graphics.group({class:"apexcharts-xaxis"}),_=Xe.getPolygonPos(this.size,this.dataPointsLen);return a.globals.labels.forEach(function(D,C){var T=a.config.xaxis.labels.formatter,P=new ls(o.ctx);if(_[C]){var L=o.getTextPos(_[C],o.size),B=T(D,{seriesIndex:-1,dataPointIndex:C,w:a});P.plotDataLabelsText({x:L.newX,y:L.newY,text:B,textAnchor:L.textAnchor,i:C,j:C,parent:g,color:Array.isArray(d.style.colors)&&d.style.colors[C]?d.style.colors[C]:"#a8a8a8",dataLabelsConfig:Je({textAnchor:L.textAnchor,dropShadow:{enabled:!1}},d),offsetCorrection:!1})}}),g}},{key:"createPaths",value:function(o,a){var d=this,g=[],_=[],D=[],C=[];if(o.length){_=[this.graphics.move(a.x,a.y)],C=[this.graphics.move(a.x,a.y)];var T=this.graphics.move(o[0].x,o[0].y),P=this.graphics.move(o[0].x,o[0].y);o.forEach(function(L,B){T+=d.graphics.line(L.x,L.y),P+=d.graphics.line(L.x,L.y),B===o.length-1&&(T+="Z",P+="Z")}),g.push(T),D.push(P)}return{linePathsFrom:_,linePathsTo:g,areaPathsFrom:C,areaPathsTo:D}}},{key:"getTextPos",value:function(o,a){var d="middle",g=o.x,_=o.y;return Math.abs(o.x)>=10?o.x>0?(d="start",g+=10):o.x<0&&(d="end",g-=10):d="middle",Math.abs(o.y)>=a-10&&(o.y<0?_-=10:o.y>0&&(_+=10)),{textAnchor:d,newX:g,newY:_}}},{key:"getPreviousPath",value:function(o){for(var a=this.w,d=null,g=0;g<a.globals.previousPaths.length;g++){var _=a.globals.previousPaths[g];_.paths.length>0&&parseInt(_.realIndex,10)===parseInt(o,10)&&void 0!==a.globals.previousPaths[g].paths[0]&&(d=a.globals.previousPaths[g].paths[0].d)}return d}},{key:"getDataPointsPos",value:function(o,a){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.dataPointsLen;o=o||[],a=a||[];for(var g=[],_=0;_<d;_++){var D={};D.x=o[_]*Math.sin(a[_]),D.y=-o[_]*Math.cos(a[_]),g.push(D)}return g}}]),te}(),Da=function(te){ht(a,ja);var o=co(a);function a(d){var g;zt(this,a),(g=o.call(this,d)).ctx=d,g.w=d.w,g.animBeginArr=[0],g.animDur=0;var _=g.w;return g.startAngle=_.config.plotOptions.radialBar.startAngle,g.endAngle=_.config.plotOptions.radialBar.endAngle,g.totalAngle=Math.abs(_.config.plotOptions.radialBar.endAngle-_.config.plotOptions.radialBar.startAngle),g.trackStartAngle=_.config.plotOptions.radialBar.track.startAngle,g.trackEndAngle=_.config.plotOptions.radialBar.track.endAngle,g.donutDataLabels=g.w.config.plotOptions.radialBar.dataLabels,g.radialDataLabels=g.donutDataLabels,g.trackStartAngle||(g.trackStartAngle=g.startAngle),g.trackEndAngle||(g.trackEndAngle=g.endAngle),360===g.endAngle&&(g.endAngle=359.99),g.margin=parseInt(_.config.plotOptions.radialBar.track.margin,10),g}return St(a,[{key:"draw",value:function(d){var g=this.w,_=new yt(this.ctx),D=_.group({class:"apexcharts-radialbar"});if(g.globals.noData)return D;var C=_.group(),T=this.defaultSize/2,P=g.globals.gridWidth/2,L=this.defaultSize/2.05;g.config.chart.sparkline.enabled||(L=L-g.config.stroke.width-g.config.chart.dropShadow.blur);var B=g.globals.fill.colors;if(g.config.plotOptions.radialBar.track.show){var V=this.drawTracks({size:L,centerX:P,centerY:T,colorArr:B,series:d});C.add(V)}var $=this.drawArcs({size:L,centerX:P,centerY:T,colorArr:B,series:d}),q=360;g.config.plotOptions.radialBar.startAngle<0&&(q=this.totalAngle);var K=(360-q)/360;if(g.globals.radialSize=L-L*K,this.radialDataLabels.value.show){var oe=Math.max(this.radialDataLabels.value.offsetY,this.radialDataLabels.name.offsetY);g.globals.radialSize+=oe*K}return C.add($.g),"front"===g.config.plotOptions.radialBar.hollow.position&&($.g.add($.elHollow),$.dataLabels&&$.g.add($.dataLabels)),D.add(C),D}},{key:"drawTracks",value:function(d){var g=this.w,_=new yt(this.ctx),D=_.group({class:"apexcharts-tracks"}),C=new pi(this.ctx),T=new Xr(this.ctx),P=this.getStrokeWidth(d);d.size=d.size-P/2;for(var L=0;L<d.series.length;L++){var B=_.group({class:"apexcharts-radialbar-track apexcharts-track"});D.add(B),B.attr({rel:L+1}),d.size=d.size-P-this.margin;var V=g.config.plotOptions.radialBar.track,$=T.fillPath({seriesNumber:0,size:d.size,fillColors:Array.isArray(V.background)?V.background[L]:V.background,solid:!0}),q=this.trackStartAngle,K=this.trackEndAngle;Math.abs(K)+Math.abs(q)>=360&&(K=360-Math.abs(this.startAngle)-.1);var oe=_.drawPath({d:"",stroke:$,strokeWidth:P*parseInt(V.strokeWidth,10)/100,fill:"none",strokeOpacity:V.opacity,classes:"apexcharts-radialbar-area"});V.dropShadow.enabled&&C.dropShadow(oe,V.dropShadow),B.add(oe),oe.attr("id","apexcharts-radialbarTrack-"+L),this.animatePaths(oe,{centerX:d.centerX,centerY:d.centerY,endAngle:K,startAngle:q,size:d.size,i:L,totalItems:2,animBeginArr:0,dur:0,isTrack:!0,easing:g.globals.easing})}return D}},{key:"drawArcs",value:function(d){var g=this.w,_=new yt(this.ctx),D=new Xr(this.ctx),C=new pi(this.ctx),T=_.group(),P=this.getStrokeWidth(d);d.size=d.size-P/2;var L=g.config.plotOptions.radialBar.hollow.background,B=d.size-P*d.series.length-this.margin*d.series.length-P*parseInt(g.config.plotOptions.radialBar.track.strokeWidth,10)/100/2,V=B-g.config.plotOptions.radialBar.hollow.margin;void 0!==g.config.plotOptions.radialBar.hollow.image&&(L=this.drawHollowImage(d,T,B,L));var $=this.drawHollow({size:V,centerX:d.centerX,centerY:d.centerY,fill:L||"transparent"});g.config.plotOptions.radialBar.hollow.dropShadow.enabled&&C.dropShadow($,g.config.plotOptions.radialBar.hollow.dropShadow);var K=1;!this.radialDataLabels.total.show&&g.globals.series.length>1&&(K=0);var oe=null;this.radialDataLabels.show&&(oe=this.renderInnerDataLabels(this.radialDataLabels,{hollowSize:B,centerX:d.centerX,centerY:d.centerY,opacity:K})),"back"===g.config.plotOptions.radialBar.hollow.position&&(T.add($),oe&&T.add(oe));var ae=!1;g.config.plotOptions.radialBar.inverseOrder&&(ae=!0);for(var fe=ae?d.series.length-1:0;ae?fe>=0:fe<d.series.length;ae?fe--:fe++){var ge=_.group({class:"apexcharts-series apexcharts-radial-series",seriesName:Xe.escapeString(g.globals.seriesNames[fe])});T.add(ge),ge.attr({rel:fe+1,"data:realIndex":fe}),this.ctx.series.addCollapsedClassToSeries(ge,fe),d.size=d.size-P-this.margin;var R=D.fillPath({seriesNumber:fe,size:d.size,value:d.series[fe]}),H=this.startAngle,Q=void 0,le=Xe.negToZero(d.series[fe]>100?100:d.series[fe])/100,Re=Math.round(this.totalAngle*le)+this.startAngle,tt=void 0;g.globals.dataChanged&&(Q=this.startAngle,tt=Math.round(this.totalAngle*Xe.negToZero(g.globals.previousPaths[fe])/100)+Q),Math.abs(Re)+Math.abs(H)>=360&&(Re-=.01),Math.abs(tt)+Math.abs(Q)>=360&&(tt-=.01);var Ve=Re-H,Dt=Array.isArray(g.config.stroke.dashArray)?g.config.stroke.dashArray[fe]:g.config.stroke.dashArray,pt=_.drawPath({d:"",stroke:R,strokeWidth:P,fill:"none",fillOpacity:g.config.fill.opacity,classes:"apexcharts-radialbar-area apexcharts-radialbar-slice-"+fe,strokeDashArray:Dt});yt.setAttrs(pt.node,{"data:angle":Ve,"data:value":d.series[fe]}),g.config.chart.dropShadow.enabled&&C.dropShadow(pt,g.config.chart.dropShadow,fe),C.setSelectionFilter(pt,0,fe),this.addListeners(pt,this.radialDataLabels),ge.add(pt),pt.attr({index:0,j:fe});var Vt=0;!this.initialAnim||g.globals.resized||g.globals.dataChanged||(this.animDur=(Vt=(Re-H)/360*g.config.chart.animations.speed)/(1.2*d.series.length)+this.animDur,this.animBeginArr.push(this.animDur)),g.globals.dataChanged&&(this.animDur=(Vt=(Re-H)/360*g.config.chart.animations.dynamicAnimation.speed)/(1.2*d.series.length)+this.animDur,this.animBeginArr.push(this.animDur)),this.animatePaths(pt,{centerX:d.centerX,centerY:d.centerY,endAngle:Re,startAngle:H,prevEndAngle:tt,prevStartAngle:Q,size:d.size,i:fe,totalItems:2,animBeginArr:this.animBeginArr,dur:Vt,shouldSetPrevPaths:!0,easing:g.globals.easing})}return{g:T,elHollow:$,dataLabels:oe}}},{key:"drawHollow",value:function(d){var g=new yt(this.ctx).drawCircle(2*d.size);return g.attr({class:"apexcharts-radialbar-hollow",cx:d.centerX,cy:d.centerY,r:d.size,fill:d.fill}),g}},{key:"drawHollowImage",value:function(d,g,_,D){var C=this.w,T=new Xr(this.ctx),P=Xe.randomId(),L=C.config.plotOptions.radialBar.hollow.image;if(C.config.plotOptions.radialBar.hollow.imageClipped)T.clippedImgArea({width:_,height:_,image:L,patternID:"pattern".concat(C.globals.cuid).concat(P)}),D="url(#pattern".concat(C.globals.cuid).concat(P,")");else{var B=C.config.plotOptions.radialBar.hollow.imageWidth,V=C.config.plotOptions.radialBar.hollow.imageHeight;if(void 0===B&&void 0===V){var $=C.globals.dom.Paper.image(L).loaded(function(K){this.move(d.centerX-K.width/2+C.config.plotOptions.radialBar.hollow.imageOffsetX,d.centerY-K.height/2+C.config.plotOptions.radialBar.hollow.imageOffsetY)});g.add($)}else{var q=C.globals.dom.Paper.image(L).loaded(function(K){this.move(d.centerX-B/2+C.config.plotOptions.radialBar.hollow.imageOffsetX,d.centerY-V/2+C.config.plotOptions.radialBar.hollow.imageOffsetY),this.size(B,V)});g.add(q)}}return D}},{key:"getStrokeWidth",value:function(d){return d.size*(100-parseInt(this.w.config.plotOptions.radialBar.hollow.size,10))/100/(d.series.length+1)-this.margin}}]),a}(),we=function(){function te(o){zt(this,te),this.w=o.w,this.lineCtx=o}return St(te,[{key:"sameValueSeriesFix",value:function(o,a){var d=this.w;if("line"===d.config.chart.type&&("gradient"===d.config.fill.type||"gradient"===d.config.fill.type[o])&&new fi(this.lineCtx.ctx,d).seriesHaveSameValues(o)){var g=a[o].slice();g[g.length-1]=g[g.length-1]+1e-6,a[o]=g}return a}},{key:"calculatePoints",value:function(o){var a=o.series,g=o.x,_=o.y,D=o.i,C=o.j,T=o.prevY,P=this.w,L=[],B=[];if(0===C){var V=this.lineCtx.categoryAxisCorrection+P.config.markers.offsetX;P.globals.isXNumeric&&(V=(P.globals.seriesX[o.realIndex][0]-P.globals.minX)/this.lineCtx.xRatio+P.config.markers.offsetX),L.push(V),B.push(Xe.isNumber(a[D][0])?T+P.config.markers.offsetY:null),L.push(g+P.config.markers.offsetX),B.push(Xe.isNumber(a[D][C+1])?_+P.config.markers.offsetY:null)}else L.push(g+P.config.markers.offsetX),B.push(Xe.isNumber(a[D][C+1])?_+P.config.markers.offsetY:null);return{x:L,y:B}}},{key:"checkPreviousPaths",value:function(o){for(var a=o.pathFromLine,d=o.pathFromArea,g=o.realIndex,_=this.w,D=0;D<_.globals.previousPaths.length;D++){var C=_.globals.previousPaths[D];("line"===C.type||"area"===C.type)&&C.paths.length>0&&parseInt(C.realIndex,10)===parseInt(g,10)&&("line"===C.type?(this.lineCtx.appendPathFrom=!1,a=_.globals.previousPaths[D].paths[0].d):"area"===C.type&&(this.lineCtx.appendPathFrom=!1,d=_.globals.previousPaths[D].paths[0].d,_.config.stroke.show&&_.globals.previousPaths[D].paths[1]&&(a=_.globals.previousPaths[D].paths[1].d)))}return{pathFromLine:a,pathFromArea:d}}},{key:"determineFirstPrevY",value:function(o){var a=o.i,d=o.series,g=o.prevY,_=o.lineYPosition,D=this.w;if(void 0!==d[a][0])g=(_=D.config.chart.stacked&&a>0?this.lineCtx.prevSeriesY[a-1][0]:this.lineCtx.zeroY)-d[a][0]/this.lineCtx.yRatio[this.lineCtx.yaxisIndex]+2*(this.lineCtx.isReversed?d[a][0]/this.lineCtx.yRatio[this.lineCtx.yaxisIndex]:0);else if(D.config.chart.stacked&&a>0&&void 0===d[a][0])for(var C=a-1;C>=0;C--)if(null!=d[C][0]){g=_=this.lineCtx.prevSeriesY[C][0];break}return{prevY:g,lineYPosition:_}}}]),te}(),se=function(){function te(o,a,d){zt(this,te),this.ctx=o,this.w=o.w,this.xyRatios=a,this.pointsChart=!("bubble"!==this.w.config.chart.type&&"scatter"!==this.w.config.chart.type)||d,this.scatter=new Cn(this.ctx),this.noNegatives=this.w.globals.minX===Number.MAX_VALUE,this.lineHelpers=new we(this),this.markers=new uo(this.ctx),this.prevSeriesY=[],this.categoryAxisCorrection=0,this.yaxisIndex=0}return St(te,[{key:"draw",value:function(o,a,d){var g=this.w,_=new yt(this.ctx),D=g.globals.comboCharts?a:g.config.chart.type,C=_.group({class:"apexcharts-".concat(D,"-series apexcharts-plot-series")}),T=new fi(this.ctx,g);this.yRatio=this.xyRatios.yRatio,this.zRatio=this.xyRatios.zRatio,this.xRatio=this.xyRatios.xRatio,this.baseLineY=this.xyRatios.baseLineY,o=T.getLogSeries(o),this.yRatio=T.getLogYRatios(this.yRatio);for(var P=[],L=0;L<o.length;L++){o=this.lineHelpers.sameValueSeriesFix(L,o);var B=g.globals.comboCharts?d[L]:L;this._initSerieVariables(o,L,B);var V=[],$=[],q=g.globals.padHorizontal+this.categoryAxisCorrection;this.ctx.series.addCollapsedClassToSeries(this.elSeries,B),g.globals.isXNumeric&&g.globals.seriesX.length>0&&(q=(g.globals.seriesX[B][0]-g.globals.minX)/this.xRatio),$.push(q);var K,oe=q,ae=oe,fe=this.zeroY;fe=this.lineHelpers.determineFirstPrevY({i:L,series:o,prevY:fe,lineYPosition:0}).prevY,V.push(fe),K=fe;var ge=this._calculatePathsFrom({series:o,i:L,realIndex:B,prevX:ae,prevY:fe}),R=this._iterateOverDataPoints({series:o,realIndex:B,i:L,x:q,y:1,pX:oe,pY:K,pathsFrom:ge,linePaths:[],areaPaths:[],seriesIndex:d,lineYPosition:0,xArrj:$,yArrj:V});this._handlePaths({type:D,realIndex:B,i:L,paths:R}),this.elSeries.add(this.elPointsMain),this.elSeries.add(this.elDataLabelsWrap),P.push(this.elSeries)}if(g.config.chart.stacked)for(var H=P.length;H>0;H--)C.add(P[H-1]);else for(var Q=0;Q<P.length;Q++)C.add(P[Q]);return C}},{key:"_initSerieVariables",value:function(o,a,d){var g=this.w,_=new yt(this.ctx);this.xDivision=g.globals.gridWidth/(g.globals.dataPoints-("on"===g.config.xaxis.tickPlacement?1:0)),this.strokeWidth=Array.isArray(g.config.stroke.width)?g.config.stroke.width[d]:g.config.stroke.width,this.yRatio.length>1&&(this.yaxisIndex=d),this.isReversed=g.config.yaxis[this.yaxisIndex]&&g.config.yaxis[this.yaxisIndex].reversed,this.zeroY=g.globals.gridHeight-this.baseLineY[this.yaxisIndex]-(this.isReversed?g.globals.gridHeight:0)+(this.isReversed?2*this.baseLineY[this.yaxisIndex]:0),this.areaBottomY=this.zeroY,(this.zeroY>g.globals.gridHeight||"end"===g.config.plotOptions.area.fillTo)&&(this.areaBottomY=g.globals.gridHeight),this.categoryAxisCorrection=this.xDivision/2,this.elSeries=_.group({class:"apexcharts-series",seriesName:Xe.escapeString(g.globals.seriesNames[d])}),this.elPointsMain=_.group({class:"apexcharts-series-markers-wrap","data:realIndex":d}),this.elDataLabelsWrap=_.group({class:"apexcharts-datalabels","data:realIndex":d}),this.elSeries.attr({"data:longestSeries":o[a].length===g.globals.dataPoints,rel:a+1,"data:realIndex":d}),this.appendPathFrom=!0}},{key:"_calculatePathsFrom",value:function(o){var a,d,g,_,D=o.series,C=o.i,T=o.realIndex,P=o.prevX,L=o.prevY,B=this.w,V=new yt(this.ctx);if(null===D[C][0]){for(var $=0;$<D[C].length;$++)if(null!==D[C][$]){a=V.move(P=this.xDivision*$,L=this.zeroY-D[C][$]/this.yRatio[this.yaxisIndex]),d=V.move(P,this.areaBottomY);break}}else a=V.move(P,L),d=V.move(P,this.areaBottomY)+V.line(P,L);if(g=V.move(-1,this.zeroY)+V.line(-1,this.zeroY),_=V.move(-1,this.zeroY)+V.line(-1,this.zeroY),B.globals.previousPaths.length>0){var q=this.lineHelpers.checkPreviousPaths({pathFromLine:g,pathFromArea:_,realIndex:T});g=q.pathFromLine,_=q.pathFromArea}return{prevX:P,prevY:L,linePath:a,areaPath:d,pathFromLine:g,pathFromArea:_}}},{key:"_handlePaths",value:function(o){var a=o.type,d=o.realIndex,g=o.i,_=o.paths,D=this.w,C=new yt(this.ctx),T=new Xr(this.ctx);this.prevSeriesY.push(_.yArrj),D.globals.seriesXvalues[d]=_.xArrj,D.globals.seriesYvalues[d]=_.yArrj;var P=D.config.forecastDataPoints;if(P.count>0){var L=D.globals.seriesXvalues[d][D.globals.seriesXvalues[d].length-P.count-1],B=C.drawRect(L,0,D.globals.gridWidth,D.globals.gridHeight,0);D.globals.dom.elForecastMask.appendChild(B.node);var V=C.drawRect(0,0,L,D.globals.gridHeight,0);D.globals.dom.elNonForecastMask.appendChild(V.node)}this.pointsChart||D.globals.delayedElements.push({el:this.elPointsMain.node,index:d});var $={i:g,realIndex:d,animationDelay:g,initialSpeed:D.config.chart.animations.speed,dataChangeSpeed:D.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-".concat(a)};if("area"===a)for(var q=T.fillPath({seriesNumber:d}),K=0;K<_.areaPaths.length;K++){var oe=C.renderPaths(Je(Je({},$),{},{pathFrom:_.pathFromArea,pathTo:_.areaPaths[K],stroke:"none",strokeWidth:0,strokeLineCap:null,fill:q}));this.elSeries.add(oe)}if(D.config.stroke.show&&!this.pointsChart){var ae;ae="line"===a?T.fillPath({seriesNumber:d,i:g}):D.globals.stroke.colors[d];for(var fe=0;fe<_.linePaths.length;fe++){var ge=Je(Je({},$),{},{pathFrom:_.pathFromLine,pathTo:_.linePaths[fe],stroke:ae,strokeWidth:this.strokeWidth,strokeLineCap:D.config.stroke.lineCap,fill:"none"}),R=C.renderPaths(ge);if(this.elSeries.add(R),P.count>0){var H=C.renderPaths(ge);H.node.setAttribute("stroke-dasharray",P.dashArray),P.strokeWidth&&H.node.setAttribute("stroke-width",P.strokeWidth),this.elSeries.add(H),H.attr("clip-path","url(#forecastMask".concat(D.globals.cuid,")")),R.attr("clip-path","url(#nonForecastMask".concat(D.globals.cuid,")"))}}}}},{key:"_iterateOverDataPoints",value:function(o){for(var a=o.series,d=o.realIndex,g=o.i,_=o.x,D=o.y,C=o.pX,T=o.pY,P=o.pathsFrom,L=o.linePaths,B=o.areaPaths,V=o.seriesIndex,$=o.lineYPosition,q=o.xArrj,K=o.yArrj,oe=this.w,ae=new yt(this.ctx),fe=this.yRatio,ge=P.prevY,R=P.linePath,H=P.areaPath,Q=P.pathFromLine,le=P.pathFromArea,Re=Xe.isNumber(oe.globals.minYArr[d])?oe.globals.minYArr[d]:oe.globals.minY,tt=oe.globals.dataPoints>1?oe.globals.dataPoints-1:oe.globals.dataPoints,Ve=0;Ve<tt;Ve++){var Dt=null==a[g][Ve+1];if(oe.globals.isXNumeric){var pt=oe.globals.seriesX[d][Ve+1];void 0===oe.globals.seriesX[d][Ve+1]&&(pt=oe.globals.seriesX[d][tt-1]),_=(pt-oe.globals.minX)/this.xRatio}else _+=this.xDivision;$=oe.config.chart.stacked&&g>0&&oe.globals.collapsedSeries.length<oe.config.series.length-1?this.prevSeriesY[function(Yn){for(var pn=Yn,xi=0;xi<oe.globals.series.length;xi++)if(oe.globals.collapsedSeriesIndices.indexOf(Yn)>-1){pn--;break}return pn>=0?pn:0}(g-1)][Ve+1]:this.zeroY,D=Dt?$-Re/fe[this.yaxisIndex]+2*(this.isReversed?Re/fe[this.yaxisIndex]:0):$-a[g][Ve+1]/fe[this.yaxisIndex]+2*(this.isReversed?a[g][Ve+1]/fe[this.yaxisIndex]:0),q.push(_),K.push(D);var qe=this.lineHelpers.calculatePoints({series:a,x:_,y:D,realIndex:d,i:g,j:Ve,prevY:ge}),Vt=this._createPaths({series:a,i:g,realIndex:d,j:Ve,x:_,y:D,pX:C,pY:T,linePath:R,areaPath:H,linePaths:L,areaPaths:B,seriesIndex:V});B=Vt.areaPaths,L=Vt.linePaths,C=Vt.pX,T=Vt.pY,H=Vt.areaPath,R=Vt.linePath,this.appendPathFrom&&(Q+=ae.line(_,this.zeroY),le+=ae.line(_,this.zeroY)),this.handleNullDataPoints(a,qe,g,Ve,d),this._handleMarkersAndLabels({pointsPos:qe,series:a,x:_,y:D,prevY:ge,i:g,j:Ve,realIndex:d})}return{yArrj:K,xArrj:q,pathFromArea:le,areaPaths:B,pathFromLine:Q,linePaths:L}}},{key:"_handleMarkersAndLabels",value:function(o){var a=o.pointsPos,d=o.i,g=o.j,_=o.realIndex,D=this.w,C=new ls(this.ctx);if(this.pointsChart)this.scatter.draw(this.elSeries,g,{realIndex:_,pointsPos:a,zRatio:this.zRatio,elParent:this.elPointsMain});else{D.globals.series[d].length>1&&this.elPointsMain.node.classList.add("apexcharts-element-hidden");var T=this.markers.plotChartMarkers(a,_,g+1);null!==T&&this.elPointsMain.add(T)}var P=C.drawDataLabel(a,_,g+1,null);null!==P&&this.elDataLabelsWrap.add(P)}},{key:"_createPaths",value:function(o){var a=o.series,d=o.i,g=o.realIndex,_=o.j,D=o.x,C=o.y,T=o.pX,P=o.pY,L=o.linePath,B=o.areaPath,V=o.linePaths,$=o.areaPaths,q=o.seriesIndex,K=this.w,oe=new yt(this.ctx),ae=K.config.stroke.curve,fe=this.areaBottomY;if(Array.isArray(K.config.stroke.curve)&&(ae=Array.isArray(q)?K.config.stroke.curve[q[d]]:K.config.stroke.curve[d]),"smooth"===ae){var ge=.35*(D-T);K.globals.hasNullValues?(null!==a[d][_]&&(null!==a[d][_+1]?(L=oe.move(T,P)+oe.curve(T+ge,P,D-ge,C,D+1,C),B=oe.move(T+1,P)+oe.curve(T+ge,P,D-ge,C,D+1,C)+oe.line(D,fe)+oe.line(T,fe)+"z"):(L=oe.move(T,P),B=oe.move(T,P)+"z")),V.push(L),$.push(B)):(L+=oe.curve(T+ge,P,D-ge,C,D,C),B+=oe.curve(T+ge,P,D-ge,C,D,C)),T=D,P=C,_===a[d].length-2&&(B=B+oe.curve(T,P,D,C,D,fe)+oe.move(D,C)+"z",K.globals.hasNullValues||(V.push(L),$.push(B)))}else null===a[d][_+1]&&(L+=oe.move(D,C),B=B+oe.line(K.globals.isXNumeric?(K.globals.seriesX[g][_]-K.globals.minX)/this.xRatio:D-this.xDivision,fe)+oe.move(D,C)+"z"),null===a[d][_]&&(L+=oe.move(D,C),B+=oe.move(D,fe)),"stepline"===ae?(L=L+oe.line(D,null,"H")+oe.line(null,C,"V"),B=B+oe.line(D,null,"H")+oe.line(null,C,"V")):"straight"===ae&&(L+=oe.line(D,C),B+=oe.line(D,C)),_===a[d].length-2&&(B=B+oe.line(D,fe)+oe.move(D,C)+"z",V.push(L),$.push(B));return{linePaths:V,areaPaths:$,pX:T,pY:P,linePath:L,areaPath:B}}},{key:"handleNullDataPoints",value:function(o,a,d,g,_){var D=this.w;if(null===o[d][g]&&D.config.markers.showNullDataPoints||1===o[d].length){var C=this.markers.plotChartMarkers(a,_,g+1,this.strokeWidth-D.config.markers.strokeWidth/2,!0);null!==C&&this.elPointsMain.add(C)}}}]),te}();window.TreemapSquared={},window.TreemapSquared.generate=function(){function te(C,T,P,L){this.xoffset=C,this.yoffset=T,this.height=L,this.width=P,this.shortestEdge=function(){return Math.min(this.height,this.width)},this.getCoordinates=function(B){var V,$=[],q=this.xoffset,K=this.yoffset,oe=_(B)/this.height,ae=_(B)/this.width;if(this.width>=this.height)for(V=0;V<B.length;V++)$.push([q,K,q+oe,K+B[V]/oe]),K+=B[V]/oe;else for(V=0;V<B.length;V++)$.push([q,K,q+B[V]/ae,K+ae]),q+=B[V]/ae;return $},this.cutArea=function(B){var V;if(this.width>=this.height){var $=B/this.height;V=new te(this.xoffset+$,this.yoffset,this.width-$,this.height)}else{var K=B/this.width;V=new te(this.xoffset,this.yoffset+K,this.width,this.height-K)}return V}}function o(C,T,P,L,B){return L=void 0===L?0:L,B=void 0===B?0:B,function(V){var $,q,K=[];for($=0;$<V.length;$++)for(q=0;q<V[$].length;q++)K.push(V[$][q]);return K}(a(function(V,$){var q,K=[],oe=$/_(V);for(q=0;q<V.length;q++)K[q]=V[q]*oe;return K}(C,T*P),[],new te(L,B,T,P),[]))}function a(C,T,P,L){var B,V,$,q,K,oe,ae;if(0!==C.length)return B=P.shortestEdge(),K=V=C[0],oe=B,0===(q=T).length||((ae=q.slice()).push(K),d(q,oe)>=d(ae,oe))?(T.push(V),a(C.slice(1),T,P,L)):($=P.cutArea(_(T),L),L.push(P.getCoordinates(T)),a(C,[],$,L)),L;L.push(P.getCoordinates(T))}function d(C,T){var P=Math.min.apply(Math,C),L=Math.max.apply(Math,C),B=_(C);return Math.max(Math.pow(T,2)*L/Math.pow(B,2),Math.pow(B,2)/(Math.pow(T,2)*P))}function g(C){return C&&C.constructor===Array}function _(C){var T,P=0;for(T=0;T<C.length;T++)P+=C[T];return P}function D(C){var T,P=0;if(g(C[0]))for(T=0;T<C.length;T++)P+=D(C[T]);else P=_(C);return P}return function C(T,P,L,B,V){B=void 0===B?0:B,V=void 0===V?0:V;var $,q,K=[],oe=[];if(g(T[0])){for(q=0;q<T.length;q++)K[q]=D(T[q]);for($=o(K,P,L,B,V),q=0;q<T.length;q++)oe.push(C(T[q],$[q][2]-$[q][0],$[q][3]-$[q][1],$[q][0],$[q][1]))}else oe=o(T,P,L,B,V);return oe}}();var ue,xe,Ae=function(){function te(o,a){zt(this,te),this.ctx=o,this.w=o.w,this.strokeWidth=this.w.config.stroke.width,this.helpers=new Bo(o),this.dynamicAnim=this.w.config.chart.animations.dynamicAnimation,this.labels=[]}return St(te,[{key:"draw",value:function(o){var a=this,d=this.w,g=new yt(this.ctx),_=new Xr(this.ctx),D=g.group({class:"apexcharts-treemap"});if(d.globals.noData)return D;var C=[];return o.forEach(function(T){var P=T.map(function(L){return Math.abs(L)});C.push(P)}),this.negRange=this.helpers.checkColorRange(),d.config.series.forEach(function(T,P){T.data.forEach(function(L){Array.isArray(a.labels[P])||(a.labels[P]=[]),a.labels[P].push(L.x)})}),window.TreemapSquared.generate(C,d.globals.gridWidth,d.globals.gridHeight).forEach(function(T,P){var L=g.group({class:"apexcharts-series apexcharts-treemap-series",seriesName:Xe.escapeString(d.globals.seriesNames[P]),rel:P+1,"data:realIndex":P});if(d.config.chart.dropShadow.enabled){var B=d.config.chart.dropShadow;new pi(a.ctx).dropShadow(D,B,P)}var V=g.group({class:"apexcharts-data-labels"});T.forEach(function($,q){var K=$[0],oe=$[1],ae=$[2],fe=$[3],ge=g.drawRect(K,oe,ae-K,fe-oe,0,"#fff",1,a.strokeWidth,d.config.plotOptions.treemap.useFillColorAsStroke?H:d.globals.stroke.colors[P]);ge.attr({cx:K,cy:oe,index:P,i:P,j:q,width:ae-K,height:fe-oe});var R=a.helpers.getShadeColor(d.config.chart.type,P,q,a.negRange),H=R.color;void 0!==d.config.series[P].data[q]&&d.config.series[P].data[q].fillColor&&(H=d.config.series[P].data[q].fillColor);var Q=_.fillPath({color:H,seriesNumber:P,dataPointIndex:q});ge.node.classList.add("apexcharts-treemap-rect"),ge.attr({fill:Q}),a.helpers.addListeners(ge);var le={x:K+(ae-K)/2,y:oe+(fe-oe)/2,width:0,height:0},Re={x:K,y:oe,width:ae-K,height:fe-oe};if(d.config.chart.animations.enabled&&!d.globals.dataChanged){var tt=1;d.globals.resized||(tt=d.config.chart.animations.speed),a.animateTreemap(ge,le,Re,tt)}d.globals.dataChanged&&a.dynamicAnim.enabled&&d.globals.shouldAnimate&&(d.globals.previousPaths[P]&&d.globals.previousPaths[P][q]&&d.globals.previousPaths[P][q].rect&&(le=d.globals.previousPaths[P][q].rect),a.animateTreemap(ge,le,Re,a.dynamicAnim.speed));var Dt=a.getFontSize($),pt=d.config.dataLabels.formatter(a.labels[P][q],{value:d.globals.series[P][q],seriesIndex:P,dataPointIndex:q,w:d}),qe=a.helpers.calculateDataLabels({text:pt,x:(K+ae)/2,y:(oe+fe)/2+a.strokeWidth/2+Dt/3,i:P,j:q,colorProps:R,fontSize:Dt,series:o});d.config.dataLabels.enabled&&qe&&a.rotateToFitLabel(qe,pt,K,oe,ae,fe),L.add(ge),null!==qe&&L.add(qe)}),L.add(V),D.add(L)}),D}},{key:"getFontSize",value:function(o){var D,a=this.w,C=function T(P){var L,B=0;if(Array.isArray(P[0]))for(L=0;L<P.length;L++)B+=T(P[L]);else for(L=0;L<P.length;L++)B+=P[L].length;return B}(this.labels)/function T(P){var L,B=0;if(Array.isArray(P[0]))for(L=0;L<P.length;L++)B+=T(P[L]);else for(L=0;L<P.length;L++)B+=1;return B}(this.labels);return D=Math.pow((o[2]-o[0])*(o[3]-o[1]),.5),Math.min(D/C,parseInt(a.config.dataLabels.style.fontSize,10))}},{key:"rotateToFitLabel",value:function(o,a,d,g,_,D){var C=new yt(this.ctx),T=C.getTextRects(a);if(T.width+5>_-d&&T.width<=D-g){var P=C.rotateAroundCenter(o.node);o.node.setAttribute("transform","rotate(-90 ".concat(P.x," ").concat(P.y,")"))}}},{key:"animateTreemap",value:function(o,a,d,g){var _=new mr(this.ctx);_.animateRect(o,{x:a.x,y:a.y,width:a.width,height:a.height},{x:d.x,y:d.y,width:d.width,height:d.height},g,function(){_.animationCompleted(o)})}}]),te}(),Ie=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w,this.timeScaleArray=[],this.utc=this.w.config.xaxis.labels.datetimeUTC}return St(te,[{key:"calculateTimeScaleTicks",value:function(o,a){var d=this,g=this.w;if(g.globals.allSeriesCollapsed)return g.globals.labels=[],g.globals.timescaleLabels=[],[];var _=new mn(this.ctx),D=(a-o)/864e5;this.determineInterval(D),g.globals.disableZoomIn=!1,g.globals.disableZoomOut=!1,D<.00011574074074074075?g.globals.disableZoomIn=!0:D>5e4&&(g.globals.disableZoomOut=!0);var C=_.getTimeUnitsfromTimestamp(o,a,this.utc),T=g.globals.gridWidth/D,P=T/24,L=P/60,B=L/60,V=Math.floor(24*D),$=Math.floor(1440*D),q=Math.floor(86400*D),K=Math.floor(D),oe=Math.floor(D/30),ae=Math.floor(D/365),fe={minMillisecond:C.minMillisecond,minSecond:C.minSecond,minMinute:C.minMinute,minHour:C.minHour,minDate:C.minDate,minMonth:C.minMonth,minYear:C.minYear},ge={firstVal:fe,currentMillisecond:fe.minMillisecond,currentSecond:fe.minSecond,currentMinute:fe.minMinute,currentHour:fe.minHour,currentMonthDate:fe.minDate,currentDate:fe.minDate,currentMonth:fe.minMonth,currentYear:fe.minYear,daysWidthOnXAxis:T,hoursWidthOnXAxis:P,minutesWidthOnXAxis:L,secondsWidthOnXAxis:B,numberOfSeconds:q,numberOfMinutes:$,numberOfHours:V,numberOfDays:K,numberOfMonths:oe,numberOfYears:ae};switch(this.tickInterval){case"years":this.generateYearScale(ge);break;case"months":case"half_year":this.generateMonthScale(ge);break;case"months_days":case"months_fortnight":case"days":case"week_days":this.generateDayScale(ge);break;case"hours":this.generateHourScale(ge);break;case"minutes_fives":case"minutes":this.generateMinuteScale(ge);break;case"seconds_tens":case"seconds_fives":case"seconds":this.generateSecondScale(ge)}var R=this.timeScaleArray.map(function(H){var Q={position:H.position,unit:H.unit,year:H.year,day:H.day?H.day:1,hour:H.hour?H.hour:0,month:H.month+1};return"month"===H.unit?Je(Je({},Q),{},{day:1,value:H.value+1}):"day"===H.unit||"hour"===H.unit?Je(Je({},Q),{},{value:H.value}):"minute"===H.unit?Je(Je({},Q),{},{value:H.value,minute:H.value}):"second"===H.unit?Je(Je({},Q),{},{value:H.value,minute:H.minute,second:H.second}):H});return R.filter(function(H){var Q=1,le=Math.ceil(g.globals.gridWidth/120),Re=H.value;void 0!==g.config.xaxis.tickAmount&&(le=g.config.xaxis.tickAmount),R.length>le&&(Q=Math.floor(R.length/le));var tt=!1,Ve=!1;switch(d.tickInterval){case"years":"year"===H.unit&&(tt=!0);break;case"half_year":Q=7,"year"===H.unit&&(tt=!0);break;case"months":Q=1,"year"===H.unit&&(tt=!0);break;case"months_fortnight":Q=15,"year"!==H.unit&&"month"!==H.unit||(tt=!0),30===Re&&(Ve=!0);break;case"months_days":Q=10,"month"===H.unit&&(tt=!0),30===Re&&(Ve=!0);break;case"week_days":Q=8,"month"===H.unit&&(tt=!0);break;case"days":Q=1,"month"===H.unit&&(tt=!0);break;case"hours":"day"===H.unit&&(tt=!0);break;case"minutes_fives":case"seconds_fives":Re%5!=0&&(Ve=!0);break;case"seconds_tens":Re%10!=0&&(Ve=!0)}if("hours"===d.tickInterval||"minutes_fives"===d.tickInterval||"seconds_tens"===d.tickInterval||"seconds_fives"===d.tickInterval){if(!Ve)return!0}else if((Re%Q==0||tt)&&!Ve)return!0})}},{key:"recalcDimensionsBasedOnFormat",value:function(o,a){var d=this.w,g=this.formatDates(o),_=this.removeOverlappingTS(g);d.globals.timescaleLabels=_.slice(),new rr(this.ctx).plotCoords()}},{key:"determineInterval",value:function(o){var a=24*o,d=60*a;switch(!0){case o/365>5:this.tickInterval="years";break;case o>800:this.tickInterval="half_year";break;case o>180:this.tickInterval="months";break;case o>90:this.tickInterval="months_fortnight";break;case o>60:this.tickInterval="months_days";break;case o>30:this.tickInterval="week_days";break;case o>2:this.tickInterval="days";break;case a>2.4:this.tickInterval="hours";break;case d>15:this.tickInterval="minutes_fives";break;case d>5:this.tickInterval="minutes";break;case d>1:this.tickInterval="seconds_tens";break;case 60*d>20:this.tickInterval="seconds_fives";break;default:this.tickInterval="seconds"}}},{key:"generateYearScale",value:function(o){var a=o.firstVal,d=o.currentMonth,g=o.currentYear,_=o.daysWidthOnXAxis,D=o.numberOfYears,C=a.minYear,T=0,P=new mn(this.ctx),L="year";if(a.minDate>1||a.minMonth>0){var B=P.determineRemainingDaysOfYear(a.minYear,a.minMonth,a.minDate);T=(P.determineDaysOfYear(a.minYear)-B+1)*_,this.timeScaleArray.push({position:T,value:C=a.minYear+1,unit:L,year:C,month:Xe.monthMod(d+1)})}else 1===a.minDate&&0===a.minMonth&&this.timeScaleArray.push({position:T,value:C,unit:L,year:g,month:Xe.monthMod(d+1)});for(var V=C,$=T,q=0;q<D;q++)V++,$=P.determineDaysOfYear(V-1)*_+$,this.timeScaleArray.push({position:$,value:V,unit:L,year:V,month:1})}},{key:"generateMonthScale",value:function(o){var a=o.firstVal,d=o.currentMonthDate,g=o.currentMonth,_=o.currentYear,D=o.daysWidthOnXAxis,C=o.numberOfMonths,T=g,P=0,L=new mn(this.ctx),B="month",V=0;if(a.minDate>1){P=(L.determineDaysOfMonths(g+1,a.minYear)-d+1)*D,T=Xe.monthMod(g+1);var $=_+V,q=Xe.monthMod(T),K=T;0===T&&(B="year",K=$,q=1,$+=V+=1),this.timeScaleArray.push({position:P,value:K,unit:B,year:$,month:q})}else this.timeScaleArray.push({position:P,value:T,unit:B,year:_,month:Xe.monthMod(g)});for(var oe=T+1,ae=P,fe=0,ge=1;fe<C;fe++,ge++){0===(oe=Xe.monthMod(oe))?(B="year",V+=1):B="month";var R=this._getYear(_,oe,V);ae=L.determineDaysOfMonths(oe,R)*D+ae,this.timeScaleArray.push({position:ae,value:0===oe?R:oe,unit:B,year:R,month:0===oe?1:oe}),oe++}}},{key:"generateDayScale",value:function(o){var a=o.firstVal,d=o.currentMonth,g=o.currentYear,_=o.hoursWidthOnXAxis,D=o.numberOfDays,C=new mn(this.ctx),T="day",P=a.minDate+1,L=P,B=function(ge,R,H){return ge>C.determineDaysOfMonths(R+1,H)&&(L=1,T="month",$=R+=1),R},V=(24-a.minHour)*_,$=P,q=B(L,d,g);0===a.minHour&&1===a.minDate?(V=0,$=Xe.monthMod(a.minMonth),T="month",L=a.minDate,D++):1!==a.minDate&&0===a.minHour&&0===a.minMinute&&(V=0,$=P=a.minDate,q=B(L=P,d,g)),this.timeScaleArray.push({position:V,value:$,unit:T,year:this._getYear(g,q,0),month:Xe.monthMod(q),day:L});for(var K=V,oe=0;oe<D;oe++){T="day",q=B(L+=1,q,this._getYear(g,q,0));var ae=this._getYear(g,q,0);K=24*_+K;var fe=1===L?Xe.monthMod(q):L;this.timeScaleArray.push({position:K,value:fe,unit:T,year:ae,month:Xe.monthMod(q),day:fe})}}},{key:"generateHourScale",value:function(o){var a=o.firstVal,d=o.currentDate,g=o.currentMonth,_=o.currentYear,D=o.minutesWidthOnXAxis,C=o.numberOfHours,T=new mn(this.ctx),P="hour",B=function(Q,le){return Q>T.determineDaysOfMonths(le+1,_)?le+=1:le},V=60-(a.minMinute+a.minSecond/60),$=V*D,q=a.minHour+1,K=q+1;60===V&&($=0,K=(q=a.minHour)+1);var Q,le,oe=d,ae=B(oe,g);this.timeScaleArray.push({position:$,value:q,unit:P,day:oe,hour:K,year:_,month:Xe.monthMod(ae)});for(var fe=$,ge=0;ge<C;ge++){P="hour",K>=24&&(K=0,P="day",ae=(Q=oe+=1,le=ae,Q>T.determineDaysOfMonths(le+1,_)&&(oe=1,le+=1),{month:le,date:oe}).month,ae=B(oe,ae));var R=this._getYear(_,ae,0);this.timeScaleArray.push({position:fe=0===K&&0===ge?V*D:60*D+fe,value:0===K?oe:K,unit:P,hour:K,day:oe,year:R,month:Xe.monthMod(ae)}),K++}}},{key:"generateMinuteScale",value:function(o){for(var P=o.minutesWidthOnXAxis,B=o.numberOfMinutes,V=o.currentMinute+1,$=o.currentDate,q=o.currentMonth,K=o.currentYear,oe=o.currentHour,ae=(60-o.currentSecond-o.currentMillisecond/1e3)*o.secondsWidthOnXAxis,fe=0;fe<B;fe++)V>=60&&(V=0,24===(oe+=1)&&(oe=0)),this.timeScaleArray.push({position:ae,value:V,unit:"minute",hour:oe,minute:V,day:$,year:this._getYear(K,q,0),month:Xe.monthMod(q)}),ae+=P,V++}},{key:"generateSecondScale",value:function(o){for(var P=o.secondsWidthOnXAxis,L=o.numberOfSeconds,B=o.currentSecond+1,V=o.currentMinute,$=o.currentDate,q=o.currentMonth,K=o.currentYear,oe=o.currentHour,ae=(1e3-o.currentMillisecond)/1e3*P,fe=0;fe<L;fe++)B>=60&&(B=0,++V>=60&&(V=0,24==++oe&&(oe=0))),this.timeScaleArray.push({position:ae,value:B,unit:"second",hour:oe,minute:V,second:B,day:$,year:this._getYear(K,q,0),month:Xe.monthMod(q)}),ae+=P,B++}},{key:"createRawDateString",value:function(o,a){var d=o.year;return 0===o.month&&(o.month=1),d+="-"+("0"+o.month.toString()).slice(-2),d+="day"===o.unit?"day"===o.unit?"-"+("0"+a).slice(-2):"-01":"-"+("0"+(o.day?o.day:"1")).slice(-2),d+="hour"===o.unit?"hour"===o.unit?"T"+("0"+a).slice(-2):"T00":"T"+("0"+(o.hour?o.hour:"0")).slice(-2),d+="minute"===o.unit?":"+("0"+a).slice(-2):":"+(o.minute?("0"+o.minute).slice(-2):"00"),d+="second"===o.unit?":"+("0"+a).slice(-2):":00",this.utc&&(d+=".000Z"),d}},{key:"formatDates",value:function(o){var a=this,d=this.w;return o.map(function(g){var _=g.value.toString(),D=new mn(a.ctx),C=a.createRawDateString(g,_),T=D.getDate(D.parseDate(C));if(a.utc||(T=D.getDate(D.parseDateWithTimezone(C))),void 0===d.config.xaxis.labels.format){var P="dd MMM",L=d.config.xaxis.labels.datetimeFormatter;"year"===g.unit&&(P=L.year),"month"===g.unit&&(P=L.month),"day"===g.unit&&(P=L.day),"hour"===g.unit&&(P=L.hour),"minute"===g.unit&&(P=L.minute),"second"===g.unit&&(P=L.second),_=D.formatDate(T,P)}else _=D.formatDate(T,d.config.xaxis.labels.format);return{dateString:C,position:g.position,value:_,unit:g.unit,year:g.year,month:g.month}})}},{key:"removeOverlappingTS",value:function(o){var a,d=this,g=new yt(this.ctx),_=!1;o.length>0&&o[0].value&&o.every(function(T){return T.value.length===o[0].value.length})&&(_=!0,a=g.getTextRects(o[0].value).width);var D=0;return o.map(function(T,P){if(P>0&&d.w.config.xaxis.labels.hideOverlappingLabels){var L=_?a:g.getTextRects(o[D].value).width;return T.position>o[D].position+L+10?(D=P,T):null}return T}).filter(function(T){return null!==T})}},{key:"_getYear",value:function(o,a,d){return o+Math.floor(a/12)+d}}]),te}(),$e=function(){function te(o,a){zt(this,te),this.ctx=a,this.w=a.w,this.el=o}return St(te,[{key:"setupElements",value:function(){var o=this.w.globals,a=this.w.config,d=a.chart.type;o.axisCharts=["line","area","bar","rangeBar","candlestick","boxPlot","scatter","bubble","radar","heatmap","treemap"].indexOf(d)>-1,o.xyCharts=["line","area","bar","rangeBar","candlestick","boxPlot","scatter","bubble"].indexOf(d)>-1,o.isBarHorizontal=("bar"===a.chart.type||"rangeBar"===a.chart.type)&&a.plotOptions.bar.horizontal,o.chartClass=".apexcharts"+o.chartID,o.dom.baseEl=this.el,o.dom.elWrap=document.createElement("div"),yt.setAttrs(o.dom.elWrap,{id:o.chartClass.substring(1),class:"apexcharts-canvas "+o.chartClass.substring(1)}),this.el.appendChild(o.dom.elWrap),o.dom.Paper=new window.SVG.Doc(o.dom.elWrap),o.dom.Paper.attr({class:"apexcharts-svg","xmlns:data":"ApexChartsNS",transform:"translate(".concat(a.chart.offsetX,", ").concat(a.chart.offsetY,")")}),o.dom.Paper.node.style.background=a.chart.background,this.setSVGDimensions(),o.dom.elGraphical=o.dom.Paper.group().attr({class:"apexcharts-inner apexcharts-graphical"}),o.dom.elAnnotations=o.dom.Paper.group().attr({class:"apexcharts-annotations"}),o.dom.elDefs=o.dom.Paper.defs(),o.dom.elLegendWrap=document.createElement("div"),o.dom.elLegendWrap.classList.add("apexcharts-legend"),o.dom.elWrap.appendChild(o.dom.elLegendWrap),o.dom.Paper.add(o.dom.elGraphical),o.dom.elGraphical.add(o.dom.elDefs)}},{key:"plotChartType",value:function(o,a){var d=this.w,g=d.config,_=d.globals,D={series:[],i:[]},C={series:[],i:[]},T={series:[],i:[]},P={series:[],i:[]},L={series:[],i:[]},B={series:[],i:[]},V={series:[],i:[]};_.series.map(function(H,Q){var le=0;void 0!==o[Q].type?("column"===o[Q].type||"bar"===o[Q].type?(_.series.length>1&&g.plotOptions.bar.horizontal&&console.warn("Horizontal bars are not supported in a mixed/combo chart. Please turn off `plotOptions.bar.horizontal`"),L.series.push(H),L.i.push(Q),le++,d.globals.columnSeries=L.series):"area"===o[Q].type?(C.series.push(H),C.i.push(Q),le++):"line"===o[Q].type?(D.series.push(H),D.i.push(Q),le++):"scatter"===o[Q].type?(T.series.push(H),T.i.push(Q)):"bubble"===o[Q].type?(P.series.push(H),P.i.push(Q),le++):"candlestick"===o[Q].type?(B.series.push(H),B.i.push(Q),le++):"boxPlot"===o[Q].type?(V.series.push(H),V.i.push(Q),le++):console.warn("You have specified an unrecognized chart type. Available types for this property are line/area/column/bar/scatter/bubble"),le>1&&(_.comboCharts=!0)):(D.series.push(H),D.i.push(Q))});var $=new se(this.ctx,a),q=new wa(this.ctx,a);this.ctx.pie=new ja(this.ctx);var K=new Da(this.ctx);this.ctx.rangeBar=new Or(this.ctx,a);var oe=new Sa(this.ctx),ae=[];if(_.comboCharts){if(C.series.length>0&&ae.push($.draw(C.series,"area",C.i)),L.series.length>0)if(d.config.chart.stacked){var fe=new zo(this.ctx,a);ae.push(fe.draw(L.series,L.i))}else this.ctx.bar=new Dn(this.ctx,a),ae.push(this.ctx.bar.draw(L.series,L.i));if(D.series.length>0&&ae.push($.draw(D.series,"line",D.i)),B.series.length>0&&ae.push(q.draw(B.series,B.i)),V.series.length>0&&ae.push(q.draw(V.series,V.i)),T.series.length>0){var ge=new se(this.ctx,a,!0);ae.push(ge.draw(T.series,"scatter",T.i))}if(P.series.length>0){var R=new se(this.ctx,a,!0);ae.push(R.draw(P.series,"bubble",P.i))}}else switch(g.chart.type){case"line":ae=$.draw(_.series,"line");break;case"area":ae=$.draw(_.series,"area");break;case"bar":g.chart.stacked?ae=new zo(this.ctx,a).draw(_.series):(this.ctx.bar=new Dn(this.ctx,a),ae=this.ctx.bar.draw(_.series));break;case"candlestick":case"boxPlot":ae=new wa(this.ctx,a).draw(_.series);break;case"rangeBar":ae=this.ctx.rangeBar.draw(_.series);break;case"heatmap":ae=new Ei(this.ctx,a).draw(_.series);break;case"treemap":ae=new Ae(this.ctx,a).draw(_.series);break;case"pie":case"donut":case"polarArea":ae=this.ctx.pie.draw(_.series);break;case"radialBar":ae=K.draw(_.series);break;case"radar":ae=oe.draw(_.series);break;default:ae=$.draw(_.series)}return ae}},{key:"setSVGDimensions",value:function(){var o=this.w.globals,a=this.w.config;o.svgWidth=a.chart.width,o.svgHeight=a.chart.height;var d=Xe.getDimensions(this.el),g=a.chart.width.toString().split(/[0-9]+/g).pop();"%"===g?Xe.isNumber(d[0])&&(0===d[0].width&&(d=Xe.getDimensions(this.el.parentNode)),o.svgWidth=d[0]*parseInt(a.chart.width,10)/100):"px"!==g&&""!==g||(o.svgWidth=parseInt(a.chart.width,10));var _=a.chart.height.toString().split(/[0-9]+/g).pop();if("auto"!==o.svgHeight&&""!==o.svgHeight)if("%"===_){var D=Xe.getDimensions(this.el.parentNode);o.svgHeight=D[1]*parseInt(a.chart.height,10)/100}else o.svgHeight=parseInt(a.chart.height,10);else o.svgHeight=o.axisCharts?o.svgWidth/1.61:o.svgWidth/1.2;o.svgWidth<0&&(o.svgWidth=0),o.svgHeight<0&&(o.svgHeight=0),yt.setAttrs(o.dom.Paper.node,{width:o.svgWidth,height:o.svgHeight}),"%"!==_&&(o.dom.Paper.node.parentNode.parentNode.style.minHeight=o.svgHeight+(a.chart.sparkline.enabled?0:o.axisCharts?a.chart.parentHeightOffset:0)+"px"),o.dom.elWrap.style.width=o.svgWidth+"px",o.dom.elWrap.style.height=o.svgHeight+"px"}},{key:"shiftGraphPosition",value:function(){var o=this.w.globals;yt.setAttrs(o.dom.elGraphical.node,{transform:"translate("+o.translateX+", "+o.translateY+")"})}},{key:"resizeNonAxisCharts",value:function(){var o=this.w,a=o.globals,d=0,g=o.config.chart.sparkline.enabled?1:15;g+=o.config.grid.padding.bottom,"top"!==o.config.legend.position&&"bottom"!==o.config.legend.position||!o.config.legend.show||o.config.legend.floating||(d=new Ua(this.ctx).legendHelpers.getLegendBBox().clwh+10);var _=o.globals.dom.baseEl.querySelector(".apexcharts-radialbar, .apexcharts-pie"),D=2.05*o.globals.radialSize;if(_&&!o.config.chart.sparkline.enabled&&0!==o.config.plotOptions.radialBar.startAngle){var C=Xe.getBoundingClientRect(_);D=C.bottom,D=Math.max(2.05*o.globals.radialSize,C.bottom-C.top)}var P=D+a.translateY+d+g;a.dom.elLegendForeign&&a.dom.elLegendForeign.setAttribute("height",P),a.dom.elWrap.style.height=P+"px",yt.setAttrs(a.dom.Paper.node,{height:P}),a.dom.Paper.node.parentNode.parentNode.style.minHeight=P+"px"}},{key:"coreCalculations",value:function(){new xn(this.ctx).init()}},{key:"resetGlobals",value:function(){var o=this,a=function(){return o.w.config.series.map(function(_){return[]})},d=new Kt,g=this.w.globals;d.initGlobalVars(g),g.seriesXvalues=a(),g.seriesYvalues=a()}},{key:"isMultipleY",value:function(){if(this.w.config.yaxis.constructor===Array&&this.w.config.yaxis.length>1)return this.w.globals.isMultipleYAxis=!0,!0}},{key:"xySettings",value:function(){var o=null,a=this.w;if(a.globals.axisCharts){if("back"===a.config.xaxis.crosshairs.position&&new Fo(this.ctx).drawXCrosshairs(),"back"===a.config.yaxis[0].crosshairs.position&&new Fo(this.ctx).drawYCrosshairs(),"datetime"===a.config.xaxis.type&&void 0===a.config.xaxis.labels.formatter){this.ctx.timeScale=new Ie(this.ctx);var d=[];isFinite(a.globals.minX)&&isFinite(a.globals.maxX)&&!a.globals.isBarHorizontal?d=this.ctx.timeScale.calculateTimeScaleTicks(a.globals.minX,a.globals.maxX):a.globals.isBarHorizontal&&(d=this.ctx.timeScale.calculateTimeScaleTicks(a.globals.minY,a.globals.maxY)),this.ctx.timeScale.recalcDimensionsBasedOnFormat(d)}o=new fi(this.ctx).getCalculatedRatios()}return o}},{key:"updateSourceChart",value:function(o){this.ctx.w.globals.selection=void 0,this.ctx.updateHelpers._updateOptions({chart:{selection:{xaxis:{min:o.w.globals.minX,max:o.w.globals.maxX}}}},!1,!1)}},{key:"setupBrushHandler",value:function(){var o=this,a=this.w;if(a.config.chart.brush.enabled&&"function"!=typeof a.config.chart.events.selection){var d=a.config.chart.brush.targets||[a.config.chart.brush.target];d.forEach(function(g){var _=ApexCharts.getChartByID(g);_.w.globals.brushSource=o.ctx,"function"!=typeof _.w.config.chart.events.zoomed&&(_.w.config.chart.events.zoomed=function(){o.updateSourceChart(_)}),"function"!=typeof _.w.config.chart.events.scrolled&&(_.w.config.chart.events.scrolled=function(){o.updateSourceChart(_)})}),a.config.chart.events.selection=function(g,_){d.forEach(function(D){var C=ApexCharts.getChartByID(D),T=Xe.clone(a.config.yaxis);if(a.config.chart.brush.autoScaleYaxis&&1===C.w.globals.series.length){var P=new Hs(C);T=P.autoScaleY(C,T,_)}var L=C.w.config.yaxis.reduce(function(B,V,$){return[].concat(wn(B),[Je(Je({},C.w.config.yaxis[$]),{},{min:T[0].min,max:T[0].max})])},[]);C.ctx.updateHelpers._updateOptions({xaxis:{min:_.xaxis.min,max:_.xaxis.max},yaxis:L},!1,!1,!1,!1)})}}}}]),te}(),Ue=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"_updateOptions",value:function(o){var a=this,d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],g=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],_=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],D=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new Promise(function(C){var T=[a.ctx];_&&(T=a.ctx.getSyncedCharts()),a.ctx.w.globals.isExecCalled&&(T=[a.ctx],a.ctx.w.globals.isExecCalled=!1),T.forEach(function(P,L){var B=P.w;return B.globals.shouldAnimate=g,d||(B.globals.resized=!0,B.globals.dataChanged=!0,g&&P.series.getPreviousPaths()),o&&"object"===nr(o)&&(P.config=new vn(o),o=fi.extendArrayProps(P.config,o,B),P.w.globals.chartID!==a.ctx.w.globals.chartID&&delete o.series,B.config=Xe.extend(B.config,o),D&&(B.globals.lastXAxis=o.xaxis?Xe.clone(o.xaxis):[],B.globals.lastYAxis=o.yaxis?Xe.clone(o.yaxis):[],B.globals.initialConfig=Xe.extend({},B.config),B.globals.initialSeries=Xe.clone(B.config.series))),P.update(o).then(function(){L===T.length-1&&C(P)})})})}},{key:"_updateSeries",value:function(o,a){var d=this,g=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise(function(_){var D,C=d.w;return C.globals.shouldAnimate=a,C.globals.dataChanged=!0,a&&d.ctx.series.getPreviousPaths(),C.globals.axisCharts?(0===(D=o.map(function(T,P){return d._extendSeries(T,P)})).length&&(D=[{data:[]}]),C.config.series=D):C.config.series=o.slice(),g&&(C.globals.initialSeries=Xe.clone(C.config.series)),d.ctx.update().then(function(){_(d.ctx)})})}},{key:"_extendSeries",value:function(o,a){var d=this.w,g=d.config.series[a];return Je(Je({},d.config.series[a]),{},{name:o.name?o.name:g&&g.name,color:o.color?o.color:g&&g.color,type:o.type?o.type:g&&g.type,data:o.data?o.data:g&&g.data})}},{key:"toggleDataPointSelection",value:function(o,a){var d=this.w,g=null,_=".apexcharts-series[data\\:realIndex='".concat(o,"']");return d.globals.axisCharts?g=d.globals.dom.Paper.select("".concat(_," path[j='").concat(a,"'], ").concat(_," circle[j='").concat(a,"'], ").concat(_," rect[j='").concat(a,"']")).members[0]:void 0===a&&(g=d.globals.dom.Paper.select("".concat(_," path[j='").concat(o,"']")).members[0],"pie"!==d.config.chart.type&&"polarArea"!==d.config.chart.type&&"donut"!==d.config.chart.type||this.ctx.pie.pieClicked(o)),g?(new yt(this.ctx).pathMouseDown(g,null),g.node?g.node:null):(console.warn("toggleDataPointSelection: Element not found"),null)}},{key:"forceXAxisUpdate",value:function(o){var a=this.w;if(["min","max"].forEach(function(g){void 0!==o.xaxis[g]&&(a.config.xaxis[g]=o.xaxis[g],a.globals.lastXAxis[g]=o.xaxis[g])}),o.xaxis.categories&&o.xaxis.categories.length&&(a.config.xaxis.categories=o.xaxis.categories),a.config.xaxis.convertedCatToNumeric){var d=new ni(o);o=d.convertCatToNumericXaxis(o,this.ctx)}return o}},{key:"forceYAxisUpdate",value:function(o){var a=this.w;return a.config.chart.stacked&&"100%"===a.config.chart.stackType&&(Array.isArray(o.yaxis)?o.yaxis.forEach(function(d,g){o.yaxis[g].min=0,o.yaxis[g].max=100}):(o.yaxis.min=0,o.yaxis.max=100)),o}},{key:"revertDefaultAxisMinMax",value:function(o){var a=this,d=this.w,g=d.globals.lastXAxis,_=d.globals.lastYAxis;o&&o.xaxis&&(g=o.xaxis),o&&o.yaxis&&(_=o.yaxis),d.config.xaxis.min=g.min,d.config.xaxis.max=g.max,d.config.yaxis.map(function(C,T){d.globals.zoomed||void 0!==_[T]?function(C){void 0!==_[C]&&(d.config.yaxis[C].min=_[C].min,d.config.yaxis[C].max=_[C].max)}(T):void 0!==a.ctx.opts.yaxis[T]&&(C.min=a.ctx.opts.yaxis[T].min,C.max=a.ctx.opts.yaxis[T].max)})}}]),te}();ue="undefined"!=typeof window?window:void 0,xe=function(te,o){var a=(void 0!==this?this:te).SVG=function(R){if(a.supported)return R=new a.Doc(R),a.parser.draw||a.prepare(),R};if(a.ns="http://www.w3.org/2000/svg",a.xmlns="http://www.w3.org/2000/xmlns/",a.xlink="http://www.w3.org/1999/xlink",a.svgjs="http://svgjs.dev",a.supported=!0,!a.supported)return!1;a.did=1e3,a.eid=function(R){return"Svgjs"+L(R)+a.did++},a.create=function(R){var H=o.createElementNS(this.ns,R);return H.setAttribute("id",this.eid(R)),H},a.extend=function(){var R,H;H=(R=[].slice.call(arguments)).pop();for(var Q=R.length-1;Q>=0;Q--)if(R[Q])for(var le in H)R[Q].prototype[le]=H[le];a.Set&&a.Set.inherit&&a.Set.inherit()},a.invent=function(R){var H="function"==typeof R.create?R.create:function(){this.constructor.call(this,a.create(R.create))};return R.inherit&&(H.prototype=new R.inherit),R.extend&&a.extend(H,R.extend),R.construct&&a.extend(R.parent||a.Container,R.construct),H},a.adopt=function(R){return R?R.instance?R.instance:((H="svg"==R.nodeName?R.parentNode instanceof te.SVGElement?new a.Nested:new a.Doc:"linearGradient"==R.nodeName?new a.Gradient("linear"):"radialGradient"==R.nodeName?new a.Gradient("radial"):a[L(R.nodeName)]?new(a[L(R.nodeName)]):new a.Element(R)).type=R.nodeName,H.node=R,R.instance=H,H instanceof a.Doc&&H.namespace().defs(),H.setData(JSON.parse(R.getAttribute("svgjs:data"))||{}),H):null;var H},a.prepare=function(){var R=o.getElementsByTagName("body")[0],H=(R?new a.Doc(R):a.adopt(o.documentElement).nested()).size(2,0);a.parser={body:R||o.documentElement,draw:H.style("opacity:0;position:absolute;left:-100%;top:-100%;overflow:hidden").node,poly:H.polyline().node,path:H.path().node,native:a.create("svg")}},a.parser={native:a.create("svg")},o.addEventListener("DOMContentLoaded",function(){a.parser.draw||a.prepare()},!1),a.regex={numberAndUnit:/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,hex:/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rgb:/rgb\((\d+),(\d+),(\d+)\)/,reference:/#([a-z0-9\-_]+)/i,transforms:/\)\s*,?\s*/,whitespace:/\s/g,isHex:/^#[a-f0-9]{3,6}$/i,isRgb:/^rgb\(/,isCss:/[^:]+:[^;]+;?/,isBlank:/^(\s+)?$/,isNumber:/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,isPercent:/^-?[\d\.]+%$/,isImage:/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,delimiter:/[\s,]+/,hyphen:/([^e])\-/gi,pathLetters:/[MLHVCSQTAZ]/gi,isPathLetter:/[MLHVCSQTAZ]/i,numbersWithDots:/((\d?\.\d+(?:e[+-]?\d+)?)((?:\.\d+(?:e[+-]?\d+)?)+))+/gi,dots:/\./g},a.utils={map:function(R,H){for(var Q=R.length,le=[],Re=0;Re<Q;Re++)le.push(H(R[Re]));return le},filter:function(R,H){for(var Q=R.length,le=[],Re=0;Re<Q;Re++)H(R[Re])&&le.push(R[Re]);return le},filterSVGElements:function(R){return this.filter(R,function(H){return H instanceof te.SVGElement})}},a.defaults={attrs:{"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","font-size":16,"font-family":"Helvetica, Arial, sans-serif","text-anchor":"start"}},a.Color=function(R){var H,Q;this.r=0,this.g=0,this.b=0,R&&("string"==typeof R?a.regex.isRgb.test(R)?(H=a.regex.rgb.exec(R.replace(a.regex.whitespace,"")),this.r=parseInt(H[1]),this.g=parseInt(H[2]),this.b=parseInt(H[3])):a.regex.isHex.test(R)&&(H=a.regex.hex.exec(4==(Q=R).length?["#",Q.substring(1,2),Q.substring(1,2),Q.substring(2,3),Q.substring(2,3),Q.substring(3,4),Q.substring(3,4)].join(""):Q),this.r=parseInt(H[1],16),this.g=parseInt(H[2],16),this.b=parseInt(H[3],16)):"object"===nr(R)&&(this.r=R.r,this.g=R.g,this.b=R.b))},a.extend(a.Color,{toString:function(){return this.toHex()},toHex:function(){return"#"+B(this.r)+B(this.g)+B(this.b)},toRgb:function(){return"rgb("+[this.r,this.g,this.b].join()+")"},brightness:function(){return this.r/255*.3+this.g/255*.59+this.b/255*.11},morph:function(R){return this.destination=new a.Color(R),this},at:function(R){return this.destination?new a.Color({r:~~(this.r+(this.destination.r-this.r)*(R=R<0?0:R>1?1:R)),g:~~(this.g+(this.destination.g-this.g)*R),b:~~(this.b+(this.destination.b-this.b)*R)}):this}}),a.Color.test=function(R){return a.regex.isHex.test(R+="")||a.regex.isRgb.test(R)},a.Color.isRgb=function(R){return R&&"number"==typeof R.r&&"number"==typeof R.g&&"number"==typeof R.b},a.Color.isColor=function(R){return a.Color.isRgb(R)||a.Color.test(R)},a.Array=function(R,H){0==(R=(R||[]).valueOf()).length&&H&&(R=H.valueOf()),this.value=this.parse(R)},a.extend(a.Array,{toString:function(){return this.value.join(" ")},valueOf:function(){return this.value},parse:function(R){return R=R.valueOf(),Array.isArray(R)?R:this.split(R)}}),a.PointArray=function(R,H){a.Array.call(this,R,H||[[0,0]])},a.PointArray.prototype=new a.Array,a.PointArray.prototype.constructor=a.PointArray;for(var d={M:function(R,H,Q){return H.x=Q.x=R[0],H.y=Q.y=R[1],["M",H.x,H.y]},L:function(R,H){return H.x=R[0],H.y=R[1],["L",R[0],R[1]]},H:function(R,H){return H.x=R[0],["H",R[0]]},V:function(R,H){return H.y=R[0],["V",R[0]]},C:function(R,H){return H.x=R[4],H.y=R[5],["C",R[0],R[1],R[2],R[3],R[4],R[5]]},Q:function(R,H){return H.x=R[2],H.y=R[3],["Q",R[0],R[1],R[2],R[3]]},Z:function(R,H,Q){return H.x=Q.x,H.y=Q.y,["Z"]}},g="mlhvqtcsaz".split(""),_=0,D=g.length;_<D;++_)d[g[_]]=function(R){return function(H,Q,le){if("H"==R)H[0]=H[0]+Q.x;else if("V"==R)H[0]=H[0]+Q.y;else if("A"==R)H[5]=H[5]+Q.x,H[6]=H[6]+Q.y;else for(var Re=0,tt=H.length;Re<tt;++Re)H[Re]=H[Re]+(Re%2?Q.y:Q.x);if(d&&"function"==typeof d[R])return d[R](H,Q,le)}}(g[_].toUpperCase());a.PathArray=function(R,H){a.Array.call(this,R,H||[["M",0,0]])},a.PathArray.prototype=new a.Array,a.PathArray.prototype.constructor=a.PathArray,a.extend(a.PathArray,{toString:function(){return function(R){for(var H=0,Q=R.length,le="";H<Q;H++)le+=R[H][0],null!=R[H][1]&&(le+=R[H][1],null!=R[H][2]&&(le+=" ",le+=R[H][2],null!=R[H][3]&&(le+=" ",le+=R[H][3],le+=" ",le+=R[H][4],null!=R[H][5]&&(le+=" ",le+=R[H][5],le+=" ",le+=R[H][6],null!=R[H][7]&&(le+=" ",le+=R[H][7])))));return le+" "}(this.value)},move:function(R,H){return this.bbox(),this},at:function(R){if(!this.destination)return this;for(var H=this.value,Q=this.destination.value,le=[],Re=new a.PathArray,tt=0,Ve=H.length;tt<Ve;tt++){le[tt]=[H[tt][0]];for(var Dt=1,pt=H[tt].length;Dt<pt;Dt++)le[tt][Dt]=H[tt][Dt]+(Q[tt][Dt]-H[tt][Dt])*R;"A"===le[tt][0]&&(le[tt][4]=+(0!=le[tt][4]),le[tt][5]=+(0!=le[tt][5]))}return Re.value=le,Re},parse:function(R){if(R instanceof a.PathArray)return R.valueOf();var H,Q={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0};R="string"==typeof R?R.replace(a.regex.numbersWithDots,T).replace(a.regex.pathLetters," $& ").replace(a.regex.hyphen,"$1 -").trim().split(a.regex.delimiter):R.reduce(function(pt,qe){return[].concat.call(pt,qe)},[]);var le=[],Re=new a.Point,tt=new a.Point,Ve=0,Dt=R.length;do{a.regex.isPathLetter.test(R[Ve])?(H=R[Ve],++Ve):"M"==H?H="L":"m"==H&&(H="l"),le.push(d[H].call(null,R.slice(Ve,Ve+=Q[H.toUpperCase()]).map(parseFloat),Re,tt))}while(Dt>Ve);return le},bbox:function(){return a.parser.draw||a.prepare(),a.parser.path.setAttribute("d",this.toString()),a.parser.path.getBBox()}}),a.Number=a.invent({create:function(R,H){this.value=0,this.unit=H||"","number"==typeof R?this.value=isNaN(R)?0:isFinite(R)?R:R<0?-34e37:34e37:"string"==typeof R?(H=R.match(a.regex.numberAndUnit))&&(this.value=parseFloat(H[1]),"%"==H[5]?this.value/=100:"s"==H[5]&&(this.value*=1e3),this.unit=H[5]):R instanceof a.Number&&(this.value=R.valueOf(),this.unit=R.unit)},extend:{toString:function(){return("%"==this.unit?~~(1e8*this.value)/1e6:"s"==this.unit?this.value/1e3:this.value)+this.unit},toJSON:function(){return this.toString()},valueOf:function(){return this.value},plus:function(R){return R=new a.Number(R),new a.Number(this+R,this.unit||R.unit)},minus:function(R){return R=new a.Number(R),new a.Number(this-R,this.unit||R.unit)},times:function(R){return R=new a.Number(R),new a.Number(this*R,this.unit||R.unit)},divide:function(R){return R=new a.Number(R),new a.Number(this/R,this.unit||R.unit)},to:function(R){var H=new a.Number(this);return"string"==typeof R&&(H.unit=R),H},morph:function(R){return this.destination=new a.Number(R),R.relative&&(this.destination.value+=this.value),this},at:function(R){return this.destination?new a.Number(this.destination).minus(this).times(R).plus(this):this}}}),a.Element=a.invent({create:function(R){this._stroke=a.defaults.attrs.stroke,this._event=null,this.dom={},(this.node=R)&&(this.type=R.nodeName,this.node.instance=this,this._stroke=R.getAttribute("stroke")||this._stroke)},extend:{x:function(R){return this.attr("x",R)},y:function(R){return this.attr("y",R)},cx:function(R){return null==R?this.x()+this.width()/2:this.x(R-this.width()/2)},cy:function(R){return null==R?this.y()+this.height()/2:this.y(R-this.height()/2)},move:function(R,H){return this.x(R).y(H)},center:function(R,H){return this.cx(R).cy(H)},width:function(R){return this.attr("width",R)},height:function(R){return this.attr("height",R)},size:function(R,H){var Q=V(this,R,H);return this.width(new a.Number(Q.width)).height(new a.Number(Q.height))},clone:function(R){this.writeDataToDom();var H=K(this.node.cloneNode(!0));return R?R.add(H):this.after(H),H},remove:function(){return this.parent()&&this.parent().removeElement(this),this},replace:function(R){return this.after(R).remove(),R},addTo:function(R){return R.put(this)},putIn:function(R){return R.add(this)},id:function(R){return this.attr("id",R)},show:function(){return this.style("display","")},hide:function(){return this.style("display","none")},visible:function(){return"none"!=this.style("display")},toString:function(){return this.attr("id")},classes:function(){var R=this.attr("class");return null==R?[]:R.trim().split(a.regex.delimiter)},hasClass:function(R){return-1!=this.classes().indexOf(R)},addClass:function(R){if(!this.hasClass(R)){var H=this.classes();H.push(R),this.attr("class",H.join(" "))}return this},removeClass:function(R){return this.hasClass(R)&&this.attr("class",this.classes().filter(function(H){return H!=R}).join(" ")),this},toggleClass:function(R){return this.hasClass(R)?this.removeClass(R):this.addClass(R)},reference:function(R){return a.get(this.attr(R))},parent:function(R){var H=this;if(!H.node.parentNode)return null;if(H=a.adopt(H.node.parentNode),!R)return H;for(;H&&H.node instanceof te.SVGElement;){if("string"==typeof R?H.matches(R):H instanceof R)return H;if(!H.node.parentNode||"#document"==H.node.parentNode.nodeName)return null;H=a.adopt(H.node.parentNode)}},doc:function(){return this instanceof a.Doc?this:this.parent(a.Doc)},parents:function(R){var H=[],Q=this;do{if(!(Q=Q.parent(R))||!Q.node)break;H.push(Q)}while(Q.parent);return H},matches:function(R){return((H=this.node).matches||H.matchesSelector||H.msMatchesSelector||H.mozMatchesSelector||H.webkitMatchesSelector||H.oMatchesSelector).call(H,R);var H},native:function(){return this.node},svg:function(R){var H=o.createElement("svg");if(!(R&&this instanceof a.Parent))return H.appendChild(R=o.createElement("svg")),this.writeDataToDom(),R.appendChild(this.node.cloneNode(!0)),H.innerHTML.replace(/^<svg>/,"").replace(/<\/svg>$/,"");H.innerHTML="<svg>"+R.replace(/\n/,"").replace(/<([\w:-]+)([^<]+?)\/>/g,"<$1$2></$1>")+"</svg>";for(var Q=0,le=H.firstChild.childNodes.length;Q<le;Q++)this.node.appendChild(H.firstChild.firstChild);return this},writeDataToDom:function(){return(this.each||this.lines)&&(this.each?this:this.lines()).each(function(){this.writeDataToDom()}),this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),this},setData:function(R){return this.dom=R,this},is:function(R){return this instanceof R}}}),a.easing={"-":function(R){return R},"<>":function(R){return-Math.cos(R*Math.PI)/2+.5},">":function(R){return Math.sin(R*Math.PI/2)},"<":function(R){return 1-Math.cos(R*Math.PI/2)}},a.morph=function(R){return function(H,Q){return new a.MorphObj(H,Q).at(R)}},a.Situation=a.invent({create:function(R){this.init=!1,this.reversed=!1,this.reversing=!1,this.duration=new a.Number(R.duration).valueOf(),this.delay=new a.Number(R.delay).valueOf(),this.start=+new Date+this.delay,this.finish=this.start+this.duration,this.ease=R.ease,this.loop=0,this.loops=!1,this.animations={},this.attrs={},this.styles={},this.transforms=[],this.once={}}}),a.FX=a.invent({create:function(R){this._target=R,this.situations=[],this.active=!1,this.situation=null,this.paused=!1,this.lastPos=0,this.pos=0,this.absPos=0,this._speed=1},extend:{animate:function(R,H,Q){"object"===nr(R)&&(H=R.ease,Q=R.delay,R=R.duration);var le=new a.Situation({duration:R||1e3,delay:Q||0,ease:a.easing[H||"-"]||H});return this.queue(le),this},target:function(R){return R&&R instanceof a.Element?(this._target=R,this):this._target},timeToAbsPos:function(R){return(R-this.situation.start)/(this.situation.duration/this._speed)},absPosToTime:function(R){return this.situation.duration/this._speed*R+this.situation.start},startAnimFrame:function(){this.stopAnimFrame(),this.animationFrame=te.requestAnimationFrame(function(){this.step()}.bind(this))},stopAnimFrame:function(){te.cancelAnimationFrame(this.animationFrame)},start:function(){return!this.active&&this.situation&&(this.active=!0,this.startCurrent()),this},startCurrent:function(){return this.situation.start=+new Date+this.situation.delay/this._speed,this.situation.finish=this.situation.start+this.situation.duration/this._speed,this.initAnimations().step()},queue:function(R){return("function"==typeof R||R instanceof a.Situation)&&this.situations.push(R),this.situation||(this.situation=this.situations.shift()),this},dequeue:function(){return this.stop(),this.situation=this.situations.shift(),this.situation&&(this.situation instanceof a.Situation?this.start():this.situation.call(this)),this},initAnimations:function(){var R,H=this.situation;if(H.init)return this;for(var Q in H.animations){R=this.target()[Q](),Array.isArray(R)||(R=[R]),Array.isArray(H.animations[Q])||(H.animations[Q]=[H.animations[Q]]);for(var le=R.length;le--;)H.animations[Q][le]instanceof a.Number&&(R[le]=new a.Number(R[le])),H.animations[Q][le]=R[le].morph(H.animations[Q][le])}for(var Q in H.attrs)H.attrs[Q]=new a.MorphObj(this.target().attr(Q),H.attrs[Q]);for(var Q in H.styles)H.styles[Q]=new a.MorphObj(this.target().style(Q),H.styles[Q]);return H.initialTransformation=this.target().matrixify(),H.init=!0,this},clearQueue:function(){return this.situations=[],this},clearCurrent:function(){return this.situation=null,this},stop:function(R,H){var Q=this.active;return this.active=!1,H&&this.clearQueue(),R&&this.situation&&(!Q&&this.startCurrent(),this.atEnd()),this.stopAnimFrame(),this.clearCurrent()},after:function(R){var H=this.last();return this.target().on("finished.fx",function Q(le){le.detail.situation==H&&(R.call(this,H),this.off("finished.fx",Q))}),this._callStart()},during:function(R){var H=this.last(),Q=function(le){le.detail.situation==H&&R.call(this,le.detail.pos,a.morph(le.detail.pos),le.detail.eased,H)};return this.target().off("during.fx",Q).on("during.fx",Q),this.after(function(){this.off("during.fx",Q)}),this._callStart()},afterAll:function(R){var H=function Q(le){R.call(this),this.off("allfinished.fx",Q)};return this.target().off("allfinished.fx",H).on("allfinished.fx",H),this._callStart()},last:function(){return this.situations.length?this.situations[this.situations.length-1]:this.situation},add:function(R,H,Q){return this.last()[Q||"animations"][R]=H,this._callStart()},step:function(R){var H,Q,le;R||(this.absPos=this.timeToAbsPos(+new Date)),!1!==this.situation.loops?(H=Math.max(this.absPos,0),Q=Math.floor(H),!0===this.situation.loops||Q<this.situation.loops?(this.pos=H-Q,le=this.situation.loop,this.situation.loop=Q):(this.absPos=this.situation.loops,this.pos=1,le=this.situation.loop-1,this.situation.loop=this.situation.loops),this.situation.reversing&&(this.situation.reversed=this.situation.reversed!=Boolean((this.situation.loop-le)%2))):(this.absPos=Math.min(this.absPos,1),this.pos=this.absPos),this.pos<0&&(this.pos=0),this.situation.reversed&&(this.pos=1-this.pos);var Re=this.situation.ease(this.pos);for(var tt in this.situation.once)tt>this.lastPos&&tt<=Re&&(this.situation.once[tt].call(this.target(),this.pos,Re),delete this.situation.once[tt]);return this.active&&this.target().fire("during",{pos:this.pos,eased:Re,fx:this,situation:this.situation}),this.situation?(this.eachAt(),1==this.pos&&!this.situation.reversed||this.situation.reversed&&0==this.pos?(this.stopAnimFrame(),this.target().fire("finished",{fx:this,situation:this.situation}),this.situations.length||(this.target().fire("allfinished"),this.situations.length||(this.target().off(".fx"),this.active=!1)),this.active?this.dequeue():this.clearCurrent()):!this.paused&&this.active&&this.startAnimFrame(),this.lastPos=Re,this):this},eachAt:function(){var R,H=this,Q=this.target(),le=this.situation;for(var Re in le.animations)R=[].concat(le.animations[Re]).map(function(Dt){return"string"!=typeof Dt&&Dt.at?Dt.at(le.ease(H.pos),H.pos):Dt}),Q[Re].apply(Q,R);for(var Re in le.attrs)R=[Re].concat(le.attrs[Re]).map(function(pt){return"string"!=typeof pt&&pt.at?pt.at(le.ease(H.pos),H.pos):pt}),Q.attr.apply(Q,R);for(var Re in le.styles)R=[Re].concat(le.styles[Re]).map(function(pt){return"string"!=typeof pt&&pt.at?pt.at(le.ease(H.pos),H.pos):pt}),Q.style.apply(Q,R);if(le.transforms.length){R=le.initialTransformation,Re=0;for(var tt=le.transforms.length;Re<tt;Re++){var Ve=le.transforms[Re];Ve instanceof a.Matrix?R=Ve.relative?R.multiply((new a.Matrix).morph(Ve).at(le.ease(this.pos))):R.morph(Ve).at(le.ease(this.pos)):(Ve.relative||Ve.undo(R.extract()),R=R.multiply(Ve.at(le.ease(this.pos))))}Q.matrix(R)}return this},once:function(R,H,Q){var le=this.last();return Q||(R=le.ease(R)),le.once[R]=H,this},_callStart:function(){return setTimeout(function(){this.start()}.bind(this),0),this}},parent:a.Element,construct:{animate:function(R,H,Q){return(this.fx||(this.fx=new a.FX(this))).animate(R,H,Q)},delay:function(R){return(this.fx||(this.fx=new a.FX(this))).delay(R)},stop:function(R,H){return this.fx&&this.fx.stop(R,H),this},finish:function(){return this.fx&&this.fx.finish(),this}}}),a.MorphObj=a.invent({create:function(R,H){return a.Color.isColor(H)?new a.Color(R).morph(H):a.regex.delimiter.test(R)?a.regex.pathLetters.test(R)?new a.PathArray(R).morph(H):new a.Array(R).morph(H):a.regex.numberAndUnit.test(H)?new a.Number(R).morph(H):(this.value=R,void(this.destination=H))},extend:{at:function(R,H){return H<1?this.value:this.destination},valueOf:function(){return this.value}}}),a.extend(a.FX,{attr:function(R,H,Q){if("object"===nr(R))for(var le in R)this.attr(le,R[le]);else this.add(R,H,"attrs");return this},plot:function(R,H,Q,le){return 4==arguments.length?this.plot([R,H,Q,le]):this.add("plot",new(this.target().morphArray)(R))}}),a.Box=a.invent({create:function(R,H,Q,le){if(!("object"!==nr(R)||R instanceof a.Element))return a.Box.call(this,null!=R.left?R.left:R.x,null!=R.top?R.top:R.y,R.width,R.height);4==arguments.length&&(this.x=R,this.y=H,this.width=Q,this.height=le),oe(this)}}),a.BBox=a.invent({create:function(R){if(a.Box.apply(this,[].slice.call(arguments)),R instanceof a.Element){var H;try{if(!o.documentElement.contains){for(var Q=R.node;Q.parentNode;)Q=Q.parentNode;if(Q!=o)throw new Error("Element not in the dom")}H=R.node.getBBox()}catch(Re){if(R instanceof a.Shape){a.parser.draw||a.prepare();var le=R.clone(a.parser.draw.instance).show();le&&le.node&&"function"==typeof le.node.getBBox&&(H=le.node.getBBox()),le&&"function"==typeof le.remove&&le.remove()}else H={x:R.node.clientLeft,y:R.node.clientTop,width:R.node.clientWidth,height:R.node.clientHeight}}a.Box.call(this,H)}},inherit:a.Box,parent:a.Element,construct:{bbox:function(){return new a.BBox(this)}}}),a.BBox.prototype.constructor=a.BBox,a.Matrix=a.invent({create:function(R){var H=q([1,0,0,1,0,0]);R=null===R?H:R instanceof a.Element?R.matrixify():"string"==typeof R?q(R.split(a.regex.delimiter).map(parseFloat)):6==arguments.length?q([].slice.call(arguments)):Array.isArray(R)?q(R):R&&"object"===nr(R)?R:H;for(var Q=fe.length-1;Q>=0;--Q)this[fe[Q]]=null!=R[fe[Q]]?R[fe[Q]]:H[fe[Q]]},extend:{extract:function(){var R=$(this,0,1);$(this,1,0);var H=180/Math.PI*Math.atan2(R.y,R.x)-90;return{x:this.e,y:this.f,transformedX:(this.e*Math.cos(H*Math.PI/180)+this.f*Math.sin(H*Math.PI/180))/Math.sqrt(this.a*this.a+this.b*this.b),transformedY:(this.f*Math.cos(H*Math.PI/180)+this.e*Math.sin(-H*Math.PI/180))/Math.sqrt(this.c*this.c+this.d*this.d),rotation:H,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f,matrix:new a.Matrix(this)}},clone:function(){return new a.Matrix(this)},morph:function(R){return this.destination=new a.Matrix(R),this},multiply:function(R){return new a.Matrix(this.native().multiply((H=R,H instanceof a.Matrix||(H=new a.Matrix(H)),H).native()));var H},inverse:function(){return new a.Matrix(this.native().inverse())},translate:function(R,H){return new a.Matrix(this.native().translate(R||0,H||0))},native:function(){for(var R=a.parser.native.createSVGMatrix(),H=fe.length-1;H>=0;H--)R[fe[H]]=this[fe[H]];return R},toString:function(){return"matrix("+ae(this.a)+","+ae(this.b)+","+ae(this.c)+","+ae(this.d)+","+ae(this.e)+","+ae(this.f)+")"}},parent:a.Element,construct:{ctm:function(){return new a.Matrix(this.node.getCTM())},screenCTM:function(){if(this instanceof a.Nested){var R=this.rect(1,1),H=R.node.getScreenCTM();return R.remove(),new a.Matrix(H)}return new a.Matrix(this.node.getScreenCTM())}}}),a.Point=a.invent({create:function(R,H){var Q;Q=Array.isArray(R)?{x:R[0],y:R[1]}:"object"===nr(R)?{x:R.x,y:R.y}:null!=R?{x:R,y:null!=H?H:R}:{x:0,y:0},this.x=Q.x,this.y=Q.y},extend:{clone:function(){return new a.Point(this)},morph:function(R,H){return this.destination=new a.Point(R,H),this}}}),a.extend(a.Element,{point:function(R,H){return new a.Point(R,H).transform(this.screenCTM().inverse())}}),a.extend(a.Element,{attr:function(R,H,Q){if(null==R){for(R={},Q=(H=this.node.attributes).length-1;Q>=0;Q--)R[H[Q].nodeName]=a.regex.isNumber.test(H[Q].nodeValue)?parseFloat(H[Q].nodeValue):H[Q].nodeValue;return R}if("object"===nr(R))for(var le in R)this.attr(le,R[le]);else if(null===H)this.node.removeAttribute(R);else{if(null==H)return null==(H=this.node.getAttribute(R))?a.defaults.attrs[R]:a.regex.isNumber.test(H)?parseFloat(H):H;"stroke-width"==R?this.attr("stroke",parseFloat(H)>0?this._stroke:null):"stroke"==R&&(this._stroke=H),"fill"!=R&&"stroke"!=R||(a.regex.isImage.test(H)&&(H=this.doc().defs().image(H,0,0)),H instanceof a.Image&&(H=this.doc().defs().pattern(0,0,function(){this.add(H)}))),"number"==typeof H?H=new a.Number(H):a.Color.isColor(H)?H=new a.Color(H):Array.isArray(H)&&(H=new a.Array(H)),"leading"==R?this.leading&&this.leading(H):"string"==typeof Q?this.node.setAttributeNS(Q,R,H.toString()):this.node.setAttribute(R,H.toString()),!this.rebuild||"font-size"!=R&&"x"!=R||this.rebuild(R,H)}return this}}),a.extend(a.Element,{transform:function(R,H){var Q;return"object"!==nr(R)?(Q=new a.Matrix(this).extract(),"string"==typeof R?Q[R]:Q):(Q=new a.Matrix(this),H=!!H||!!R.relative,null!=R.a&&(Q=H?Q.multiply(new a.Matrix(R)):new a.Matrix(R)),this.attr("transform",Q))}}),a.extend(a.Element,{untransform:function(){return this.attr("transform",null)},matrixify:function(){return(this.attr("transform")||"").split(a.regex.transforms).slice(0,-1).map(function(R){var H=R.trim().split("(");return[H[0],H[1].split(a.regex.delimiter).map(function(Q){return parseFloat(Q)})]}).reduce(function(R,H){return"matrix"==H[0]?R.multiply(q(H[1])):R[H[0]].apply(R,H[1])},new a.Matrix)},toParent:function(R){if(this==R)return this;var H=this.screenCTM(),Q=R.screenCTM().inverse();return this.addTo(R).untransform().transform(Q.multiply(H)),this},toDoc:function(){return this.toParent(this.doc())}}),a.Transformation=a.invent({create:function(R,H){if(arguments.length>1&&"boolean"!=typeof H)return this.constructor.call(this,[].slice.call(arguments));if(Array.isArray(R))for(var Q=0,le=this.arguments.length;Q<le;++Q)this[this.arguments[Q]]=R[Q];else if(R&&"object"===nr(R))for(Q=0,le=this.arguments.length;Q<le;++Q)this[this.arguments[Q]]=R[this.arguments[Q]];this.inversed=!1,!0===H&&(this.inversed=!0)}}),a.Translate=a.invent({parent:a.Matrix,inherit:a.Transformation,create:function(R,H){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["transformedX","transformedY"],method:"translate"}}),a.extend(a.Element,{style:function(R,H){if(0==arguments.length)return this.node.style.cssText||"";if(arguments.length<2)if("object"===nr(R))for(var Q in R)this.style(Q,R[Q]);else{if(!a.regex.isCss.test(R))return this.node.style[P(R)];for(R=R.split(/\s*;\s*/).filter(function(le){return!!le}).map(function(le){return le.split(/\s*:\s*/)});H=R.pop();)this.style(H[0],H[1])}else this.node.style[P(R)]=null===H||a.regex.isBlank.test(H)?"":H;return this}}),a.Parent=a.invent({create:function(R){this.constructor.call(this,R)},inherit:a.Element,extend:{children:function(){return a.utils.map(a.utils.filterSVGElements(this.node.childNodes),function(R){return a.adopt(R)})},add:function(R,H){return null==H?this.node.appendChild(R.node):R.node!=this.node.childNodes[H]&&this.node.insertBefore(R.node,this.node.childNodes[H]),this},put:function(R,H){return this.add(R,H),R},has:function(R){return this.index(R)>=0},index:function(R){return[].slice.call(this.node.childNodes).indexOf(R.node)},get:function(R){return a.adopt(this.node.childNodes[R])},first:function(){return this.get(0)},last:function(){return this.get(this.node.childNodes.length-1)},each:function(R,H){for(var Q=this.children(),le=0,Re=Q.length;le<Re;le++)Q[le]instanceof a.Element&&R.apply(Q[le],[le,Q]),H&&Q[le]instanceof a.Container&&Q[le].each(R,H);return this},removeElement:function(R){return this.node.removeChild(R.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,this},defs:function(){return this.doc().defs()}}}),a.extend(a.Parent,{ungroup:function(R,H){return 0===H||this instanceof a.Defs||this.node==a.parser.draw||(R=R||(this instanceof a.Doc?this:this.parent(a.Parent)),H=H||1/0,this.each(function(){return this instanceof a.Defs?this:this instanceof a.Parent?this.ungroup(R,H-1):this.toParent(R)}),this.node.firstChild||this.remove()),this},flatten:function(R,H){return this.ungroup(R,H)}}),a.Container=a.invent({create:function(R){this.constructor.call(this,R)},inherit:a.Parent}),a.ViewBox=a.invent({parent:a.Container,construct:{}}),["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","touchstart","touchmove","touchleave","touchend","touchcancel"].forEach(function(R){a.Element.prototype[R]=function(H){return a.on(this.node,R,H),this}}),a.listeners=[],a.handlerMap=[],a.listenerId=0,a.on=function(R,H,Q,le,Re){var tt=Q.bind(le||R.instance||R),Ve=(a.handlerMap.indexOf(R)+1||a.handlerMap.push(R))-1,Dt=H.split(".")[0],pt=H.split(".")[1]||"*";a.listeners[Ve]=a.listeners[Ve]||{},a.listeners[Ve][Dt]=a.listeners[Ve][Dt]||{},a.listeners[Ve][Dt][pt]=a.listeners[Ve][Dt][pt]||{},Q._svgjsListenerId||(Q._svgjsListenerId=++a.listenerId),a.listeners[Ve][Dt][pt][Q._svgjsListenerId]=tt,R.addEventListener(Dt,tt,Re||{passive:!0})},a.off=function(R,H,Q){var le=a.handlerMap.indexOf(R),Re=H&&H.split(".")[0],tt=H&&H.split(".")[1],Ve="";if(-1!=le)if(Q){if("function"==typeof Q&&(Q=Q._svgjsListenerId),!Q)return;a.listeners[le][Re]&&a.listeners[le][Re][tt||"*"]&&(R.removeEventListener(Re,a.listeners[le][Re][tt||"*"][Q],!1),delete a.listeners[le][Re][tt||"*"][Q])}else if(tt&&Re){if(a.listeners[le][Re]&&a.listeners[le][Re][tt]){for(var Dt in a.listeners[le][Re][tt])a.off(R,[Re,tt].join("."),Dt);delete a.listeners[le][Re][tt]}}else if(tt)for(var pt in a.listeners[le])for(var Ve in a.listeners[le][pt])tt===Ve&&a.off(R,[pt,tt].join("."));else if(Re){if(a.listeners[le][Re]){for(var Ve in a.listeners[le][Re])a.off(R,[Re,Ve].join("."));delete a.listeners[le][Re]}}else{for(var pt in a.listeners[le])a.off(R,pt);delete a.listeners[le],delete a.handlerMap[le]}},a.extend(a.Element,{on:function(R,H,Q,le){return a.on(this.node,R,H,Q,le),this},off:function(R,H){return a.off(this.node,R,H),this},fire:function(R,H){return this.node.dispatchEvent(R instanceof te.Event?R:R=new a.CustomEvent(R,{detail:H,cancelable:!0})),this._event=R,this},event:function(){return this._event}}),a.Defs=a.invent({create:"defs",inherit:a.Container}),a.G=a.invent({create:"g",inherit:a.Container,extend:{x:function(R){return null==R?this.transform("x"):this.transform({x:R-this.x()},!0)}},construct:{group:function(){return this.put(new a.G)}}}),a.Doc=a.invent({create:function(R){R&&("svg"==(R="string"==typeof R?o.getElementById(R):R).nodeName?this.constructor.call(this,R):(this.constructor.call(this,a.create("svg")),R.appendChild(this.node),this.size("100%","100%")),this.namespace().defs())},inherit:a.Container,extend:{namespace:function(){return this.attr({xmlns:a.ns,version:"1.1"}).attr("xmlns:xlink",a.xlink,a.xmlns).attr("xmlns:svgjs",a.svgjs,a.xmlns)},defs:function(){var R;return this._defs||(this._defs=(R=this.node.getElementsByTagName("defs")[0])?a.adopt(R):new a.Defs,this.node.appendChild(this._defs.node)),this._defs},parent:function(){return this.node.parentNode&&"#document"!=this.node.parentNode.nodeName?this.node.parentNode:null},remove:function(){return this.parent()&&this.parent().removeChild(this.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,a.parser.draw&&!a.parser.draw.parentNode&&this.node.appendChild(a.parser.draw),this},clone:function(R){this.writeDataToDom();var H=this.node,Q=K(H.cloneNode(!0));return R?(R.node||R).appendChild(Q.node):H.parentNode.insertBefore(Q.node,H.nextSibling),Q}}}),a.extend(a.Element,{}),a.Gradient=a.invent({create:function(R){this.constructor.call(this,a.create(R+"Gradient")),this.type=R},inherit:a.Container,extend:{at:function(R,H,Q){return this.put(new a.Stop).update(R,H,Q)},update:function(R){return this.clear(),"function"==typeof R&&R.call(this,this),this},fill:function(){return"url(#"+this.id()+")"},toString:function(){return this.fill()},attr:function(R,H,Q){return"transform"==R&&(R="gradientTransform"),a.Container.prototype.attr.call(this,R,H,Q)}},construct:{gradient:function(R,H){return this.defs().gradient(R,H)}}}),a.extend(a.Gradient,a.FX,{from:function(R,H){return this.attr("radial"==(this._target||this).type?{fx:new a.Number(R),fy:new a.Number(H)}:{x1:new a.Number(R),y1:new a.Number(H)})},to:function(R,H){return this.attr("radial"==(this._target||this).type?{cx:new a.Number(R),cy:new a.Number(H)}:{x2:new a.Number(R),y2:new a.Number(H)})}}),a.extend(a.Defs,{gradient:function(R,H){return this.put(new a.Gradient(R)).update(H)}}),a.Stop=a.invent({create:"stop",inherit:a.Element,extend:{update:function(R){return("number"==typeof R||R instanceof a.Number)&&(R={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=R.opacity&&this.attr("stop-opacity",R.opacity),null!=R.color&&this.attr("stop-color",R.color),null!=R.offset&&this.attr("offset",new a.Number(R.offset)),this}}}),a.Pattern=a.invent({create:"pattern",inherit:a.Container,extend:{fill:function(){return"url(#"+this.id()+")"},update:function(R){return this.clear(),"function"==typeof R&&R.call(this,this),this},toString:function(){return this.fill()},attr:function(R,H,Q){return"transform"==R&&(R="patternTransform"),a.Container.prototype.attr.call(this,R,H,Q)}},construct:{pattern:function(R,H,Q){return this.defs().pattern(R,H,Q)}}}),a.extend(a.Defs,{pattern:function(R,H,Q){return this.put(new a.Pattern).update(Q).attr({x:0,y:0,width:R,height:H,patternUnits:"userSpaceOnUse"})}}),a.Shape=a.invent({create:function(R){this.constructor.call(this,R)},inherit:a.Element}),a.Symbol=a.invent({create:"symbol",inherit:a.Container,construct:{symbol:function(){return this.put(new a.Symbol)}}}),a.Use=a.invent({create:"use",inherit:a.Shape,extend:{element:function(R,H){return this.attr("href",(H||"")+"#"+R,a.xlink)}},construct:{use:function(R,H){return this.put(new a.Use).element(R,H)}}}),a.Rect=a.invent({create:"rect",inherit:a.Shape,construct:{rect:function(R,H){return this.put(new a.Rect).size(R,H)}}}),a.Circle=a.invent({create:"circle",inherit:a.Shape,construct:{circle:function(R){return this.put(new a.Circle).rx(new a.Number(R).divide(2)).move(0,0)}}}),a.extend(a.Circle,a.FX,{rx:function(R){return this.attr("r",R)},ry:function(R){return this.rx(R)}}),a.Ellipse=a.invent({create:"ellipse",inherit:a.Shape,construct:{ellipse:function(R,H){return this.put(new a.Ellipse).size(R,H).move(0,0)}}}),a.extend(a.Ellipse,a.Rect,a.FX,{rx:function(R){return this.attr("rx",R)},ry:function(R){return this.attr("ry",R)}}),a.extend(a.Circle,a.Ellipse,{x:function(R){return null==R?this.cx()-this.rx():this.cx(R+this.rx())},y:function(R){return null==R?this.cy()-this.ry():this.cy(R+this.ry())},cx:function(R){return null==R?this.attr("cx"):this.attr("cx",R)},cy:function(R){return null==R?this.attr("cy"):this.attr("cy",R)},width:function(R){return null==R?2*this.rx():this.rx(new a.Number(R).divide(2))},height:function(R){return null==R?2*this.ry():this.ry(new a.Number(R).divide(2))},size:function(R,H){var Q=V(this,R,H);return this.rx(new a.Number(Q.width).divide(2)).ry(new a.Number(Q.height).divide(2))}}),a.Line=a.invent({create:"line",inherit:a.Shape,extend:{array:function(){return new a.PointArray([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])},plot:function(R,H,Q,le){return null==R?this.array():(R=void 0!==H?{x1:R,y1:H,x2:Q,y2:le}:new a.PointArray(R).toLine(),this.attr(R))},move:function(R,H){return this.attr(this.array().move(R,H).toLine())},size:function(R,H){var Q=V(this,R,H);return this.attr(this.array().size(Q.width,Q.height).toLine())}},construct:{line:function(R,H,Q,le){return a.Line.prototype.plot.apply(this.put(new a.Line),null!=R?[R,H,Q,le]:[0,0,0,0])}}}),a.Polyline=a.invent({create:"polyline",inherit:a.Shape,construct:{polyline:function(R){return this.put(new a.Polyline).plot(R||new a.PointArray)}}}),a.Polygon=a.invent({create:"polygon",inherit:a.Shape,construct:{polygon:function(R){return this.put(new a.Polygon).plot(R||new a.PointArray)}}}),a.extend(a.Polyline,a.Polygon,{array:function(){return this._array||(this._array=new a.PointArray(this.attr("points")))},plot:function(R){return null==R?this.array():this.clear().attr("points","string"==typeof R?R:this._array=new a.PointArray(R))},clear:function(){return delete this._array,this},move:function(R,H){return this.attr("points",this.array().move(R,H))},size:function(R,H){var Q=V(this,R,H);return this.attr("points",this.array().size(Q.width,Q.height))}}),a.extend(a.Line,a.Polyline,a.Polygon,{morphArray:a.PointArray,x:function(R){return null==R?this.bbox().x:this.move(R,this.bbox().y)},y:function(R){return null==R?this.bbox().y:this.move(this.bbox().x,R)},width:function(R){var H=this.bbox();return null==R?H.width:this.size(R,H.height)},height:function(R){var H=this.bbox();return null==R?H.height:this.size(H.width,R)}}),a.Path=a.invent({create:"path",inherit:a.Shape,extend:{morphArray:a.PathArray,array:function(){return this._array||(this._array=new a.PathArray(this.attr("d")))},plot:function(R){return null==R?this.array():this.clear().attr("d","string"==typeof R?R:this._array=new a.PathArray(R))},clear:function(){return delete this._array,this}},construct:{path:function(R){return this.put(new a.Path).plot(R||new a.PathArray)}}}),a.Image=a.invent({create:"image",inherit:a.Shape,extend:{load:function(R){if(!R)return this;var H=this,Q=new te.Image;return a.on(Q,"load",function(){a.off(Q);var le=H.parent(a.Pattern);null!==le&&(0==H.width()&&0==H.height()&&H.size(Q.width,Q.height),le&&0==le.width()&&0==le.height()&&le.size(H.width(),H.height()),"function"==typeof H._loaded&&H._loaded.call(H,{width:Q.width,height:Q.height,ratio:Q.width/Q.height,url:R}))}),a.on(Q,"error",function(le){a.off(Q),"function"==typeof H._error&&H._error.call(H,le)}),this.attr("href",Q.src=this.src=R,a.xlink)},loaded:function(R){return this._loaded=R,this},error:function(R){return this._error=R,this}},construct:{image:function(R,H,Q){return this.put(new a.Image).load(R).size(H||0,Q||H||0)}}}),a.Text=a.invent({create:function(){this.constructor.call(this,a.create("text")),this.dom.leading=new a.Number(1.3),this._rebuild=!0,this._build=!1,this.attr("font-family",a.defaults.attrs["font-family"])},inherit:a.Shape,extend:{x:function(R){return null==R?this.attr("x"):this.attr("x",R)},text:function(R){if(void 0===R){R="";for(var H=this.node.childNodes,Q=0,le=H.length;Q<le;++Q)0!=Q&&3!=H[Q].nodeType&&1==a.adopt(H[Q]).dom.newLined&&(R+="\n"),R+=H[Q].textContent;return R}if(this.clear().build(!0),"function"==typeof R)R.call(this,this);else{Q=0;for(var Re=(R=R.split("\n")).length;Q<Re;Q++)this.tspan(R[Q]).newLine()}return this.build(!1).rebuild()},size:function(R){return this.attr("font-size",R).rebuild()},leading:function(R){return null==R?this.dom.leading:(this.dom.leading=new a.Number(R),this.rebuild())},lines:function(){var R=(this.textPath&&this.textPath()||this).node,H=a.utils.map(a.utils.filterSVGElements(R.childNodes),function(Q){return a.adopt(Q)});return new a.Set(H)},rebuild:function(R){if("boolean"==typeof R&&(this._rebuild=R),this._rebuild){var H=this,Q=0,le=this.dom.leading*new a.Number(this.attr("font-size"));this.lines().each(function(){this.dom.newLined&&(H.textPath()||this.attr("x",H.attr("x")),"\n"==this.text()?Q+=le:(this.attr("dy",le+Q),Q=0))}),this.fire("rebuild")}return this},build:function(R){return this._build=!!R,this},setData:function(R){return this.dom=R,this.dom.leading=new a.Number(R.leading||1.3),this}},construct:{text:function(R){return this.put(new a.Text).text(R)},plain:function(R){return this.put(new a.Text).plain(R)}}}),a.Tspan=a.invent({create:"tspan",inherit:a.Shape,extend:{text:function(R){return null==R?this.node.textContent+(this.dom.newLined?"\n":""):("function"==typeof R?R.call(this,this):this.plain(R),this)},dx:function(R){return this.attr("dx",R)},dy:function(R){return this.attr("dy",R)},newLine:function(){var R=this.parent(a.Text);return this.dom.newLined=!0,this.dy(R.dom.leading*R.attr("font-size")).attr("x",R.x())}}}),a.extend(a.Text,a.Tspan,{plain:function(R){return!1===this._build&&this.clear(),this.node.appendChild(o.createTextNode(R)),this},tspan:function(R){var H=(this.textPath&&this.textPath()||this).node,Q=new a.Tspan;return!1===this._build&&this.clear(),H.appendChild(Q.node),Q.text(R)},clear:function(){for(var R=(this.textPath&&this.textPath()||this).node;R.hasChildNodes();)R.removeChild(R.lastChild);return this},length:function(){return this.node.getComputedTextLength()}}),a.TextPath=a.invent({create:"textPath",inherit:a.Parent,parent:a.Text,construct:{morphArray:a.PathArray,array:function(){var R=this.track();return R?R.array():null},plot:function(R){var H=this.track(),Q=null;return H&&(Q=H.plot(R)),null==R?Q:this},track:function(){var R=this.textPath();if(R)return R.reference("href")},textPath:function(){if(this.node.firstChild&&"textPath"==this.node.firstChild.nodeName)return a.adopt(this.node.firstChild)}}}),a.Nested=a.invent({create:function(){this.constructor.call(this,a.create("svg")),this.style("overflow","visible")},inherit:a.Container,construct:{nested:function(){return this.put(new a.Nested)}}});var C={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(R,H){return"color"==H?R:R+"-"+H}};function T(R,H,Q,le){return Q+le.replace(a.regex.dots," .")}function P(R){return R.toLowerCase().replace(/-(.)/g,function(H,Q){return Q.toUpperCase()})}function L(R){return R.charAt(0).toUpperCase()+R.slice(1)}function B(R){var H=R.toString(16);return 1==H.length?"0"+H:H}function V(R,H,Q){if(null==H||null==Q){var le=R.bbox();null==H?H=le.width/le.height*Q:null==Q&&(Q=le.height/le.width*H)}return{width:H,height:Q}}function $(R,H,Q){return{x:H*R.a+Q*R.c+0,y:H*R.b+Q*R.d+0}}function q(R){return{a:R[0],b:R[1],c:R[2],d:R[3],e:R[4],f:R[5]}}function K(R){for(var H=R.childNodes.length-1;H>=0;H--)R.childNodes[H]instanceof te.SVGElement&&K(R.childNodes[H]);return a.adopt(R).id(a.eid(R.nodeName))}function oe(R){return null==R.x&&(R.x=0,R.y=0,R.width=0,R.height=0),R.w=R.width,R.h=R.height,R.x2=R.x+R.width,R.y2=R.y+R.height,R.cx=R.x+R.width/2,R.cy=R.y+R.height/2,R}function ae(R){return Math.abs(R)>1e-37?R:0}["fill","stroke"].forEach(function(R){var H={};H[R]=function(Q){if(void 0===Q)return this;if("string"==typeof Q||a.Color.isRgb(Q)||Q&&"function"==typeof Q.fill)this.attr(R,Q);else for(var le=C[R].length-1;le>=0;le--)null!=Q[C[R][le]]&&this.attr(C.prefix(R,C[R][le]),Q[C[R][le]]);return this},a.extend(a.Element,a.FX,H)}),a.extend(a.Element,a.FX,{translate:function(R,H){return this.transform({x:R,y:H})},matrix:function(R){return this.attr("transform",new a.Matrix(6==arguments.length?[].slice.call(arguments):R))},opacity:function(R){return this.attr("opacity",R)},dx:function(R){return this.x(new a.Number(R).plus(this instanceof a.FX?0:this.x()),!0)},dy:function(R){return this.y(new a.Number(R).plus(this instanceof a.FX?0:this.y()),!0)}}),a.extend(a.Path,{length:function(){return this.node.getTotalLength()},pointAt:function(R){return this.node.getPointAtLength(R)}}),a.Set=a.invent({create:function(R){Array.isArray(R)?this.members=R:this.clear()},extend:{add:function(){for(var R=[].slice.call(arguments),H=0,Q=R.length;H<Q;H++)this.members.push(R[H]);return this},remove:function(R){var H=this.index(R);return H>-1&&this.members.splice(H,1),this},each:function(R){for(var H=0,Q=this.members.length;H<Q;H++)R.apply(this.members[H],[H,this.members]);return this},clear:function(){return this.members=[],this},length:function(){return this.members.length},has:function(R){return this.index(R)>=0},index:function(R){return this.members.indexOf(R)},get:function(R){return this.members[R]},first:function(){return this.get(0)},last:function(){return this.get(this.members.length-1)},valueOf:function(){return this.members}},construct:{set:function(R){return new a.Set(R)}}}),a.FX.Set=a.invent({create:function(R){this.set=R}}),a.Set.inherit=function(){var R=[];for(var H in a.Shape.prototype)"function"==typeof a.Shape.prototype[H]&&"function"!=typeof a.Set.prototype[H]&&R.push(H);for(var H in R.forEach(function(le){a.Set.prototype[le]=function(){for(var Re=0,tt=this.members.length;Re<tt;Re++)this.members[Re]&&"function"==typeof this.members[Re][le]&&this.members[Re][le].apply(this.members[Re],arguments);return"animate"==le?this.fx||(this.fx=new a.FX.Set(this)):this}}),R=[],a.FX.prototype)"function"==typeof a.FX.prototype[H]&&"function"!=typeof a.FX.Set.prototype[H]&&R.push(H);R.forEach(function(Q){a.FX.Set.prototype[Q]=function(){for(var le=0,Re=this.set.members.length;le<Re;le++)this.set.members[le].fx[Q].apply(this.set.members[le].fx,arguments);return this}})},a.extend(a.Element,{}),a.extend(a.Element,{remember:function(R,H){if("object"===nr(arguments[0]))for(var Q in R)this.remember(Q,R[Q]);else{if(1==arguments.length)return this.memory()[R];this.memory()[R]=H}return this},forget:function(){if(0==arguments.length)this._memory={};else for(var R=arguments.length-1;R>=0;R--)delete this.memory()[arguments[R]];return this},memory:function(){return this._memory||(this._memory={})}}),a.get=function(R){var H=o.getElementById(function(Q){var le=(Q||"").toString().match(a.regex.reference);if(le)return le[1]}(R)||R);return a.adopt(H)},a.select=function(R,H){return new a.Set(a.utils.map((H||o).querySelectorAll(R),function(Q){return a.adopt(Q)}))},a.extend(a.Parent,{select:function(R){return a.select(R,this.node)}});var fe="abcdef".split("");if("function"!=typeof te.CustomEvent){var ge=function(R,H){H=H||{bubbles:!1,cancelable:!1,detail:void 0};var Q=o.createEvent("CustomEvent");return Q.initCustomEvent(R,H.bubbles,H.cancelable,H.detail),Q};ge.prototype=te.Event.prototype,a.CustomEvent=ge}else a.CustomEvent=te.CustomEvent;return a},void 0!==(Vn=function(){return xe(ue,ue.document)}.call(tr,gr,tr,os))&&(os.exports=Vn),function(){SVG.Filter=SVG.invent({create:"filter",inherit:SVG.Parent,extend:{source:"SourceGraphic",sourceAlpha:"SourceAlpha",background:"BackgroundImage",backgroundAlpha:"BackgroundAlpha",fill:"FillPaint",stroke:"StrokePaint",autoSetIn:!0,put:function(C,T){return this.add(C,T),!C.attr("in")&&this.autoSetIn&&C.attr("in",this.source),C.attr("result")||C.attr("result",C),C},blend:function(C,T,P){return this.put(new SVG.BlendEffect(C,T,P))},colorMatrix:function(C,T){return this.put(new SVG.ColorMatrixEffect(C,T))},convolveMatrix:function(C){return this.put(new SVG.ConvolveMatrixEffect(C))},componentTransfer:function(C){return this.put(new SVG.ComponentTransferEffect(C))},composite:function(C,T,P){return this.put(new SVG.CompositeEffect(C,T,P))},flood:function(C,T){return this.put(new SVG.FloodEffect(C,T))},offset:function(C,T){return this.put(new SVG.OffsetEffect(C,T))},image:function(C){return this.put(new SVG.ImageEffect(C))},merge:function(){var C=[void 0];for(var T in arguments)C.push(arguments[T]);return this.put(new(SVG.MergeEffect.bind.apply(SVG.MergeEffect,C)))},gaussianBlur:function(C,T){return this.put(new SVG.GaussianBlurEffect(C,T))},morphology:function(C,T){return this.put(new SVG.MorphologyEffect(C,T))},diffuseLighting:function(C,T,P){return this.put(new SVG.DiffuseLightingEffect(C,T,P))},displacementMap:function(C,T,P,L,B){return this.put(new SVG.DisplacementMapEffect(C,T,P,L,B))},specularLighting:function(C,T,P,L){return this.put(new SVG.SpecularLightingEffect(C,T,P,L))},tile:function(){return this.put(new SVG.TileEffect)},turbulence:function(C,T,P,L,B){return this.put(new SVG.TurbulenceEffect(C,T,P,L,B))},toString:function(){return"url(#"+this.attr("id")+")"}}}),SVG.extend(SVG.Defs,{filter:function(C){var T=this.put(new SVG.Filter);return"function"==typeof C&&C.call(T,T),T}}),SVG.extend(SVG.Container,{filter:function(C){return this.defs().filter(C)}}),SVG.extend(SVG.Element,SVG.G,SVG.Nested,{filter:function(C){return this.filterer=C instanceof SVG.Element?C:this.doc().filter(C),this.doc()&&this.filterer.doc()!==this.doc()&&this.doc().defs().add(this.filterer),this.attr("filter",this.filterer),this.filterer},unfilter:function(C){return this.filterer&&!0===C&&this.filterer.remove(),delete this.filterer,this.attr("filter",null)}}),SVG.Effect=SVG.invent({create:function(){this.constructor.call(this)},inherit:SVG.Element,extend:{in:function(C){return null==C?this.parent()&&this.parent().select('[result="'+this.attr("in")+'"]').get(0)||this.attr("in"):this.attr("in",C)},result:function(C){return null==C?this.attr("result"):this.attr("result",C)},toString:function(){return this.result()}}}),SVG.ParentEffect=SVG.invent({create:function(){this.constructor.call(this)},inherit:SVG.Parent,extend:{in:function(C){return null==C?this.parent()&&this.parent().select('[result="'+this.attr("in")+'"]').get(0)||this.attr("in"):this.attr("in",C)},result:function(C){return null==C?this.attr("result"):this.attr("result",C)},toString:function(){return this.result()}}});var te={blend:function(C,T){return this.parent()&&this.parent().blend(this,C,T)},colorMatrix:function(C,T){return this.parent()&&this.parent().colorMatrix(C,T).in(this)},convolveMatrix:function(C){return this.parent()&&this.parent().convolveMatrix(C).in(this)},componentTransfer:function(C){return this.parent()&&this.parent().componentTransfer(C).in(this)},composite:function(C,T){return this.parent()&&this.parent().composite(this,C,T)},flood:function(C,T){return this.parent()&&this.parent().flood(C,T)},offset:function(C,T){return this.parent()&&this.parent().offset(C,T).in(this)},image:function(C){return this.parent()&&this.parent().image(C)},merge:function(){return this.parent()&&this.parent().merge.apply(this.parent(),[this].concat(arguments))},gaussianBlur:function(C,T){return this.parent()&&this.parent().gaussianBlur(C,T).in(this)},morphology:function(C,T){return this.parent()&&this.parent().morphology(C,T).in(this)},diffuseLighting:function(C,T,P){return this.parent()&&this.parent().diffuseLighting(C,T,P).in(this)},displacementMap:function(C,T,P,L){return this.parent()&&this.parent().displacementMap(this,C,T,P,L)},specularLighting:function(C,T,P,L){return this.parent()&&this.parent().specularLighting(C,T,P,L).in(this)},tile:function(){return this.parent()&&this.parent().tile().in(this)},turbulence:function(C,T,P,L,B){return this.parent()&&this.parent().turbulence(C,T,P,L,B).in(this)}};SVG.extend(SVG.Effect,te),SVG.extend(SVG.ParentEffect,te),SVG.ChildEffect=SVG.invent({create:function(){this.constructor.call(this)},inherit:SVG.Element,extend:{in:function(C){this.attr("in",C)}}});var o={blend:function(C,T,P){this.attr({in:C,in2:T,mode:P||"normal"})},colorMatrix:function(C,T){"matrix"==C&&(T=g(T)),this.attr({type:C,values:void 0===T?null:T})},convolveMatrix:function(C){C=g(C),this.attr({order:Math.sqrt(C.split(" ").length),kernelMatrix:C})},composite:function(C,T,P){this.attr({in:C,in2:T,operator:P})},flood:function(C,T){this.attr("flood-color",C),null!=T&&this.attr("flood-opacity",T)},offset:function(C,T){this.attr({dx:C,dy:T})},image:function(C){this.attr("href",C,SVG.xlink)},displacementMap:function(C,T,P,L,B){this.attr({in:C,in2:T,scale:P,xChannelSelector:L,yChannelSelector:B})},gaussianBlur:function(C,T){this.attr("stdDeviation",null!=C||null!=T?_(Array.prototype.slice.call(arguments)):"0 0")},morphology:function(C,T){this.attr({operator:C,radius:T})},tile:function(){},turbulence:function(C,T,P,L,B){this.attr({numOctaves:T,seed:P,stitchTiles:L,baseFrequency:C,type:B})}},a={merge:function(){var C;if(arguments[0]instanceof SVG.Set){var T=this;arguments[0].each(function(L){this instanceof SVG.MergeNode?T.put(this):(this instanceof SVG.Effect||this instanceof SVG.ParentEffect)&&T.put(new SVG.MergeNode(this))})}else{C=Array.isArray(arguments[0])?arguments[0]:arguments;for(var P=0;P<C.length;P++)C[P]instanceof SVG.MergeNode?this.put(C[P]):this.put(new SVG.MergeNode(C[P]))}},componentTransfer:function(C){if(this.rgb=new SVG.Set,["r","g","b","a"].forEach(function(P){this[P]=new(SVG["Func"+P.toUpperCase()])("identity"),this.rgb.add(this[P]),this.node.appendChild(this[P].node)}.bind(this)),C)for(var T in C.rgb&&(["r","g","b"].forEach(function(P){this[P].attr(C.rgb)}.bind(this)),delete C.rgb),C)this[T].attr(C[T])},diffuseLighting:function(C,T,P){this.attr({surfaceScale:C,diffuseConstant:T,kernelUnitLength:P})},specularLighting:function(C,T,P,L){this.attr({surfaceScale:C,diffuseConstant:T,specularExponent:P,kernelUnitLength:L})}},d={distantLight:function(C,T){this.attr({azimuth:C,elevation:T})},pointLight:function(C,T,P){this.attr({x:C,y:T,z:P})},spotLight:function(C,T,P,L,B,V){this.attr({x:C,y:T,z:P,pointsAtX:L,pointsAtY:B,pointsAtZ:V})},mergeNode:function(C){this.attr("in",C)}};function g(C){return Array.isArray(C)&&(C=new SVG.Array(C)),C.toString().replace(/^\s+/,"").replace(/\s+$/,"").replace(/\s+/g," ")}function _(C){if(!Array.isArray(C))return C;for(var T=0,P=C.length,L=[];T<P;T++)L.push(C[T]);return L.join(" ")}function D(){var C=function(){};for(var T in"function"==typeof arguments[arguments.length-1]&&(C=arguments[arguments.length-1],Array.prototype.splice.call(arguments,arguments.length-1,1)),arguments)for(var P in arguments[T])C(arguments[T][P],P,arguments[T])}["r","g","b","a"].forEach(function(C){d["Func"+C.toUpperCase()]=function(T){switch(this.attr("type",T),T){case"table":this.attr("tableValues",arguments[1]);break;case"linear":this.attr("slope",arguments[1]),this.attr("intercept",arguments[2]);break;case"gamma":this.attr("amplitude",arguments[1]),this.attr("exponent",arguments[2]),this.attr("offset",arguments[2])}}}),D(o,function(C,T){var P=T.charAt(0).toUpperCase()+T.slice(1);SVG[P+"Effect"]=SVG.invent({create:function(){this.constructor.call(this,SVG.create("fe"+P)),C.apply(this,arguments),this.result(this.attr("id")+"Out")},inherit:SVG.Effect,extend:{}})}),D(a,function(C,T){var P=T.charAt(0).toUpperCase()+T.slice(1);SVG[P+"Effect"]=SVG.invent({create:function(){this.constructor.call(this,SVG.create("fe"+P)),C.apply(this,arguments),this.result(this.attr("id")+"Out")},inherit:SVG.ParentEffect,extend:{}})}),D(d,function(C,T){var P=T.charAt(0).toUpperCase()+T.slice(1);SVG[P]=SVG.invent({create:function(){this.constructor.call(this,SVG.create("fe"+P)),C.apply(this,arguments)},inherit:SVG.ChildEffect,extend:{}})}),SVG.extend(SVG.MergeEffect,{in:function(C){return C instanceof SVG.MergeNode?this.add(C,0):this.add(new SVG.MergeNode(C),0),this}}),SVG.extend(SVG.CompositeEffect,SVG.BlendEffect,SVG.DisplacementMapEffect,{in2:function(C){return null==C?this.parent()&&this.parent().select('[result="'+this.attr("in2")+'"]').get(0)||this.attr("in2"):this.attr("in2",C)}}),SVG.filter={sepiatone:[.343,.669,.119,0,0,.249,.626,.13,0,0,.172,.334,.111,0,0,0,0,0,1,0]}}.call(void 0),function(){function te(_,D,C,T,P,L,B){for(var V=_.slice(D,C||B),$=T.slice(P,L||B),q=0,K={pos:[0,0],start:[0,0]},oe={pos:[0,0],start:[0,0]};V[q]=o.call(K,V[q]),$[q]=o.call(oe,$[q]),V[q][0]!=$[q][0]||"M"==V[q][0]||"A"==V[q][0]&&(V[q][4]!=$[q][4]||V[q][5]!=$[q][5])?(Array.prototype.splice.apply(V,[q,1].concat(d.call(K,V[q]))),Array.prototype.splice.apply($,[q,1].concat(d.call(oe,$[q])))):(V[q]=a.call(K,V[q]),$[q]=a.call(oe,$[q])),++q!=V.length||q!=$.length;)q==V.length&&V.push(["C",K.pos[0],K.pos[1],K.pos[0],K.pos[1],K.pos[0],K.pos[1]]),q==$.length&&$.push(["C",oe.pos[0],oe.pos[1],oe.pos[0],oe.pos[1],oe.pos[0],oe.pos[1]]);return{start:V,dest:$}}function o(_){switch(_[0]){case"z":case"Z":_[0]="L",_[1]=this.start[0],_[2]=this.start[1];break;case"H":_[0]="L",_[2]=this.pos[1];break;case"V":_[0]="L",_[2]=_[1],_[1]=this.pos[0];break;case"T":_[0]="Q",_[3]=_[1],_[4]=_[2],_[1]=this.reflection[1],_[2]=this.reflection[0];break;case"S":_[0]="C",_[6]=_[4],_[5]=_[3],_[4]=_[2],_[3]=_[1],_[2]=this.reflection[1],_[1]=this.reflection[0]}return _}function a(_){var D=_.length;return this.pos=[_[D-2],_[D-1]],-1!="SCQT".indexOf(_[0])&&(this.reflection=[2*this.pos[0]-_[D-4],2*this.pos[1]-_[D-3]]),_}function d(_){var D=[_];switch(_[0]){case"M":return this.pos=this.start=[_[1],_[2]],D;case"L":_[5]=_[3]=_[1],_[6]=_[4]=_[2],_[1]=this.pos[0],_[2]=this.pos[1];break;case"Q":_[6]=_[4],_[5]=_[3],_[4]=1*_[4]/3+2*_[2]/3,_[3]=1*_[3]/3+2*_[1]/3,_[2]=1*this.pos[1]/3+2*_[2]/3,_[1]=1*this.pos[0]/3+2*_[1]/3;break;case"A":_=(D=function(C,T){var P,L,B,V,$,q,K,oe,ae,fe,ge,R,H,Q,le,Re,tt,Ve,Dt,pt,qe,Vt,Yn,pn,xi,sr,ki=Math.abs(T[1]),bi=Math.abs(T[2]),Gs=T[3]%360,$a=T[4],Zn=T[5],pc=T[6],Ts=T[7],yr=new SVG.Point(C),or=new SVG.Point(pc,Ts),Ou=[];if(0===ki||0===bi||yr.x===or.x&&yr.y===or.y)return[["C",yr.x,yr.y,or.x,or.y,or.x,or.y]];for((L=(P=new SVG.Point((yr.x-or.x)/2,(yr.y-or.y)/2).transform((new SVG.Matrix).rotate(Gs))).x*P.x/(ki*ki)+P.y*P.y/(bi*bi))>1&&(ki*=L=Math.sqrt(L),bi*=L),B=(new SVG.Matrix).rotate(Gs).scale(1/ki,1/bi).rotate(-Gs),yr=yr.transform(B),q=(V=[(or=or.transform(B)).x-yr.x,or.y-yr.y])[0]*V[0]+V[1]*V[1],$=Math.sqrt(q),V[0]/=$,V[1]/=$,K=q<4?Math.sqrt(1-q/4):0,$a===Zn&&(K*=-1),oe=new SVG.Point((or.x+yr.x)/2+K*-V[1],(or.y+yr.y)/2+K*V[0]),ae=new SVG.Point(yr.x-oe.x,yr.y-oe.y),fe=new SVG.Point(or.x-oe.x,or.y-oe.y),ge=Math.acos(ae.x/Math.sqrt(ae.x*ae.x+ae.y*ae.y)),ae.y<0&&(ge*=-1),R=Math.acos(fe.x/Math.sqrt(fe.x*fe.x+fe.y*fe.y)),fe.y<0&&(R*=-1),Zn&&ge>R&&(R+=2*Math.PI),!Zn&&ge<R&&(R-=2*Math.PI),Re=[],tt=ge,H=(R-ge)/(Q=Math.ceil(2*Math.abs(ge-R)/Math.PI)),le=4*Math.tan(H/4)/3,qe=0;qe<=Q;qe++)Dt=Math.cos(tt),Ve=Math.sin(tt),pt=new SVG.Point(oe.x+Dt,oe.y+Ve),Re[qe]=[new SVG.Point(pt.x+le*Ve,pt.y-le*Dt),pt,new SVG.Point(pt.x-le*Ve,pt.y+le*Dt)],tt+=H;for(Re[0][0]=Re[0][1].clone(),Re[Re.length-1][2]=Re[Re.length-1][1].clone(),B=(new SVG.Matrix).rotate(Gs).scale(ki,bi).rotate(-Gs),qe=0,Vt=Re.length;qe<Vt;qe++)Re[qe][0]=Re[qe][0].transform(B),Re[qe][1]=Re[qe][1].transform(B),Re[qe][2]=Re[qe][2].transform(B);for(qe=1,Vt=Re.length;qe<Vt;qe++)Yn=(pt=Re[qe-1][2]).x,pn=pt.y,xi=(pt=Re[qe][0]).x,sr=pt.y,pc=(pt=Re[qe][1]).x,Ou.push(["C",Yn,pn,xi,sr,pc,Ts=pt.y]);return Ou}(this.pos,_))[0]}return _[0]="C",this.pos=[_[5],_[6]],this.reflection=[2*_[5]-_[3],2*_[6]-_[4]],D}function g(_,D){if(!1===D)return!1;for(var C=D,T=_.length;C<T;++C)if("M"==_[C][0])return C;return!1}SVG.extend(SVG.PathArray,{morph:function(_){for(var D=this.value,C=this.parse(_),T=0,P=0,L=!1,B=!1;!1!==T||!1!==P;){var V;L=g(D,!1!==T&&T+1),B=g(C,!1!==P&&P+1),!1===T&&(T=0==(V=new SVG.PathArray($.start).bbox()).height||0==V.width?D.push(D[0])-1:D.push(["M",V.x+V.width/2,V.y+V.height/2])-1),!1===P&&(P=0==(V=new SVG.PathArray($.dest).bbox()).height||0==V.width?C.push(C[0])-1:C.push(["M",V.x+V.width/2,V.y+V.height/2])-1);var $=te(D,T,L,C,P,B);D=D.slice(0,T).concat($.start,!1===L?[]:D.slice(L)),C=C.slice(0,P).concat($.dest,!1===B?[]:C.slice(B)),T=!1!==L&&T+$.start.length,P=!1!==B&&P+$.dest.length}return this.value=D,this.destination=new SVG.PathArray,this.destination.value=C,this}})}(),function(){function te(o){o.remember("_draggable",this),this.el=o}te.prototype.init=function(o,a){var d=this;this.constraint=o,this.value=a,this.el.on("mousedown.drag",function(g){d.start(g)}),this.el.on("touchstart.drag",function(g){d.start(g)})},te.prototype.transformPoint=function(o,a){var d=(o=o||window.event).changedTouches&&o.changedTouches[0]||o;return this.p.x=d.clientX-(a||0),this.p.y=d.clientY,this.p.matrixTransform(this.m)},te.prototype.getBBox=function(){var o=this.el.bbox();return this.el instanceof SVG.Nested&&(o=this.el.rbox()),(this.el instanceof SVG.G||this.el instanceof SVG.Use||this.el instanceof SVG.Nested)&&(o.x=this.el.x(),o.y=this.el.y()),o},te.prototype.start=function(o){if("click"!=o.type&&"mousedown"!=o.type&&"mousemove"!=o.type||1==(o.which||o.buttons)){var a=this;if(this.el.fire("beforedrag",{event:o,handler:this}),!this.el.event().defaultPrevented){o.preventDefault(),o.stopPropagation(),this.parent=this.parent||this.el.parent(SVG.Nested)||this.el.parent(SVG.Doc),this.p=this.parent.node.createSVGPoint(),this.m=this.el.node.getScreenCTM().inverse();var d,g=this.getBBox();if(this.el instanceof SVG.Text)switch(d=this.el.node.getComputedTextLength(),this.el.attr("text-anchor")){case"middle":d/=2;break;case"start":d=0}this.startPoints={point:this.transformPoint(o,d),box:g,transform:this.el.transform()},SVG.on(window,"mousemove.drag",function(_){a.drag(_)}),SVG.on(window,"touchmove.drag",function(_){a.drag(_)}),SVG.on(window,"mouseup.drag",function(_){a.end(_)}),SVG.on(window,"touchend.drag",function(_){a.end(_)}),this.el.fire("dragstart",{event:o,p:this.startPoints.point,m:this.m,handler:this})}}},te.prototype.drag=function(o){var a=this.getBBox(),d=this.transformPoint(o),g=this.startPoints.box.x+d.x-this.startPoints.point.x,_=this.startPoints.box.y+d.y-this.startPoints.point.y,D=this.constraint,C=d.x-this.startPoints.point.x,T=d.y-this.startPoints.point.y;if(this.el.fire("dragmove",{event:o,p:d,m:this.m,handler:this}),this.el.event().defaultPrevented)return d;if("function"==typeof D){var P=D.call(this.el,g,_,this.m);"boolean"==typeof P&&(P={x:P,y:P}),!0===P.x?this.el.x(g):!1!==P.x&&this.el.x(P.x),!0===P.y?this.el.y(_):!1!==P.y&&this.el.y(P.y)}else"object"==typeof D&&(null!=D.minX&&g<D.minX?C=(g=D.minX)-this.startPoints.box.x:null!=D.maxX&&g>D.maxX-a.width&&(C=(g=D.maxX-a.width)-this.startPoints.box.x),null!=D.minY&&_<D.minY?T=(_=D.minY)-this.startPoints.box.y:null!=D.maxY&&_>D.maxY-a.height&&(T=(_=D.maxY-a.height)-this.startPoints.box.y),null!=D.snapToGrid&&(g-=g%D.snapToGrid,_-=_%D.snapToGrid,C-=C%D.snapToGrid,T-=T%D.snapToGrid),this.el instanceof SVG.G?this.el.matrix(this.startPoints.transform).transform({x:C,y:T},!0):this.el.move(g,_));return d},te.prototype.end=function(o){var a=this.drag(o);this.el.fire("dragend",{event:o,p:a,m:this.m,handler:this}),SVG.off(window,"mousemove.drag"),SVG.off(window,"touchmove.drag"),SVG.off(window,"mouseup.drag"),SVG.off(window,"touchend.drag")},SVG.extend(SVG.Element,{draggable:function(o,a){"function"!=typeof o&&"object"!=typeof o||(a=o,o=!0);var d=this.remember("_draggable")||new te(this);return(o=void 0===o||o)?d.init(a||{},o):(this.off("mousedown.drag"),this.off("touchstart.drag")),this}})}.call(void 0),function(){function te(o){this.el=o,o.remember("_selectHandler",this),this.pointSelection={isSelected:!1},this.rectSelection={isSelected:!1},this.pointsList={lt:[0,0],rt:["width",0],rb:["width","height"],lb:[0,"height"],t:["width",0],r:["width","height"],b:["width","height"],l:[0,"height"]},this.pointCoord=function(a,d,g){var _="string"!=typeof a?a:d[a];return g?_/2:_},this.pointCoords=function(a,d){var g=this.pointsList[a];return{x:this.pointCoord(g[0],d,"t"===a||"b"===a),y:this.pointCoord(g[1],d,"r"===a||"l"===a)}}}te.prototype.init=function(o,a){var d=this.el.bbox();this.options={};var g=this.el.selectize.defaults.points;for(var _ in this.el.selectize.defaults)this.options[_]=this.el.selectize.defaults[_],void 0!==a[_]&&(this.options[_]=a[_]);var D=["points","pointsExclude"];for(var _ in D){var C=this.options[D[_]];"string"==typeof C?C=C.length>0?C.split(/\s*,\s*/i):[]:"boolean"==typeof C&&"points"===D[_]&&(C=C?g:[]),this.options[D[_]]=C}this.options.points=[g,this.options.points].reduce(function(T,P){return T.filter(function(L){return P.indexOf(L)>-1})}),this.options.points=[this.options.points,this.options.pointsExclude].reduce(function(T,P){return T.filter(function(L){return P.indexOf(L)<0})}),this.parent=this.el.parent(),this.nested=this.nested||this.parent.group(),this.nested.matrix(new SVG.Matrix(this.el).translate(d.x,d.y)),this.options.deepSelect&&-1!==["line","polyline","polygon"].indexOf(this.el.type)?this.selectPoints(o):this.selectRect(o),this.observe(),this.cleanup()},te.prototype.selectPoints=function(o){return this.pointSelection.isSelected=o,this.pointSelection.set||(this.pointSelection.set=this.parent.set(),this.drawPoints()),this},te.prototype.getPointArray=function(){var o=this.el.bbox();return this.el.array().valueOf().map(function(a){return[a[0]-o.x,a[1]-o.y]})},te.prototype.drawPoints=function(){for(var o=this,a=this.getPointArray(),d=0,g=a.length;d<g;++d){var _=function(C){return function(T){(T=T||window.event).preventDefault?T.preventDefault():T.returnValue=!1,T.stopPropagation(),o.el.fire("point",{x:T.pageX||T.touches[0].pageX,y:T.pageY||T.touches[0].pageY,i:C,event:T})}}(d),D=this.drawPoint(a[d][0],a[d][1]).addClass(this.options.classPoints).addClass(this.options.classPoints+"_point").on("touchstart",_).on("mousedown",_);this.pointSelection.set.add(D)}},te.prototype.drawPoint=function(o,a){var d=this.options.pointType;switch(d){case"circle":return this.drawCircle(o,a);case"rect":return this.drawRect(o,a);default:if("function"==typeof d)return d.call(this,o,a);throw new Error("Unknown "+d+" point type!")}},te.prototype.drawCircle=function(o,a){return this.nested.circle(this.options.pointSize).center(o,a)},te.prototype.drawRect=function(o,a){return this.nested.rect(this.options.pointSize,this.options.pointSize).center(o,a)},te.prototype.updatePointSelection=function(){var o=this.getPointArray();this.pointSelection.set.each(function(a){this.cx()===o[a][0]&&this.cy()===o[a][1]||this.center(o[a][0],o[a][1])})},te.prototype.updateRectSelection=function(){var o=this,a=this.el.bbox();if(this.rectSelection.set.get(0).attr({width:a.width,height:a.height}),this.options.points.length&&this.options.points.map(function(g,_){var D=o.pointCoords(g,a);o.rectSelection.set.get(_+1).center(D.x,D.y)}),this.options.rotationPoint){var d=this.rectSelection.set.length();this.rectSelection.set.get(d-1).center(a.width/2,20)}},te.prototype.selectRect=function(o){var a=this,d=this.el.bbox();function g(C){return function(T){(T=T||window.event).preventDefault?T.preventDefault():T.returnValue=!1,T.stopPropagation(),a.el.fire(C,{x:T.pageX||T.touches[0].pageX,y:T.pageY||T.touches[0].pageY,event:T})}}if(this.rectSelection.isSelected=o,this.rectSelection.set=this.rectSelection.set||this.parent.set(),this.rectSelection.set.get(0)||this.rectSelection.set.add(this.nested.rect(d.width,d.height).addClass(this.options.classRect)),this.options.points.length&&this.rectSelection.set.length()<2&&(this.options.points.map(function(C,T){var P=a.pointCoords(C,d),L=a.drawPoint(P.x,P.y).attr("class",a.options.classPoints+"_"+C).on("mousedown",g(C)).on("touchstart",g(C));a.rectSelection.set.add(L)}),this.rectSelection.set.each(function(){this.addClass(a.options.classPoints)})),this.options.rotationPoint&&(this.options.points&&!this.rectSelection.set.get(9)||!this.options.points&&!this.rectSelection.set.get(1))){var _=function(C){(C=C||window.event).preventDefault?C.preventDefault():C.returnValue=!1,C.stopPropagation(),a.el.fire("rot",{x:C.pageX||C.touches[0].pageX,y:C.pageY||C.touches[0].pageY,event:C})},D=this.drawPoint(d.width/2,20).attr("class",this.options.classPoints+"_rot").on("touchstart",_).on("mousedown",_);this.rectSelection.set.add(D)}},te.prototype.handler=function(){var o=this.el.bbox();this.nested.matrix(new SVG.Matrix(this.el).translate(o.x,o.y)),this.rectSelection.isSelected&&this.updateRectSelection(),this.pointSelection.isSelected&&this.updatePointSelection()},te.prototype.observe=function(){var o=this;if(MutationObserver)if(this.rectSelection.isSelected||this.pointSelection.isSelected)this.observerInst=this.observerInst||new MutationObserver(function(){o.handler()}),this.observerInst.observe(this.el.node,{attributes:!0});else try{this.observerInst.disconnect(),delete this.observerInst}catch(a){}else this.el.off("DOMAttrModified.select"),(this.rectSelection.isSelected||this.pointSelection.isSelected)&&this.el.on("DOMAttrModified.select",function(){o.handler()})},te.prototype.cleanup=function(){!this.rectSelection.isSelected&&this.rectSelection.set&&(this.rectSelection.set.each(function(){this.remove()}),this.rectSelection.set.clear(),delete this.rectSelection.set),!this.pointSelection.isSelected&&this.pointSelection.set&&(this.pointSelection.set.each(function(){this.remove()}),this.pointSelection.set.clear(),delete this.pointSelection.set),this.pointSelection.isSelected||this.rectSelection.isSelected||(this.nested.remove(),delete this.nested)},SVG.extend(SVG.Element,{selectize:function(o,a){return"object"==typeof o&&(a=o,o=!0),(this.remember("_selectHandler")||new te(this)).init(void 0===o||o,a||{}),this}}),SVG.Element.prototype.selectize.defaults={points:["lt","rt","rb","lb","t","r","b","l"],pointsExclude:[],classRect:"svg_select_boundingRect",classPoints:"svg_select_points",pointSize:7,rotationPoint:!0,deepSelect:!1,pointType:"circle"}}(),function(){(function(){function te(o){o.remember("_resizeHandler",this),this.el=o,this.parameters={},this.lastUpdateCall=null,this.p=o.doc().node.createSVGPoint()}te.prototype.transformPoint=function(o,a,d){return this.p.x=o-(this.offset.x-window.pageXOffset),this.p.y=a-(this.offset.y-window.pageYOffset),this.p.matrixTransform(d||this.m)},te.prototype._extractPosition=function(o){return{x:null!=o.clientX?o.clientX:o.touches[0].clientX,y:null!=o.clientY?o.clientY:o.touches[0].clientY}},te.prototype.init=function(o){var a=this;if(this.stop(),"stop"!==o){for(var d in this.options={},this.el.resize.defaults)this.options[d]=this.el.resize.defaults[d],void 0!==o[d]&&(this.options[d]=o[d]);this.el.on("lt.resize",function(g){a.resize(g||window.event)}),this.el.on("rt.resize",function(g){a.resize(g||window.event)}),this.el.on("rb.resize",function(g){a.resize(g||window.event)}),this.el.on("lb.resize",function(g){a.resize(g||window.event)}),this.el.on("t.resize",function(g){a.resize(g||window.event)}),this.el.on("r.resize",function(g){a.resize(g||window.event)}),this.el.on("b.resize",function(g){a.resize(g||window.event)}),this.el.on("l.resize",function(g){a.resize(g||window.event)}),this.el.on("rot.resize",function(g){a.resize(g||window.event)}),this.el.on("point.resize",function(g){a.resize(g||window.event)}),this.update()}},te.prototype.stop=function(){return this.el.off("lt.resize"),this.el.off("rt.resize"),this.el.off("rb.resize"),this.el.off("lb.resize"),this.el.off("t.resize"),this.el.off("r.resize"),this.el.off("b.resize"),this.el.off("l.resize"),this.el.off("rot.resize"),this.el.off("point.resize"),this},te.prototype.resize=function(o){var a=this;this.m=this.el.node.getScreenCTM().inverse(),this.offset={x:window.pageXOffset,y:window.pageYOffset};var d=this._extractPosition(o.detail.event);if(this.parameters={type:this.el.type,p:this.transformPoint(d.x,d.y),x:o.detail.x,y:o.detail.y,box:this.el.bbox(),rotation:this.el.transform().rotation},"text"===this.el.type&&(this.parameters.fontSize=this.el.attr()["font-size"]),void 0!==o.detail.i){var g=this.el.array().valueOf();this.parameters.i=o.detail.i,this.parameters.pointCoords=[g[o.detail.i][0],g[o.detail.i][1]]}switch(o.type){case"lt":this.calc=function(_,D){var C=this.snapToGrid(_,D);if(this.parameters.box.width-C[0]>0&&this.parameters.box.height-C[1]>0){if("text"===this.parameters.type)return this.el.move(this.parameters.box.x+C[0],this.parameters.box.y),void this.el.attr("font-size",this.parameters.fontSize-C[0]);C=this.checkAspectRatio(C),this.el.move(this.parameters.box.x+C[0],this.parameters.box.y+C[1]).size(this.parameters.box.width-C[0],this.parameters.box.height-C[1])}};break;case"rt":this.calc=function(_,D){var C=this.snapToGrid(_,D,2);if(this.parameters.box.width+C[0]>0&&this.parameters.box.height-C[1]>0){if("text"===this.parameters.type)return this.el.move(this.parameters.box.x-C[0],this.parameters.box.y),void this.el.attr("font-size",this.parameters.fontSize+C[0]);C=this.checkAspectRatio(C,!0),this.el.move(this.parameters.box.x,this.parameters.box.y+C[1]).size(this.parameters.box.width+C[0],this.parameters.box.height-C[1])}};break;case"rb":this.calc=function(_,D){var C=this.snapToGrid(_,D,0);if(this.parameters.box.width+C[0]>0&&this.parameters.box.height+C[1]>0){if("text"===this.parameters.type)return this.el.move(this.parameters.box.x-C[0],this.parameters.box.y),void this.el.attr("font-size",this.parameters.fontSize+C[0]);C=this.checkAspectRatio(C),this.el.move(this.parameters.box.x,this.parameters.box.y).size(this.parameters.box.width+C[0],this.parameters.box.height+C[1])}};break;case"lb":this.calc=function(_,D){var C=this.snapToGrid(_,D,1);if(this.parameters.box.width-C[0]>0&&this.parameters.box.height+C[1]>0){if("text"===this.parameters.type)return this.el.move(this.parameters.box.x+C[0],this.parameters.box.y),void this.el.attr("font-size",this.parameters.fontSize-C[0]);C=this.checkAspectRatio(C,!0),this.el.move(this.parameters.box.x+C[0],this.parameters.box.y).size(this.parameters.box.width-C[0],this.parameters.box.height+C[1])}};break;case"t":this.calc=function(_,D){var C=this.snapToGrid(_,D,2);if(this.parameters.box.height-C[1]>0){if("text"===this.parameters.type)return;this.el.move(this.parameters.box.x,this.parameters.box.y+C[1]).height(this.parameters.box.height-C[1])}};break;case"r":this.calc=function(_,D){var C=this.snapToGrid(_,D,0);if(this.parameters.box.width+C[0]>0){if("text"===this.parameters.type)return;this.el.move(this.parameters.box.x,this.parameters.box.y).width(this.parameters.box.width+C[0])}};break;case"b":this.calc=function(_,D){var C=this.snapToGrid(_,D,0);if(this.parameters.box.height+C[1]>0){if("text"===this.parameters.type)return;this.el.move(this.parameters.box.x,this.parameters.box.y).height(this.parameters.box.height+C[1])}};break;case"l":this.calc=function(_,D){var C=this.snapToGrid(_,D,1);if(this.parameters.box.width-C[0]>0){if("text"===this.parameters.type)return;this.el.move(this.parameters.box.x+C[0],this.parameters.box.y).width(this.parameters.box.width-C[0])}};break;case"rot":this.calc=function(_,D){var C=_+this.parameters.p.x,T=D+this.parameters.p.y,P=Math.atan2(this.parameters.p.y-this.parameters.box.y-this.parameters.box.height/2,this.parameters.p.x-this.parameters.box.x-this.parameters.box.width/2),L=Math.atan2(T-this.parameters.box.y-this.parameters.box.height/2,C-this.parameters.box.x-this.parameters.box.width/2),B=this.parameters.rotation+180*(L-P)/Math.PI+this.options.snapToAngle/2;this.el.center(this.parameters.box.cx,this.parameters.box.cy).rotate(B-B%this.options.snapToAngle,this.parameters.box.cx,this.parameters.box.cy)};break;case"point":this.calc=function(_,D){var C=this.snapToGrid(_,D,this.parameters.pointCoords[0],this.parameters.pointCoords[1]),T=this.el.array().valueOf();T[this.parameters.i][0]=this.parameters.pointCoords[0]+C[0],T[this.parameters.i][1]=this.parameters.pointCoords[1]+C[1],this.el.plot(T)}}this.el.fire("resizestart",{dx:this.parameters.x,dy:this.parameters.y,event:o}),SVG.on(window,"touchmove.resize",function(_){a.update(_||window.event)}),SVG.on(window,"touchend.resize",function(){a.done()}),SVG.on(window,"mousemove.resize",function(_){a.update(_||window.event)}),SVG.on(window,"mouseup.resize",function(){a.done()})},te.prototype.update=function(o){if(o){var a=this._extractPosition(o),d=this.transformPoint(a.x,a.y),g=d.x-this.parameters.p.x,_=d.y-this.parameters.p.y;this.lastUpdateCall=[g,_],this.calc(g,_),this.el.fire("resizing",{dx:g,dy:_,event:o})}else this.lastUpdateCall&&this.calc(this.lastUpdateCall[0],this.lastUpdateCall[1])},te.prototype.done=function(){this.lastUpdateCall=null,SVG.off(window,"mousemove.resize"),SVG.off(window,"mouseup.resize"),SVG.off(window,"touchmove.resize"),SVG.off(window,"touchend.resize"),this.el.fire("resizedone")},te.prototype.snapToGrid=function(o,a,d,g){var _;return _=void 0!==g?[(d+o)%this.options.snapToGrid,(g+a)%this.options.snapToGrid]:[(this.parameters.box.x+o+(1&(d=null==d?3:d)?0:this.parameters.box.width))%this.options.snapToGrid,(this.parameters.box.y+a+(2&d?0:this.parameters.box.height))%this.options.snapToGrid],o<0&&(_[0]-=this.options.snapToGrid),a<0&&(_[1]-=this.options.snapToGrid),o-=Math.abs(_[0])<this.options.snapToGrid/2?_[0]:_[0]-(o<0?-this.options.snapToGrid:this.options.snapToGrid),a-=Math.abs(_[1])<this.options.snapToGrid/2?_[1]:_[1]-(a<0?-this.options.snapToGrid:this.options.snapToGrid),this.constraintToBox(o,a,d,g)},te.prototype.constraintToBox=function(o,a,d,g){var _,D,C=this.options.constraint||{};return void 0!==g?(_=d,D=g):(_=this.parameters.box.x+(1&d?0:this.parameters.box.width),D=this.parameters.box.y+(2&d?0:this.parameters.box.height)),void 0!==C.minX&&_+o<C.minX&&(o=C.minX-_),void 0!==C.maxX&&_+o>C.maxX&&(o=C.maxX-_),void 0!==C.minY&&D+a<C.minY&&(a=C.minY-D),void 0!==C.maxY&&D+a>C.maxY&&(a=C.maxY-D),[o,a]},te.prototype.checkAspectRatio=function(o,a){if(!this.options.saveAspectRatio)return o;var d=o.slice(),g=this.parameters.box.width/this.parameters.box.height,_=this.parameters.box.width+o[0],D=this.parameters.box.height-o[1],C=_/D;return C<g?(d[1]=_/g-this.parameters.box.height,a&&(d[1]=-d[1])):C>g&&(d[0]=this.parameters.box.width-D*g,a&&(d[0]=-d[0])),d},SVG.extend(SVG.Element,{resize:function(o){return(this.remember("_resizeHandler")||new te(this)).init(o||{}),this}}),SVG.Element.prototype.resize.defaults={snapToAngle:.1,snapToGrid:1,constraint:{},saveAspectRatio:!1}}).call(this)}(),void 0===window.Apex&&(window.Apex={});var Oe=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"initModules",value:function(){this.ctx.publicMethods=["updateOptions","updateSeries","appendData","appendSeries","toggleSeries","showSeries","hideSeries","setLocale","resetSeries","zoomX","toggleDataPointSelection","dataURI","addXaxisAnnotation","addYaxisAnnotation","addPointAnnotation","clearAnnotations","removeAnnotation","paper","destroy"],this.ctx.eventList=["click","mousedown","mousemove","mouseleave","touchstart","touchmove","touchleave","mouseup","touchend"],this.ctx.animations=new mr(this.ctx),this.ctx.axes=new hl(this.ctx),this.ctx.core=new $e(this.ctx.el,this.ctx),this.ctx.config=new vn({}),this.ctx.data=new Tn(this.ctx),this.ctx.grid=new cs(this.ctx),this.ctx.graphics=new yt(this.ctx),this.ctx.coreUtils=new fi(this.ctx),this.ctx.crosshairs=new Fo(this.ctx),this.ctx.events=new xa(this.ctx),this.ctx.exports=new Va(this.ctx),this.ctx.localization=new js(this.ctx),this.ctx.options=new Fr,this.ctx.responsive=new dl(this.ctx),this.ctx.series=new Bi(this.ctx),this.ctx.theme=new pl(this.ctx),this.ctx.formatters=new ho(this.ctx),this.ctx.titleSubtitle=new Es(this.ctx),this.ctx.legend=new Ua(this.ctx),this.ctx.toolbar=new fl(this.ctx),this.ctx.dimensions=new rr(this.ctx),this.ctx.updateHelpers=new Ue(this.ctx),this.ctx.zoomPanSelection=new hc(this.ctx),this.ctx.w.globals.tooltip=new us(this.ctx)}}]),te}(),We=function(){function te(o){zt(this,te),this.ctx=o,this.w=o.w}return St(te,[{key:"clear",value:function(o){var a=o.isUpdating;this.ctx.zoomPanSelection&&this.ctx.zoomPanSelection.destroy(),this.ctx.toolbar&&this.ctx.toolbar.destroy(),this.ctx.animations=null,this.ctx.axes=null,this.ctx.annotations=null,this.ctx.core=null,this.ctx.data=null,this.ctx.grid=null,this.ctx.series=null,this.ctx.responsive=null,this.ctx.theme=null,this.ctx.formatters=null,this.ctx.titleSubtitle=null,this.ctx.legend=null,this.ctx.dimensions=null,this.ctx.options=null,this.ctx.crosshairs=null,this.ctx.zoomPanSelection=null,this.ctx.updateHelpers=null,this.ctx.toolbar=null,this.ctx.localization=null,this.ctx.w.globals.tooltip=null,this.clearDomElements({isUpdating:a})}},{key:"killSVG",value:function(o){o.each(function(a,d){this.removeClass("*"),this.off(),this.stop()},!0),o.ungroup(),o.clear()}},{key:"clearDomElements",value:function(o){var a=this,g=this.w.globals.dom.Paper.node;g.parentNode&&g.parentNode.parentNode&&!o.isUpdating&&(g.parentNode.parentNode.style.minHeight="unset");var _=this.w.globals.dom.baseEl;_&&this.ctx.eventList.forEach(function(C){_.removeEventListener(C,a.ctx.events.documentEvent)});var D=this.w.globals.dom;if(null!==this.ctx.el)for(;this.ctx.el.firstChild;)this.ctx.el.removeChild(this.ctx.el.firstChild);this.killSVG(D.Paper),D.Paper.remove(),D.elWrap=null,D.elGraphical=null,D.elAnnotations=null,D.elLegendWrap=null,D.baseEl=null,D.elGridRect=null,D.elGridRectMask=null,D.elGridRectMarkerMask=null,D.elForecastMask=null,D.elNonForecastMask=null,D.elDefs=null}}]),te}(),at=new WeakMap,Tt=function(){function te(o,a){zt(this,te),this.opts=a,this.ctx=this,this.w=new ua(a).init(),this.el=o,this.w.globals.cuid=Xe.randomId(),this.w.globals.chartID=this.w.config.chart.id?Xe.escapeString(this.w.config.chart.id):this.w.globals.cuid,new Oe(this).initModules(),this.create=Xe.bind(this.create,this),this.windowResizeHandler=this._windowResizeHandler.bind(this),this.parentResizeHandler=this._parentResizeCallback.bind(this)}return St(te,[{key:"render",value:function(){var o=this;return new Promise(function(a,d){if(null!==o.el){void 0===Apex._chartInstances&&(Apex._chartInstances=[]),o.w.config.chart.id&&Apex._chartInstances.push({id:o.w.globals.chartID,group:o.w.config.chart.group,chart:o}),o.setLocale(o.w.config.chart.defaultLocale);var g=o.w.config.chart.events.beforeMount;if("function"==typeof g&&g(o,o.w),o.events.fireEvent("beforeMount",[o,o.w]),window.addEventListener("resize",o.windowResizeHandler),L=o.el.parentNode,B=o.parentResizeHandler,V=!1,$=new ResizeObserver(function(q){V&&B.call(L,q),V=!0}),L.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Array.from(L.children).forEach(function(q){return $.observe(q)}):$.observe(L),at.set(B,$),!o.css){var _=o.el.getRootNode&&o.el.getRootNode(),D=Xe.is("ShadowRoot",_),C=o.el.ownerDocument,T=C.getElementById("apexcharts-css");!D&&T||(o.css=document.createElement("style"),o.css.id="apexcharts-css",o.css.textContent='.apexcharts-canvas {\n  position: relative;\n  user-select: none;\n  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */\n}\n\n\n/* scrollbar is not visible by default for legend, hence forcing the visibility */\n.apexcharts-canvas ::-webkit-scrollbar {\n  -webkit-appearance: none;\n  width: 6px;\n}\n\n.apexcharts-canvas ::-webkit-scrollbar-thumb {\n  border-radius: 4px;\n  background-color: rgba(0, 0, 0, .5);\n  box-shadow: 0 0 1px rgba(255, 255, 255, .5);\n  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);\n}\n\n\n.apexcharts-inner {\n  position: relative;\n}\n\n.apexcharts-text tspan {\n  font-family: inherit;\n}\n\n.legend-mouseover-inactive {\n  transition: 0.15s ease all;\n  opacity: 0.20;\n}\n\n.apexcharts-series-collapsed {\n  opacity: 0;\n}\n\n.apexcharts-tooltip {\n  border-radius: 5px;\n  box-shadow: 2px 2px 6px -4px #999;\n  cursor: default;\n  font-size: 14px;\n  left: 62px;\n  opacity: 0;\n  pointer-events: none;\n  position: absolute;\n  top: 20px;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  white-space: nowrap;\n  z-index: 12;\n  transition: 0.15s ease all;\n}\n\n.apexcharts-tooltip.apexcharts-active {\n  opacity: 1;\n  transition: 0.15s ease all;\n}\n\n.apexcharts-tooltip.apexcharts-theme-light {\n  border: 1px solid #e3e3e3;\n  background: rgba(255, 255, 255, 0.96);\n}\n\n.apexcharts-tooltip.apexcharts-theme-dark {\n  color: #fff;\n  background: rgba(30, 30, 30, 0.8);\n}\n\n.apexcharts-tooltip * {\n  font-family: inherit;\n}\n\n\n.apexcharts-tooltip-title {\n  padding: 6px;\n  font-size: 15px;\n  margin-bottom: 4px;\n}\n\n.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {\n  background: #ECEFF1;\n  border-bottom: 1px solid #ddd;\n}\n\n.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {\n  background: rgba(0, 0, 0, 0.7);\n  border-bottom: 1px solid #333;\n}\n\n.apexcharts-tooltip-text-y-value,\n.apexcharts-tooltip-text-goals-value,\n.apexcharts-tooltip-text-z-value {\n  display: inline-block;\n  font-weight: 600;\n  margin-left: 5px;\n}\n\n.apexcharts-tooltip-text-y-label:empty,\n.apexcharts-tooltip-text-y-value:empty,\n.apexcharts-tooltip-text-goals-label:empty,\n.apexcharts-tooltip-text-goals-value:empty,\n.apexcharts-tooltip-text-z-value:empty {\n  display: none;\n}\n\n.apexcharts-tooltip-text-y-value,\n.apexcharts-tooltip-text-goals-value,\n.apexcharts-tooltip-text-z-value {\n  font-weight: 600;\n}\n\n.apexcharts-tooltip-text-goals-label, \n.apexcharts-tooltip-text-goals-value {\n  padding: 6px 0 5px;\n}\n\n.apexcharts-tooltip-goals-group, \n.apexcharts-tooltip-text-goals-label, \n.apexcharts-tooltip-text-goals-value {\n  display: flex;\n}\n.apexcharts-tooltip-text-goals-label:not(:empty),\n.apexcharts-tooltip-text-goals-value:not(:empty) {\n  margin-top: -6px;\n}\n\n.apexcharts-tooltip-marker {\n  width: 12px;\n  height: 12px;\n  position: relative;\n  top: 0px;\n  margin-right: 10px;\n  border-radius: 50%;\n}\n\n.apexcharts-tooltip-series-group {\n  padding: 0 10px;\n  display: none;\n  text-align: left;\n  justify-content: left;\n  align-items: center;\n}\n\n.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {\n  opacity: 1;\n}\n\n.apexcharts-tooltip-series-group.apexcharts-active,\n.apexcharts-tooltip-series-group:last-child {\n  padding-bottom: 4px;\n}\n\n.apexcharts-tooltip-series-group-hidden {\n  opacity: 0;\n  height: 0;\n  line-height: 0;\n  padding: 0 !important;\n}\n\n.apexcharts-tooltip-y-group {\n  padding: 6px 0 5px;\n}\n\n.apexcharts-tooltip-box, .apexcharts-custom-tooltip {\n  padding: 4px 8px;\n}\n\n.apexcharts-tooltip-boxPlot {\n  display: flex;\n  flex-direction: column-reverse;\n}\n\n.apexcharts-tooltip-box>div {\n  margin: 4px 0;\n}\n\n.apexcharts-tooltip-box span.value {\n  font-weight: bold;\n}\n\n.apexcharts-tooltip-rangebar {\n  padding: 5px 8px;\n}\n\n.apexcharts-tooltip-rangebar .category {\n  font-weight: 600;\n  color: #777;\n}\n\n.apexcharts-tooltip-rangebar .series-name {\n  font-weight: bold;\n  display: block;\n  margin-bottom: 5px;\n}\n\n.apexcharts-xaxistooltip {\n  opacity: 0;\n  padding: 9px 10px;\n  pointer-events: none;\n  color: #373d3f;\n  font-size: 13px;\n  text-align: center;\n  border-radius: 2px;\n  position: absolute;\n  z-index: 10;\n  background: #ECEFF1;\n  border: 1px solid #90A4AE;\n  transition: 0.15s ease all;\n}\n\n.apexcharts-xaxistooltip.apexcharts-theme-dark {\n  background: rgba(0, 0, 0, 0.7);\n  border: 1px solid rgba(0, 0, 0, 0.5);\n  color: #fff;\n}\n\n.apexcharts-xaxistooltip:after,\n.apexcharts-xaxistooltip:before {\n  left: 50%;\n  border: solid transparent;\n  content: " ";\n  height: 0;\n  width: 0;\n  position: absolute;\n  pointer-events: none;\n}\n\n.apexcharts-xaxistooltip:after {\n  border-color: rgba(236, 239, 241, 0);\n  border-width: 6px;\n  margin-left: -6px;\n}\n\n.apexcharts-xaxistooltip:before {\n  border-color: rgba(144, 164, 174, 0);\n  border-width: 7px;\n  margin-left: -7px;\n}\n\n.apexcharts-xaxistooltip-bottom:after,\n.apexcharts-xaxistooltip-bottom:before {\n  bottom: 100%;\n}\n\n.apexcharts-xaxistooltip-top:after,\n.apexcharts-xaxistooltip-top:before {\n  top: 100%;\n}\n\n.apexcharts-xaxistooltip-bottom:after {\n  border-bottom-color: #ECEFF1;\n}\n\n.apexcharts-xaxistooltip-bottom:before {\n  border-bottom-color: #90A4AE;\n}\n\n.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {\n  border-bottom-color: rgba(0, 0, 0, 0.5);\n}\n\n.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {\n  border-bottom-color: rgba(0, 0, 0, 0.5);\n}\n\n.apexcharts-xaxistooltip-top:after {\n  border-top-color: #ECEFF1\n}\n\n.apexcharts-xaxistooltip-top:before {\n  border-top-color: #90A4AE;\n}\n\n.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {\n  border-top-color: rgba(0, 0, 0, 0.5);\n}\n\n.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {\n  border-top-color: rgba(0, 0, 0, 0.5);\n}\n\n.apexcharts-xaxistooltip.apexcharts-active {\n  opacity: 1;\n  transition: 0.15s ease all;\n}\n\n.apexcharts-yaxistooltip {\n  opacity: 0;\n  padding: 4px 10px;\n  pointer-events: none;\n  color: #373d3f;\n  font-size: 13px;\n  text-align: center;\n  border-radius: 2px;\n  position: absolute;\n  z-index: 10;\n  background: #ECEFF1;\n  border: 1px solid #90A4AE;\n}\n\n.apexcharts-yaxistooltip.apexcharts-theme-dark {\n  background: rgba(0, 0, 0, 0.7);\n  border: 1px solid rgba(0, 0, 0, 0.5);\n  color: #fff;\n}\n\n.apexcharts-yaxistooltip:after,\n.apexcharts-yaxistooltip:before {\n  top: 50%;\n  border: solid transparent;\n  content: " ";\n  height: 0;\n  width: 0;\n  position: absolute;\n  pointer-events: none;\n}\n\n.apexcharts-yaxistooltip:after {\n  border-color: rgba(236, 239, 241, 0);\n  border-width: 6px;\n  margin-top: -6px;\n}\n\n.apexcharts-yaxistooltip:before {\n  border-color: rgba(144, 164, 174, 0);\n  border-width: 7px;\n  margin-top: -7px;\n}\n\n.apexcharts-yaxistooltip-left:after,\n.apexcharts-yaxistooltip-left:before {\n  left: 100%;\n}\n\n.apexcharts-yaxistooltip-right:after,\n.apexcharts-yaxistooltip-right:before {\n  right: 100%;\n}\n\n.apexcharts-yaxistooltip-left:after {\n  border-left-color: #ECEFF1;\n}\n\n.apexcharts-yaxistooltip-left:before {\n  border-left-color: #90A4AE;\n}\n\n.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {\n  border-left-color: rgba(0, 0, 0, 0.5);\n}\n\n.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {\n  border-left-color: rgba(0, 0, 0, 0.5);\n}\n\n.apexcharts-yaxistooltip-right:after {\n  border-right-color: #ECEFF1;\n}\n\n.apexcharts-yaxistooltip-right:before {\n  border-right-color: #90A4AE;\n}\n\n.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {\n  border-right-color: rgba(0, 0, 0, 0.5);\n}\n\n.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {\n  border-right-color: rgba(0, 0, 0, 0.5);\n}\n\n.apexcharts-yaxistooltip.apexcharts-active {\n  opacity: 1;\n}\n\n.apexcharts-yaxistooltip-hidden {\n  display: none;\n}\n\n.apexcharts-xcrosshairs,\n.apexcharts-ycrosshairs {\n  pointer-events: none;\n  opacity: 0;\n  transition: 0.15s ease all;\n}\n\n.apexcharts-xcrosshairs.apexcharts-active,\n.apexcharts-ycrosshairs.apexcharts-active {\n  opacity: 1;\n  transition: 0.15s ease all;\n}\n\n.apexcharts-ycrosshairs-hidden {\n  opacity: 0;\n}\n\n.apexcharts-selection-rect {\n  cursor: move;\n}\n\n.svg_select_boundingRect, .svg_select_points_rot {\n  pointer-events: none;\n  opacity: 0;\n  visibility: hidden;\n}\n.apexcharts-selection-rect + g .svg_select_boundingRect,\n.apexcharts-selection-rect + g .svg_select_points_rot {\n  opacity: 0;\n  visibility: hidden;\n}\n\n.apexcharts-selection-rect + g .svg_select_points_l,\n.apexcharts-selection-rect + g .svg_select_points_r {\n  cursor: ew-resize;\n  opacity: 1;\n  visibility: visible;\n}\n\n.svg_select_points {\n  fill: #efefef;\n  stroke: #333;\n  rx: 2;\n}\n\n.apexcharts-svg.apexcharts-zoomable.hovering-zoom {\n  cursor: crosshair\n}\n\n.apexcharts-svg.apexcharts-zoomable.hovering-pan {\n  cursor: move\n}\n\n.apexcharts-zoom-icon,\n.apexcharts-zoomin-icon,\n.apexcharts-zoomout-icon,\n.apexcharts-reset-icon,\n.apexcharts-pan-icon,\n.apexcharts-selection-icon,\n.apexcharts-menu-icon,\n.apexcharts-toolbar-custom-icon {\n  cursor: pointer;\n  width: 20px;\n  height: 20px;\n  line-height: 24px;\n  color: #6E8192;\n  text-align: center;\n}\n\n.apexcharts-zoom-icon svg,\n.apexcharts-zoomin-icon svg,\n.apexcharts-zoomout-icon svg,\n.apexcharts-reset-icon svg,\n.apexcharts-menu-icon svg {\n  fill: #6E8192;\n}\n\n.apexcharts-selection-icon svg {\n  fill: #444;\n  transform: scale(0.76)\n}\n\n.apexcharts-theme-dark .apexcharts-zoom-icon svg,\n.apexcharts-theme-dark .apexcharts-zoomin-icon svg,\n.apexcharts-theme-dark .apexcharts-zoomout-icon svg,\n.apexcharts-theme-dark .apexcharts-reset-icon svg,\n.apexcharts-theme-dark .apexcharts-pan-icon svg,\n.apexcharts-theme-dark .apexcharts-selection-icon svg,\n.apexcharts-theme-dark .apexcharts-menu-icon svg,\n.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {\n  fill: #f3f4f5;\n}\n\n.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,\n.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,\n.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {\n  fill: #008FFB;\n}\n\n.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,\n.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,\n.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,\n.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,\n.apexcharts-theme-light .apexcharts-reset-icon:hover svg,\n.apexcharts-theme-light .apexcharts-menu-icon:hover svg {\n  fill: #333;\n}\n\n.apexcharts-selection-icon,\n.apexcharts-menu-icon {\n  position: relative;\n}\n\n.apexcharts-reset-icon {\n  margin-left: 5px;\n}\n\n.apexcharts-zoom-icon,\n.apexcharts-reset-icon,\n.apexcharts-menu-icon {\n  transform: scale(0.85);\n}\n\n.apexcharts-zoomin-icon,\n.apexcharts-zoomout-icon {\n  transform: scale(0.7)\n}\n\n.apexcharts-zoomout-icon {\n  margin-right: 3px;\n}\n\n.apexcharts-pan-icon {\n  transform: scale(0.62);\n  position: relative;\n  left: 1px;\n  top: 0px;\n}\n\n.apexcharts-pan-icon svg {\n  fill: #fff;\n  stroke: #6E8192;\n  stroke-width: 2;\n}\n\n.apexcharts-pan-icon.apexcharts-selected svg {\n  stroke: #008FFB;\n}\n\n.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {\n  stroke: #333;\n}\n\n.apexcharts-toolbar {\n  position: absolute;\n  z-index: 11;\n  max-width: 176px;\n  text-align: right;\n  border-radius: 3px;\n  padding: 0px 6px 2px 6px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.apexcharts-menu {\n  background: #fff;\n  position: absolute;\n  top: 100%;\n  border: 1px solid #ddd;\n  border-radius: 3px;\n  padding: 3px;\n  right: 10px;\n  opacity: 0;\n  min-width: 110px;\n  transition: 0.15s ease all;\n  pointer-events: none;\n}\n\n.apexcharts-menu.apexcharts-menu-open {\n  opacity: 1;\n  pointer-events: all;\n  transition: 0.15s ease all;\n}\n\n.apexcharts-menu-item {\n  padding: 6px 7px;\n  font-size: 12px;\n  cursor: pointer;\n}\n\n.apexcharts-theme-light .apexcharts-menu-item:hover {\n  background: #eee;\n}\n\n.apexcharts-theme-dark .apexcharts-menu {\n  background: rgba(0, 0, 0, 0.7);\n  color: #fff;\n}\n\n@media screen and (min-width: 768px) {\n  .apexcharts-canvas:hover .apexcharts-toolbar {\n    opacity: 1;\n  }\n}\n\n.apexcharts-datalabel.apexcharts-element-hidden {\n  opacity: 0;\n}\n\n.apexcharts-pie-label,\n.apexcharts-datalabels,\n.apexcharts-datalabel,\n.apexcharts-datalabel-label,\n.apexcharts-datalabel-value {\n  cursor: default;\n  pointer-events: none;\n}\n\n.apexcharts-pie-label-delay {\n  opacity: 0;\n  animation-name: opaque;\n  animation-duration: 0.3s;\n  animation-fill-mode: forwards;\n  animation-timing-function: ease;\n}\n\n.apexcharts-canvas .apexcharts-element-hidden {\n  opacity: 0;\n}\n\n.apexcharts-hide .apexcharts-series-points {\n  opacity: 0;\n}\n\n.apexcharts-gridline,\n.apexcharts-annotation-rect,\n.apexcharts-tooltip .apexcharts-marker,\n.apexcharts-area-series .apexcharts-area,\n.apexcharts-line,\n.apexcharts-zoom-rect,\n.apexcharts-toolbar svg,\n.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,\n.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,\n.apexcharts-radar-series path,\n.apexcharts-radar-series polygon {\n  pointer-events: none;\n}\n\n\n/* markers */\n\n.apexcharts-marker {\n  transition: 0.15s ease all;\n}\n\n@keyframes opaque {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n\n/* Resize generated styles */\n\n@keyframes resizeanim {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 0;\n  }\n}\n\n.resize-triggers {\n  animation: 1ms resizeanim;\n  visibility: hidden;\n  opacity: 0;\n}\n\n.resize-triggers,\n.resize-triggers>div,\n.contract-trigger:before {\n  content: " ";\n  display: block;\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n}\n\n.resize-triggers>div {\n  background: #eee;\n  overflow: auto;\n}\n\n.contract-trigger:before {\n  width: 200%;\n  height: 200%;\n}',D?_.prepend(o.css):C.head.appendChild(o.css))}var P=o.create(o.w.config.series,{});if(!P)return a(o);o.mount(P).then(function(){"function"==typeof o.w.config.chart.events.mounted&&o.w.config.chart.events.mounted(o,o.w),o.events.fireEvent("mounted",[o,o.w]),a(P)}).catch(function(q){d(q)})}else d(new Error("Element not found"));var L,B,V,$})}},{key:"create",value:function(o,a){var d=this.w;new Oe(this).initModules();var g=this.w.globals;if(g.noData=!1,g.animationEnded=!1,this.responsive.checkResponsiveConfig(a),d.config.xaxis.convertedCatToNumeric&&new ni(d.config).convertCatToNumericXaxis(d.config,this.ctx),null===this.el||(this.core.setupElements(),"treemap"===d.config.chart.type&&(d.config.grid.show=!1,d.config.yaxis[0].show=!1),0===g.svgWidth))return g.animationEnded=!0,null;var _=fi.checkComboSeries(o);g.comboCharts=_.comboCharts,g.comboBarCount=_.comboBarCount;var D=o.every(function(B){return B.data&&0===B.data.length});(0===o.length||D)&&this.series.handleNoData(),this.events.setupEventHandlers(),this.data.parseData(o),this.theme.init(),new uo(this).setGlobalMarkerSize(),this.formatters.setLabelFormatters(),this.titleSubtitle.draw(),g.noData&&g.collapsedSeries.length!==g.series.length&&!d.config.legend.showForSingleSeries||this.legend.init(),this.series.hasAllSeriesEqualX(),g.axisCharts&&(this.core.coreCalculations(),"category"!==d.config.xaxis.type&&this.formatters.setLabelFormatters(),this.ctx.toolbar.minX=d.globals.minX,this.ctx.toolbar.maxX=d.globals.maxX),this.formatters.heatmapLabelFormatters(),this.dimensions.plotCoords();var C=this.core.xySettings();this.grid.createGridMask();var T=this.core.plotChartType(o,C),P=new ls(this);return P.bringForward(),d.config.dataLabels.background.enabled&&P.dataLabelsBackground(),this.core.shiftGraphPosition(),{elGraph:T,xyRatios:C,elInner:d.globals.dom.elGraphical,dimensions:{plot:{left:d.globals.translateX,top:d.globals.translateY,width:d.globals.gridWidth,height:d.globals.gridHeight}}}}},{key:"mount",value:function(){var o=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,d=this,g=d.w;return new Promise(function(_,D){if(null===d.el)return D(new Error("Not enough data to display or target element not found"));(null===a||g.globals.allSeriesCollapsed)&&d.series.handleNoData(),"treemap"!==g.config.chart.type&&d.axes.drawAxis(g.config.chart.type,a.xyRatios),d.grid=new cs(d);var C=d.grid.drawGrid();d.annotations=new as(d),d.annotations.drawImageAnnos(),d.annotations.drawTextAnnos(),"back"===g.config.grid.position&&C&&g.globals.dom.elGraphical.add(C.el);var T=new po(o.ctx),P=new fo(o.ctx);if(null!==C&&(T.xAxisLabelCorrections(C.xAxisTickWidth),P.setYAxisTextAlignments(),g.config.yaxis.map(function(V,$){-1===g.globals.ignoreYAxisIndexes.indexOf($)&&P.yAxisTitleRotate($,V.opposite)})),"back"===g.config.annotations.position&&(g.globals.dom.Paper.add(g.globals.dom.elAnnotations),d.annotations.drawAxesAnnotations()),Array.isArray(a.elGraph))for(var L=0;L<a.elGraph.length;L++)g.globals.dom.elGraphical.add(a.elGraph[L]);else g.globals.dom.elGraphical.add(a.elGraph);if("front"===g.config.grid.position&&C&&g.globals.dom.elGraphical.add(C.el),"front"===g.config.xaxis.crosshairs.position&&d.crosshairs.drawXCrosshairs(),"front"===g.config.yaxis[0].crosshairs.position&&d.crosshairs.drawYCrosshairs(),"front"===g.config.annotations.position&&(g.globals.dom.Paper.add(g.globals.dom.elAnnotations),d.annotations.drawAxesAnnotations()),!g.globals.noData){if(g.config.tooltip.enabled&&!g.globals.noData&&d.w.globals.tooltip.drawTooltip(a.xyRatios),g.globals.axisCharts&&(g.globals.isXNumeric||g.config.xaxis.convertedCatToNumeric||g.globals.isRangeBar))(g.config.chart.zoom.enabled||g.config.chart.selection&&g.config.chart.selection.enabled||g.config.chart.pan&&g.config.chart.pan.enabled)&&d.zoomPanSelection.init({xyRatios:a.xyRatios});else{var B=g.config.chart.toolbar.tools;["zoom","zoomin","zoomout","selection","pan","reset"].forEach(function(V){B[V]=!1})}g.config.chart.toolbar.show&&!g.globals.allSeriesCollapsed&&d.toolbar.createToolbar()}g.globals.memory.methodsToExec.length>0&&g.globals.memory.methodsToExec.forEach(function(V){V.method(V.params,!1,V.context)}),g.globals.axisCharts||g.globals.noData||d.core.resizeNonAxisCharts(),_(d)})}},{key:"destroy",value:function(){var o,a;window.removeEventListener("resize",this.windowResizeHandler),(a=at.get(o=this.parentResizeHandler))&&(a.disconnect(),at.delete(o));var d=this.w.config.chart.id;d&&Apex._chartInstances.forEach(function(g,_){g.id===Xe.escapeString(d)&&Apex._chartInstances.splice(_,1)}),new We(this.ctx).clear({isUpdating:!1})}},{key:"updateOptions",value:function(o){var a=this,d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],g=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],_=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],D=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],C=this.w;return C.globals.selection=void 0,o.series&&(this.series.resetSeries(!1,!0,!1),o.series.length&&o.series[0].data&&(o.series=o.series.map(function(T,P){return a.updateHelpers._extendSeries(T,P)})),this.updateHelpers.revertDefaultAxisMinMax()),o.xaxis&&(o=this.updateHelpers.forceXAxisUpdate(o)),o.yaxis&&(o=this.updateHelpers.forceYAxisUpdate(o)),C.globals.collapsedSeriesIndices.length>0&&this.series.clearPreviousPaths(),o.theme&&(o=this.theme.updateThemeOptions(o)),this.updateHelpers._updateOptions(o,d,g,_,D)}},{key:"updateSeries",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],d=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.series.resetSeries(!1),this.updateHelpers.revertDefaultAxisMinMax(),this.updateHelpers._updateSeries(o,a,d)}},{key:"appendSeries",value:function(o){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],d=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],g=this.w.config.series.slice();return g.push(o),this.series.resetSeries(!1),this.updateHelpers.revertDefaultAxisMinMax(),this.updateHelpers._updateSeries(g,a,d)}},{key:"appendData",value:function(o){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],d=this;d.w.globals.dataChanged=!0,d.series.getPreviousPaths();for(var g=d.w.config.series.slice(),_=0;_<g.length;_++)if(null!=o[_])for(var D=0;D<o[_].data.length;D++)g[_].data.push(o[_].data[D]);return d.w.config.series=g,a&&(d.w.globals.initialSeries=Xe.clone(d.w.config.series)),this.update()}},{key:"update",value:function(o){var a=this;return new Promise(function(d,g){new We(a.ctx).clear({isUpdating:!0});var _=a.create(a.w.config.series,o);if(!_)return d(a);a.mount(_).then(function(){"function"==typeof a.w.config.chart.events.updated&&a.w.config.chart.events.updated(a,a.w),a.events.fireEvent("updated",[a,a.w]),a.w.globals.isDirty=!0,d(a)}).catch(function(D){g(D)})})}},{key:"getSyncedCharts",value:function(){var o=this.getGroupedCharts(),a=[this];return o.length&&(a=[],o.forEach(function(d){a.push(d)})),a}},{key:"getGroupedCharts",value:function(){var o=this;return Apex._chartInstances.filter(function(a){if(a.group)return!0}).map(function(a){return o.w.config.chart.group===a.group?a.chart:o})}},{key:"toggleSeries",value:function(o){return this.series.toggleSeries(o)}},{key:"highlightSeriesOnLegendHover",value:function(o,a){return this.series.toggleSeriesOnHover(o,a)}},{key:"showSeries",value:function(o){this.series.showSeries(o)}},{key:"hideSeries",value:function(o){this.series.hideSeries(o)}},{key:"resetSeries",value:function(){var o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.series.resetSeries(o,a)}},{key:"addEventListener",value:function(o,a){this.events.addEventListener(o,a)}},{key:"removeEventListener",value:function(o,a){this.events.removeEventListener(o,a)}},{key:"addXaxisAnnotation",value:function(o){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,g=this;d&&(g=d),g.annotations.addXaxisAnnotationExternal(o,a,g)}},{key:"addYaxisAnnotation",value:function(o){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,g=this;d&&(g=d),g.annotations.addYaxisAnnotationExternal(o,a,g)}},{key:"addPointAnnotation",value:function(o){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,g=this;d&&(g=d),g.annotations.addPointAnnotationExternal(o,a,g)}},{key:"clearAnnotations",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,a=this;o&&(a=o),a.annotations.clearAnnotations(a)}},{key:"removeAnnotation",value:function(o){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,d=this;a&&(d=a),d.annotations.removeAnnotation(d,o)}},{key:"getChartArea",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-inner")}},{key:"getSeriesTotalXRange",value:function(o,a){return this.coreUtils.getSeriesTotalsXRange(o,a)}},{key:"getHighestValueInSeries",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=new xn(this.ctx);return a.getMinYMaxY(o).highestY}},{key:"getLowestValueInSeries",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=new xn(this.ctx);return a.getMinYMaxY(o).lowestY}},{key:"getSeriesTotal",value:function(){return this.w.globals.seriesTotals}},{key:"toggleDataPointSelection",value:function(o,a){return this.updateHelpers.toggleDataPointSelection(o,a)}},{key:"zoomX",value:function(o,a){this.ctx.toolbar.zoomUpdateOptions(o,a)}},{key:"setLocale",value:function(o){this.localization.setCurrentLocaleValues(o)}},{key:"dataURI",value:function(o){return new Va(this.ctx).dataURI(o)}},{key:"paper",value:function(){return this.w.globals.dom.Paper}},{key:"_parentResizeCallback",value:function(){this.w.globals.animationEnded&&this.w.config.chart.redrawOnParentResize&&this._windowResize()}},{key:"_windowResize",value:function(){var o=this;clearTimeout(this.w.globals.resizeTimer),this.w.globals.resizeTimer=window.setTimeout(function(){o.w.globals.resized=!0,o.w.globals.dataChanged=!1,o.ctx.update()},150)}},{key:"_windowResizeHandler",value:function(){var o=this.w.config.chart.redrawOnWindowResize;"function"==typeof o&&(o=o()),o&&this._windowResize()}}],[{key:"getChartByID",value:function(o){var a=Xe.escapeString(o),d=Apex._chartInstances.filter(function(g){return g.id===a})[0];return d&&d.chart}},{key:"initOnLoad",value:function(){for(var o=document.querySelectorAll("[data-apexcharts]"),a=0;a<o.length;a++)new te(o[a],JSON.parse(o[a].getAttribute("data-options"))).render()}},{key:"exec",value:function(o,a){var d=this.getChartByID(o);if(d){d.w.globals.isExecCalled=!0;var g=null;if(-1!==d.publicMethods.indexOf(a)){for(var _=arguments.length,D=new Array(_>2?_-2:0),C=2;C<_;C++)D[C-2]=arguments[C];g=d[a].apply(d,D)}return g}}},{key:"merge",value:function(o,a){return Xe.extend(o,a)}}]),te}();os.exports=Tt},887:function(os){os.exports=function(){"use strict";var tr,gr,Vn;function nr(v,St){if(tr)if(gr){var Cs="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+tr+")(sharedChunk); ("+gr+")(sharedChunk); self.onerror = null;",Nr={};tr(Nr),Vn=St(Nr),"undefined"!=typeof window&&(Vn.workerUrl=window.URL.createObjectURL(new Blob([Cs],{type:"text/javascript"})))}else gr=St;else tr=St}return nr(0,function(v){var Cs=Nr;function Nr(c,r,u,p){this.cx=3*c,this.bx=3*(u-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(p-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=p,this.p2x=u,this.p2y=p}Nr.prototype.sampleCurveX=function(c){return((this.ax*c+this.bx)*c+this.cx)*c},Nr.prototype.sampleCurveY=function(c){return((this.ay*c+this.by)*c+this.cy)*c},Nr.prototype.sampleCurveDerivativeX=function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},Nr.prototype.solveCurveX=function(c,r){var u,p,y,b,E;for(void 0===r&&(r=1e-6),y=c,E=0;E<8;E++){if(b=this.sampleCurveX(y)-c,Math.abs(b)<r)return y;var k=this.sampleCurveDerivativeX(y);if(Math.abs(k)<1e-6)break;y-=b/k}if((y=c)<(u=0))return u;if(y>(p=1))return p;for(;u<p;){if(b=this.sampleCurveX(y),Math.abs(b-c)<r)return y;c>b?u=y:p=y,y=.5*(p-u)+u}return y},Nr.prototype.solve=function(c,r){return this.sampleCurveY(this.solveCurveX(c,r))};var Je=ht;function ht(c,r){this.x=c,this.y=r}ht.prototype={clone:function(){return new ht(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,r){return this.clone()._rotateAround(c,r)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var r=c.x-this.x,u=c.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,r){return Math.atan2(this.x*r-this.y*c,this.x*c+this.y*r)},_matMult:function(c){var r=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=r,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var r=Math.cos(c),u=Math.sin(c),p=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=p,this},_rotateAround:function(c,r){var u=Math.cos(c),p=Math.sin(c),y=r.y+p*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-p*(this.y-r.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ht.convert=function(c){return c instanceof ht?c:Array.isArray(c)?new ht(c[0],c[1]):c};var $t="undefined"!=typeof self?self:{};const Ss=Math.pow(2,53)-1,Ds=Math.PI/180,co=180/Math.PI;function wn(c){return c*Ds}function Cr(c){return c*co}const Xe=[[0,0],[1,0],[1,1],[0,1]];function mr(c){if(c<=0)return 0;if(c>=1)return 1;const r=c*c,u=r*c;return 4*(c<.5?u:3*(c-r)+u-.75)}function pi(c,r,u,p){const y=new Cs(c,r,u,p);return function(b){return y.solve(b)}}const yt=pi(.25,.1,.25,1);function On(c,r,u){return Math.min(u,Math.max(r,c))}function Ro(c,r,u){const p=u-r,y=((c-r)%p+p)%p+r;return y===r?u:y}function fi(c,r,u){if(!c.length)return u(null,[]);let p=c.length;const y=new Array(c.length);let b=null;c.forEach((E,k)=>{r(E,(N,z)=>{N&&(b=N),y[k]=z,0==--p&&u(b,y)})})}function va(c){const r=[];for(const u in c)r.push(c[u]);return r}function Mi(c,...r){for(const u of r)for(const p in u)c[p]=u[p];return c}let cc=1;function Fr(){return cc++}function as(){return function c(r){return r?(r^16*Math.random()>>r/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function Xr(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function uo(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function Cn(c,r){c.forEach(u=>{r[u]&&(r[u]=r[u].bind(r))})}function ls(c,r){return-1!==c.indexOf(r,c.length-r.length)}function No(c,r,u){const p={};for(const y in c)p[y]=r.call(u||this,c[y],y,c);return p}function Bi(c,r,u){const p={};for(const y in c)r.call(u||this,c[y],y,c)&&(p[y]=c[y]);return p}function ir(c){return Array.isArray(c)?c.map(ir):"object"==typeof c&&c?No(c,ir):c}const Dn={};function mn(c){Dn[c]||("undefined"!=typeof console&&console.warn(c),Dn[c]=!0)}function Or(c,r,u){return(u.y-c.y)*(r.x-c.x)>(r.y-c.y)*(u.x-c.x)}function ni(c){let r=0;for(let u,p,y=0,b=c.length,E=b-1;y<b;E=y++)u=c[y],p=c[E],r+=(p.x-u.x)*(u.y+p.y);return r}function vn(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Kt(c){const r={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,p,y,b)=>{const E=y||b;return r[p]=!E||E.toLowerCase(),""}),r["max-age"]){const u=parseInt(r["max-age"],10);isNaN(u)?delete r["max-age"]:r["max-age"]=u}return r}let ua,Tn,ho,Us=null;function Va(c){if(null==Us){const r=c.navigator?c.navigator.userAgent:null;Us=!!c.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return Us}function po(c){try{const r=$t[c];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch(r){return!1}}const cs={now:()=>void 0!==ho?ho:$t.performance.now(),setNow(c){ho=c},restoreNow(){ho=void 0},frame(c){const r=$t.requestAnimationFrame(c);return{cancel:()=>$t.cancelAnimationFrame(r)}},getImageData(c,r=0){const u=$t.document.createElement("canvas"),p=u.getContext("2d");if(!p)throw new Error("failed to create canvas 2d context");return u.width=c.width,u.height=c.height,p.drawImage(c,0,0,c.width,c.height),p.getImageData(-r,-r,c.width+2*r,c.height+2*r)},resolveURL:c=>(ua||(ua=$t.document.createElement("a")),ua.href=c,ua.href),get devicePixelRatio(){return $t.devicePixelRatio},get prefersReducedMotion(){return!!$t.matchMedia&&(null==Tn&&(Tn=$t.matchMedia("(prefers-reduced-motion: reduce)")),Tn.matches)}};let Hs;const xn={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Hs){const c=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Hs=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):c}catch(r){Hs=c}}return Hs},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},fo={supported:!1,testSupport:function(c){!hl&&js&&(Fo?dl(c):xa=c)}};let xa,js,hl=!1,Fo=!1;function dl(c){const r=c.createTexture();c.bindTexture(c.TEXTURE_2D,r);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,js),c.isContextLost())return;fo.supported=!0}catch(u){}c.deleteTexture(r),hl=!0}$t.document&&(js=$t.document.createElement("img"),js.onload=function(){xa&&dl(xa),xa=null,Fo=!0},js.onerror=function(){hl=!0,xa=null},js.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const pl="01",Es="NO_ACCESS_TOKEN";function As(c){return 0===c.indexOf("mapbox:")}function ba(c){return xn.API_URL_REGEX.test(c)}const uc=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function $s(c){const r=c.match(uc);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function rr(c){const r=c.params.length?`?${c.params.join("&")}`:"";return`${c.protocol}://${c.authority}${c.path}${r}`}function tu(c){if(!c)return null;const r=c.split(".");if(!r||3!==r.length)return null;try{return JSON.parse(decodeURIComponent($t.atob(r[1]).split("").map(u=>"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(u){return null}}class Ua{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const u=tu(xn.ACCESS_TOKEN);let p="";return p=u&&u.u?$t.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,(y,b)=>String.fromCharCode(Number("0x"+b)))):xn.ACCESS_TOKEN||"",r?`mapbox.eventData.${r}:${p}`:`mapbox.eventData:${p}`}fetchEventData(){const r=po("localStorage"),u=this.getStorageKey(),p=this.getStorageKey("uuid");if(r)try{const y=$t.localStorage.getItem(u);y&&(this.eventData=JSON.parse(y));const b=$t.localStorage.getItem(p);b&&(this.anonId=b)}catch(y){mn("Unable to read from LocalStorage")}}saveEventData(){const r=po("localStorage"),u=this.getStorageKey(),p=this.getStorageKey("uuid");if(r)try{$t.localStorage.setItem(p,this.anonId),Object.keys(this.eventData).length>=1&&$t.localStorage.setItem(u,JSON.stringify(this.eventData))}catch(y){mn("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,u,p,y){if(!xn.EVENTS_URL)return;const b=$s(xn.EVENTS_URL);b.params.push(`access_token=${y||xn.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(r).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"2.6.1",skuId:pl,userId:this.anonId},k=u?Mi(E,u):E,N={url:rr(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([k])};this.pendingRequest=xe(N,z=>{this.pendingRequest=null,p(z),this.saveEventData(),this.processRequests(y)})}queueRequest(r,u){this.queue.push(r),this.processRequests(u)}}const fl=new class extends Ua{constructor(c){super("appUserTurnstile"),this._customAccessToken=c}postTurnstileEvent(c,r){xn.EVENTS_URL&&xn.ACCESS_TOKEN&&Array.isArray(c)&&c.some(u=>As(u)||ba(u))&&this.queueRequest(Date.now(),r)}processRequests(c){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=tu(xn.ACCESS_TOKEN),u=r?r.u:xn.ACCESS_TOKEN;let p=u!==this.eventData.tokenU;uo(this.anonId)||(this.anonId=as(),p=!0);const y=this.queue.shift();if(this.eventData.lastSuccess){const b=new Date(this.eventData.lastSuccess),E=new Date(y),k=(y-this.eventData.lastSuccess)/864e5;p=p||k>=1||k<-1||b.getDate()!==E.getDate()}else p=!0;if(!p)return this.processRequests();this.postEvent(y,{"enabled.telemetry":!1},b=>{b||(this.eventData.lastSuccess=y,this.eventData.tokenU=u)},c)}},hc=fl.postTurnstileEvent.bind(fl),Oo=new class extends Ua{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(c,r,u,p){this.skuToken=r,this.errorCb=p,xn.EVENTS_URL&&(u||xn.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},u):this.errorCb(new Error(Es)))}processRequests(c){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:u}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),uo(this.anonId)||(this.anonId=as()),this.postEvent(u,{skuToken:this.skuToken},p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},c))}},dc=Oo.postMapLoadEvent.bind(Oo),Ha=new class extends Ua{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(c,r,u,p){if(!xn.API_URL||!xn.SESSION_PATH)return;const y=$s(xn.API_URL+xn.SESSION_PATH);y.params.push(`sku=${r||""}`),y.params.push(`access_token=${p||xn.ACCESS_TOKEN||""}`);const b={url:rr(y),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Ae(b,E=>{this.pendingRequest=null,u(E),this.saveEventData(),this.processRequests(p)})}getSessionAPI(c,r,u,p){this.skuToken=r,this.errorCb=p,xn.SESSION_PATH&&xn.API_URL&&(u||xn.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},u):this.errorCb(new Error(Es)))}processRequests(c){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:u}=this.queue.shift();r&&this.success[r]||this.getSession(u,this.skuToken,p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},c)}},gl=Ha.getSessionAPI.bind(Ha),Lo=new Set,ml="mapbox-tiles";let us,zo,wa=500,Bo=50;function Ei(){$t.caches&&!us&&(us=$t.caches.open(ml))}function Ca(c){const r=c.indexOf("?");return r<0?c:c.slice(0,r)}let ja=1/0;const Sa={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Sa);class Da extends Error{constructor(r,u,p){401===u&&ba(p)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(r),this.status=u,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const we=vn()?()=>self.worker&&self.worker.referrer:()=>("blob:"===$t.location.protocol?$t.parent:$t).location.href,se=function(c,r){if(!(/^file:/.test(u=c.url)||/^file:/.test(we())&&!/^\w+:/.test(u))){if($t.fetch&&$t.Request&&$t.AbortController&&$t.Request.prototype.hasOwnProperty("signal"))return function(p,y){const b=new $t.AbortController,E=new $t.Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:we(),signal:b.signal});let k=!1,N=!1;const z=(j=E.url).indexOf("sku=")>0&&ba(j);var j;"json"===p.type&&E.headers.set("Accept","application/json");const W=(ie,ce,pe)=>{if(N)return;if(ie&&"SecurityError"!==ie.message&&mn(ie),ce&&pe)return Y(ce);const Ce=Date.now();$t.fetch(E).then(Te=>{if(Te.ok){const Pe=z?Te.clone():null;return Y(Te,Pe,Ce)}return y(new Da(Te.statusText,Te.status,p.url))}).catch(Te=>{20!==Te.code&&y(new Error(Te.message))})},Y=(ie,ce,pe)=>{("arrayBuffer"===p.type?ie.arrayBuffer():"json"===p.type?ie.json():ie.text()).then(Ce=>{N||(ce&&pe&&function(Te,Pe,Be){if(Ei(),!us)return;const je={status:Pe.status,statusText:Pe.statusText,headers:new $t.Headers};Pe.headers.forEach((Ge,ot)=>je.headers.set(ot,Ge));const He=Kt(Pe.headers.get("Cache-Control")||"");He["no-store"]||(He["max-age"]&&je.headers.set("Expires",new Date(Be+1e3*He["max-age"]).toUTCString()),new Date(je.headers.get("Expires")).getTime()-Be<42e4||function(Ge,ot){if(void 0===zo)try{new Response(new ReadableStream),zo=!0}catch(nt){zo=!1}zo?ot(Ge.body):Ge.blob().then(ot)}(Pe,Ge=>{const ot=new $t.Response(Ge,je);Ei(),us&&us.then(nt=>nt.put(Ca(Te.url),ot)).catch(nt=>mn(nt.message))}))}(E,ce,pe),k=!0,y(null,Ce,ie.headers.get("Cache-Control"),ie.headers.get("Expires")))}).catch(Ce=>{N||y(new Error(Ce.message))})};return z?function(ie,ce){if(Ei(),!us)return ce(null);const pe=Ca(ie.url);us.then(Ce=>{Ce.match(pe).then(Te=>{const Pe=function(Be){if(!Be)return!1;const je=new Date(Be.headers.get("Expires")||0),He=Kt(Be.headers.get("Cache-Control")||"");return je>Date.now()&&!He["no-cache"]}(Te);Ce.delete(pe),Pe&&Ce.put(pe,Te.clone()),ce(null,Te,Pe)}).catch(ce)}).catch(ce)}(E,W):W(null,null),{cancel:()=>{N=!0,k||b.abort()}}}(c,r);if(vn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,r,void 0,!0)}var u;return function(p,y){const b=new $t.XMLHttpRequest;b.open(p.method||"GET",p.url,!0),"arrayBuffer"===p.type&&(b.responseType="arraybuffer");for(const E in p.headers)b.setRequestHeader(E,p.headers[E]);return"json"===p.type&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials="include"===p.credentials,b.onerror=()=>{y(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||0===b.status)&&null!==b.response){let E=b.response;if("json"===p.type)try{E=JSON.parse(b.response)}catch(k){return y(k)}y(null,E,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else y(new Da(b.statusText,b.status,p.url))},b.send(p.body),{cancel:()=>b.abort()}}(c,r)},ue=function(c,r){return se(Mi(c,{type:"arrayBuffer"}),r)},xe=function(c,r){return se(Mi(c,{method:"POST"}),r)},Ae=function(c,r){return se(Mi(c,{method:"GET"}),r)};function Ie(c){const r=$t.document.createElement("a");return r.href=c,r.protocol===$t.document.location.protocol&&r.host===$t.document.location.host}const $e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ue,Oe;Ue=[],Oe=0;const We=function(c,r){if(fo.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),Oe>=xn.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:c,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return Ue.push(b),b}Oe++;let u=!1;const p=()=>{if(!u)for(u=!0,Oe--;Ue.length&&Oe<xn.MAX_PARALLEL_IMAGE_REQUESTS;){const b=Ue.shift(),{requestParameters:E,callback:k,cancelled:N}=b;N||(b.cancel=We(E,k).cancel)}},y=ue(c,(b,E,k,N)=>{p(),b?r(b):E&&($t.createImageBitmap?function(z,j){const W=new $t.Blob([new Uint8Array(z)],{type:"image/png"});$t.createImageBitmap(W).then(Y=>{j(null,Y)}).catch(Y=>{j(new Error(`Could not load image because of ${Y.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(E,(z,j)=>r(z,j,k,N)):function(z,j){const W=new $t.Image,Y=$t.URL;W.onload=()=>{j(null,W),Y.revokeObjectURL(W.src),W.onload=null,$t.requestAnimationFrame(()=>{W.src=$e})},W.onerror=()=>j(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const ie=new $t.Blob([new Uint8Array(z)],{type:"image/png"});W.src=z.byteLength?Y.createObjectURL(ie):$e}(E,(z,j)=>r(z,j,k,N)))});return{cancel:()=>{y.cancel(),p()}}};function at(c,r,u){u[c]&&-1!==u[c].indexOf(r)||(u[c]=u[c]||[],u[c].push(r))}function Tt(c,r,u){if(u&&u[c]){const p=u[c].indexOf(r);-1!==p&&u[c].splice(p,1)}}class te{constructor(r,u={}){Mi(this,u),this.type=r}}class o extends te{constructor(r,u={}){super("error",Mi({error:r},u))}}class a{on(r,u){return this._listeners=this._listeners||{},at(r,u,this._listeners),this}off(r,u){return Tt(r,u,this._listeners),Tt(r,u,this._oneTimeListeners),this}once(r,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},at(r,u,this._oneTimeListeners),this):new Promise(p=>this.once(r,p))}fire(r,u){"string"==typeof r&&(r=new te(r,u||{}));const p=r.type;if(this.listens(p)){r.target=this;const y=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const k of y)k.call(this,r);const b=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const k of b)Tt(p,k,this._oneTimeListeners),k.call(this,r);const E=this._eventedParent;E&&(Mi(r,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),E.fire(r))}else r instanceof o&&console.error(r.error);return this}listens(r){return!!(this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r))}setEventedParent(r,u){return this._eventedParent=r,this._eventedParentData=u,this}}var d=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class g{constructor(r,u,p,y){this.message=(r?`${r}: `:"")+p,y&&(this.identifier=y),null!=u&&u.__line__&&(this.line=u.__line__)}}function _(c){const r=c.value;return r?[new g(c.key,r,"constants have been deprecated as of v8")]:[]}function D(c,...r){for(const u of r)for(const p in u)c[p]=u[p];return c}function C(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function T(c){if(Array.isArray(c))return c.map(T);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const r={};for(const u in c)r[u]=T(c[u]);return r}return C(c)}class P extends Error{constructor(r,u){super(u),this.message=u,this.key=r}}class L{constructor(r,u=[]){this.parent=r,this.bindings={};for(const[p,y]of u)this.bindings[p]=y}concat(r){return new L(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const B={kind:"null"},V={kind:"number"},$={kind:"string"},q={kind:"boolean"},K={kind:"color"},oe={kind:"object"},ae={kind:"value"},fe={kind:"collator"},ge={kind:"formatted"},R={kind:"resolvedImage"};function H(c,r){return{kind:"array",itemType:c,N:r}}function Q(c){if("array"===c.kind){const r=Q(c.itemType);return"number"==typeof c.N?`array<${r}, ${c.N}>`:"value"===c.itemType.kind?"array":`array<${r}>`}return c.kind}const le=[B,V,$,q,K,ge,oe,H(ae),R];function Re(c,r){if("error"===r.kind)return null;if("array"===c.kind){if("array"===r.kind&&(0===r.N&&"value"===r.itemType.kind||!Re(c.itemType,r.itemType))&&("number"!=typeof c.N||c.N===r.N))return null}else{if(c.kind===r.kind)return null;if("value"===c.kind)for(const u of le)if(!Re(u,r))return null}return`Expected ${Q(c)} but found ${Q(r)} instead.`}function tt(c,r){return r.some(u=>u.kind===c.kind)}function Ve(c,r){return r.some(u=>"null"===u?null===c:"array"===u?Array.isArray(c):"object"===u?c&&!Array.isArray(c)&&"object"==typeof c:u===typeof c)}function Dt(c){var r={exports:{}};return c(r,r.exports),r.exports}var pt=Dt(function(c,r){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function p(k){return(k=Math.round(k))<0?0:k>255?255:k}function y(k){return p("%"===k[k.length-1]?parseFloat(k)/100*255:parseInt(k))}function b(k){return(N="%"===k[k.length-1]?parseFloat(k)/100:parseFloat(k))<0?0:N>1?1:N;var N}function E(k,N,z){return z<0?z+=1:z>1&&(z-=1),6*z<1?k+(N-k)*z*6:2*z<1?N:3*z<2?k+(N-k)*(2/3-z)*6:k}try{r.parseCSSColor=function(k){var N,z=k.replace(/ /g,"").toLowerCase();if(z in u)return u[z].slice();if("#"===z[0])return 4===z.length?(N=parseInt(z.substr(1),16))>=0&&N<=4095?[(3840&N)>>4|(3840&N)>>8,240&N|(240&N)>>4,15&N|(15&N)<<4,1]:null:7===z.length&&(N=parseInt(z.substr(1),16))>=0&&N<=16777215?[(16711680&N)>>16,(65280&N)>>8,255&N,1]:null;var j=z.indexOf("("),W=z.indexOf(")");if(-1!==j&&W+1===z.length){var Y=z.substr(0,j),ie=z.substr(j+1,W-(j+1)).split(","),ce=1;switch(Y){case"rgba":if(4!==ie.length)return null;ce=b(ie.pop());case"rgb":return 3!==ie.length?null:[y(ie[0]),y(ie[1]),y(ie[2]),ce];case"hsla":if(4!==ie.length)return null;ce=b(ie.pop());case"hsl":if(3!==ie.length)return null;var pe=(parseFloat(ie[0])%360+360)%360/360,Ce=b(ie[1]),Te=b(ie[2]),Pe=Te<=.5?Te*(Ce+1):Te+Ce-Te*Ce,Be=2*Te-Pe;return[p(255*E(Be,Pe,pe+1/3)),p(255*E(Be,Pe,pe)),p(255*E(Be,Pe,pe-1/3)),ce];default:return null}}return null}}catch(k){}});class qe{constructor(r,u,p,y=1){this.r=r,this.g=u,this.b=p,this.a=y}static parse(r){if(!r)return;if(r instanceof qe)return r;if("string"!=typeof r)return;const u=pt.parseCSSColor(r);return u?new qe(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toString(){const[r,u,p,y]=this.toArray();return`rgba(${Math.round(r)},${Math.round(u)},${Math.round(p)},${y})`}toArray(){const{r,g:u,b:p,a:y}=this;return 0===y?[0,0,0,0]:[255*r/y,255*u/y,255*p/y,y]}}qe.black=new qe(0,0,0,1),qe.white=new qe(1,1,1,1),qe.transparent=new qe(0,0,0,0),qe.red=new qe(1,0,0,1),qe.blue=new qe(0,0,1,1);class Vt{constructor(r,u,p){this.sensitivity=r?u?"variant":"case":u?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,u){return this.collator.compare(r,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Yn{constructor(r,u,p,y,b){this.text=r,this.image=u,this.scale=p,this.fontStack=y,this.textColor=b}}class pn{constructor(r){this.sections=r}static fromString(r){return new pn([new Yn(r,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(r=>0!==r.text.length||r.image&&0!==r.image.name.length)}static factory(r){return r instanceof pn?r:pn.fromString(r)}toString(){return 0===this.sections.length?"":this.sections.map(r=>r.text).join("")}serialize(){const r=["format"];for(const u of this.sections){if(u.image){r.push(["image",u.image.name]);continue}r.push(u.text);const p={};u.fontStack&&(p["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(p["font-scale"]=u.scale),u.textColor&&(p["text-color"]=["rgba"].concat(u.textColor.toArray())),r.push(p)}return r}}class xi{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new xi({name:r,available:!1}):null}serialize(){return["image",this.name]}}function sr(c,r,u,p){return"number"==typeof c&&c>=0&&c<=255&&"number"==typeof r&&r>=0&&r<=255&&"number"==typeof u&&u>=0&&u<=255?void 0===p||"number"==typeof p&&p>=0&&p<=1?null:`Invalid rgba value [${[c,r,u,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof p?[c,r,u,p]:[c,r,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ki(c){if(null===c||"string"==typeof c||"boolean"==typeof c||"number"==typeof c||c instanceof qe||c instanceof Vt||c instanceof pn||c instanceof xi)return!0;if(Array.isArray(c)){for(const r of c)if(!ki(r))return!1;return!0}if("object"==typeof c){for(const r in c)if(!ki(c[r]))return!1;return!0}return!1}function bi(c){if(null===c)return B;if("string"==typeof c)return $;if("boolean"==typeof c)return q;if("number"==typeof c)return V;if(c instanceof qe)return K;if(c instanceof Vt)return fe;if(c instanceof pn)return ge;if(c instanceof xi)return R;if(Array.isArray(c)){const r=c.length;let u;for(const p of c){const y=bi(p);if(u){if(u===y)continue;u=ae;break}u=y}return H(u||ae,r)}return oe}function Gs(c){const r=typeof c;return null===c?"":"string"===r||"number"===r||"boolean"===r?String(c):c instanceof qe||c instanceof pn||c instanceof xi?c.toString():JSON.stringify(c)}class $a{constructor(r,u){this.type=r,this.value=u}static parse(r,u){if(2!==r.length)return u.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!ki(r[1]))return u.error("invalid value");const p=r[1];let y=bi(p);const b=u.expectedType;return"array"!==y.kind||0!==y.N||!b||"array"!==b.kind||"number"==typeof b.N&&0!==b.N||(y=b),new $a(y,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof qe?["rgba"].concat(this.value.toArray()):this.value instanceof pn?this.value.serialize():this.value}}class Zn{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const pc={string:$,number:V,boolean:q,object:oe};class Ts{constructor(r,u){this.type=r,this.args=u}static parse(r,u){if(r.length<2)return u.error("Expected at least one argument.");let p,y=1;const b=r[0];if("array"===b){let k,N;if(r.length>2){const z=r[1];if("string"!=typeof z||!(z in pc)||"object"===z)return u.error('The item type argument of "array" must be one of string, number, boolean',1);k=pc[z],y++}else k=ae;if(r.length>3){if(null!==r[2]&&("number"!=typeof r[2]||r[2]<0||r[2]!==Math.floor(r[2])))return u.error('The length argument to "array" must be a positive integer literal',2);N=r[2],y++}p=H(k,N)}else p=pc[b];const E=[];for(;y<r.length;y++){const k=u.parse(r[y],y,ae);if(!k)return null;E.push(k)}return new Ts(p,E)}evaluate(r){for(let u=0;u<this.args.length;u++){const p=this.args[u].evaluate(r);if(!Re(this.type,bi(p)))return p;if(u===this.args.length-1)throw new Zn(`Expected value to be of type ${Q(this.type)}, but found ${Q(bi(p))} instead.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=this.type,u=[r.kind];if("array"===r.kind){const p=r.itemType;if("string"===p.kind||"number"===p.kind||"boolean"===p.kind){u.push(p.kind);const y=r.N;("number"==typeof y||this.args.length>1)&&u.push(y)}}return u.concat(this.args.map(p=>p.serialize()))}}class yr{constructor(r){this.type=ge,this.sections=r}static parse(r,u){if(r.length<2)return u.error("Expected at least one argument.");const p=r[1];if(!Array.isArray(p)&&"object"==typeof p)return u.error("First argument must be an image or text section.");const y=[];let b=!1;for(let E=1;E<=r.length-1;++E){const k=r[E];if(b&&"object"==typeof k&&!Array.isArray(k)){b=!1;let N=null;if(k["font-scale"]&&(N=u.parse(k["font-scale"],1,V),!N))return null;let z=null;if(k["text-font"]&&(z=u.parse(k["text-font"],1,H($)),!z))return null;let j=null;if(k["text-color"]&&(j=u.parse(k["text-color"],1,K),!j))return null;const W=y[y.length-1];W.scale=N,W.font=z,W.textColor=j}else{const N=u.parse(r[E],1,ae);if(!N)return null;const z=N.type.kind;if("string"!==z&&"value"!==z&&"null"!==z&&"resolvedImage"!==z)return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,y.push({content:N,scale:null,font:null,textColor:null})}}return new yr(y)}evaluate(r){return new pn(this.sections.map(u=>{const p=u.content.evaluate(r);return bi(p)===R?new Yn("",p,null,null,null):new Yn(Gs(p),null,u.scale?u.scale.evaluate(r):null,u.font?u.font.evaluate(r).join(","):null,u.textColor?u.textColor.evaluate(r):null)}))}eachChild(r){for(const u of this.sections)r(u.content),u.scale&&r(u.scale),u.font&&r(u.font),u.textColor&&r(u.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const u of this.sections){r.push(u.content.serialize());const p={};u.scale&&(p["font-scale"]=u.scale.serialize()),u.font&&(p["text-font"]=u.font.serialize()),u.textColor&&(p["text-color"]=u.textColor.serialize()),r.push(p)}return r}}class or{constructor(r){this.type=R,this.input=r}static parse(r,u){if(2!==r.length)return u.error("Expected two arguments.");const p=u.parse(r[1],1,$);return p?new or(p):u.error("No image name provided.")}evaluate(r){const u=this.input.evaluate(r),p=xi.fromString(u);return p&&r.availableImages&&(p.available=r.availableImages.indexOf(u)>-1),p}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Ou={"to-boolean":q,"to-color":K,"to-number":V,"to-string":$};class yl{constructor(r,u){this.type=r,this.args=u}static parse(r,u){if(r.length<2)return u.error("Expected at least one argument.");const p=r[0];if(("to-boolean"===p||"to-string"===p)&&2!==r.length)return u.error("Expected one argument.");const y=Ou[p],b=[];for(let E=1;E<r.length;E++){const k=u.parse(r[E],E,ae);if(!k)return null;b.push(k)}return new yl(y,b)}evaluate(r){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(r));if("color"===this.type.kind){let u,p;for(const y of this.args){if(u=y.evaluate(r),p=null,u instanceof qe)return u;if("string"==typeof u){const b=r.parseColor(u);if(b)return b}else if(Array.isArray(u)&&(p=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:sr(u[0],u[1],u[2],u[3]),!p))return new qe(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new Zn(p||`Could not parse color from value '${"string"==typeof u?u:String(JSON.stringify(u))}'`)}if("number"===this.type.kind){let u=null;for(const p of this.args){if(u=p.evaluate(r),null===u)return 0;const y=Number(u);if(!isNaN(y))return y}throw new Zn(`Could not convert ${JSON.stringify(u)} to number.`)}return"formatted"===this.type.kind?pn.fromString(Gs(this.args[0].evaluate(r))):"resolvedImage"===this.type.kind?xi.fromString(Gs(this.args[0].evaluate(r))):Gs(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){if("formatted"===this.type.kind)return new yr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new or(this.args[0]).serialize();const r=[`to-${this.type.kind}`];return this.eachChild(u=>{r.push(u.serialize())}),r}}const ag=["Unknown","Point","LineString","Polygon"];class cp{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ag[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,u=this.featureDistanceData.scale,{x:p,y}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(p*u-r[0])+this.featureDistanceData.bearing[1]*(y*u-r[1])}return 0}parseColor(r){let u=this._parseColorCache[r];return u||(u=this._parseColorCache[r]=qe.parse(r)),u}}class gi{constructor(r,u,p,y){this.name=r,this.type=u,this._evaluate=p,this.args=y}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(r=>r.serialize()))}static parse(r,u){const p=r[0],y=gi.definitions[p];if(!y)return u.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(y)?y[0]:y.type,E=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,k=E.filter(([z])=>!Array.isArray(z)||z.length===r.length-1);let N=null;for(const[z,j]of k){N=new Uo(u.registry,u.path,null,u.scope);const W=[];let Y=!1;for(let ie=1;ie<r.length;ie++){const ce=r[ie],pe=Array.isArray(z)?z[ie-1]:z.type,Ce=N.parse(ce,1+W.length,pe);if(!Ce){Y=!0;break}W.push(Ce)}if(!Y)if(Array.isArray(z)&&z.length!==W.length)N.error(`Expected ${z.length} arguments, but found ${W.length} instead.`);else{for(let ie=0;ie<W.length;ie++){const ce=Array.isArray(z)?z[ie]:z.type,pe=W[ie];N.concat(ie+1).checkSubtype(ce,pe.type)}if(0===N.errors.length)return new gi(p,b,j,W)}}if(1===k.length)u.errors.push(...N.errors);else{const z=(k.length?k:E).map(([W])=>{return Y=W,Array.isArray(Y)?`(${Y.map(Q).join(", ")})`:`(${Q(Y.type)}...)`;var Y}).join(" | "),j=[];for(let W=1;W<r.length;W++){const Y=u.parse(r[W],1+j.length);if(!Y)return null;j.push(Q(Y.type))}u.error(`Expected arguments of type ${z}, but found (${j.join(", ")}) instead.`)}return null}static register(r,u){gi.definitions=u;for(const p in u)r[p]=gi}}class mi{constructor(r,u,p){this.type=fe,this.locale=p,this.caseSensitive=r,this.diacriticSensitive=u}static parse(r,u){if(2!==r.length)return u.error("Expected one argument.");const p=r[1];if("object"!=typeof p||Array.isArray(p))return u.error("Collator options argument must be an object.");const y=u.parse(void 0!==p["case-sensitive"]&&p["case-sensitive"],1,q);if(!y)return null;const b=u.parse(void 0!==p["diacritic-sensitive"]&&p["diacritic-sensitive"],1,q);if(!b)return null;let E=null;return p.locale&&(E=u.parse(p.locale,1,$),!E)?null:new mi(y,b,E)}evaluate(r){return new Vt(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}const _l=8192;function up(c,r){c[0]=Math.min(c[0],r[0]),c[1]=Math.min(c[1],r[1]),c[2]=Math.max(c[2],r[0]),c[3]=Math.max(c[3],r[1])}function Vh(c,r){return!(c[0]<=r[0]||c[2]>=r[2]||c[1]<=r[1]||c[3]>=r[3])}function Ft(c,r){const u=(180+c[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,y=Math.pow(2,r.z);return[Math.round(u*y*_l),Math.round(p*y*_l)]}function My(c,r,u){const p=c[0]-r[0],y=c[1]-r[1],b=c[0]-u[0],E=c[1]-u[1];return p*E-b*y==0&&p*b<=0&&y*E<=0}function kn(c,r){let u=!1;for(let E=0,k=r.length;E<k;E++){const N=r[E];for(let z=0,j=N.length;z<j-1;z++){if(My(c,N[z],N[z+1]))return!1;(y=N[z])[1]>(p=c)[1]!=(b=N[z+1])[1]>p[1]&&p[0]<(b[0]-y[0])*(p[1]-y[1])/(b[1]-y[1])+y[0]&&(u=!u)}}var p,y,b;return u}function go(c,r){for(let u=0;u<r.length;u++)if(kn(c,r[u]))return!0;return!1}function Uh(c,r,u,p){const y=p[0]-u[0],b=p[1]-u[1],E=(c[0]-u[0])*b-y*(c[1]-u[1]),k=(r[0]-u[0])*b-y*(r[1]-u[1]);return E>0&&k<0||E<0&&k>0}function lg(c,r,u){for(const z of u)for(let j=0;j<z.length-1;++j)if((k=[(E=z[j+1])[0]-(b=z[j])[0],E[1]-b[1]])[0]*(N=[(y=r)[0]-(p=c)[0],y[1]-p[1]])[1]-k[1]*N[0]!=0&&Uh(p,y,b,E)&&Uh(b,E,p,y))return!0;var p,y,b,E,k,N;return!1}function hp(c,r){for(let u=0;u<c.length;++u)if(!kn(c[u],r))return!1;for(let u=0;u<c.length-1;++u)if(lg(c[u],c[u+1],r))return!1;return!0}function dp(c,r){for(let u=0;u<r.length;u++)if(hp(c,r[u]))return!0;return!1}function hs(c,r,u){const p=[];for(let y=0;y<c.length;y++){const b=[];for(let E=0;E<c[y].length;E++){const k=Ft(c[y][E],u);up(r,k),b.push(k)}p.push(b)}return p}function nu(c,r,u){const p=[];for(let y=0;y<c.length;y++){const b=hs(c[y],r,u);p.push(b)}return p}function Lu(c,r,u,p){if(c[0]<u[0]||c[0]>u[2]){const y=.5*p;let b=c[0]-u[0]>y?-p:u[0]-c[0]>y?p:0;0===b&&(b=c[0]-u[2]>y?-p:u[2]-c[0]>y?p:0),c[0]+=b}up(r,c)}function iu(c,r,u,p){const y=Math.pow(2,p.z)*_l,b=[p.x*_l,p.y*_l],E=[];for(const k of c)for(const N of k){const z=[N.x+b[0],N.y+b[1]];Lu(z,r,u,y),E.push(z)}return E}function Xt(c,r,u,p){const y=Math.pow(2,p.z)*_l,b=[p.x*_l,p.y*_l],E=[];for(const N of c){const z=[];for(const j of N){const W=[j.x+b[0],j.y+b[1]];up(r,W),z.push(W)}E.push(z)}if(r[2]-r[0]<=y/2){(k=r)[0]=k[1]=1/0,k[2]=k[3]=-1/0;for(const N of E)for(const z of N)Lu(z,r,u,y)}var k;return E}class ha{constructor(r,u){this.type=q,this.geojson=r,this.geometries=u}static parse(r,u){if(2!==r.length)return u.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(ki(r[1])){const p=r[1];if("FeatureCollection"===p.type)for(let y=0;y<p.features.length;++y){const b=p.features[y].geometry.type;if("Polygon"===b||"MultiPolygon"===b)return new ha(p,p.features[y].geometry)}else if("Feature"===p.type){const y=p.geometry.type;if("Polygon"===y||"MultiPolygon"===y)return new ha(p,p.geometry)}else if("Polygon"===p.type||"MultiPolygon"===p.type)return new ha(p,p)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(null!=r.geometry()&&null!=r.canonicalID()){if("Point"===r.geometryType())return function(u,p){const y=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],E=u.canonicalID();if("Polygon"===p.type){const k=hs(p.coordinates,b,E),N=iu(u.geometry(),y,b,E);if(!Vh(y,b))return!1;for(const z of N)if(!kn(z,k))return!1}if("MultiPolygon"===p.type){const k=nu(p.coordinates,b,E),N=iu(u.geometry(),y,b,E);if(!Vh(y,b))return!1;for(const z of N)if(!go(z,k))return!1}return!0}(r,this.geometries);if("LineString"===r.geometryType())return function(u,p){const y=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],E=u.canonicalID();if("Polygon"===p.type){const k=hs(p.coordinates,b,E),N=Xt(u.geometry(),y,b,E);if(!Vh(y,b))return!1;for(const z of N)if(!hp(z,k))return!1}if("MultiPolygon"===p.type){const k=nu(p.coordinates,b,E),N=Xt(u.geometry(),y,b,E);if(!Vh(y,b))return!1;for(const z of N)if(!dp(z,k))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function fc(c){if(c instanceof gi&&("get"===c.name&&1===c.args.length||"feature-state"===c.name||"has"===c.name&&1===c.args.length||"properties"===c.name||"geometry-type"===c.name||"id"===c.name||/^filter-/.test(c.name))||c instanceof ha)return!1;let r=!0;return c.eachChild(u=>{r&&!fc(u)&&(r=!1)}),r}function Vo(c){if(c instanceof gi&&"feature-state"===c.name)return!1;let r=!0;return c.eachChild(u=>{r&&!Vo(u)&&(r=!1)}),r}function Mn(c,r){if(c instanceof gi&&r.indexOf(c.name)>=0)return!1;let u=!0;return c.eachChild(p=>{u&&!Mn(p,r)&&(u=!1)}),u}class Hh{constructor(r,u){this.type=u.type,this.name=r,this.boundExpression=u}static parse(r,u){if(2!==r.length||"string"!=typeof r[1])return u.error("'var' expression requires exactly one string literal argument.");const p=r[1];return u.scope.has(p)?new Hh(p,u.scope.get(p)):u.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Uo{constructor(r,u=[],p,y=new L,b=[]){this.registry=r,this.path=u,this.key=u.map(E=>`[${E}]`).join(""),this.scope=y,this.errors=b,this.expectedType=p}parse(r,u,p,y,b={}){return u?this.concat(u,p,y)._parse(r,b):this._parse(r,b)}_parse(r,u){function p(y,b,E){return"assert"===E?new Ts(b,[y]):"coerce"===E?new yl(b,[y]):y}if(null!==r&&"string"!=typeof r&&"boolean"!=typeof r&&"number"!=typeof r||(r=["literal",r]),Array.isArray(r)){if(0===r.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const y=r[0];if("string"!=typeof y)return this.error(`Expression name must be a string, but found ${typeof y} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[y];if(b){let E=b.parse(r,this);if(!E)return null;if(this.expectedType){const k=this.expectedType,N=E.type;if("string"!==k.kind&&"number"!==k.kind&&"boolean"!==k.kind&&"object"!==k.kind&&"array"!==k.kind||"value"!==N.kind)if("color"!==k.kind&&"formatted"!==k.kind&&"resolvedImage"!==k.kind||"value"!==N.kind&&"string"!==N.kind){if(this.checkSubtype(k,N))return null}else E=p(E,k,u.typeAnnotation||"coerce");else E=p(E,k,u.typeAnnotation||"assert")}if(!(E instanceof $a)&&"resolvedImage"!==E.type.kind&&Ms(E)){const k=new cp;try{E=new $a(E.type,E.evaluate(k))}catch(N){return this.error(N.message),null}}return E}return this.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===r?"'undefined' value invalid. Use null instead.":"object"==typeof r?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,u,p){const y="number"==typeof r?this.path.concat(r):this.path,b=p?this.scope.concat(p):this.scope;return new Uo(this.registry,y,u||null,b,this.errors)}error(r,...u){const p=`${this.key}${u.map(y=>`[${y}]`).join("")}`;this.errors.push(new P(p,r))}checkSubtype(r,u){const p=Re(r,u);return p&&this.error(p),p}}function Ms(c){if(c instanceof Hh)return Ms(c.boundExpression);if(c instanceof gi&&"error"===c.name||c instanceof mi||c instanceof ha)return!1;const r=c instanceof yl||c instanceof Ts;let u=!0;return c.eachChild(p=>{u=r?u&&Ms(p):u&&p instanceof $a}),!!u&&fc(c)&&Mn(c,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function zu(c,r){const u=c.length-1;let p,y,b=0,E=u,k=0;for(;b<=E;)if(k=Math.floor((b+E)/2),p=c[k],y=c[k+1],p<=r){if(k===u||r<y)return k;b=k+1}else{if(!(p>r))throw new Zn("Input is not a number.");E=k-1}return 0}class Bu{constructor(r,u,p){this.type=r,this.input=u,this.labels=[],this.outputs=[];for(const[y,b]of p)this.labels.push(y),this.outputs.push(b)}static parse(r,u){if(r.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return u.error("Expected an even number of arguments.");const p=u.parse(r[1],1,V);if(!p)return null;const y=[];let b=null;u.expectedType&&"value"!==u.expectedType.kind&&(b=u.expectedType);for(let E=1;E<r.length;E+=2){const k=1===E?-1/0:r[E],N=r[E+1],z=E,j=E+1;if("number"!=typeof k)return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(y.length&&y[y.length-1][0]>=k)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);const W=u.parse(N,j,b);if(!W)return null;b=b||W.type,y.push([k,W])}return new Bu(b,p,y)}evaluate(r){const u=this.labels,p=this.outputs;if(1===u.length)return p[0].evaluate(r);const y=this.input.evaluate(r);if(y<=u[0])return p[0].evaluate(r);const b=u.length;return y>=u[b-1]?p[b-1].evaluate(r):p[zu(u,y)].evaluate(r)}eachChild(r){r(this.input);for(const u of this.outputs)r(u)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){const r=["step",this.input.serialize()];for(let u=0;u<this.labels.length;u++)u>0&&r.push(this.labels[u]),r.push(this.outputs[u].serialize());return r}}function ln(c,r,u){return c*(1-u)+r*u}var ru=Object.freeze({__proto__:null,number:ln,color:function(c,r,u){return new qe(ln(c.r,r.r,u),ln(c.g,r.g,u),ln(c.b,r.b,u),ln(c.a,r.a,u))},array:function(c,r,u){return c.map((p,y)=>ln(p,r[y],u))}});const cg=4/29,Gn=6/29,pp=3*Gn*Gn,ky=Math.PI/180,vl=180/Math.PI;function ii(c){return c>.008856451679035631?Math.pow(c,1/3):c/pp+cg}function xl(c){return c>Gn?c*c*c:pp*(c-cg)}function gc(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function mc(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Uu(c){const r=mc(c.r),u=mc(c.g),p=mc(c.b),y=ii((.4124564*r+.3575761*u+.1804375*p)/.95047),b=ii((.2126729*r+.7151522*u+.072175*p)/1);return{l:116*b-16,a:500*(y-b),b:200*(b-ii((.0193339*r+.119192*u+.9503041*p)/1.08883)),alpha:c.a}}function da(c){let r=(c.l+16)/116,u=isNaN(c.a)?r:r+c.a/500,p=isNaN(c.b)?r:r-c.b/200;return r=1*xl(r),u=.95047*xl(u),p=1.08883*xl(p),new qe(gc(3.2404542*u-1.5371385*r-.4985314*p),gc(-.969266*u+1.8760108*r+.041556*p),gc(.0556434*u-.2040259*r+1.0572252*p),c.alpha)}function yc(c,r,u){const p=r-c;return c+u*(p>180||p<-180?p-360*Math.round(p/360):p)}const _c={forward:Uu,reverse:da,interpolate:function(c,r,u){return{l:ln(c.l,r.l,u),a:ln(c.a,r.a,u),b:ln(c.b,r.b,u),alpha:ln(c.alpha,r.alpha,u)}}},Jn={forward:function(c){const{l:r,a:u,b:p}=Uu(c),y=Math.atan2(p,u)*vl;return{h:y<0?y+360:y,c:Math.sqrt(u*u+p*p),l:r,alpha:c.a}},reverse:function(c){const r=c.h*ky,u=c.c;return da({l:c.l,a:Math.cos(r)*u,b:Math.sin(r)*u,alpha:c.alpha})},interpolate:function(c,r,u){return{h:yc(c.h,r.h,u),c:ln(c.c,r.c,u),l:ln(c.l,r.l,u),alpha:ln(c.alpha,r.alpha,u)}}};var fp=Object.freeze({__proto__:null,lab:_c,hcl:Jn});class ks{constructor(r,u,p,y,b){this.type=r,this.operator=u,this.interpolation=p,this.input=y,this.labels=[],this.outputs=[];for(const[E,k]of b)this.labels.push(E),this.outputs.push(k)}static interpolationFactor(r,u,p,y){let b=0;if("exponential"===r.name)b=Hu(u,r.base,p,y);else if("linear"===r.name)b=Hu(u,1,p,y);else if("cubic-bezier"===r.name){const E=r.controlPoints;b=new Cs(E[0],E[1],E[2],E[3]).solve(Hu(u,1,p,y))}return b}static parse(r,u){let[p,y,b,...E]=r;if(!Array.isArray(y)||0===y.length)return u.error("Expected an interpolation type expression.",1);if("linear"===y[0])y={name:"linear"};else if("exponential"===y[0]){const z=y[1];if("number"!=typeof z)return u.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:z}}else{if("cubic-bezier"!==y[0])return u.error(`Unknown interpolation type ${String(y[0])}`,1,0);{const z=y.slice(1);if(4!==z.length||z.some(j=>"number"!=typeof j||j<0||j>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:z}}}if(r.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(b=u.parse(b,2,V),!b)return null;const k=[];let N=null;"interpolate-hcl"===p||"interpolate-lab"===p?N=K:u.expectedType&&"value"!==u.expectedType.kind&&(N=u.expectedType);for(let z=0;z<E.length;z+=2){const j=E[z],W=E[z+1],Y=z+3,ie=z+4;if("number"!=typeof j)return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Y);if(k.length&&k[k.length-1][0]>=j)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Y);const ce=u.parse(W,ie,N);if(!ce)return null;N=N||ce.type,k.push([j,ce])}return"number"===N.kind||"color"===N.kind||"array"===N.kind&&"number"===N.itemType.kind&&"number"==typeof N.N?new ks(N,p,y,b,k):u.error(`Type ${Q(N)} is not interpolatable.`)}evaluate(r){const u=this.labels,p=this.outputs;if(1===u.length)return p[0].evaluate(r);const y=this.input.evaluate(r);if(y<=u[0])return p[0].evaluate(r);const b=u.length;if(y>=u[b-1])return p[b-1].evaluate(r);const E=zu(u,y),k=ks.interpolationFactor(this.interpolation,y,u[E],u[E+1]),N=p[E].evaluate(r),z=p[E+1].evaluate(r);return"interpolate"===this.operator?ru[this.type.kind.toLowerCase()](N,z,k):"interpolate-hcl"===this.operator?Jn.reverse(Jn.interpolate(Jn.forward(N),Jn.forward(z),k)):_c.reverse(_c.interpolate(_c.forward(N),_c.forward(z),k))}eachChild(r){r(this.input);for(const u of this.outputs)r(u)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){let r;r="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const u=[this.operator,r,this.input.serialize()];for(let p=0;p<this.labels.length;p++)u.push(this.labels[p],this.outputs[p].serialize());return u}}function Hu(c,r,u,p){const y=p-u,b=c-u;return 0===y?0:1===r?b/y:(Math.pow(r,b)-1)/(Math.pow(r,y)-1)}class su{constructor(r,u){this.type=r,this.args=u}static parse(r,u){if(r.length<2)return u.error("Expectected at least one argument.");let p=null;const y=u.expectedType;y&&"value"!==y.kind&&(p=y);const b=[];for(const k of r.slice(1)){const N=u.parse(k,1+b.length,p,void 0,{typeAnnotation:"omit"});if(!N)return null;p=p||N.type,b.push(N)}const E=y&&b.some(k=>Re(y,k.type));return new su(E?ae:p,b)}evaluate(r){let u,p=null,y=0;for(const b of this.args)if(y++,p=b.evaluate(r),p&&p instanceof xi&&!p.available&&(u||(u=p.name),p=null,y===this.args.length&&(p=u)),null!==p)break;return p}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=["coalesce"];return this.eachChild(u=>{r.push(u.serialize())}),r}}class Ln{constructor(r,u){this.type=u.type,this.bindings=[].concat(r),this.result=u}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const u of this.bindings)r(u[1]);r(this.result)}static parse(r,u){if(r.length<4)return u.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const p=[];for(let b=1;b<r.length-1;b+=2){const E=r[b];if("string"!=typeof E)return u.error(`Expected string, but found ${typeof E} instead.`,b);if(/[^a-zA-Z0-9_]/.test(E))return u.error("Variable names must contain only alphanumeric characters or '_'.",b);const k=u.parse(r[b+1],b+1);if(!k)return null;p.push([E,k])}const y=u.parse(r[r.length-1],r.length-1,u.expectedType,p);return y?new Ln(p,y):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[u,p]of this.bindings)r.push(u,p.serialize());return r.push(this.result.serialize()),r}}class $h{constructor(r,u,p){this.type=r,this.index=u,this.input=p}static parse(r,u){if(3!==r.length)return u.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const p=u.parse(r[1],1,V),y=u.parse(r[2],2,H(u.expectedType||ae));return p&&y?new $h(y.type.itemType,p,y):null}evaluate(r){const u=this.index.evaluate(r),p=this.input.evaluate(r);if(u<0)throw new Zn(`Array index out of bounds: ${u} < 0.`);if(u>=p.length)throw new Zn(`Array index out of bounds: ${u} > ${p.length-1}.`);if(u!==Math.floor(u))throw new Zn(`Array index must be an integer, but found ${u} instead.`);return p[u]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class ju{constructor(r,u){this.type=q,this.needle=r,this.haystack=u}static parse(r,u){if(3!==r.length)return u.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const p=u.parse(r[1],1,ae),y=u.parse(r[2],2,ae);return p&&y?tt(p.type,[q,$,V,B,ae])?new ju(p,y):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${Q(p.type)} instead`):null}evaluate(r){const u=this.needle.evaluate(r),p=this.haystack.evaluate(r);if(!p)return!1;if(!Ve(u,["boolean","string","number","null"]))throw new Zn(`Expected first argument to be of type boolean, string, number or null, but found ${Q(bi(u))} instead.`);if(!Ve(p,["string","array"]))throw new Zn(`Expected second argument to be of type array or string, but found ${Q(bi(p))} instead.`);return p.indexOf(u)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Rt{constructor(r,u,p){this.type=V,this.needle=r,this.haystack=u,this.fromIndex=p}static parse(r,u){if(r.length<=2||r.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const p=u.parse(r[1],1,ae),y=u.parse(r[2],2,ae);if(!p||!y)return null;if(!tt(p.type,[q,$,V,B,ae]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${Q(p.type)} instead`);if(4===r.length){const b=u.parse(r[3],3,V);return b?new Rt(p,y,b):null}return new Rt(p,y)}evaluate(r){const u=this.needle.evaluate(r),p=this.haystack.evaluate(r);if(!Ve(u,["boolean","string","number","null"]))throw new Zn(`Expected first argument to be of type boolean, string, number or null, but found ${Q(bi(u))} instead.`);if(!Ve(p,["string","array"]))throw new Zn(`Expected second argument to be of type array or string, but found ${Q(bi(p))} instead.`);if(this.fromIndex){const y=this.fromIndex.evaluate(r);return p.indexOf(u,y)}return p.indexOf(u)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Lr{constructor(r,u,p,y,b,E){this.inputType=r,this.type=u,this.input=p,this.cases=y,this.outputs=b,this.otherwise=E}static parse(r,u){if(r.length<5)return u.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return u.error("Expected an even number of arguments.");let p,y;u.expectedType&&"value"!==u.expectedType.kind&&(y=u.expectedType);const b={},E=[];for(let z=2;z<r.length-1;z+=2){let j=r[z];const W=r[z+1];Array.isArray(j)||(j=[j]);const Y=u.concat(z);if(0===j.length)return Y.error("Expected at least one branch label.");for(const ce of j){if("number"!=typeof ce&&"string"!=typeof ce)return Y.error("Branch labels must be numbers or strings.");if("number"==typeof ce&&Math.abs(ce)>Number.MAX_SAFE_INTEGER)return Y.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof ce&&Math.floor(ce)!==ce)return Y.error("Numeric branch labels must be integer values.");if(p){if(Y.checkSubtype(p,bi(ce)))return null}else p=bi(ce);if(void 0!==b[String(ce)])return Y.error("Branch labels must be unique.");b[String(ce)]=E.length}const ie=u.parse(W,z,y);if(!ie)return null;y=y||ie.type,E.push(ie)}const k=u.parse(r[1],1,ae);if(!k)return null;const N=u.parse(r[r.length-1],r.length-1,y);return N?"value"!==k.type.kind&&u.concat(1).checkSubtype(p,k.type)?null:new Lr(p,y,k,b,E,N):null}evaluate(r){const u=this.input.evaluate(r);return(bi(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],u=Object.keys(this.cases).sort(),p=[],y={};for(const E of u){const k=y[this.cases[E]];void 0===k?(y[this.cases[E]]=p.length,p.push([this.cases[E],[E]])):p[k][1].push(E)}const b=E=>"number"===this.inputType.kind?Number(E):E;for(const[E,k]of p)r.push(1===k.length?b(k[0]):k.map(b)),r.push(this.outputs[E].serialize());return r.push(this.otherwise.serialize()),r}}class _r{constructor(r,u,p){this.type=r,this.branches=u,this.otherwise=p}static parse(r,u){if(r.length<4)return u.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return u.error("Expected an odd number of arguments.");let p;u.expectedType&&"value"!==u.expectedType.kind&&(p=u.expectedType);const y=[];for(let E=1;E<r.length-1;E+=2){const k=u.parse(r[E],E,q);if(!k)return null;const N=u.parse(r[E+1],E+1,p);if(!N)return null;y.push([k,N]),p=p||N.type}const b=u.parse(r[r.length-1],r.length-1,p);return b?new _r(p,y,b):null}evaluate(r){for(const[u,p]of this.branches)if(u.evaluate(r))return p.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[u,p]of this.branches)r(u),r(p);r(this.otherwise)}outputDefined(){return this.branches.every(([r,u])=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild(u=>{r.push(u.serialize())}),r}}class Ho{constructor(r,u,p,y){this.type=r,this.input=u,this.beginIndex=p,this.endIndex=y}static parse(r,u){if(r.length<=2||r.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const p=u.parse(r[1],1,ae),y=u.parse(r[2],2,V);if(!p||!y)return null;if(!tt(p.type,[H(ae),$,ae]))return u.error(`Expected first argument to be of type array or string, but found ${Q(p.type)} instead`);if(4===r.length){const b=u.parse(r[3],3,V);return b?new Ho(p.type,p,y,b):null}return new Ho(p.type,p,y)}evaluate(r){const u=this.input.evaluate(r),p=this.beginIndex.evaluate(r);if(!Ve(u,["string","array"]))throw new Zn(`Expected first argument to be of type array or string, but found ${Q(bi(u))} instead.`);if(this.endIndex){const y=this.endIndex.evaluate(r);return u.slice(p,y)}return u.slice(p)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Ea(c,r){return"=="===c||"!="===c?"boolean"===r.kind||"string"===r.kind||"number"===r.kind||"null"===r.kind||"value"===r.kind:"string"===r.kind||"number"===r.kind||"value"===r.kind}function Ws(c,r,u,p){return 0===p.compare(r,u)}function zr(c,r,u){const p="=="!==c&&"!="!==c;return class r2{constructor(b,E,k){this.type=q,this.lhs=b,this.rhs=E,this.collator=k,this.hasUntypedArgument="value"===b.type.kind||"value"===E.type.kind}static parse(b,E){if(3!==b.length&&4!==b.length)return E.error("Expected two or three arguments.");const k=b[0];let N=E.parse(b[1],1,ae);if(!N)return null;if(!Ea(k,N.type))return E.concat(1).error(`"${k}" comparisons are not supported for type '${Q(N.type)}'.`);let z=E.parse(b[2],2,ae);if(!z)return null;if(!Ea(k,z.type))return E.concat(2).error(`"${k}" comparisons are not supported for type '${Q(z.type)}'.`);if(N.type.kind!==z.type.kind&&"value"!==N.type.kind&&"value"!==z.type.kind)return E.error(`Cannot compare types '${Q(N.type)}' and '${Q(z.type)}'.`);p&&("value"===N.type.kind&&"value"!==z.type.kind?N=new Ts(z.type,[N]):"value"!==N.type.kind&&"value"===z.type.kind&&(z=new Ts(N.type,[z])));let j=null;if(4===b.length){if("string"!==N.type.kind&&"string"!==z.type.kind&&"value"!==N.type.kind&&"value"!==z.type.kind)return E.error("Cannot use collator to compare non-string types.");if(j=E.parse(b[3],3,fe),!j)return null}return new r2(N,z,j)}evaluate(b){const E=this.lhs.evaluate(b),k=this.rhs.evaluate(b);if(p&&this.hasUntypedArgument){const N=bi(E),z=bi(k);if(N.kind!==z.kind||"string"!==N.kind&&"number"!==N.kind)throw new Zn(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${N.kind}, ${z.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const N=bi(E),z=bi(k);if("string"!==N.kind||"string"!==z.kind)return r(b,E,k)}return this.collator?u(b,E,k,this.collator.evaluate(b)):r(b,E,k)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}serialize(){const b=[c];return this.eachChild(E=>{b.push(E.serialize())}),b}}}const Ut=zr("==",function(c,r,u){return r===u},Ws),En=zr("!=",function(c,r,u){return r!==u},function(c,r,u,p){return!Ws(0,r,u,p)}),Oi=zr("<",function(c,r,u){return r<u},function(c,r,u,p){return p.compare(r,u)<0}),Xs=zr(">",function(c,r,u){return r>u},function(c,r,u,p){return p.compare(r,u)>0}),bl=zr("<=",function(c,r,u){return r<=u},function(c,r,u,p){return p.compare(r,u)<=0}),Sr=zr(">=",function(c,r,u){return r>=u},function(c,r,u,p){return p.compare(r,u)>=0});class mo{constructor(r,u,p,y,b){this.type=$,this.number=r,this.locale=u,this.currency=p,this.minFractionDigits=y,this.maxFractionDigits=b}static parse(r,u){if(3!==r.length)return u.error("Expected two arguments.");const p=u.parse(r[1],1,V);if(!p)return null;const y=r[2];if("object"!=typeof y||Array.isArray(y))return u.error("NumberFormat options argument must be an object.");let b=null;if(y.locale&&(b=u.parse(y.locale,1,$),!b))return null;let E=null;if(y.currency&&(E=u.parse(y.currency,1,$),!E))return null;let k=null;if(y["min-fraction-digits"]&&(k=u.parse(y["min-fraction-digits"],1,V),!k))return null;let N=null;return y["max-fraction-digits"]&&(N=u.parse(y["max-fraction-digits"],1,V),!N)?null:new mo(p,b,E,k,N)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class Li{constructor(r){this.type=V,this.input=r}static parse(r,u){if(2!==r.length)return u.error(`Expected 1 argument, but found ${r.length-1} instead.`);const p=u.parse(r[1],1);return p?"array"!==p.type.kind&&"string"!==p.type.kind&&"value"!==p.type.kind?u.error(`Expected argument of type string or array, but found ${Q(p.type)} instead.`):new Li(p):null}evaluate(r){const u=this.input.evaluate(r);if("string"==typeof u||Array.isArray(u))return u.length;throw new Zn(`Expected value to be of type string or array, but found ${Q(bi(u))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild(u=>{r.push(u.serialize())}),r}}const jo={"==":Ut,"!=":En,">":Xs,"<":Oi,">=":Sr,"<=":bl,array:Ts,at:$h,boolean:Ts,case:_r,coalesce:su,collator:mi,format:yr,image:or,in:ju,"index-of":Rt,interpolate:ks,"interpolate-hcl":ks,"interpolate-lab":ks,length:Li,let:Ln,literal:$a,match:Lr,number:Ts,"number-format":mo,object:Ts,slice:Ho,step:Bu,string:Ts,"to-boolean":yl,"to-color":yl,"to-number":yl,"to-string":yl,var:Hh,within:ha};function wl(c,[r,u,p,y]){r=r.evaluate(c),u=u.evaluate(c),p=p.evaluate(c);const b=y?y.evaluate(c):1,E=sr(r,u,p,b);if(E)throw new Zn(E);return new qe(r/255*b,u/255*b,p/255*b,b)}function yn(c,r){return c in r}function vc(c,r){const u=r[c];return void 0===u?null:u}function Ys(c){return{type:c}}function ou(c){return{result:"success",value:c}}function yo(c){return{result:"error",value:c}}function Zi(c){return"data-driven"===c["property-type"]||"cross-faded-data-driven"===c["property-type"]}function xc(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function Ga(c){return!!c.expression&&c.expression.interpolated}function hn(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":null===c?"null":typeof c}function li(c){return"object"==typeof c&&null!==c&&!Array.isArray(c)}function ug(c){return c}function gp(c,r){const u="color"===r.type,p=c.stops&&"object"==typeof c.stops[0][0],y=p||!(p||void 0!==c.property),b=c.type||(Ga(r)?"exponential":"interval");if(u&&((c=D({},c)).stops&&(c.stops=c.stops.map(z=>[z[0],qe.parse(z[1])])),c.default=qe.parse(c.default?c.default:r.default)),c.colorSpace&&"rgb"!==c.colorSpace&&!fp[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let E,k,N;if("exponential"===b)E=au;else if("interval"===b)E=Wa;else if("categorical"===b){E=$u,k=Object.create(null);for(const z of c.stops)k[z[0]]=z[1];N=typeof c.stops[0][0]}else{if("identity"!==b)throw new Error(`Unknown function type "${b}"`);E=Cl}if(p){const z={},j=[];for(let ie=0;ie<c.stops.length;ie++){const ce=c.stops[ie],pe=ce[0].zoom;void 0===z[pe]&&(z[pe]={zoom:pe,type:c.type,property:c.property,default:c.default,stops:[]},j.push(pe)),z[pe].stops.push([ce[0].value,ce[1]])}const W=[];for(const ie of j)W.push([z[ie].zoom,gp(z[ie],r)]);const Y={name:"linear"};return{kind:"composite",interpolationType:Y,interpolationFactor:ks.interpolationFactor.bind(void 0,Y),zoomStops:W.map(ie=>ie[0]),evaluate:({zoom:ie},ce)=>au({stops:W,base:c.base},r,ie).evaluate(ie,ce)}}if(y){const z="exponential"===b?{name:"exponential",base:void 0!==c.base?c.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:ks.interpolationFactor.bind(void 0,z),zoomStops:c.stops.map(j=>j[0]),evaluate:({zoom:j})=>E(c,r,j,k,N)}}return{kind:"source",evaluate(z,j){const W=j&&j.properties?j.properties[c.property]:void 0;return void 0===W?Aa(c.default,r.default):E(c,r,W,k,N)}}}function Aa(c,r,u){return void 0!==c?c:void 0!==r?r:void 0!==u?u:void 0}function $u(c,r,u,p,y){return Aa(typeof u===y?p[u]:void 0,c.default,r.default)}function Wa(c,r,u){if("number"!==hn(u))return Aa(c.default,r.default);const p=c.stops.length;if(1===p||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[p-1][0])return c.stops[p-1][1];const y=zu(c.stops.map(b=>b[0]),u);return c.stops[y][1]}function au(c,r,u){const p=void 0!==c.base?c.base:1;if("number"!==hn(u))return Aa(c.default,r.default);const y=c.stops.length;if(1===y||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[y-1][0])return c.stops[y-1][1];const b=zu(c.stops.map(j=>j[0]),u),E=function(j,W,Y,ie){const ce=ie-Y,pe=j-Y;return 0===ce?0:1===W?pe/ce:(Math.pow(W,pe)-1)/(Math.pow(W,ce)-1)}(u,p,c.stops[b][0],c.stops[b+1][0]),k=c.stops[b][1],N=c.stops[b+1][1];let z=ru[r.type]||ug;if(c.colorSpace&&"rgb"!==c.colorSpace){const j=fp[c.colorSpace];z=(W,Y)=>j.reverse(j.interpolate(j.forward(W),j.forward(Y),E))}return"function"==typeof k.evaluate?{evaluate(...j){const W=k.evaluate.apply(void 0,j),Y=N.evaluate.apply(void 0,j);if(void 0!==W&&void 0!==Y)return z(W,Y,E)}}:z(k,N,E)}function Cl(c,r,u){return"color"===r.type?u=qe.parse(u):"formatted"===r.type?u=pn.fromString(u.toString()):"resolvedImage"===r.type?u=xi.fromString(u.toString()):hn(u)===r.type||"enum"===r.type&&r.values[u]||(u=void 0),Aa(u,c.default,r.default)}gi.register(jo,{error:[{kind:"error"},[$],(c,[r])=>{throw new Zn(r.evaluate(c))}],typeof:[$,[ae],(c,[r])=>Q(bi(r.evaluate(c)))],"to-rgba":[H(V,4),[K],(c,[r])=>r.evaluate(c).toArray()],rgb:[K,[V,V,V],wl],rgba:[K,[V,V,V,V],wl],has:{type:q,overloads:[[[$],(c,[r])=>yn(r.evaluate(c),c.properties())],[[$,oe],(c,[r,u])=>yn(r.evaluate(c),u.evaluate(c))]]},get:{type:ae,overloads:[[[$],(c,[r])=>vc(r.evaluate(c),c.properties())],[[$,oe],(c,[r,u])=>vc(r.evaluate(c),u.evaluate(c))]]},"feature-state":[ae,[$],(c,[r])=>vc(r.evaluate(c),c.featureState||{})],properties:[oe,[],c=>c.properties()],"geometry-type":[$,[],c=>c.geometryType()],id:[ae,[],c=>c.id()],zoom:[V,[],c=>c.globals.zoom],pitch:[V,[],c=>c.globals.pitch||0],"distance-from-center":[V,[],c=>c.distanceFromCenter()],"heatmap-density":[V,[],c=>c.globals.heatmapDensity||0],"line-progress":[V,[],c=>c.globals.lineProgress||0],"sky-radial-progress":[V,[],c=>c.globals.skyRadialProgress||0],accumulated:[ae,[],c=>void 0===c.globals.accumulated?null:c.globals.accumulated],"+":[V,Ys(V),(c,r)=>{let u=0;for(const p of r)u+=p.evaluate(c);return u}],"*":[V,Ys(V),(c,r)=>{let u=1;for(const p of r)u*=p.evaluate(c);return u}],"-":{type:V,overloads:[[[V,V],(c,[r,u])=>r.evaluate(c)-u.evaluate(c)],[[V],(c,[r])=>-r.evaluate(c)]]},"/":[V,[V,V],(c,[r,u])=>r.evaluate(c)/u.evaluate(c)],"%":[V,[V,V],(c,[r,u])=>r.evaluate(c)%u.evaluate(c)],ln2:[V,[],()=>Math.LN2],pi:[V,[],()=>Math.PI],e:[V,[],()=>Math.E],"^":[V,[V,V],(c,[r,u])=>Math.pow(r.evaluate(c),u.evaluate(c))],sqrt:[V,[V],(c,[r])=>Math.sqrt(r.evaluate(c))],log10:[V,[V],(c,[r])=>Math.log(r.evaluate(c))/Math.LN10],ln:[V,[V],(c,[r])=>Math.log(r.evaluate(c))],log2:[V,[V],(c,[r])=>Math.log(r.evaluate(c))/Math.LN2],sin:[V,[V],(c,[r])=>Math.sin(r.evaluate(c))],cos:[V,[V],(c,[r])=>Math.cos(r.evaluate(c))],tan:[V,[V],(c,[r])=>Math.tan(r.evaluate(c))],asin:[V,[V],(c,[r])=>Math.asin(r.evaluate(c))],acos:[V,[V],(c,[r])=>Math.acos(r.evaluate(c))],atan:[V,[V],(c,[r])=>Math.atan(r.evaluate(c))],min:[V,Ys(V),(c,r)=>Math.min(...r.map(u=>u.evaluate(c)))],max:[V,Ys(V),(c,r)=>Math.max(...r.map(u=>u.evaluate(c)))],abs:[V,[V],(c,[r])=>Math.abs(r.evaluate(c))],round:[V,[V],(c,[r])=>{const u=r.evaluate(c);return u<0?-Math.round(-u):Math.round(u)}],floor:[V,[V],(c,[r])=>Math.floor(r.evaluate(c))],ceil:[V,[V],(c,[r])=>Math.ceil(r.evaluate(c))],"filter-==":[q,[$,ae],(c,[r,u])=>c.properties()[r.value]===u.value],"filter-id-==":[q,[ae],(c,[r])=>c.id()===r.value],"filter-type-==":[q,[$],(c,[r])=>c.geometryType()===r.value],"filter-<":[q,[$,ae],(c,[r,u])=>{const p=c.properties()[r.value],y=u.value;return typeof p==typeof y&&p<y}],"filter-id-<":[q,[ae],(c,[r])=>{const u=c.id(),p=r.value;return typeof u==typeof p&&u<p}],"filter->":[q,[$,ae],(c,[r,u])=>{const p=c.properties()[r.value],y=u.value;return typeof p==typeof y&&p>y}],"filter-id->":[q,[ae],(c,[r])=>{const u=c.id(),p=r.value;return typeof u==typeof p&&u>p}],"filter-<=":[q,[$,ae],(c,[r,u])=>{const p=c.properties()[r.value],y=u.value;return typeof p==typeof y&&p<=y}],"filter-id-<=":[q,[ae],(c,[r])=>{const u=c.id(),p=r.value;return typeof u==typeof p&&u<=p}],"filter->=":[q,[$,ae],(c,[r,u])=>{const p=c.properties()[r.value],y=u.value;return typeof p==typeof y&&p>=y}],"filter-id->=":[q,[ae],(c,[r])=>{const u=c.id(),p=r.value;return typeof u==typeof p&&u>=p}],"filter-has":[q,[ae],(c,[r])=>r.value in c.properties()],"filter-has-id":[q,[],c=>null!==c.id()&&void 0!==c.id()],"filter-type-in":[q,[H($)],(c,[r])=>r.value.indexOf(c.geometryType())>=0],"filter-id-in":[q,[H(ae)],(c,[r])=>r.value.indexOf(c.id())>=0],"filter-in-small":[q,[$,H(ae)],(c,[r,u])=>u.value.indexOf(c.properties()[r.value])>=0],"filter-in-large":[q,[$,H(ae)],(c,[r,u])=>function(p,y,b,E){for(;b<=E;){const k=b+E>>1;if(y[k]===p)return!0;y[k]>p?E=k-1:b=k+1}return!1}(c.properties()[r.value],u.value,0,u.value.length-1)],all:{type:q,overloads:[[[q,q],(c,[r,u])=>r.evaluate(c)&&u.evaluate(c)],[Ys(q),(c,r)=>{for(const u of r)if(!u.evaluate(c))return!1;return!0}]]},any:{type:q,overloads:[[[q,q],(c,[r,u])=>r.evaluate(c)||u.evaluate(c)],[Ys(q),(c,r)=>{for(const u of r)if(u.evaluate(c))return!0;return!1}]]},"!":[q,[q],(c,[r])=>!r.evaluate(c)],"is-supported-script":[q,[$],(c,[r])=>{const u=c.globals&&c.globals.isSupportedScript;return!u||u(r.evaluate(c))}],upcase:[$,[$],(c,[r])=>r.evaluate(c).toUpperCase()],downcase:[$,[$],(c,[r])=>r.evaluate(c).toLowerCase()],concat:[$,Ys(ae),(c,r)=>r.map(u=>Gs(u.evaluate(c))).join("")],"resolved-locale":[$,[fe],(c,[r])=>r.evaluate(c).resolvedLocale()]});class Dr{constructor(r,u){var p;this.expression=r,this._warningHistory={},this._evaluator=new cp,this._defaultValue=u?"color"===(p=u).type&&li(p.default)?new qe(0,0,0,0):"color"===p.type?qe.parse(p.default)||null:void 0===p.default?null:p.default:null,this._enumValues=u&&"enum"===u.type?u.values:null}evaluateWithoutErrorHandling(r,u,p,y,b,E,k,N){return this._evaluator.globals=r,this._evaluator.feature=u,this._evaluator.featureState=p,this._evaluator.canonical=y,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=E,this._evaluator.featureTileCoord=k||null,this._evaluator.featureDistanceData=N||null,this.expression.evaluate(this._evaluator)}evaluate(r,u,p,y,b,E,k,N){this._evaluator.globals=r,this._evaluator.feature=u||null,this._evaluator.featureState=p||null,this._evaluator.canonical=y,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=E||null,this._evaluator.featureTileCoord=k||null,this._evaluator.featureDistanceData=N||null;try{const z=this.expression.evaluate(this._evaluator);if(null==z||"number"==typeof z&&z!=z)return this._defaultValue;if(this._enumValues&&!(z in this._enumValues))throw new Zn(`Expected value to be one of ${Object.keys(this._enumValues).map(j=>JSON.stringify(j)).join(", ")}, but found ${JSON.stringify(z)} instead.`);return z}catch(z){return this._warningHistory[z.message]||(this._warningHistory[z.message]=!0,"undefined"!=typeof console&&console.warn(z.message)),this._defaultValue}}}function $o(c){return Array.isArray(c)&&c.length>0&&"string"==typeof c[0]&&c[0]in jo}function ds(c,r){const u=new Uo(jo,[],r?function(y){const b={color:K,string:$,number:V,enum:$,boolean:q,formatted:ge,resolvedImage:R};return"array"===y.type?H(b[y.value]||ae,y.length):b[y.type]}(r):void 0),p=u.parse(c,void 0,void 0,void 0,r&&"string"===r.type?{typeAnnotation:"coerce"}:void 0);return p?ou(new Dr(p,r)):yo(u.errors)}class Er{constructor(r,u){this.kind=r,this._styleExpression=u,this.isStateDependent="constant"!==r&&!Vo(u.expression)}evaluateWithoutErrorHandling(r,u,p,y,b,E){return this._styleExpression.evaluateWithoutErrorHandling(r,u,p,y,b,E)}evaluate(r,u,p,y,b,E){return this._styleExpression.evaluate(r,u,p,y,b,E)}}class bc{constructor(r,u,p,y){this.kind=r,this.zoomStops=p,this._styleExpression=u,this.isStateDependent="camera"!==r&&!Vo(u.expression),this.interpolationType=y}evaluateWithoutErrorHandling(r,u,p,y,b,E){return this._styleExpression.evaluateWithoutErrorHandling(r,u,p,y,b,E)}evaluate(r,u,p,y,b,E){return this._styleExpression.evaluate(r,u,p,y,b,E)}interpolationFactor(r,u,p){return this.interpolationType?ks.interpolationFactor(this.interpolationType,r,u,p):0}}function lu(c,r){if("error"===(c=ds(c,r)).result)return c;const u=c.value.expression,p=fc(u);if(!p&&!Zi(r))return yo([new P("","data expressions not supported")]);const y=Mn(u,["zoom","pitch","distance-from-center"]);if(!y&&!xc(r))return yo([new P("","zoom expressions not supported")]);const b=Ar(u);return b||y?b instanceof P?yo([b]):b instanceof ks&&!Ga(r)?yo([new P("",'"interpolate" expressions cannot be used with this property')]):ou(b?new bc(p?"camera":"composite",c.value,b.labels,b instanceof ks?b.interpolation:void 0):new Er(p?"constant":"source",c.value)):yo([new P("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ta{constructor(r,u){this._parameters=r,this._specification=u,D(this,gp(this._parameters,this._specification))}static deserialize(r){return new Ta(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function Ar(c){let r=null;if(c instanceof Ln)r=Ar(c.result);else if(c instanceof su){for(const u of c.args)if(r=Ar(u),r)break}else(c instanceof Bu||c instanceof ks)&&c.input instanceof gi&&"zoom"===c.input.name&&(r=c);return r instanceof P||c.eachChild(u=>{const p=Ar(u);p instanceof P?r=p:!r&&p?r=new P("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&p&&r!==p&&(r=new P("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function _o(c){const r=c.key,u=c.value,p=c.valueSpec||{},y=c.objectElementValidators||{},b=c.style,E=c.styleSpec;let k=[];const N=hn(u);if("object"!==N)return[new g(r,u,`object expected, ${N} found`)];for(const z in u){const j=z.split(".")[0],W=p[j]||p["*"];let Y;if(y[j])Y=y[j];else if(p[j])Y=Yr;else if(y["*"])Y=y["*"];else{if(!p["*"]){k.push(new g(r,u[z],`unknown property "${z}"`));continue}Y=Yr}k=k.concat(Y({key:(r&&`${r}.`)+z,value:u[z],valueSpec:W,style:b,styleSpec:E,object:u,objectKey:z},u))}for(const z in p)y[z]||p[z].required&&void 0===p[z].default&&void 0===u[z]&&k.push(new g(r,u,`missing required property "${z}"`));return k}function Gh(c){const r=c.value,u=c.valueSpec,p=c.style,y=c.styleSpec,b=c.key,E=c.arrayElementValidator||Yr;if("array"!==hn(r))return[new g(b,r,`array expected, ${hn(r)} found`)];if(u.length&&r.length!==u.length)return[new g(b,r,`array length ${u.length} expected, length ${r.length} found`)];if(u["min-length"]&&r.length<u["min-length"])return[new g(b,r,`array length at least ${u["min-length"]} expected, length ${r.length} found`)];let k={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum};y.$version<7&&(k.function=u.function),"object"===hn(u.value)&&(k=u.value);let N=[];for(let z=0;z<r.length;z++)N=N.concat(E({array:r,arrayIndex:z,value:r[z],valueSpec:k,style:p,styleSpec:y,key:`${b}[${z}]`}));return N}function Wh(c){const r=c.key,u=c.value,p=c.valueSpec;let y=hn(u);if("number"===y&&u!=u&&(y="NaN"),"number"!==y)return[new g(r,u,`number expected, ${y} found`)];if("minimum"in p){let b=p.minimum;if("array"===hn(p.minimum)&&(b=p.minimum[c.arrayIndex]),u<b)return[new g(r,u,`${u} is less than the minimum value ${b}`)]}if("maximum"in p){let b=p.maximum;if("array"===hn(p.maximum)&&(b=p.maximum[c.arrayIndex]),u>b)return[new g(r,u,`${u} is greater than the maximum value ${b}`)]}return[]}function Gu(c){const r=c.valueSpec,u=C(c.value.type);let p,y,b,E={};const k="categorical"!==u&&void 0===c.value.property,N=!k,z="array"===hn(c.value.stops)&&"array"===hn(c.value.stops[0])&&"object"===hn(c.value.stops[0][0]),j=_o({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(ie){if("identity"===u)return[new g(ie.key,ie.value,'identity function may not have a "stops" property')];let ce=[];const pe=ie.value;return ce=ce.concat(Gh({key:ie.key,value:pe,valueSpec:ie.valueSpec,style:ie.style,styleSpec:ie.styleSpec,arrayElementValidator:W})),"array"===hn(pe)&&0===pe.length&&ce.push(new g(ie.key,pe,"array must have at least one stop")),ce},default:function(ie){return Yr({key:ie.key,value:ie.value,valueSpec:r,style:ie.style,styleSpec:ie.styleSpec})}}});return"identity"===u&&k&&j.push(new g(c.key,c.value,'missing required property "property"')),"identity"===u||c.value.stops||j.push(new g(c.key,c.value,'missing required property "stops"')),"exponential"===u&&c.valueSpec.expression&&!Ga(c.valueSpec)&&j.push(new g(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(N&&!Zi(c.valueSpec)?j.push(new g(c.key,c.value,"property functions not supported")):k&&!xc(c.valueSpec)&&j.push(new g(c.key,c.value,"zoom functions not supported"))),"categorical"!==u&&!z||void 0!==c.value.property||j.push(new g(c.key,c.value,'"property" property is required')),j;function W(ie){let ce=[];const pe=ie.value,Ce=ie.key;if("array"!==hn(pe))return[new g(Ce,pe,`array expected, ${hn(pe)} found`)];if(2!==pe.length)return[new g(Ce,pe,`array length 2 expected, length ${pe.length} found`)];if(z){if("object"!==hn(pe[0]))return[new g(Ce,pe,`object expected, ${hn(pe[0])} found`)];if(void 0===pe[0].zoom)return[new g(Ce,pe,"object stop key must have zoom")];if(void 0===pe[0].value)return[new g(Ce,pe,"object stop key must have value")];if(b&&b>C(pe[0].zoom))return[new g(Ce,pe[0].zoom,"stop zoom values must appear in ascending order")];C(pe[0].zoom)!==b&&(b=C(pe[0].zoom),y=void 0,E={}),ce=ce.concat(_o({key:`${Ce}[0]`,value:pe[0],valueSpec:{zoom:{}},style:ie.style,styleSpec:ie.styleSpec,objectElementValidators:{zoom:Wh,value:Y}}))}else ce=ce.concat(Y({key:`${Ce}[0]`,value:pe[0],valueSpec:{},style:ie.style,styleSpec:ie.styleSpec},pe));return $o(T(pe[1]))?ce.concat([new g(`${Ce}[1]`,pe[1],"expressions are not allowed in function stops.")]):ce.concat(Yr({key:`${Ce}[1]`,value:pe[1],valueSpec:r,style:ie.style,styleSpec:ie.styleSpec}))}function Y(ie,ce){const pe=hn(ie.value),Ce=C(ie.value),Te=null!==ie.value?ie.value:ce;if(p){if(pe!==p)return[new g(ie.key,Te,`${pe} stop domain type must match previous stop domain type ${p}`)]}else p=pe;if("number"!==pe&&"string"!==pe&&"boolean"!==pe)return[new g(ie.key,Te,"stop domain value must be a number, string, or boolean")];if("number"!==pe&&"categorical"!==u){let Pe=`number expected, ${pe} found`;return Zi(r)&&void 0===u&&(Pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new g(ie.key,Te,Pe)]}return"categorical"!==u||"number"!==pe||isFinite(Ce)&&Math.floor(Ce)===Ce?"categorical"!==u&&"number"===pe&&void 0!==y&&Ce<y?[new g(ie.key,Te,"stop domain values must appear in ascending order")]:(y=Ce,"categorical"===u&&Ce in E?[new g(ie.key,Te,"stop domain values must be unique")]:(E[Ce]=!0,[])):[new g(ie.key,Te,`integer expected, found ${Ce}`)]}}function Sl(c){const r=("property"===c.expressionContext?lu:ds)(T(c.value),c.valueSpec);if("error"===r.result)return r.value.map(p=>new g(`${c.key}${p.key}`,c.value,p.message));const u=r.value.expression||r.value._styleExpression.expression;if("property"===c.expressionContext&&"text-font"===c.propertyKey&&!u.outputDefined())return[new g(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===c.expressionContext&&"layout"===c.propertyType&&!Vo(u))return[new g(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===c.expressionContext)return mp(u,c);if(c.expressionContext&&0===c.expressionContext.indexOf("cluster")){if(!Mn(u,["zoom","feature-state"]))return[new g(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===c.expressionContext&&!fc(u))return[new g(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function mp(c,r){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);for(const y of r.valueSpec.expression.parameters)u.delete(y);if(0===u.size)return[];const p=[];return c instanceof gi&&u.has(c.name)?[new g(r.key,r.value,`["${c.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(c.eachChild(y=>{p.push(...mp(y,r))}),p)}function cu(c){const r=c.key,u=c.value,p=c.valueSpec,y=[];return Array.isArray(p.values)?-1===p.values.indexOf(C(u))&&y.push(new g(r,u,`expected one of [${p.values.join(", ")}], ${JSON.stringify(u)} found`)):-1===Object.keys(p.values).indexOf(C(u))&&y.push(new g(r,u,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(u)} found`)),y}function Xh(c){if(!0===c||!1===c)return!0;if(!Array.isArray(c)||0===c.length)return!1;switch(c[0]){case"has":return c.length>=2&&"$id"!==c[1]&&"$type"!==c[1];case"in":return c.length>=3&&("string"!=typeof c[1]||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==c.length||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const r of c.slice(1))if(!Xh(r)&&"boolean"!=typeof r)return!1;return!0;default:return!0}}function Wu(c,r="fill"){if(null==c)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Xh(c)||(c=Yh(c));const u=c;let p=!0;try{p=function(z){if(!Cc(z))return z;let j=T(z);return wc(j),j=yp(j),j}(u)}catch(z){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(u,null,2)}\n        `)}const y=d[`filter_${r}`],b=ds(p,y);let E=null;if("error"===b.result)throw new Error(b.value.map(z=>`${z.key}: ${z.message}`).join(", "));E=(z,j,W)=>b.value.evaluate(z,j,{},W);let k=null,N=null;if(p!==u){const z=ds(u,y);if("error"===z.result)throw new Error(z.value.map(j=>`${j.key}: ${j.message}`).join(", "));k=(j,W,Y,ie,ce)=>z.value.evaluate(j,W,{},Y,void 0,void 0,ie,ce),N=!fc(z.value.expression)}return E=E,{filter:E,dynamicFilter:k||void 0,needGeometry:vp(p),needFeature:!!N}}function yp(c){if(!Array.isArray(c))return c;const r=function(u){if(hg.has(u[0]))for(let p=1;p<u.length;p++)if(Cc(u[p]))return!0;return u}(c);return!0===r?r:r.map(u=>yp(u))}function wc(c){let r=!1;const u=[];if("case"===c[0]){for(let p=1;p<c.length-1;p+=2)r=r||Cc(c[p]),u.push(c[p+1]);u.push(c[c.length-1])}else if("match"===c[0]){r=r||Cc(c[1]);for(let p=2;p<c.length-1;p+=2)u.push(c[p+1]);u.push(c[c.length-1])}else if("step"===c[0]){r=r||Cc(c[1]);for(let p=1;p<c.length-1;p+=2)u.push(c[p+1])}r&&(c.length=0,c.push("any",...u));for(let p=1;p<c.length;p++)wc(c[p])}function Cc(c){if(!Array.isArray(c))return!1;if("pitch"===(r=c[0])||"distance-from-center"===r)return!0;var r;for(let u=1;u<c.length;u++)if(Cc(c[u]))return!0;return!1}const hg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function _p(c,r){return c<r?-1:c>r?1:0}function vp(c){if(!Array.isArray(c))return!1;if("within"===c[0])return!0;for(let r=1;r<c.length;r++)if(vp(c[r]))return!0;return!1}function Yh(c){if(!c)return!0;const r=c[0];return c.length<=1?"any"!==r:"=="===r?uu(c[1],c[2],"=="):"!="===r?Sc(uu(c[1],c[2],"==")):"<"===r||">"===r||"<="===r||">="===r?uu(c[1],c[2],r):"any"===r?(u=c.slice(1),["any"].concat(u.map(Yh))):"all"===r?["all"].concat(c.slice(1).map(Yh)):"none"===r?["all"].concat(c.slice(1).map(Yh).map(Sc)):"in"===r?dg(c[1],c.slice(2)):"!in"===r?Sc(dg(c[1],c.slice(2))):"has"===r?qh(c[1]):"!has"===r?Sc(qh(c[1])):"within"!==r||c;var u}function uu(c,r,u){switch(c){case"$type":return[`filter-type-${u}`,r];case"$id":return[`filter-id-${u}`,r];default:return[`filter-${u}`,c,r]}}function dg(c,r){if(0===r.length)return!1;switch(c){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(u=>typeof u!=typeof r[0])?["filter-in-large",c,["literal",r.sort(_p)]]:["filter-in-small",c,["literal",r]]}}function qh(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Sc(c){return["!",c]}function xp(c){if(Xh(T(c.value))){const r=T(c.layerType);return Sl(D({},c,{expressionContext:"filter",valueSpec:c.styleSpec[`filter_${r||"fill"}`]}))}return pg(c)}function pg(c){const r=c.value,u=c.key;if("array"!==hn(r))return[new g(u,r,`array expected, ${hn(r)} found`)];const p=c.styleSpec;let y,b=[];if(r.length<1)return[new g(u,r,"filter array must have at least 1 element")];switch(b=b.concat(cu({key:`${u}[0]`,value:r[0],valueSpec:p.filter_operator,style:c.style,styleSpec:c.styleSpec})),C(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===C(r[1])&&b.push(new g(u,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":3!==r.length&&b.push(new g(u,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(y=hn(r[1]),"string"!==y&&b.push(new g(`${u}[1]`,r[1],`string expected, ${y} found`)));for(let E=2;E<r.length;E++)y=hn(r[E]),"$type"===C(r[1])?b=b.concat(cu({key:`${u}[${E}]`,value:r[E],valueSpec:p.geometry_type,style:c.style,styleSpec:c.styleSpec})):"string"!==y&&"number"!==y&&"boolean"!==y&&b.push(new g(`${u}[${E}]`,r[E],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let E=1;E<r.length;E++)b=b.concat(pg({key:`${u}[${E}]`,value:r[E],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":y=hn(r[1]),2!==r.length?b.push(new g(u,r,`filter array for "${r[0]}" operator must have 2 elements`)):"string"!==y&&b.push(new g(`${u}[1]`,r[1],`string expected, ${y} found`));break;case"within":y=hn(r[1]),2!==r.length?b.push(new g(u,r,`filter array for "${r[0]}" operator must have 2 elements`)):"object"!==y&&b.push(new g(`${u}[1]`,r[1],`object expected, ${y} found`))}return b}function Xu(c,r){const u=c.key,p=c.style,y=c.styleSpec,b=c.value,E=c.objectKey,k=y[`${r}_${c.layerType}`];if(!k)return[];const N=E.match(/^(.*)-transition$/);if("paint"===r&&N&&k[N[1]]&&k[N[1]].transition)return Yr({key:u,value:b,valueSpec:y.transition,style:p,styleSpec:y});const z=c.valueSpec||k[E];if(!z)return[new g(u,b,`unknown property "${E}"`)];let j;if("string"===hn(b)&&Zi(z)&&!z.tokens&&(j=/^{([^}]+)}$/.exec(b)))return[new g(u,b,`"${E}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(j[1])} }\`.`)];const W=[];return"symbol"===c.layerType&&("text-field"===E&&p&&!p.glyphs&&W.push(new g(u,b,'use of "text-field" requires a style "glyphs" property')),"text-font"===E&&li(T(b))&&"identity"===C(b.type)&&W.push(new g(u,b,'"text-font" does not support identity functions'))),W.concat(Yr({key:c.key,value:b,valueSpec:z,style:p,styleSpec:y,expressionContext:"property",propertyType:r,propertyKey:E}))}function Go(c){return Xu(c,"paint")}function ps(c){return Xu(c,"layout")}function In(c){let r=[];const u=c.value,p=c.key,y=c.style,b=c.styleSpec;u.type||u.ref||r.push(new g(p,u,'either "type" or "ref" is required'));let E=C(u.type);const k=C(u.ref);if(u.id){const N=C(u.id);for(let z=0;z<c.arrayIndex;z++){const j=y.layers[z];C(j.id)===N&&r.push(new g(p,u.id,`duplicate layer id "${u.id}", previously used at line ${j.id.__line__}`))}}if("ref"in u){let N;["type","source","source-layer","filter","layout"].forEach(z=>{z in u&&r.push(new g(p,u[z],`"${z}" is prohibited for ref layers`))}),y.layers.forEach(z=>{C(z.id)===k&&(N=z)}),N?N.ref?r.push(new g(p,u.ref,"ref cannot reference another ref layer")):E=C(N.type):r.push(new g(p,u.ref,`ref layer "${k}" not found`))}else if("background"!==E&&"sky"!==E)if(u.source){const N=y.sources&&y.sources[u.source],z=N&&C(N.type);N?"vector"===z&&"raster"===E?r.push(new g(p,u.source,`layer "${u.id}" requires a raster source`)):"raster"===z&&"raster"!==E?r.push(new g(p,u.source,`layer "${u.id}" requires a vector source`)):"vector"!==z||u["source-layer"]?"raster-dem"===z&&"hillshade"!==E?r.push(new g(p,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==E||!u.paint||!u.paint["line-gradient"]||"geojson"===z&&N.lineMetrics||r.push(new g(p,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new g(p,u,`layer "${u.id}" must specify a "source-layer"`)):r.push(new g(p,u.source,`source "${u.source}" not found`))}else r.push(new g(p,u,'missing required property "source"'));return r=r.concat(_o({key:p,value:u,valueSpec:b.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Yr({key:`${p}.type`,value:u.type,valueSpec:b.layer.type,style:c.style,styleSpec:c.styleSpec,object:u,objectKey:"type"}),filter:N=>xp(D({layerType:E},N)),layout:N=>_o({layer:u,key:N.key,value:N.value,style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":z=>ps(D({layerType:E},z))}}),paint:N=>_o({layer:u,key:N.key,value:N.value,style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":z=>Go(D({layerType:E},z))}})}})),r}function Dl(c){const r=c.value,u=c.key,p=hn(r);return"string"!==p?[new g(u,r,`string expected, ${p} found`)]:[]}const bp={promoteId:function({key:c,value:r}){if("string"===hn(r))return Dl({key:c,value:r});{const u=[];for(const p in r)u.push(...Dl({key:`${c}.${p}`,value:r[p]}));return u}}};function wp(c){const r=c.value,u=c.key,p=c.styleSpec,y=c.style;if(!r.type)return[new g(u,r,'"type" is required')];const b=C(r.type);let E;switch(b){case"vector":case"raster":case"raster-dem":return E=_o({key:u,value:r,valueSpec:p[`source_${b.replace("-","_")}`],style:c.style,styleSpec:p,objectElementValidators:bp}),E;case"geojson":if(E=_o({key:u,value:r,valueSpec:p.source_geojson,style:y,styleSpec:p,objectElementValidators:bp}),r.cluster)for(const k in r.clusterProperties){const[N,z]=r.clusterProperties[k],j="string"==typeof N?[N,["accumulated"],["get",k]]:N;E.push(...Sl({key:`${u}.${k}.map`,value:z,expressionContext:"cluster-map"})),E.push(...Sl({key:`${u}.${k}.reduce`,value:j,expressionContext:"cluster-reduce"}))}return E;case"video":return _o({key:u,value:r,valueSpec:p.source_video,style:y,styleSpec:p});case"image":return _o({key:u,value:r,valueSpec:p.source_image,style:y,styleSpec:p});case"canvas":return[new g(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return cu({key:`${u}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:y,styleSpec:p})}}function Zh(c){const r=c.value,u=c.styleSpec,p=u.light,y=c.style;let b=[];const E=hn(r);if(void 0===r)return b;if("object"!==E)return b=b.concat([new g("light",r,`object expected, ${E} found`)]),b;for(const k in r){const N=k.match(/^(.*)-transition$/);b=b.concat(N&&p[N[1]]&&p[N[1]].transition?Yr({key:k,value:r[k],valueSpec:u.transition,style:y,styleSpec:u}):p[k]?Yr({key:k,value:r[k],valueSpec:p[k],style:y,styleSpec:u}):[new g(k,r[k],`unknown property "${k}"`)])}return b}function hu(c){const r=c.value,u=c.key,p=c.style,y=c.styleSpec,b=y.terrain;let E=[];const k=hn(r);if(void 0===r)return E;if("object"!==k)return E=E.concat([new g("terrain",r,`object expected, ${k} found`)]),E;for(const N in r){const z=N.match(/^(.*)-transition$/);E=E.concat(z&&b[z[1]]&&b[z[1]].transition?Yr({key:N,value:r[N],valueSpec:y.transition,style:p,styleSpec:y}):b[N]?Yr({key:N,value:r[N],valueSpec:b[N],style:p,styleSpec:y}):[new g(N,r[N],`unknown property "${N}"`)])}if(r.source){const N=p.sources&&p.sources[r.source],z=N&&C(N.type);N?"raster-dem"!==z&&E.push(new g(u,r.source,`terrain cannot be used with a source of type ${z}, it only be used with a "raster-dem" source type`)):E.push(new g(u,r.source,`source "${r.source}" not found`))}else E.push(new g(u,r,'terrain is missing required property "source"'));return E}function Cp(c){const r=c.value,u=c.style,p=c.styleSpec,y=p.fog;let b=[];const E=hn(r);if(void 0===r)return b;if("object"!==E)return b=b.concat([new g("fog",r,`object expected, ${E} found`)]),b;for(const k in r){const N=k.match(/^(.*)-transition$/);b=b.concat(N&&y[N[1]]&&y[N[1]].transition?Yr({key:k,value:r[k],valueSpec:p.transition,style:u,styleSpec:p}):y[k]?Yr({key:k,value:r[k],valueSpec:y[k],style:u,styleSpec:p}):[new g(k,r[k],`unknown property "${k}"`)])}return b}const Dc={"*":()=>[],array:Gh,boolean:function(c){const r=c.value,u=c.key,p=hn(r);return"boolean"!==p?[new g(u,r,`boolean expected, ${p} found`)]:[]},number:Wh,color:function(c){const r=c.key,u=c.value,p=hn(u);return"string"!==p?[new g(r,u,`color expected, ${p} found`)]:null===pt.parseCSSColor(u)?[new g(r,u,`color expected, "${u}" found`)]:[]},constants:_,enum:cu,filter:xp,function:Gu,layer:In,object:_o,source:wp,light:Zh,terrain:hu,fog:Cp,string:Dl,formatted:function(c){return 0===Dl(c).length?[]:Sl(c)},resolvedImage:function(c){return 0===Dl(c).length?[]:Sl(c)},projection:function(c){const r=c.value,u=c.styleSpec,p=u.projection,y=c.style;let b=[];const E=hn(r);if("object"===E)for(const k in r)b=b.concat(Yr({key:k,value:r[k],valueSpec:p[k],style:y,styleSpec:u}));else"string"!==E&&(b=b.concat([new g("projection",r,`object or string expected, ${E} found`)]));return b}};function Yr(c){const r=c.value,u=c.valueSpec,p=c.styleSpec;return u.expression&&li(C(r))?Gu(c):u.expression&&$o(T(r))?Sl(c):u.type&&Dc[u.type]?Dc[u.type](c):_o(D({},c,{valueSpec:u.type?p[u.type]:u}))}function vo(c){const r=c.value,u=c.key,p=Dl(c);return p.length||(-1===r.indexOf("{fontstack}")&&p.push(new g(u,r,'"glyphs" url must include a "{fontstack}" token')),-1===r.indexOf("{range}")&&p.push(new g(u,r,'"glyphs" url must include a "{range}" token'))),p}function xo(c,r=d){let u=[];return u=u.concat(Yr({key:"",value:c,valueSpec:r.$root,styleSpec:r,style:c,objectElementValidators:{glyphs:vo,"*":()=>[]}})),c.constants&&(u=u.concat(_({key:"constants",value:c.constants,style:c,styleSpec:r}))),Jh(u)}function Jh(c){return[].concat(c).sort((r,u)=>r.line-u.line)}function Wo(c){return function(...r){return Jh(c.apply(this,r))}}xo.source=Wo(wp),xo.light=Wo(Zh),xo.terrain=Wo(hu),xo.fog=Wo(Cp),xo.layer=Wo(In),xo.filter=Wo(xp),xo.paintProperty=Wo(Go),xo.layoutProperty=Wo(ps);const El=xo,Kh=El.light,Sp=El.fog,Ii=El.paintProperty,Qh=El.layoutProperty;function Dp(c,r){let u=!1;if(r&&r.length)for(const p of r)c.fire(new o(new Error(p.message))),u=!0;return u}var Pi=pa;function pa(c,r,u){var p=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var y=new Int32Array(this.arrayBuffer);c=y[0],this.d=(r=y[1])+2*(u=y[2]);for(var b=0;b<this.d*this.d;b++){var E=y[3+b],k=y[3+b+1];p.push(E===k?null:y.subarray(E,k))}var N=y[3+p.length+1];this.keys=y.subarray(y[3+p.length],N),this.bboxes=y.subarray(N),this.insert=this._insertReadonly}else{this.d=r+2*u;for(var z=0;z<this.d*this.d;z++)p.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=c,this.padding=u,this.scale=r/c,this.uid=0;var j=u/r*c;this.min=-j,this.max=c+j}pa.prototype.insert=function(c,r,u,p,y){this._forEachCell(r,u,p,y,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(y)},pa.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},pa.prototype._insertCell=function(c,r,u,p,y,b){this.cells[y].push(b)},pa.prototype.query=function(c,r,u,p,y){var b=this.min,E=this.max;if(c<=b&&r<=b&&E<=u&&E<=p&&!y)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(c,r,u,p,this._queryCell,k,{},y),k},pa.prototype._queryCell=function(c,r,u,p,y,b,E,k){var N=this.cells[y];if(null!==N)for(var z=this.keys,j=this.bboxes,W=0;W<N.length;W++){var Y=N[W];if(void 0===E[Y]){var ie=4*Y;(k?k(j[ie+0],j[ie+1],j[ie+2],j[ie+3]):c<=j[ie+2]&&r<=j[ie+3]&&u>=j[ie+0]&&p>=j[ie+1])?(E[Y]=!0,b.push(z[Y])):E[Y]=!1}}},pa.prototype._forEachCell=function(c,r,u,p,y,b,E,k){for(var N=this._convertToCellCoord(c),z=this._convertToCellCoord(r),j=this._convertToCellCoord(u),W=this._convertToCellCoord(p),Y=N;Y<=j;Y++)for(var ie=z;ie<=W;ie++){var ce=this.d*ie+Y;if((!k||k(this._convertFromCellCoord(Y),this._convertFromCellCoord(ie),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(ie+1)))&&y.call(this,c,r,u,p,ce,b,E,k))return}},pa.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},pa.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},pa.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,r=3+this.cells.length+1+1,u=0,p=0;p<this.cells.length;p++)u+=this.cells[p].length;var y=new Int32Array(r+u+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var b=r,E=0;E<c.length;E++){var k=c[E];y[3+E]=b,y.set(k,b),b+=k.length}return y[3+c.length]=b,y.set(this.keys,b),y[3+c.length+1]=b+=this.keys.length,y.set(this.bboxes,b),b+=this.bboxes.length,y.buffer};const{ImageData:ed,ImageBitmap:du}=$t,qr={};function Bt(c,r,u={}){Object.defineProperty(r,"_classRegistryKey",{value:c,writeable:!1}),qr[c]={klass:r,omit:u.omit||[],shallow:u.shallow||[]}}Bt("Object",Object),Pi.serialize=function(c,r){const u=c.toArrayBuffer();return r&&r.push(u),{buffer:u}},Pi.deserialize=function(c){return new Pi(c.buffer)},Bt("Grid",Pi),Bt("Color",qe),Bt("Error",Error),Bt("ResolvedImage",xi),Bt("StylePropertyFunction",Ta),Bt("StyleExpression",Dr,{omit:["_evaluator"]}),Bt("ZoomDependentExpression",bc),Bt("ZoomConstantExpression",Er),Bt("CompoundExpression",gi,{omit:["_evaluate"]});for(const c in jo)jo[c]._classRegistryKey||Bt(`Expression_${c}`,jo[c]);function Yu(c){return c&&"undefined"!=typeof ArrayBuffer&&(c instanceof ArrayBuffer||c.constructor&&"ArrayBuffer"===c.constructor.name)}function Xa(c){return du&&c instanceof du}function Br(c,r){if(null==c||"boolean"==typeof c||"number"==typeof c||"string"==typeof c||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Yu(c)||Xa(c))return r&&r.push(c),c;if(ArrayBuffer.isView(c)){const u=c;return r&&r.push(u.buffer),u}if(c instanceof ed)return r&&r.push(c.data.buffer),c;if(Array.isArray(c)){const u=[];for(const p of c)u.push(Br(p,r));return u}if("object"==typeof c){const u=c.constructor,p=u._classRegistryKey;if(!p)throw new Error("can't serialize object of unregistered class");const y=u.serialize?u.serialize(c,r):{};if(!u.serialize){for(const b in c){if(!c.hasOwnProperty(b)||qr[p].omit.indexOf(b)>=0)continue;const E=c[b];y[b]=qr[p].shallow.indexOf(b)>=0?E:Br(E,r)}c instanceof Error&&(y.message=c.message)}if(y.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==p&&(y.$name=p),y}throw new Error("can't serialize object of type "+typeof c)}function Ec(c){if(null==c||"boolean"==typeof c||"number"==typeof c||"string"==typeof c||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Yu(c)||Xa(c)||ArrayBuffer.isView(c)||c instanceof ed)return c;if(Array.isArray(c))return c.map(Ec);if("object"==typeof c){const r=c.$name||"Object",{klass:u}=qr[r];if(!u)throw new Error(`can't deserialize unregistered class ${r}`);if(u.deserialize)return u.deserialize(c);const p=Object.create(u.prototype);for(const y of Object.keys(c)){if("$name"===y)continue;const b=c[y];p[y]=qr[r].shallow.indexOf(y)>=0?b:Ec(b)}return p}throw new Error("can't deserialize object of type "+typeof c)}class qu{constructor(){this.first=!0}update(r,u){const p=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=u),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=p,!0))}}const Ep=c=>c>=1536&&c<=1791,Ma=c=>c>=1872&&c<=1919,td=c=>c>=2208&&c<=2303,Zu=c=>c>=11904&&c<=12031,en=c=>c>=12032&&c<=12255,fg=c=>c>=12272&&c<=12287,Ju=c=>c>=12288&&c<=12351,Ac=c=>c>=12352&&c<=12447,Ku=c=>c>=12448&&c<=12543,Qu=c=>c>=12544&&c<=12591,Ap=c=>c>=12704&&c<=12735,nd=c=>c>=12736&&c<=12783,bt=c=>c>=12784&&c<=12799,zn=c=>c>=12800&&c<=13055,qn=c=>c>=13056&&c<=13311,$i=c=>c>=13312&&c<=19903,Tc=c=>c>=19968&&c<=40959,Mc=c=>c>=40960&&c<=42127,Xo=c=>c>=42128&&c<=42191,Al=c=>c>=44032&&c<=55215,eh=c=>c>=63744&&c<=64255,Tl=c=>c>=64336&&c<=65023,Tp=c=>c>=65040&&c<=65055,Ya=c=>c>=65072&&c<=65103,pu=c=>c>=65104&&c<=65135,Vr=c=>c>=65136&&c<=65279,Yo=c=>c>=65280&&c<=65519;function ka(c){for(const r of c)if(id(r.charCodeAt(0)))return!0;return!1}function Ia(c){for(const r of c)if(!qs(r.charCodeAt(0)))return!1;return!0}function qs(c){return!(Ep(c)||Ma(c)||td(c)||Tl(c)||Vr(c))}function id(c){return!(746!==c&&747!==c&&(c<4352||!(Ap(c)||Qu(c)||Ya(c)&&!(c>=65097&&c<=65103)||eh(c)||qn(c)||Zu(c)||nd(c)||!(!Ju(c)||c>=12296&&c<=12305||c>=12308&&c<=12319||12336===c)||$i(c)||Tc(c)||zn(c)||(r=c,r>=12592&&r<=12687)||(r=>r>=43360&&r<=43391)(c)||(r=>r>=55216&&r<=55295)(c)||(r=>r>=4352&&r<=4607)(c)||Al(c)||Ac(c)||fg(c)||(r=>r>=12688&&r<=12703)(c)||en(c)||bt(c)||Ku(c)&&12540!==c||!(!Yo(c)||65288===c||65289===c||65293===c||c>=65306&&c<=65310||65339===c||65341===c||65343===c||c>=65371&&c<=65503||65507===c||c>=65512&&c<=65519)||!(!pu(c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||(r=>r>=5120&&r<=5759)(c)||(r=>r>=6320&&r<=6399)(c)||Tp(c)||(r=>r>=19904&&r<=19967)(c)||Mc(c)||Xo(c))));var r}function th(c){return!(id(c)||(r=c,(u=r)>=128&&u<=255&&(167===r||169===r||174===r||177===r||188===r||189===r||190===r||215===r||247===r)||(u=>u>=8192&&u<=8303)(r)&&(8214===r||8224===r||8225===r||8240===r||8241===r||8251===r||8252===r||8258===r||8263===r||8264===r||8265===r||8273===r)||(u=>u>=8448&&u<=8527)(r)||(u=>u>=8528&&u<=8591)(r)||(u=>u>=8960&&u<=9215)(r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||9003===r||r>=9085&&r<=9114||r>=9150&&r<=9165||9167===r||r>=9169&&r<=9179||r>=9186&&r<=9215)||(u=>u>=9216&&u<=9279)(r)&&9251!==r||(u=>u>=9280&&u<=9311)(r)||(u=>u>=9312&&u<=9471)(r)||(u=>u>=9632&&u<=9727)(r)||(u=>u>=9728&&u<=9983)(r)&&!(r>=9754&&r<=9759)||(u=>u>=11008&&u<=11263)(r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Ju(r)||Ku(r)||(u=>u>=57344&&u<=63743)(r)||Ya(r)||pu(r)||Yo(r)||8734===r||8756===r||8757===r||r>=9984&&r<=10087||r>=10102&&r<=10131||65532===r||65533===r));var r,u}function kc(c){return c>=1424&&c<=2303||Tl(c)||Vr(c)}function gg(c,r){return!(!r&&kc(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||(u=c,u>=6016&&u<=6143));var u}function rd(c){for(const r of c)if(kc(r.charCodeAt(0)))return!0;return!1}const qa="deferred",x="loading",l="loaded";let f=null,w="unavailable",A=null;const M=function(c){c&&"string"==typeof c&&c.indexOf("NetworkError")>-1&&(w="error"),f&&f(c)};function O(){U.fire(new te("pluginStateChange",{pluginStatus:w,pluginURL:A}))}const U=new a,X=function(){return w},Z=function(){if(w!==qa||!A)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");w=x,O(),A&&ue({url:A},c=>{c?M(c):(w=l,O())})},ee={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>w===l||null!=ee.applyArabicShaping,isLoading:()=>w===x,setState(c){w=c.pluginStatus,A=c.pluginURL},isParsed:()=>null!=ee.applyArabicShaping&&null!=ee.processBidirectionalText&&null!=ee.processStyledBidirectionalText,getPluginURL:()=>A};class ne{constructor(r,u){this.zoom=r,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.zoomHistory=u.zoomHistory,this.transition=u.transition,this.pitch=u.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new qu,this.transition={},this.pitch=0)}isSupportedScript(r){return function(u,p){for(const y of u)if(!gg(y.charCodeAt(0),p))return!1;return!0}(r,ee.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,u=r-Math.floor(r),p=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*u}}}class de{constructor(r,u){this.property=r,this.value=u,this.expression=function(p,y){if(li(p))return new Ta(p,y);if($o(p)){const b=lu(p,y);if("error"===b.result)throw new Error(b.value.map(E=>`${E.key}: ${E.message}`).join(", "));return b.value}{let b=p;return"string"==typeof p&&"color"===y.type&&(b=qe.parse(p)),{kind:"constant",evaluate:()=>b}}}(void 0===u?r.specification.default:u,r.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(r,u,p){return this.property.possiblyEvaluate(this,r,u,p)}}class ye{constructor(r){this.property=r,this.value=new de(r,void 0)}transitioned(r,u){return new _e(this.property,this.value,u,Mi({},r.transition,this.transition),r.now)}untransitioned(){return new _e(this.property,this.value,null,{},0)}}class me{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return ir(this._values[r].value.value)}setValue(r,u){this._values.hasOwnProperty(r)||(this._values[r]=new ye(this._values[r].property)),this._values[r].value=new de(this._values[r].property,null===u?void 0:ir(u))}getTransition(r){return ir(this._values[r].transition)}setTransition(r,u){this._values.hasOwnProperty(r)||(this._values[r]=new ye(this._values[r].property)),this._values[r].transition=ir(u)||void 0}serialize(){const r={};for(const u of Object.keys(this._values)){const p=this.getValue(u);void 0!==p&&(r[u]=p);const y=this.getTransition(u);void 0!==y&&(r[`${u}-transition`]=y)}return r}transitioned(r,u){const p=new De(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].transitioned(r,u._values[y]);return p}untransitioned(){const r=new De(this._properties);for(const u of Object.keys(this._values))r._values[u]=this._values[u].untransitioned();return r}}class _e{constructor(r,u,p,y,b){const E=y.delay||0,k=y.duration||0;b=b||0,this.property=r,this.value=u,this.begin=b+E,this.end=this.begin+k,r.specification.transition&&(y.delay||y.duration)&&(this.prior=p)}possiblyEvaluate(r,u,p){const y=r.now||0,b=this.value.possiblyEvaluate(r,u,p),E=this.prior;if(E){if(y>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(y<this.begin)return E.possiblyEvaluate(r,u,p);{const k=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(r,u,p),b,mr(k))}}return b}}class De{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,u,p){const y=new Me(this._properties);for(const b of Object.keys(this._values))y._values[b]=this._values[b].possiblyEvaluate(r,u,p);return y}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class ve{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}getValue(r){return ir(this._values[r].value)}setValue(r,u){this._values[r]=new de(this._values[r].property,null===u?void 0:ir(u))}serialize(){const r={};for(const u of Object.keys(this._values)){const p=this.getValue(u);void 0!==p&&(r[u]=p)}return r}possiblyEvaluate(r,u,p){const y=new Me(this._properties);for(const b of Object.keys(this._values))y._values[b]=this._values[b].possiblyEvaluate(r,u,p);return y}}class Ee{constructor(r,u,p){this.property=r,this.value=u,this.parameters=p}isConstant(){return"constant"===this.value.kind}constantOr(r){return"constant"===this.value.kind?this.value.value:r}evaluate(r,u,p,y){return this.property.evaluate(this.value,this.parameters,r,u,p,y)}}class Me{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class be{constructor(r){this.specification=r}possiblyEvaluate(r,u){return r.expression.evaluate(u)}interpolate(r,u,p){const y=ru[this.specification.type];return y?y(r,u,p):r}}class ke{constructor(r,u){this.specification=r,this.overrides=u}possiblyEvaluate(r,u,p,y){return new Ee(this,"constant"===r.expression.kind||"camera"===r.expression.kind?{kind:"constant",value:r.expression.evaluate(u,null,{},p,y)}:r.expression,u)}interpolate(r,u,p){if("constant"!==r.value.kind||"constant"!==u.value.kind)return r;if(void 0===r.value.value||void 0===u.value.value)return new Ee(this,{kind:"constant",value:void 0},r.parameters);const y=ru[this.specification.type];return y?new Ee(this,{kind:"constant",value:y(r.value.value,u.value.value,p)},r.parameters):r}evaluate(r,u,p,y,b,E){return"constant"===r.kind?r.value:r.evaluate(u,p,y,b,E)}}class Fe extends ke{possiblyEvaluate(r,u,p,y){if(void 0===r.value)return new Ee(this,{kind:"constant",value:void 0},u);if("constant"===r.expression.kind){const b=r.expression.evaluate(u,null,{},p,y),E="resolvedImage"===r.property.specification.type&&"string"!=typeof b?b.name:b,k=this._calculate(E,E,E,u);return new Ee(this,{kind:"constant",value:k},u)}if("camera"===r.expression.kind){const b=this._calculate(r.expression.evaluate({zoom:u.zoom-1}),r.expression.evaluate({zoom:u.zoom}),r.expression.evaluate({zoom:u.zoom+1}),u);return new Ee(this,{kind:"constant",value:b},u)}return new Ee(this,r.expression,u)}evaluate(r,u,p,y,b,E){if("source"===r.kind){const k=r.evaluate(u,p,y,b,E);return this._calculate(k,k,k,u)}return"composite"===r.kind?this._calculate(r.evaluate({zoom:Math.floor(u.zoom)-1},p,y),r.evaluate({zoom:Math.floor(u.zoom)},p,y),r.evaluate({zoom:Math.floor(u.zoom)+1},p,y),u):r.value}_calculate(r,u,p,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:r,to:u,other:p}:{from:p,to:u,other:r}}interpolate(r){return r}}class Qe{constructor(r){this.specification=r}possiblyEvaluate(r,u,p,y){if(void 0!==r.value){if("constant"===r.expression.kind){const b=r.expression.evaluate(u,null,{},p,y);return this._calculate(b,b,b,u)}return this._calculate(r.expression.evaluate(new ne(Math.floor(u.zoom-1),u)),r.expression.evaluate(new ne(Math.floor(u.zoom),u)),r.expression.evaluate(new ne(Math.floor(u.zoom+1),u)),u)}}_calculate(r,u,p,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:r,to:u}:{from:p,to:u}}interpolate(r){return r}}class Ke{constructor(r){this.specification=r}possiblyEvaluate(r,u,p,y){return!!r.expression.evaluate(u,null,{},p,y)}interpolate(){return!1}}class rt{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const u in r){const p=r[u];p.specification.overridable&&this.overridableProperties.push(u);const y=this.defaultPropertyValues[u]=new de(p,void 0),b=this.defaultTransitionablePropertyValues[u]=new ye(p);this.defaultTransitioningPropertyValues[u]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=y.possiblyEvaluate({})}}}function st(c,r){return 256*(c=On(Math.floor(c),0,255))+On(Math.floor(r),0,255)}Bt("DataDrivenProperty",ke),Bt("DataConstantProperty",be),Bt("CrossFadedDataDrivenProperty",Fe),Bt("CrossFadedProperty",Qe),Bt("ColorRampProperty",Ke);const _t={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class it{constructor(r,u){this._structArray=r,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class At{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,u){return r._trim(),u&&(r.isTransferred=!0,u.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const u=Object.create(this.prototype);return u.arrayBuffer=r.arrayBuffer,u.length=r.length,u.capacity=r.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ye(c,r=1){let u=0,p=0;return{members:c.map(y=>{const b=_t[y.type].BYTES_PER_ELEMENT,E=u=Et(u,Math.max(r,b)),k=y.components||1;return p=Math.max(p,b),u+=b*k,{name:y.name,type:y.type,components:k,offset:E}}),size:Et(u,Math.max(p,r)),alignment:r}}function Et(c,r){return Math.ceil(c/r)*r}class Lt extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,u){const p=this.length;return this.resize(p+1),this.emplace(p,r,u)}emplace(r,u,p){const y=2*r;return this.int16[y+0]=u,this.int16[y+1]=p,r}}Lt.prototype.bytesPerElement=4,Bt("StructArrayLayout2i4",Lt);class Yt extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,u,p,y){const b=this.length;return this.resize(b+1),this.emplace(b,r,u,p,y)}emplace(r,u,p,y,b){const E=4*r;return this.int16[E+0]=u,this.int16[E+1]=p,this.int16[E+2]=y,this.int16[E+3]=b,r}}Yt.prototype.bytesPerElement=8,Bt("StructArrayLayout4i8",Yt);class Zt extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,u,p,y,b,E,k){const N=this.length;return this.resize(N+1),this.emplace(N,r,u,p,y,b,E,k)}emplace(r,u,p,y,b,E,k,N){const z=6*r,j=12*r,W=3*r;return this.int16[z+0]=u,this.int16[z+1]=p,this.uint8[j+4]=y,this.uint8[j+5]=b,this.uint8[j+6]=E,this.uint8[j+7]=k,this.float32[W+2]=N,r}}Zt.prototype.bytesPerElement=12,Bt("StructArrayLayout2i4ub1f12",Zt);class tn extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,u,p){const y=this.length;return this.resize(y+1),this.emplace(y,r,u,p)}emplace(r,u,p,y){const b=3*r;return this.float32[b+0]=u,this.float32[b+1]=p,this.float32[b+2]=y,r}}tn.prototype.bytesPerElement=12,Bt("StructArrayLayout3f12",tn);class nn extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,u,p,y,b,E,k,N,z,j){const W=this.length;return this.resize(W+1),this.emplace(W,r,u,p,y,b,E,k,N,z,j)}emplace(r,u,p,y,b,E,k,N,z,j,W){const Y=10*r;return this.uint16[Y+0]=u,this.uint16[Y+1]=p,this.uint16[Y+2]=y,this.uint16[Y+3]=b,this.uint16[Y+4]=E,this.uint16[Y+5]=k,this.uint16[Y+6]=N,this.uint16[Y+7]=z,this.uint16[Y+8]=j,this.uint16[Y+9]=W,r}}nn.prototype.bytesPerElement=20,Bt("StructArrayLayout10ui20",nn);class Gt extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,u,p,y,b,E,k,N){const z=this.length;return this.resize(z+1),this.emplace(z,r,u,p,y,b,E,k,N)}emplace(r,u,p,y,b,E,k,N,z){const j=8*r;return this.uint16[j+0]=u,this.uint16[j+1]=p,this.uint16[j+2]=y,this.uint16[j+3]=b,this.uint16[j+4]=E,this.uint16[j+5]=k,this.uint16[j+6]=N,this.uint16[j+7]=z,r}}Gt.prototype.bytesPerElement=16,Bt("StructArrayLayout8ui16",Gt);class sn extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce,pe,Ce){const Te=this.length;return this.resize(Te+1),this.emplace(Te,r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce,pe,Ce)}emplace(r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce,pe,Ce,Te){const Pe=16*r;return this.int16[Pe+0]=u,this.int16[Pe+1]=p,this.int16[Pe+2]=y,this.int16[Pe+3]=b,this.uint16[Pe+4]=E,this.uint16[Pe+5]=k,this.uint16[Pe+6]=N,this.uint16[Pe+7]=z,this.int16[Pe+8]=j,this.int16[Pe+9]=W,this.int16[Pe+10]=Y,this.int16[Pe+11]=ie,this.int16[Pe+12]=ce,this.int16[Pe+13]=pe,this.int16[Pe+14]=Ce,this.int16[Pe+15]=Te,r}}sn.prototype.bytesPerElement=32,Bt("StructArrayLayout4i4ui4i4i32",sn);class Un extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const u=this.length;return this.resize(u+1),this.emplace(u,r)}emplace(r,u){return this.uint32[1*r+0]=u,r}}Un.prototype.bytesPerElement=4,Bt("StructArrayLayout1ul4",Un);class Vi extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,u,p,y,b,E,k,N,z,j,W,Y,ie){const ce=this.length;return this.resize(ce+1),this.emplace(ce,r,u,p,y,b,E,k,N,z,j,W,Y,ie)}emplace(r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce){const pe=20*r,Ce=10*r;return this.int16[pe+0]=u,this.int16[pe+1]=p,this.int16[pe+2]=y,this.int16[pe+3]=b,this.int16[pe+4]=E,this.float32[Ce+3]=k,this.float32[Ce+4]=N,this.float32[Ce+5]=z,this.float32[Ce+6]=j,this.int16[pe+14]=W,this.uint32[Ce+8]=Y,this.uint16[pe+18]=ie,this.uint16[pe+19]=ce,r}}Vi.prototype.bytesPerElement=40,Bt("StructArrayLayout5i4f1i1ul2ui40",Vi);class Tr extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,u,p,y,b,E,k){const N=this.length;return this.resize(N+1),this.emplace(N,r,u,p,y,b,E,k)}emplace(r,u,p,y,b,E,k,N){const z=8*r;return this.int16[z+0]=u,this.int16[z+1]=p,this.int16[z+2]=y,this.int16[z+4]=b,this.int16[z+5]=E,this.int16[z+6]=k,this.int16[z+7]=N,r}}Tr.prototype.bytesPerElement=16,Bt("StructArrayLayout3i2i2i16",Tr);class Ur extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,u,p,y,b){const E=this.length;return this.resize(E+1),this.emplace(E,r,u,p,y,b)}emplace(r,u,p,y,b,E){const k=4*r,N=8*r;return this.float32[k+0]=u,this.float32[k+1]=p,this.float32[k+2]=y,this.int16[N+6]=b,this.int16[N+7]=E,r}}Ur.prototype.bytesPerElement=16,Bt("StructArrayLayout2f1f2i16",Ur);class ar extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,u,p,y){const b=this.length;return this.resize(b+1),this.emplace(b,r,u,p,y)}emplace(r,u,p,y,b){const E=12*r,k=3*r;return this.uint8[E+0]=u,this.uint8[E+1]=p,this.float32[k+1]=y,this.float32[k+2]=b,r}}ar.prototype.bytesPerElement=12,Bt("StructArrayLayout2ub2f12",ar);class lr extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,u,p){const y=this.length;return this.resize(y+1),this.emplace(y,r,u,p)}emplace(r,u,p,y){const b=3*r;return this.uint16[b+0]=u,this.uint16[b+1]=p,this.uint16[b+2]=y,r}}lr.prototype.bytesPerElement=6,Bt("StructArrayLayout3ui6",lr);class Is extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce,pe,Ce,Te,Pe,Be,je,He){const Ge=this.length;return this.resize(Ge+1),this.emplace(Ge,r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce,pe,Ce,Te,Pe,Be,je,He)}emplace(r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce,pe,Ce,Te,Pe,Be,je,He,Ge){const ot=30*r,nt=15*r,Mt=60*r;return this.int16[ot+0]=u,this.int16[ot+1]=p,this.int16[ot+2]=y,this.float32[nt+2]=b,this.float32[nt+3]=E,this.uint16[ot+8]=k,this.uint16[ot+9]=N,this.uint32[nt+5]=z,this.uint32[nt+6]=j,this.uint32[nt+7]=W,this.uint16[ot+16]=Y,this.uint16[ot+17]=ie,this.uint16[ot+18]=ce,this.float32[nt+10]=pe,this.float32[nt+11]=Ce,this.uint8[Mt+48]=Te,this.uint8[Mt+49]=Pe,this.uint8[Mt+50]=Be,this.uint32[nt+13]=je,this.int16[ot+28]=He,this.uint8[Mt+58]=Ge,r}}Is.prototype.bytesPerElement=60,Bt("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",Is);class bo extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce,pe,Ce,Te,Pe,Be,je,He,Ge,ot,nt,Mt,ft,lt,gt,Ct,ct){const It=this.length;return this.resize(It+1),this.emplace(It,r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce,pe,Ce,Te,Pe,Be,je,He,Ge,ot,nt,Mt,ft,lt,gt,Ct,ct)}emplace(r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce,pe,Ce,Te,Pe,Be,je,He,Ge,ot,nt,Mt,ft,lt,gt,Ct,ct,It){const Ot=38*r,rn=19*r;return this.int16[Ot+0]=u,this.int16[Ot+1]=p,this.int16[Ot+2]=y,this.float32[rn+2]=b,this.float32[rn+3]=E,this.int16[Ot+8]=k,this.int16[Ot+9]=N,this.int16[Ot+10]=z,this.int16[Ot+11]=j,this.int16[Ot+12]=W,this.int16[Ot+13]=Y,this.uint16[Ot+14]=ie,this.uint16[Ot+15]=ce,this.uint16[Ot+16]=pe,this.uint16[Ot+17]=Ce,this.uint16[Ot+18]=Te,this.uint16[Ot+19]=Pe,this.uint16[Ot+20]=Be,this.uint16[Ot+21]=je,this.uint16[Ot+22]=He,this.uint16[Ot+23]=Ge,this.uint16[Ot+24]=ot,this.uint16[Ot+25]=nt,this.uint16[Ot+26]=Mt,this.uint16[Ot+27]=ft,this.uint16[Ot+28]=lt,this.uint32[rn+15]=gt,this.float32[rn+16]=Ct,this.float32[rn+17]=ct,this.float32[rn+18]=It,r}}bo.prototype.bytesPerElement=76,Bt("StructArrayLayout3i2f6i15ui1ul3f76",bo);class ri extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const u=this.length;return this.resize(u+1),this.emplace(u,r)}emplace(r,u){return this.float32[1*r+0]=u,r}}ri.prototype.bytesPerElement=4,Bt("StructArrayLayout1f4",ri);class Ji extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,u,p){const y=this.length;return this.resize(y+1),this.emplace(y,r,u,p)}emplace(r,u,p,y){const b=3*r;return this.int16[b+0]=u,this.int16[b+1]=p,this.int16[b+2]=y,r}}Ji.prototype.bytesPerElement=6,Bt("StructArrayLayout3i6",Ji);class Pn extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,u,p,y){const b=this.length;return this.resize(b+1),this.emplace(b,r,u,p,y)}emplace(r,u,p,y,b){const E=6*r;return this.uint32[3*r+0]=u,this.uint16[E+2]=p,this.uint16[E+3]=y,this.uint16[E+4]=b,r}}Pn.prototype.bytesPerElement=12,Bt("StructArrayLayout1ul3ui12",Pn);class wi extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,u){const p=this.length;return this.resize(p+1),this.emplace(p,r,u)}emplace(r,u,p){const y=2*r;return this.uint16[y+0]=u,this.uint16[y+1]=p,r}}wi.prototype.bytesPerElement=4,Bt("StructArrayLayout2ui4",wi);class Hr extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const u=this.length;return this.resize(u+1),this.emplace(u,r)}emplace(r,u){return this.uint16[1*r+0]=u,r}}Hr.prototype.bytesPerElement=2,Bt("StructArrayLayout1ui2",Hr);class Ci extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,u){const p=this.length;return this.resize(p+1),this.emplace(p,r,u)}emplace(r,u,p){const y=2*r;return this.float32[y+0]=u,this.float32[y+1]=p,r}}Ci.prototype.bytesPerElement=8,Bt("StructArrayLayout2f8",Ci);class jr extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,u,p,y){const b=this.length;return this.resize(b+1),this.emplace(b,r,u,p,y)}emplace(r,u,p,y,b){const E=4*r;return this.float32[E+0]=u,this.float32[E+1]=p,this.float32[E+2]=y,this.float32[E+3]=b,r}}jr.prototype.bytesPerElement=16,Bt("StructArrayLayout4f16",jr);class Ml extends it{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Ml.prototype.size=40;class Zr extends Vi{get(r){return new Ml(this,r)}}Bt("CollisionBoxArray",Zr);class qo extends it{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(r){this._structArray.uint8[this._pos1+49]=r}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(r){this._structArray.uint8[this._pos1+50]=r}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(r){this._structArray.uint32[this._pos4+13]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(r){this._structArray.uint8[this._pos1+58]=r}}qo.prototype.size=60;class fu extends Is{get(r){return new qo(this,r)}}Bt("PlacedSymbolArray",fu);class nh extends it{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(r){this._structArray.uint32[this._pos4+15]=r}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}nh.prototype.size=76;class kl extends bo{get(r){return new nh(this,r)}}Bt("SymbolInstanceArray",kl);class sd extends ri{getoffsetX(r){return this.float32[1*r+0]}}Bt("GlyphOffsetArray",sd);class Ic extends Ji{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}Bt("SymbolLineVertexArray",Ic);class gu extends it{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}gu.prototype.size=12;class Iy extends Pn{get(r){return new gu(this,r)}}Bt("FeatureIndexArray",Iy);class Py extends it{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}Py.prototype.size=4;class od extends wi{get(r){return new Py(this,r)}}Bt("FillExtrusionCentroidArray",od);const ad=Ye([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),Ex=Ye([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var mg=Dt(function(c){c.exports=function(r,u){var p,y,b,E,k,N,z,j;for(y=r.length-(p=3&r.length),b=u,k=3432918353,N=461845907,j=0;j<y;)z=255&r.charCodeAt(j)|(255&r.charCodeAt(++j))<<8|(255&r.charCodeAt(++j))<<16|(255&r.charCodeAt(++j))<<24,++j,b=27492+(65535&(E=5*(65535&(b=(b^=z=(65535&(z=(z=(65535&z)*k+(((z>>>16)*k&65535)<<16)&4294967295)<<15|z>>>17))*N+(((z>>>16)*N&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(z=0,p){case 3:z^=(255&r.charCodeAt(j+2))<<16;case 2:z^=(255&r.charCodeAt(j+1))<<8;case 1:b^=z=(65535&(z=(z=(65535&(z^=255&r.charCodeAt(j)))*k+(((z>>>16)*k&65535)<<16)&4294967295)<<15|z>>>17))*N+(((z>>>16)*N&65535)<<16)&4294967295}return b^=r.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}}),Ry=Dt(function(c){c.exports=function(r,u){for(var p,y=r.length,b=u^y,E=0;y>=4;)p=1540483477*(65535&(p=255&r.charCodeAt(E)|(255&r.charCodeAt(++E))<<8|(255&r.charCodeAt(++E))<<16|(255&r.charCodeAt(++E))<<24))+((1540483477*(p>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),y-=4,++E;switch(y){case 3:b^=(255&r.charCodeAt(E+2))<<16;case 2:b^=(255&r.charCodeAt(E+1))<<8;case 1:b=1540483477*(65535&(b^=255&r.charCodeAt(E)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}}),Za=mg,Jr=Ry;Za.murmur3=mg,Za.murmur2=Jr;class ih{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,u,p,y){this.ids.push(Il(r)),this.positions.push(u,p,y)}getPositions(r){const u=Il(r);let p=0,y=this.ids.length-1;for(;p<y;){const E=p+y>>1;this.ids[E]>=u?y=E:p=E+1}const b=[];for(;this.ids[p]===u;)b.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return b}static serialize(r,u){const p=new Float64Array(r.ids),y=new Uint32Array(r.positions);return Pc(p,y,0,p.length-1),u&&u.push(p.buffer,y.buffer),{ids:p,positions:y}}static deserialize(r){const u=new ih;return u.ids=r.ids,u.positions=r.positions,u.indexed=!0,u}}function Il(c){const r=+c;return!isNaN(r)&&r<=Ss?r:Za(String(c))}function Pc(c,r,u,p){for(;u<p;){const y=c[u+p>>1];let b=u-1,E=p+1;for(;;){do{b++}while(c[b]<y);do{E--}while(c[E]>y);if(b>=E)break;Pl(c,b,E),Pl(r,3*b,3*E),Pl(r,3*b+1,3*E+1),Pl(r,3*b+2,3*E+2)}E-u<p-E?(Pc(c,r,u,E),u=E+1):(Pc(c,r,E+1,p),p=E)}}function Pl(c,r,u){const p=c[r];c[r]=c[u],c[u]=p}Bt("FeaturePositionMap",ih);class wo{constructor(r,u){this.gl=r.gl,this.location=u}}class Rc extends wo{constructor(r,u){super(r,u),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class Mp extends wo{constructor(r,u){super(r,u),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class Nc extends wo{constructor(r,u){super(r,u),this.current=qe.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const iC=new Float32Array(16),rC=new Float32Array(9),Ax=new Float32Array(4);function Ny(c){return[st(255*c.r,255*c.g),st(255*c.b,255*c.a)]}class ld{constructor(r,u,p){this.value=r,this.uniformNames=u.map(y=>`u_${y}`),this.type=p}setUniform(r,u,p){r.set(p.constantOr(this.value))}getBinding(r,u,p){return"color"===this.type?new Nc(r,u):new Rc(r,u)}}class on{constructor(r,u){this.uniformNames=u.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=u.tl.concat(u.br),this.patternTo=r.tl.concat(r.br)}setUniform(r,u,p,y){const b="u_pattern_to"===y||"u_dash_to"===y?this.patternTo:"u_pattern_from"===y||"u_dash_from"===y?this.patternFrom:"u_pixel_ratio_to"===y?this.pixelRatioTo:"u_pixel_ratio_from"===y?this.pixelRatioFrom:null;b&&r.set(b)}getBinding(r,u,p){return"u_pattern_from"===p||"u_pattern_to"===p||"u_dash_from"===p||"u_dash_to"===p?new Mp(r,u):new Rc(r,u)}}class Rl{constructor(r,u,p,y){this.expression=r,this.type=p,this.maxValue=0,this.paintVertexAttributes=u.map(b=>({name:`a_${b}`,type:"Float32",components:"color"===p?2:1,offset:0})),this.paintVertexArray=new y}populatePaintArray(r,u,p,y,b,E){const k=this.paintVertexArray.length,N=this.expression.evaluate(new ne(0),u,{},b,y,E);this.paintVertexArray.resize(r),this._setPaintValue(k,r,N)}updatePaintArray(r,u,p,y,b){const E=this.expression.evaluate({zoom:0},p,y,void 0,b);this._setPaintValue(r,u,E)}_setPaintValue(r,u,p){if("color"===this.type){const y=Ny(p);for(let b=r;b<u;b++)this.paintVertexArray.emplace(b,y[0],y[1])}else{for(let y=r;y<u;y++)this.paintVertexArray.emplace(y,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ja{constructor(r,u,p,y,b,E){this.expression=r,this.uniformNames=u.map(k=>`u_${k}_t`),this.type=p,this.useIntegerZoom=y,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=u.map(k=>({name:`a_${k}`,type:"Float32",components:"color"===p?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(r,u,p,y,b,E){const k=this.expression.evaluate(new ne(this.zoom),u,{},b,y,E),N=this.expression.evaluate(new ne(this.zoom+1),u,{},b,y,E),z=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(z,r,k,N)}updatePaintArray(r,u,p,y,b){const E=this.expression.evaluate({zoom:this.zoom},p,y,void 0,b),k=this.expression.evaluate({zoom:this.zoom+1},p,y,void 0,b);this._setPaintValue(r,u,E,k)}_setPaintValue(r,u,p,y){if("color"===this.type){const b=Ny(p),E=Ny(y);for(let k=r;k<u;k++)this.paintVertexArray.emplace(k,b[0],b[1],E[0],E[1])}else{for(let b=r;b<u;b++)this.paintVertexArray.emplace(b,p,y);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(y))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,u){const p=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,y=On(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);r.set(y)}getBinding(r,u,p){return new Rc(r,u)}}class mu{constructor(r,u,p,y,b,E,k){this.expression=r,this.type=p,this.useIntegerZoom=y,this.zoom=b,this.layerId=k,this.paintVertexAttributes=("array"===p?Ex:ad).members;for(let N=0;N<u.length;++N);this.zoomInPaintVertexArray=new E,this.zoomOutPaintVertexArray=new E}populatePaintArray(r,u,p){const y=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(y,r,u.patterns&&u.patterns[this.layerId],p)}updatePaintArray(r,u,p,y,b,E){this._setPaintValues(r,u,p.patterns&&p.patterns[this.layerId],E)}_setPaintValues(r,u,p,y){if(!y||!p)return;const{min:b,mid:E,max:k}=p,N=y[b],z=y[E],j=y[k];if(N&&z&&j)for(let W=r;W<u;W++)this._setPaintValue(this.zoomInPaintVertexArray,W,z,N),this._setPaintValue(this.zoomOutPaintVertexArray,W,z,j)}_setPaintValue(r,u,p,y){r.emplace(u,p.tl[0],p.tl[1],p.br[0],p.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1],p.pixelRatio,y.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Fc{constructor(r,u,p=(()=>!0)){this.binders={},this._buffers=[];const y=[];for(const b in r.paint._values){if(!p(b))continue;const E=r.paint.get(b);if(!(E instanceof Ee&&Zi(E.property.specification)))continue;const k=oC(b,r.type),N=E.value,z=E.property.specification.type,j=E.property.useIntegerZoom,W=E.property.specification["property-type"],Y="cross-faded"===W||"cross-faded-data-driven"===W,ie="line-dasharray"===String(b)&&"constant"!==r.layout.get("line-cap").value.kind;if("constant"!==N.kind||ie)if("source"===N.kind||ie||Y){const ce=Mr(b,z,"source");this.binders[b]=Y?new mu(N,k,z,j,u,ce,r.id):new Rl(N,k,z,ce),y.push(`/a_${b}`)}else{const ce=Mr(b,z,"composite");this.binders[b]=new Ja(N,k,z,j,u,ce),y.push(`/z_${b}`)}else this.binders[b]=Y?new on(N.value,k):new ld(N.value,k,z),y.push(`/u_${b}`)}this.cacheKey=y.sort().join("")}getMaxValue(r){const u=this.binders[r];return u instanceof Rl||u instanceof Ja?u.maxValue:0}populatePaintArrays(r,u,p,y,b,E){for(const k in this.binders){const N=this.binders[k];(N instanceof Rl||N instanceof Ja||N instanceof mu)&&N.populatePaintArray(r,u,p,y,b,E)}}setConstantPatternPositions(r,u){for(const p in this.binders){const y=this.binders[p];y instanceof on&&y.setConstantPatternPositions(r,u)}}updatePaintArrays(r,u,p,y,b,E){let k=!1;for(const N in r){const z=u.getPositions(N);for(const j of z){const W=p.feature(j.index);for(const Y in this.binders){const ie=this.binders[Y];if((ie instanceof Rl||ie instanceof Ja||ie instanceof mu)&&!0===ie.expression.isStateDependent){const ce=y.paint.get(Y);ie.expression=ce.value,ie.updatePaintArray(j.start,j.end,W,r[N],b,E),k=!0}}}}return k}defines(){const r=[];for(const u in this.binders){const p=this.binders[u];(p instanceof ld||p instanceof on)&&r.push(...p.uniformNames.map(y=>`#define HAS_UNIFORM_${y}`))}return r}getBinderAttributes(){const r=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof Rl||p instanceof Ja||p instanceof mu)for(let y=0;y<p.paintVertexAttributes.length;y++)r.push(p.paintVertexAttributes[y].name)}return r}getBinderUniforms(){const r=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof ld||p instanceof on||p instanceof Ja)for(const y of p.uniformNames)r.push(y)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,u){const p=[];for(const y in this.binders){const b=this.binders[y];if(b instanceof ld||b instanceof on||b instanceof Ja)for(const E of b.uniformNames)if(u[E]){const k=b.getBinding(r,u[E],E);p.push({name:E,property:y,binding:k})}}return p}setUniforms(r,u,p,y){for(const{name:b,property:E,binding:k}of u)this.binders[E].setUniform(k,y,p.get(E),b)}updatePaintBuffers(r){this._buffers=[];for(const u in this.binders){const p=this.binders[u];if(r&&p instanceof mu){const y=2===r.fromScale?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;y&&this._buffers.push(y)}else(p instanceof Rl||p instanceof Ja)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(r){for(const u in this.binders){const p=this.binders[u];(p instanceof Rl||p instanceof Ja||p instanceof mu)&&p.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const u=this.binders[r];(u instanceof Rl||u instanceof Ja||u instanceof mu)&&u.destroy()}}}class rh{constructor(r,u,p=(()=>!0)){this.programConfigurations={};for(const y of r)this.programConfigurations[y.id]=new Fc(y,u,p);this.needsUpload=!1,this._featureMap=new ih,this._bufferOffset=0}populatePaintArrays(r,u,p,y,b,E,k){for(const N in this.programConfigurations)this.programConfigurations[N].populatePaintArrays(r,u,y,b,E,k);void 0!==u.id&&this._featureMap.add(u.id,p,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,u,p,y,b){for(const E of p)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(r,this._featureMap,u,E,y,b)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}const sC={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function oC(c,r){return sC[c]||[c.replace(`${r}-`,"").replace(/-/g,"_")]}const cd={"line-pattern":{source:nn,composite:nn},"fill-pattern":{source:nn,composite:nn},"fill-extrusion-pattern":{source:nn,composite:nn},"line-dasharray":{source:Gt,composite:Gt}},aC={color:{source:Ci,composite:jr},number:{source:ri,composite:Ci}};function Mr(c,r,u){const p=cd[c];return p&&p[u]||aC[r][u]}Bt("ConstantBinder",ld),Bt("CrossFadedConstantBinder",on),Bt("SourceExpressionBinder",Rl),Bt("CrossFadedCompositeBinder",mu),Bt("CompositeExpressionBinder",Ja),Bt("ProgramConfiguration",Fc,{omit:["_buffers"]}),Bt("ProgramConfigurationSet",rh);const sh="-transition";class Zs extends a{constructor(r,u){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==r.type&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,"background"!==r.type&&"sky"!==r.type&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),u.layout&&(this._unevaluatedLayout=new ve(u.layout)),u.paint)){this._transitionablePaint=new me(u.paint);for(const p in r.paint)this.setPaintProperty(p,r.paint[p],{validate:!1});for(const p in r.layout)this.setLayoutProperty(p,r.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Me(u.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return"visibility"===r?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,u,p={}){null!=u&&this._validate(Qh,`layers.${this.id}.layout.${r}`,r,u,p)||("visibility"!==r?this._unevaluatedLayout.setValue(r,u):this.visibility=u)}getPaintProperty(r){return ls(r,sh)?this._transitionablePaint.getTransition(r.slice(0,-sh.length)):this._transitionablePaint.getValue(r)}setPaintProperty(r,u,p={}){if(null!=u&&this._validate(Ii,`layers.${this.id}.paint.${r}`,r,u,p))return!1;if(ls(r,sh))return this._transitionablePaint.setTransition(r.slice(0,-sh.length),u||void 0),!1;{const y=this._transitionablePaint._values[r],b="cross-faded-data-driven"===y.property.specification["property-type"],E=y.value.isDataDriven(),k=y.value;this._transitionablePaint.setValue(r,u),this._handleSpecialPaintPropertyUpdate(r);const N=this._transitionablePaint._values[r].value;return N.isDataDriven()||E||b||this._handleOverridablePaintPropertyUpdate(r,k,N)}}_handleSpecialPaintPropertyUpdate(r){}getProgramIds(){return null}getProgramConfiguration(r){return null}_handleOverridablePaintPropertyUpdate(r,u,p){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||"none"===this.visibility}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,u){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,u)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Bi(r,(u,p)=>!(void 0===u||"layout"===p&&!Object.keys(u).length||"paint"===p&&!Object.keys(u).length))}_validate(r,u,p,y,b={}){return(!b||!1!==b.validate)&&Dp(this,r.call(El,{key:u,layerType:this.type,objectKey:p,value:y,styleSpec:d,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const u=this.paint.get(r);if(u instanceof Ee&&Zi(u.property.specification)&&("source"===u.value.kind||"composite"===u.value.kind)&&u.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Wu(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const lC=Ye([{name:"a_pos",components:2,type:"Int16"}],4),{members:Tx}=lC;class yi{constructor(r=[]){this.segments=r}prepareSegment(r,u,p,y){let b=this.segments[this.segments.length-1];return r>yi.MAX_VERTEX_ARRAY_LENGTH&&mn(`Max vertices per segment is ${yi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!b||b.vertexLength+r>yi.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==y)&&(b={vertexOffset:u.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},void 0!==y&&(b.sortKey=y),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const r of this.segments)for(const u in r.vaos)r.vaos[u].destroy()}static simpleSegment(r,u,p,y){return new yi([{vertexOffset:r,primitiveOffset:u,vertexLength:p,primitiveLength:y,vaos:{},sortKey:0}])}}yi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Bt("SegmentVector",yi);var cn=8192;class Ka{constructor(r,u){r&&(u?this.setSouthWest(r).setNorthEast(u):4===r.length?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}setNorthEast(r){return this._ne=r instanceof Rn?new Rn(r.lng,r.lat):Rn.convert(r),this}setSouthWest(r){return this._sw=r instanceof Rn?new Rn(r.lng,r.lat):Rn.convert(r),this}extend(r){const u=this._sw,p=this._ne;let y,b;if(r instanceof Rn)y=r,b=r;else{if(!(r instanceof Ka))return Array.isArray(r)?4===r.length||r.every(Array.isArray)?this.extend(Ka.convert(r)):this.extend(Rn.convert(r)):this;if(y=r._sw,b=r._ne,!y||!b)return this}return u||p?(u.lng=Math.min(y.lng,u.lng),u.lat=Math.min(y.lat,u.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new Rn(y.lng,y.lat),this._ne=new Rn(b.lng,b.lat)),this}getCenter(){return new Rn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Rn(this.getWest(),this.getNorth())}getSouthEast(){return new Rn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:u,lat:p}=Rn.convert(r);let y=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&y}static convert(r){return!r||r instanceof Ka?r:new Ka(r)}}const Oc=6371008.8;class Rn{constructor(r,u){if(isNaN(r)||isNaN(u))throw new Error(`Invalid LngLat object: (${r}, ${u})`);if(this.lng=+r,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Rn(Ro(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const u=Math.PI/180,p=this.lat*u,y=r.lat*u,b=Math.sin(p)*Math.sin(y)+Math.cos(p)*Math.cos(y)*Math.cos((r.lng-this.lng)*u);return Oc*Math.acos(Math.min(b,1))}toBounds(r=0){const u=360*r/40075017,p=u/Math.cos(Math.PI/180*this.lat);return new Ka(new Rn(this.lng-p,this.lat-u),new Rn(this.lng+p,this.lat+u))}static convert(r){if(r instanceof Rn)return r;if(Array.isArray(r)&&(2===r.length||3===r.length))return new Rn(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&"object"==typeof r&&null!==r)return new Rn(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const yg=2*Math.PI*Oc;function Fy(c){return yg*Math.cos(c*Math.PI/180)}function _g(c){return(180+c)/360}function Oy(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Ly(c,r){return c/Fy(r)}function Lc(c){return 360*c-180}function cr(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function ud(c,r){return c*Fy(cr(r))}const Zo=85.051129;class vg{constructor(r,u,p=0){this.x=+r,this.y=+u,this.z=+p}static fromLngLat(r,u=0){const p=Rn.convert(r);return new vg(_g(p.lng),Oy(p.lat),Ly(u,p.lat))}toLngLat(){return new Rn(Lc(this.x),cr(this.y))}toAltitude(){return ud(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/yg*(r=cr(this.y),1/Math.cos(r*Math.PI/180));var r}}function kp(c,r,u,p,y,b,E,k,N){const z=(r+p)/2,j=(u+y)/2,W=new Je(z,j);k(W),function(Y,ie,ce,pe,Ce,Te){const Pe=ce-Ce,Be=pe-Te;return Math.abs((pe-ie)*Pe-(ce-Y)*Be)/Math.hypot(Pe,Be)}(W.x,W.y,b.x,b.y,E.x,E.y)>=N?(kp(c,r,u,z,j,b,W,k,N),kp(c,z,j,p,y,W,E,k,N)):c.push(E)}function Mx(c,r,u){const p=[];let y,b,E;for(const k of c){const{x:N,y:z}=k;r(k),E?kp(p,y,b,N,z,E,k,r,u):p.push(k),y=N,b=z,E=k}return p}const xg=Math.pow(2,14)-1,zy=-xg-1;function kx(c,r){const u=Math.round(c.x*r),p=Math.round(c.y*r);return c.x=On(u,zy,xg),c.y=On(p,zy,xg),(u<c.x||u>c.x+1||p<c.y||p>c.y+1)&&mn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function Nl(c,r,u){const p=c.loadGeometry(),y=c.extent,b=cn/y;if(r&&u&&"mercator"!==u.projection.name){const E=1<<r.z,{scale:k,x:N,y:z,projection:j}=u,W=Y=>{const ie=Lc((r.x+Y.x/y)/E),ce=cr((r.y+Y.y/y)/E),pe=j.project(ie,ce);Y.x=(pe.x*k-N)*y,Y.y=(pe.y*k-z)*y};for(let Y=0;Y<p.length;Y++)if(1!==c.type)p[Y]=Mx(p[Y],W,1);else{const ie=[];for(const ce of p[Y])ce.x<0||ce.x>=y||ce.y<0||ce.y>=y||(W(ce),ie.push(ce));p[Y]=ie}}for(const E of p)for(const k of E)kx(k,b);return p}function Pa(c,r){return{type:c.type,id:c.id,properties:c.properties,geometry:r?Nl(c):[]}}function oh(c,r,u,p,y){c.emplaceBack(2*r+(p+1)/2,2*u+(y+1)/2)}class ah{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(u=>u.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Lt,this.indexArray=new lr,this.segments=new yi,this.programConfigurations=new rh(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(r,u,p,y){const b=this.layers[0],E=[];let k=null;"circle"===b.type&&(k=b.layout.get("circle-sort-key"));for(const{feature:N,id:z,index:j,sourceLayerIndex:W}of r){const Y=this.layers[0]._featureFilter.needGeometry,ie=Pa(N,Y);if(!this.layers[0]._featureFilter.filter(new ne(this.zoom),ie,p))continue;const ce=k?k.evaluate(ie,{},p):void 0,pe={id:z,properties:N.properties,type:N.type,sourceLayerIndex:W,index:j,geometry:Y?ie.geometry:Nl(N,p,y),patterns:{},sortKey:ce};E.push(pe)}k&&E.sort((N,z)=>N.sortKey-z.sortKey);for(const N of E){const{geometry:z,index:j,sourceLayerIndex:W}=N,Y=r[j].feature;this.addFeature(N,z,j,u.availableImages,p),u.featureIndex.insert(Y,z,j,W,this.index)}}update(r,u,p,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,u,this.stateDependentLayers,p,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Tx),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,u,p,y,b){for(const E of u)for(const k of E){const N=k.x,z=k.y;if(N<0||N>=cn||z<0||z>=cn)continue;const j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),W=j.vertexLength;oh(this.layoutVertexArray,N,z,-1,-1),oh(this.layoutVertexArray,N,z,1,-1),oh(this.layoutVertexArray,N,z,1,1),oh(this.layoutVertexArray,N,z,-1,1),this.indexArray.emplaceBack(W,W+1,W+2),this.indexArray.emplaceBack(W,W+3,W+2),j.vertexLength+=4,j.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,p,{},y,b)}}function Ix(c,r){for(let u=0;u<c.length;u++)if(Qa(r,c[u]))return!0;for(let u=0;u<r.length;u++)if(Qa(c,r[u]))return!0;return!!bg(c,r)}function hd(c,r,u){return!!Qa(c,r)||!!wg(r,c,u)}function Ip(c,r){if(1===c.length)return Rp(r,c[0]);for(let u=0;u<r.length;u++){const p=r[u];for(let y=0;y<p.length;y++)if(Qa(c,p[y]))return!0}for(let u=0;u<c.length;u++)if(Rp(r,c[u]))return!0;for(let u=0;u<r.length;u++)if(bg(c,r[u]))return!0;return!1}function lh(c,r,u){if(c.length>1){if(bg(c,r))return!0;for(let p=0;p<r.length;p++)if(wg(r[p],c,u))return!0}for(let p=0;p<c.length;p++)if(wg(c[p],r,u))return!0;return!1}function bg(c,r){if(0===c.length||0===r.length)return!1;for(let u=0;u<c.length-1;u++){const p=c[u],y=c[u+1];for(let b=0;b<r.length-1;b++)if(Px(p,y,r[b],r[b+1]))return!0}return!1}function Px(c,r,u,p){return Or(c,u,p)!==Or(r,u,p)&&Or(c,r,u)!==Or(c,r,p)}function wg(c,r,u){const p=u*u;if(1===r.length)return c.distSqr(r[0])<p;for(let y=1;y<r.length;y++)if(Pp(c,r[y-1],r[y])<p)return!0;return!1}function Pp(c,r,u){const p=r.distSqr(u);if(0===p)return c.distSqr(r);const y=((c.x-r.x)*(u.x-r.x)+(c.y-r.y)*(u.y-r.y))/p;return c.distSqr(y<0?r:y>1?u:u.sub(r)._mult(y)._add(r))}function Rp(c,r){let u,p,y,b=!1;for(let E=0;E<c.length;E++){u=c[E];for(let k=0,N=u.length-1;k<u.length;N=k++)p=u[k],y=u[N],p.y>r.y!=y.y>r.y&&r.x<(y.x-p.x)*(r.y-p.y)/(y.y-p.y)+p.x&&(b=!b)}return b}function Qa(c,r){let u=!1;for(let p=0,y=c.length-1;p<c.length;y=p++){const b=c[p],E=c[y];b.y>r.y!=E.y>r.y&&r.x<(E.x-b.x)*(r.y-b.y)/(E.y-b.y)+b.x&&(u=!u)}return u}function yu(c,r,u,p,y){for(const E of c)if(r<=E.x&&u<=E.y&&p>=E.x&&y>=E.y)return!0;const b=[new Je(r,u),new Je(r,y),new Je(p,y),new Je(p,u)];if(c.length>2)for(const E of b)if(Qa(c,E))return!0;for(let E=0;E<c.length-1;E++)if(Rx(c[E],c[E+1],b))return!0;return!1}function Rx(c,r,u){const p=u[0],y=u[2];if(c.x<p.x&&r.x<p.x||c.x>y.x&&r.x>y.x||c.y<p.y&&r.y<p.y||c.y>y.y&&r.y>y.y)return!1;const b=Or(c,r,u[0]);return b!==Or(c,r,u[1])||b!==Or(c,r,u[2])||b!==Or(c,r,u[3])}function dt(c,r,u){const p=r.paint.get(c).value;return"constant"===p.kind?p.value:u.programConfigurations.get(r.id).getMaxValue(c)}function dd(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Nx(c,r,u,p,y){if(!r[0]&&!r[1])return c;const b=Je.convert(r)._mult(y);"viewport"===u&&b._rotate(-p);const E=[];for(let k=0;k<c.length;k++)E.push(c[k].sub(b));return E}function zc(c,r,u,p){const y=Je.convert(c)._mult(p);return"viewport"===r&&y._rotate(-u),y}Bt("CircleBucket",ah,{omit:["layers"]});const pd=new rt({"circle-sort-key":new ke(d.layout_circle["circle-sort-key"])});var Fx={paint:new rt({"circle-radius":new ke(d.paint_circle["circle-radius"]),"circle-color":new ke(d.paint_circle["circle-color"]),"circle-blur":new ke(d.paint_circle["circle-blur"]),"circle-opacity":new ke(d.paint_circle["circle-opacity"]),"circle-translate":new be(d.paint_circle["circle-translate"]),"circle-translate-anchor":new be(d.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new be(d.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new be(d.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ke(d.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ke(d.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ke(d.paint_circle["circle-stroke-opacity"])}),layout:pd},fs="undefined"!=typeof Float32Array?Float32Array:Array;function Cg(){var c=new fs(9);return fs!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function Bc(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Js(c,r,u){var p=r[0],y=r[1],b=r[2],E=r[3],k=r[4],N=r[5],z=r[6],j=r[7],W=r[8],Y=r[9],ie=r[10],ce=r[11],pe=r[12],Ce=r[13],Te=r[14],Pe=r[15],Be=u[0],je=u[1],He=u[2],Ge=u[3];return c[0]=Be*p+je*k+He*W+Ge*pe,c[1]=Be*y+je*N+He*Y+Ge*Ce,c[2]=Be*b+je*z+He*ie+Ge*Te,c[3]=Be*E+je*j+He*ce+Ge*Pe,c[4]=(Be=u[4])*p+(je=u[5])*k+(He=u[6])*W+(Ge=u[7])*pe,c[5]=Be*y+je*N+He*Y+Ge*Ce,c[6]=Be*b+je*z+He*ie+Ge*Te,c[7]=Be*E+je*j+He*ce+Ge*Pe,c[8]=(Be=u[8])*p+(je=u[9])*k+(He=u[10])*W+(Ge=u[11])*pe,c[9]=Be*y+je*N+He*Y+Ge*Ce,c[10]=Be*b+je*z+He*ie+Ge*Te,c[11]=Be*E+je*j+He*ce+Ge*Pe,c[12]=(Be=u[12])*p+(je=u[13])*k+(He=u[14])*W+(Ge=u[15])*pe,c[13]=Be*y+je*N+He*Y+Ge*Ce,c[14]=Be*b+je*z+He*ie+Ge*Te,c[15]=Be*E+je*j+He*ce+Ge*Pe,c}Math.hypot||(Math.hypot=function(){for(var c=0,r=arguments.length;r--;)c+=arguments[r]*arguments[r];return Math.sqrt(c)});var Np=Js;function Ra(){var c=new fs(3);return fs!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function By(c){return Math.hypot(c[0],c[1],c[2])}function _u(c,r,u){var p=new fs(3);return p[0]=c,p[1]=r,p[2]=u,p}function Fp(c,r,u){return c[0]=r[0]-u[0],c[1]=r[1]-u[1],c[2]=r[2]-u[2],c}function fd(c,r,u){return c[0]=r[0]*u[0],c[1]=r[1]*u[1],c[2]=r[2]*u[2],c}function Sg(c,r,u,p){return c[0]=r[0]+u[0]*p,c[1]=r[1]+u[1]*p,c[2]=r[2]+u[2]*p,c}function Vy(c,r){var u=r[0],p=r[1],y=r[2],b=u*u+p*p+y*y;return b>0&&(b=1/Math.sqrt(b)),c[0]=r[0]*b,c[1]=r[1]*b,c[2]=r[2]*b,c}function Uy(c,r,u){var p=u[0],y=u[1],b=u[2],E=r[0],k=r[1],N=r[2],z=y*N-b*k,j=b*E-p*N,W=p*k-y*E,Y=y*W-b*j,ie=b*z-p*W,ce=p*j-y*z,pe=2*u[3];return j*=pe,W*=pe,ie*=2,ce*=2,c[0]=E+(z*=pe)+(Y*=2),c[1]=k+j+ie,c[2]=N+W+ce,c}var el,c,gd=Fp,Ox=fd,cC=By;function ch(c,r,u){var p=r[0],y=r[1],b=r[2],E=r[3];return c[0]=u[0]*p+u[4]*y+u[8]*b+u[12]*E,c[1]=u[1]*p+u[5]*y+u[9]*b+u[13]*E,c[2]=u[2]*p+u[6]*y+u[10]*b+u[14]*E,c[3]=u[3]*p+u[7]*y+u[11]*b+u[15]*E,c}function Dg(){var c=new fs(4);return fs!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function Lx(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function Hy(c,r,u){u*=.5;var p=r[0],y=r[1],b=r[2],E=r[3],k=Math.sin(u),N=Math.cos(u);return c[0]=p*N+E*k,c[1]=y*N+b*k,c[2]=b*N-y*k,c[3]=E*N-p*k,c}function jy(c,r){return c[0]===r[0]&&c[1]===r[1]}function $y(c,r,u,p,y,b,E,k,N){if(b&&c.queryGeometry.isAboveHorizon)return!1;b&&(N*=c.pixelToTileUnitsFactor);for(const z of r)for(const j of z){const W=j.add(k),Y=y&&u.elevation?u.elevation.exaggeration()*y.getElevationAt(W.x,W.y,!0):0,ie=b?W:Op(W,Y,p),ce=b?c.tilespaceRays.map(Ce=>zx(Ce,Y)):c.queryGeometry.screenGeometry,pe=ch([],[j.x,j.y,Y,1],p);if(!E&&b?N*=pe[3]/u.cameraToCenterDistance:E&&!b&&(N*=u.cameraToCenterDistance/pe[3]),hd(ce,ie,N))return!0}return!1}function Op(c,r,u){const p=ch([],[c.x,c.y,r,1],u);return new Je(p[0]/p[3],p[1]/p[3])}Ra(),el=new fs(4),fs!=Float32Array&&(el[0]=0,el[1]=0,el[2]=0,el[3]=0),Ra(),_u(1,0,0),_u(0,1,0),Dg(),Dg(),Cg(),c=new fs(2),fs!=Float32Array&&(c[0]=0,c[1]=0);const Lp=_u(0,0,0),uh=_u(0,0,1);function zx(c,r){const u=Ra();return Lp[2]=r,c.intersectsPlane(Lp,uh,u),new Je(u[0],u[1])}class Gy extends ah{}function Wy(c,{width:r,height:u},p,y){if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==r*u*p)throw new RangeError("mismatched image size")}else y=new Uint8Array(r*u*p);return c.width=r,c.height=u,c.data=y,c}function md(c,{width:r,height:u},p){if(r===c.width&&u===c.height)return;const y=Wy({},{width:r,height:u},p);yd(c,y,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,r),height:Math.min(c.height,u)},p),c.width=r,c.height=u,c.data=y.data}function yd(c,r,u,p,y,b){if(0===y.width||0===y.height)return r;if(y.width>c.width||y.height>c.height||u.x>c.width-y.width||u.y>c.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>r.width||y.height>r.height||p.x>r.width-y.width||p.y>r.height-y.height)throw new RangeError("out of range destination coordinates for image copy");const E=c.data,k=r.data;for(let N=0;N<y.height;N++){const z=((u.y+N)*c.width+u.x)*b,j=((p.y+N)*r.width+p.x)*b;for(let W=0;W<y.width*b;W++)k[j+W]=E[z+W]}return r}Bt("HeatmapBucket",Gy,{omit:["layers"]});class Fl{constructor(r,u){Wy(this,r,1,u)}resize(r){md(this,r,1)}clone(){return new Fl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,u,p,y,b){yd(r,u,p,y,b,1)}}class Co{constructor(r,u){Wy(this,r,4,u)}resize(r){md(this,r,4)}replace(r,u){u?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Co({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,u,p,y,b){yd(r,u,p,y,b,4)}}Bt("AlphaImage",Fl),Bt("RGBAImage",Co);var Xy={paint:new rt({"heatmap-radius":new ke(d.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ke(d.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new be(d.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ke(d.paint_heatmap["heatmap-color"]),"heatmap-opacity":new be(d.paint_heatmap["heatmap-opacity"])})};function Ol(c){const r={},u=c.resolution||256,p=c.clips?c.clips.length:1,y=c.image||new Co({width:u,height:p}),b=(E,k,N)=>{r[c.evaluationKey]=N;const z=c.expression.evaluate(r);y.data[E+k+0]=Math.floor(255*z.r/z.a),y.data[E+k+1]=Math.floor(255*z.g/z.a),y.data[E+k+2]=Math.floor(255*z.b/z.a),y.data[E+k+3]=Math.floor(255*z.a)};if(c.clips)for(let E=0,k=0;E<p;++E,k+=4*u)for(let N=0,z=0;N<u;N++,z+=4){const j=N/(u-1),{start:W,end:Y}=c.clips[E];b(k,z,W*(1-j)+Y*j)}else for(let E=0,k=0;E<u;E++,k+=4)b(0,k,E/(u-1));return y}var Bx={paint:new rt({"hillshade-illumination-direction":new be(d.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new be(d.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new be(d.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new be(d.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new be(d.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new be(d.paint_hillshade["hillshade-accent-color"])})};const Vx=Ye([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ux}=Vx;var zp=Ps,Hx=Ps;function Ps(c,r,u){u=u||2;var p,y,b,E,k,N,z,j=r&&r.length,W=j?r[0]*u:c.length,Y=Na(c,0,W,u,!0),ie=[];if(!Y||Y.next===Y.prev)return ie;if(j&&(Y=function(pe,Ce,Te,Pe){var Be,je,He,Ge=[];for(Be=0,je=Ce.length;Be<je;Be++)(He=Na(pe,Ce[Be]*Pe,Be<je-1?Ce[Be+1]*Pe:pe.length,Pe,!1))===He.next&&(He.steiner=!0),Ge.push(qx(He));for(Ge.sort(Yy),Be=0;Be<Ge.length;Be++)Te=Ll(Te=Xx(Ge[Be],Te),Te.next);return Te}(c,r,Y,u)),c.length>80*u){p=b=c[0],y=E=c[1];for(var ce=u;ce<W;ce+=u)(k=c[ce])<p&&(p=k),(N=c[ce+1])<y&&(y=N),k>b&&(b=k),N>E&&(E=N);z=0!==(z=Math.max(b-p,E-y))?1/z:0}return _d(Y,ie,u,p,y,z),ie}function Na(c,r,u,p,y){var b,E;if(y===wd(c,r,u,p)>0)for(b=r;b<u;b+=p)E=Jx(b,c[b],c[b+1],E);else for(b=u-p;b>=r;b-=p)E=Jx(b,c[b],c[b+1],E);return E&&xd(E,E.next)&&(Bp(E),E=E.next),E}function Ll(c,r){if(!c)return c;r||(r=c);var u,p=c;do{if(u=!1,p.steiner||!xd(p,p.next)&&0!==Ri(p.prev,p,p.next))p=p.next;else{if(Bp(p),(p=r=p.prev)===p.next)break;u=!0}}while(u||p!==r);return r}function _d(c,r,u,p,y,b,E){if(c){!E&&b&&function(j,W,Y,ie){var ce=j;do{null===ce.z&&(ce.z=Eg(ce.x,ce.y,W,Y,ie)),ce.prevZ=ce.prev,ce.nextZ=ce.next,ce=ce.next}while(ce!==j);ce.prevZ.nextZ=null,ce.prevZ=null,function(pe){var Ce,Te,Pe,Be,je,He,Ge,ot,nt=1;do{for(Te=pe,pe=null,je=null,He=0;Te;){for(He++,Pe=Te,Ge=0,Ce=0;Ce<nt&&(Ge++,Pe=Pe.nextZ);Ce++);for(ot=nt;Ge>0||ot>0&&Pe;)0!==Ge&&(0===ot||!Pe||Te.z<=Pe.z)?(Be=Te,Te=Te.nextZ,Ge--):(Be=Pe,Pe=Pe.nextZ,ot--),je?je.nextZ=Be:pe=Be,Be.prevZ=je,je=Be;Te=Pe}je.nextZ=null,nt*=2}while(He>1)}(ce)}(c,p,y,b);for(var k,N,z=c;c.prev!==c.next;)if(k=c.prev,N=c.next,b?$x(c,p,y,b):jx(c))r.push(k.i/u),r.push(c.i/u),r.push(N.i/u),Bp(c),c=N.next,z=N.next;else if((c=N)===z){E?1===E?_d(c=Gx(Ll(c),r,u),r,u,p,y,b,2):2===E&&Wx(c,r,u,p,y,b):_d(Ll(c),r,u,p,y,b,1);break}}}function jx(c){var r=c.prev,u=c,p=c.next;if(Ri(r,u,p)>=0)return!1;for(var y=c.next.next;y!==c.prev;){if(vd(r.x,r.y,u.x,u.y,p.x,p.y,y.x,y.y)&&Ri(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function $x(c,r,u,p){var y=c.prev,b=c,E=c.next;if(Ri(y,b,E)>=0)return!1;for(var k=y.x>b.x?y.x>E.x?y.x:E.x:b.x>E.x?b.x:E.x,N=y.y>b.y?y.y>E.y?y.y:E.y:b.y>E.y?b.y:E.y,z=Eg(y.x<b.x?y.x<E.x?y.x:E.x:b.x<E.x?b.x:E.x,y.y<b.y?y.y<E.y?y.y:E.y:b.y<E.y?b.y:E.y,r,u,p),j=Eg(k,N,r,u,p),W=c.prevZ,Y=c.nextZ;W&&W.z>=z&&Y&&Y.z<=j;){if(W!==c.prev&&W!==c.next&&vd(y.x,y.y,b.x,b.y,E.x,E.y,W.x,W.y)&&Ri(W.prev,W,W.next)>=0||(W=W.prevZ,Y!==c.prev&&Y!==c.next&&vd(y.x,y.y,b.x,b.y,E.x,E.y,Y.x,Y.y)&&Ri(Y.prev,Y,Y.next)>=0))return!1;Y=Y.nextZ}for(;W&&W.z>=z;){if(W!==c.prev&&W!==c.next&&vd(y.x,y.y,b.x,b.y,E.x,E.y,W.x,W.y)&&Ri(W.prev,W,W.next)>=0)return!1;W=W.prevZ}for(;Y&&Y.z<=j;){if(Y!==c.prev&&Y!==c.next&&vd(y.x,y.y,b.x,b.y,E.x,E.y,Y.x,Y.y)&&Ri(Y.prev,Y,Y.next)>=0)return!1;Y=Y.nextZ}return!0}function Gx(c,r,u){var p=c;do{var y=p.prev,b=p.next.next;!xd(y,b)&&Fa(y,p,p.next,b)&&hh(y,b)&&hh(b,y)&&(r.push(y.i/u),r.push(p.i/u),r.push(b.i/u),Bp(p),Bp(p.next),p=c=b),p=p.next}while(p!==c);return Ll(p)}function Wx(c,r,u,p,y,b){var E=c;do{for(var k=E.next.next;k!==E.prev;){if(E.i!==k.i&&Zx(E,k)){var N=Ag(E,k);return E=Ll(E,E.next),N=Ll(N,N.next),_d(E,r,u,p,y,b),void _d(N,r,u,p,y,b)}k=k.next}E=E.next}while(E!==c)}function Yy(c,r){return c.x-r.x}function Xx(c,r){var u=function(b,E){var k,N=E,z=b.x,j=b.y,W=-1/0;do{if(j<=N.y&&j>=N.next.y&&N.next.y!==N.y){var Y=N.x+(j-N.y)*(N.next.x-N.x)/(N.next.y-N.y);if(Y<=z&&Y>W){if(W=Y,Y===z){if(j===N.y)return N;if(j===N.next.y)return N.next}k=N.x<N.next.x?N:N.next}}N=N.next}while(N!==E);if(!k)return null;if(z===W)return k;var ie,ce=k,pe=k.x,Ce=k.y,Te=1/0;N=k;do{z>=N.x&&N.x>=pe&&z!==N.x&&vd(j<Ce?z:W,j,pe,Ce,j<Ce?W:z,j,N.x,N.y)&&(ie=Math.abs(j-N.y)/(z-N.x),hh(N,b)&&(ie<Te||ie===Te&&(N.x>k.x||N.x===k.x&&Yx(k,N)))&&(k=N,Te=ie)),N=N.next}while(N!==ce);return k}(c,r);if(!u)return r;var p=Ag(u,c),y=Ll(u,u.next);return Ll(p,p.next),r===u?y:r}function Yx(c,r){return Ri(c.prev,c,r.prev)<0&&Ri(r.next,c,c.next)<0}function Eg(c,r,u,p,y){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=32767*(c-u)*y)|c<<8))|c<<4))|c<<2))|c<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-p)*y)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function qx(c){var r=c,u=c;do{(r.x<u.x||r.x===u.x&&r.y<u.y)&&(u=r),r=r.next}while(r!==c);return u}function vd(c,r,u,p,y,b,E,k){return(y-E)*(r-k)-(c-E)*(b-k)>=0&&(c-E)*(p-k)-(u-E)*(r-k)>=0&&(u-E)*(b-k)-(y-E)*(p-k)>=0}function Zx(c,r){return c.next.i!==r.i&&c.prev.i!==r.i&&!function(u,p){var y=u;do{if(y.i!==u.i&&y.next.i!==u.i&&y.i!==p.i&&y.next.i!==p.i&&Fa(y,y.next,u,p))return!0;y=y.next}while(y!==u);return!1}(c,r)&&(hh(c,r)&&hh(r,c)&&function(u,p){var y=u,b=!1,E=(u.x+p.x)/2,k=(u.y+p.y)/2;do{y.y>k!=y.next.y>k&&y.next.y!==y.y&&E<(y.next.x-y.x)*(k-y.y)/(y.next.y-y.y)+y.x&&(b=!b),y=y.next}while(y!==u);return b}(c,r)&&(Ri(c.prev,c,r.prev)||Ri(c,r.prev,r))||xd(c,r)&&Ri(c.prev,c,c.next)>0&&Ri(r.prev,r,r.next)>0)}function Ri(c,r,u){return(r.y-c.y)*(u.x-r.x)-(r.x-c.x)*(u.y-r.y)}function xd(c,r){return c.x===r.x&&c.y===r.y}function Fa(c,r,u,p){var y=bd(Ri(c,r,u)),b=bd(Ri(c,r,p)),E=bd(Ri(u,p,c)),k=bd(Ri(u,p,r));return y!==b&&E!==k||!(0!==y||!Vc(c,u,r))||!(0!==b||!Vc(c,p,r))||!(0!==E||!Vc(u,c,p))||!(0!==k||!Vc(u,r,p))}function Vc(c,r,u){return r.x<=Math.max(c.x,u.x)&&r.x>=Math.min(c.x,u.x)&&r.y<=Math.max(c.y,u.y)&&r.y>=Math.min(c.y,u.y)}function bd(c){return c>0?1:c<0?-1:0}function hh(c,r){return Ri(c.prev,c,c.next)<0?Ri(c,r,c.next)>=0&&Ri(c,c.prev,r)>=0:Ri(c,r,c.prev)<0||Ri(c,c.next,r)<0}function Ag(c,r){var u=new qy(c.i,c.x,c.y),p=new qy(r.i,r.x,r.y),y=c.next,b=r.prev;return c.next=r,r.prev=c,u.next=y,y.prev=u,p.next=u,u.prev=p,b.next=p,p.prev=b,p}function Jx(c,r,u,p){var y=new qy(c,r,u);return p?(y.next=p.next,y.prev=p,p.next.prev=y,p.next=y):(y.prev=y,y.next=y),y}function Bp(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function qy(c,r,u){this.i=c,this.x=r,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function wd(c,r,u,p){for(var y=0,b=r,E=u-p;b<u;b+=p)y+=(c[E]-c[b])*(c[b+1]+c[E+1]),E=b;return y}function Tg(c,r,u,p,y){Vp(c,r,u||0,p||c.length-1,y||uC)}function Vp(c,r,u,p,y){for(;p>u;){if(p-u>600){var b=p-u+1,E=r-u+1,k=Math.log(b),N=.5*Math.exp(2*k/3),z=.5*Math.sqrt(k*N*(b-N)/b)*(E-b/2<0?-1:1);Vp(c,r,Math.max(u,Math.floor(r-E*N/b+z)),Math.min(p,Math.floor(r+(b-E)*N/b+z)),y)}var j=c[r],W=u,Y=p;for(Up(c,u,r),y(c[p],j)>0&&Up(c,u,p);W<Y;){for(Up(c,W,Y),W++,Y--;y(c[W],j)<0;)W++;for(;y(c[Y],j)>0;)Y--}0===y(c[u],j)?Up(c,u,Y):Up(c,++Y,p),Y<=r&&(u=Y+1),r<=Y&&(p=Y-1)}}function Up(c,r,u){var p=c[r];c[r]=c[u],c[u]=p}function uC(c,r){return c<r?-1:c>r?1:0}function Hp(c,r){const u=c.length;if(u<=1)return[c];const p=[];let y,b;for(let E=0;E<u;E++){const k=ni(c[E]);0!==k&&(c[E].area=Math.abs(k),void 0===b&&(b=k<0),b===k<0?(y&&p.push(y),y=[c[E]]):y.push(c[E]))}if(y&&p.push(y),r>1)for(let E=0;E<p.length;E++)p[E].length<=r||(Tg(p[E],r,1,p[E].length-1,Kx),p[E]=p[E].slice(0,r));return p}function Kx(c,r){return r.area-c.area}function Mg(c,r,u){const p=u.patternDependencies;let y=!1;for(const b of r){const E=b.paint.get(`${c}-pattern`);E.isConstant()||(y=!0);const k=E.constantOr(null);k&&(y=!0,p[k.to]=!0,p[k.from]=!0)}return y}function kg(c,r,u,p,y){const b=y.patternDependencies;for(const E of r){const k=E.paint.get(`${c}-pattern`).value;if("constant"!==k.kind){let N=k.evaluate({zoom:p-1},u,{},y.availableImages),z=k.evaluate({zoom:p},u,{},y.availableImages),j=k.evaluate({zoom:p+1},u,{},y.availableImages);N=N&&N.name?N.name:N,z=z&&z.name?z.name:z,j=j&&j.name?j.name:j,b[N]=!0,b[z]=!0,b[j]=!0,u.patterns[E.id]={min:N,mid:z,max:j}}}return u}Ps.deviation=function(c,r,u,p){var y=r&&r.length,b=Math.abs(wd(c,0,y?r[0]*u:c.length,u));if(y)for(var E=0,k=r.length;E<k;E++)b-=Math.abs(wd(c,r[E]*u,E<k-1?r[E+1]*u:c.length,u));var N=0;for(E=0;E<p.length;E+=3){var z=p[E]*u,j=p[E+1]*u,W=p[E+2]*u;N+=Math.abs((c[z]-c[W])*(c[j+1]-c[z+1])-(c[z]-c[j])*(c[W+1]-c[z+1]))}return 0===b&&0===N?0:Math.abs((N-b)/b)},Ps.flatten=function(c){for(var r=c[0][0].length,u={vertices:[],holes:[],dimensions:r},p=0,y=0;y<c.length;y++){for(var b=0;b<c[y].length;b++)for(var E=0;E<r;E++)u.vertices.push(c[y][b][E]);y>0&&u.holes.push(p+=c[y-1].length)}return u},zp.default=Hx;class jp{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(u=>u.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Lt,this.indexArray=new lr,this.indexArray2=new wi,this.programConfigurations=new rh(r.layers,r.zoom),this.segments=new yi,this.segments2=new yi,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(r,u,p,y){this.hasPattern=Mg("fill",this.layers,u);const b=this.layers[0].layout.get("fill-sort-key"),E=[];for(const{feature:k,id:N,index:z,sourceLayerIndex:j}of r){const W=this.layers[0]._featureFilter.needGeometry,Y=Pa(k,W);if(!this.layers[0]._featureFilter.filter(new ne(this.zoom),Y,p))continue;const ie=b?b.evaluate(Y,{},p,u.availableImages):void 0,ce={id:N,properties:k.properties,type:k.type,sourceLayerIndex:j,index:z,geometry:W?Y.geometry:Nl(k,p,y),patterns:{},sortKey:ie};E.push(ce)}b&&E.sort((k,N)=>k.sortKey-N.sortKey);for(const k of E){const{geometry:N,index:z,sourceLayerIndex:j}=k;if(this.hasPattern){const W=kg("fill",this.layers,k,this.zoom,u);this.patternFeatures.push(W)}else this.addFeature(k,N,z,p,{},u.availableImages);u.featureIndex.insert(r[z].feature,N,z,j,this.index)}}update(r,u,p,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,u,this.stateDependentLayers,p,y)}addFeatures(r,u,p,y){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,u,p,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Ux),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,u,p,y,b,E=[]){for(const k of Hp(u,500)){let N=0;for(const ce of k)N+=ce.length;const z=this.segments.prepareSegment(N,this.layoutVertexArray,this.indexArray),j=z.vertexLength,W=[],Y=[];for(const ce of k){if(0===ce.length)continue;ce!==k[0]&&Y.push(W.length/2);const pe=this.segments2.prepareSegment(ce.length,this.layoutVertexArray,this.indexArray2),Ce=pe.vertexLength;this.layoutVertexArray.emplaceBack(ce[0].x,ce[0].y),this.indexArray2.emplaceBack(Ce+ce.length-1,Ce),W.push(ce[0].x),W.push(ce[0].y);for(let Te=1;Te<ce.length;Te++)this.layoutVertexArray.emplaceBack(ce[Te].x,ce[Te].y),this.indexArray2.emplaceBack(Ce+Te-1,Ce+Te),W.push(ce[Te].x),W.push(ce[Te].y);pe.vertexLength+=ce.length,pe.primitiveLength+=ce.length}const ie=zp(W,Y);for(let ce=0;ce<ie.length;ce+=3)this.indexArray.emplaceBack(j+ie[ce],j+ie[ce+1],j+ie[ce+2]);z.vertexLength+=N,z.primitiveLength+=ie.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,p,b,E,y)}}Bt("FillBucket",jp,{omit:["layers","patternFeatures"]});const Zy=new rt({"fill-sort-key":new ke(d.layout_fill["fill-sort-key"])});var $p={paint:new rt({"fill-antialias":new be(d.paint_fill["fill-antialias"]),"fill-opacity":new ke(d.paint_fill["fill-opacity"]),"fill-color":new ke(d.paint_fill["fill-color"]),"fill-outline-color":new ke(d.paint_fill["fill-outline-color"]),"fill-translate":new be(d.paint_fill["fill-translate"]),"fill-translate-anchor":new be(d.paint_fill["fill-translate-anchor"]),"fill-pattern":new Fe(d.paint_fill["fill-pattern"])}),layout:Zy};const Jy=Ye([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Ig=Ye([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:Qx}=Jy;var Ai=dh;function dh(c,r,u,p,y){this.properties={},this.extent=u,this.type=0,this._pbf=c,this._geometry=-1,this._keys=p,this._values=y,c.readFields(eb,this,r)}function eb(c,r,u){1==c?r.id=u.readVarint():2==c?function(p,y){for(var b=p.readVarint()+p.pos;p.pos<b;){var E=y._keys[p.readVarint()],k=y._values[p.readVarint()];y.properties[E]=k}}(u,r):3==c?r.type=u.readVarint():4==c&&(r._geometry=u.pos)}function Pg(c){for(var r,u,p=0,y=0,b=c.length,E=b-1;y<b;E=y++)p+=((u=c[E]).x-(r=c[y]).x)*(r.y+u.y);return p}dh.types=["Unknown","Point","LineString","Polygon"],dh.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var r,u=c.readVarint()+c.pos,p=1,y=0,b=0,E=0,k=[];c.pos<u;){if(y<=0){var N=c.readVarint();p=7&N,y=N>>3}if(y--,1===p||2===p)b+=c.readSVarint(),E+=c.readSVarint(),1===p&&(r&&k.push(r),r=[]),r.push(new Je(b,E));else{if(7!==p)throw new Error("unknown command "+p);r&&r.push(r[0].clone())}}return r&&k.push(r),k},dh.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var r=c.readVarint()+c.pos,u=1,p=0,y=0,b=0,E=1/0,k=-1/0,N=1/0,z=-1/0;c.pos<r;){if(p<=0){var j=c.readVarint();u=7&j,p=j>>3}if(p--,1===u||2===u)(y+=c.readSVarint())<E&&(E=y),y>k&&(k=y),(b+=c.readSVarint())<N&&(N=b),b>z&&(z=b);else if(7!==u)throw new Error("unknown command "+u)}return[E,N,k,z]},dh.prototype.toGeoJSON=function(c,r,u){var p,y,b=this.extent*Math.pow(2,u),E=this.extent*c,k=this.extent*r,N=this.loadGeometry(),z=dh.types[this.type];function j(ie){for(var ce=0;ce<ie.length;ce++){var pe=ie[ce];ie[ce]=[360*(pe.x+E)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(pe.y+k)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var W=[];for(p=0;p<N.length;p++)W[p]=N[p][0];j(N=W);break;case 2:for(p=0;p<N.length;p++)j(N[p]);break;case 3:for(N=function(ie){var ce=ie.length;if(ce<=1)return[ie];for(var pe,Ce,Te=[],Pe=0;Pe<ce;Pe++){var Be=Pg(ie[Pe]);0!==Be&&(void 0===Ce&&(Ce=Be<0),Ce===Be<0?(pe&&Te.push(pe),pe=[ie[Pe]]):pe.push(ie[Pe]))}return pe&&Te.push(pe),Te}(N),p=0;p<N.length;p++)for(y=0;y<N[p].length;y++)j(N[p][y])}1===N.length?N=N[0]:z="Multi"+z;var Y={type:"Feature",geometry:{type:z,coordinates:N},properties:this.properties};return"id"in this&&(Y.id=this.id),Y};var Rg=Ky;function Ky(c,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(tb,this,r),this.length=this._features.length}function tb(c,r,u){15===c?r.version=u.readVarint():1===c?r.name=u.readString():5===c?r.extent=u.readVarint():2===c?r._features.push(u.pos):3===c?r._keys.push(u.readString()):4===c&&r._values.push(function(p){for(var y=null,b=p.readVarint()+p.pos;p.pos<b;){var E=p.readVarint()>>3;y=1===E?p.readString():2===E?p.readFloat():3===E?p.readDouble():4===E?p.readVarint64():5===E?p.readVarint():6===E?p.readSVarint():7===E?p.readBoolean():null}return y}(u))}function nb(c,r,u){if(3===c){var p=new Rg(u,u.readVarint()+u.pos);p.length&&(r[p.name]=p)}}Ky.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var r=this._pbf.readVarint()+this._pbf.pos;return new Ai(this._pbf,r,this.extent,this._keys,this._values)};var vu={VectorTile:function(c,r){this.layers=c.readFields(nb,{},r)},VectorTileFeature:Ai,VectorTileLayer:Rg};const ib=vu.VectorTileFeature.types,hC=Math.pow(2,13);function Gp(c,r,u,p,y,b,E,k){c.emplaceBack((r<<1)+E,(u<<1)+b,(Math.floor(p*hC)<<1)+y,Math.round(k))}class ph{constructor(){this.acc=new Je(0,0),this.polyCount=[]}startRing(r){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Je(r.x,r.y),this.max=new Je(r.x,r.y))}append(r,u){this.currentPolyCount.edges++,this.acc._add(r);let p=!!this.borders;const y=this.min,b=this.max;r.x<y.x?(y.x=r.x,p=!0):r.x>b.x&&(b.x=r.x,p=!0),r.y<y.y?(y.y=r.y,p=!0):r.y>b.y&&(b.y=r.y,p=!0),((0===r.x||r.x===cn)&&r.x===u.x)!=((0===r.y||r.y===cn)&&r.y===u.y)&&this.processBorderOverlap(r,u),p&&this.checkBorderIntersection(r,u)}checkBorderIntersection(r,u){u.x<0!=r.x<0&&this.addBorderIntersection(0,ln(u.y,r.y,(0-u.x)/(r.x-u.x))),u.x>cn!=r.x>cn&&this.addBorderIntersection(1,ln(u.y,r.y,(cn-u.x)/(r.x-u.x))),u.y<0!=r.y<0&&this.addBorderIntersection(2,ln(u.x,r.x,(0-u.y)/(r.y-u.y))),u.y>cn!=r.y>cn&&this.addBorderIntersection(3,ln(u.x,r.x,(cn-u.y)/(r.y-u.y)))}addBorderIntersection(r,u){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[r];u<p[0]&&(p[0]=u),u>p[1]&&(p[1]=u)}processBorderOverlap(r,u){if(r.x===u.x){if(r.y===u.y)return;const p=0===r.x?0:1;this.addBorderIntersection(p,u.y),this.addBorderIntersection(p,r.y)}else{const p=0===r.y?2:3;this.addBorderIntersection(p,u.x),this.addBorderIntersection(p,r.x)}}centroid(){const r=this.polyCount.reduce((u,p)=>u+p.edges,0);return 0!==r?this.acc.div(r)._round():new Je(0,0)}span(){return new Je(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((r,u)=>r+ +(u[0]!==Number.MAX_VALUE),0)}}class gs{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(u=>u.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Yt,this.centroidVertexArray=new od,this.indexArray=new lr,this.programConfigurations=new rh(r.layers,r.zoom),this.segments=new yi,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.enableTerrain=r.enableTerrain}populate(r,u,p,y){this.features=[],this.hasPattern=Mg("fill-extrusion",this.layers,u),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(b){const E=Math.exp(Math.PI*(1-b.y/(1<<b.z)*2));return 80150034*E/(E*E+1)/cn/(1<<b.z)}(p);for(const{feature:b,id:E,index:k,sourceLayerIndex:N}of r){const z=this.layers[0]._featureFilter.needGeometry,j=Pa(b,z);if(!this.layers[0]._featureFilter.filter(new ne(this.zoom),j,p))continue;const W={id:E,sourceLayerIndex:N,index:k,geometry:z?j.geometry:Nl(b,p,y),properties:b.properties,type:b.type,patterns:{}},Y=this.layoutVertexArray.length;this.hasPattern?this.features.push(kg("fill-extrusion",this.layers,W,this.zoom,u)):this.addFeature(W,W.geometry,k,p,{},u.availableImages),u.featureIndex.insert(b,W.geometry,k,N,this.index,Y)}this.sortBorders()}addFeatures(r,u,p,y){for(const b of this.features){const{geometry:E}=b;this.addFeature(b,E,b.index,u,p,y)}this.sortBorders()}update(r,u,p,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,u,this.stateDependentLayers,p,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Qx),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}uploadCentroid(r){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,Ig.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,u,p,y,b,E){const k=this.enableTerrain?new ph:null;for(const z of Hp(u,500)){let j=0,W=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(0===z.length||(N=z[0]).every(Ce=>Ce.x<=0)||N.every(Ce=>Ce.x>=cn)||N.every(Ce=>Ce.y<=0)||N.every(Ce=>Ce.y>=cn))continue;for(let Ce=0;Ce<z.length;Ce++){const Te=z[Ce];if(0===Te.length)continue;j+=Te.length;let Pe=0;k&&k.startRing(Te[0]);for(let Be=0;Be<Te.length;Be++){const je=Te[Be];if(Be>=1){const He=Te[Be-1];if(!Ng(je,He)){k&&k.append(je,He),W.vertexLength+4>yi.MAX_VERTEX_ARRAY_LENGTH&&(W=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ge=je.sub(He)._perp(),ot=Ge.x/(Math.abs(Ge.x)+Math.abs(Ge.y)),nt=Ge.y>0?1:0,Mt=He.dist(je);Pe+Mt>32768&&(Pe=0),Gp(this.layoutVertexArray,je.x,je.y,ot,nt,0,0,Pe),Gp(this.layoutVertexArray,je.x,je.y,ot,nt,0,1,Pe),Pe+=Mt,Gp(this.layoutVertexArray,He.x,He.y,ot,nt,0,0,Pe),Gp(this.layoutVertexArray,He.x,He.y,ot,nt,0,1,Pe);const ft=W.vertexLength;this.indexArray.emplaceBack(ft,ft+2,ft+1),this.indexArray.emplaceBack(ft+1,ft+2,ft+3),W.vertexLength+=4,W.primitiveLength+=2}}}}if(W.vertexLength+j>yi.MAX_VERTEX_ARRAY_LENGTH&&(W=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray)),"Polygon"!==ib[r.type])continue;const Y=[],ie=[],ce=W.vertexLength;for(let Ce=0;Ce<z.length;Ce++){const Te=z[Ce];if(0!==Te.length){Te!==z[0]&&ie.push(Y.length/2);for(let Pe=0;Pe<Te.length;Pe++){const Be=Te[Pe];Gp(this.layoutVertexArray,Be.x,Be.y,0,0,1,1,0),Y.push(Be.x),Y.push(Be.y),k&&k.currentPolyCount.top++}}}const pe=zp(Y,ie);for(let Ce=0;Ce<pe.length;Ce+=3)this.indexArray.emplaceBack(ce+pe[Ce],ce+pe[Ce+2],ce+pe[Ce+1]);W.primitiveLength+=pe.length/3,W.vertexLength+=j}var N;if(k&&k.polyCount.length>0){if(k.borders){k.vertexArrayOffset=this.centroidVertexArray.length;const z=k.borders,j=this.featuresOnBorder.push(k)-1;for(let W=0;W<4;W++)z[W][0]!==Number.MAX_VALUE&&this.borders[W].push(j)}this.encodeCentroid(k.borders?void 0:k.centroid(),k)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,p,b,E,y)}sortBorders(){for(let r=0;r<4;r++)this.borders[r].sort((u,p)=>this.featuresOnBorder[u].borders[r][0]-this.featuresOnBorder[p].borders[r][0])}encodeCentroid(r,u,p=!0){let y,b;if(r)if(0!==r.y){const k=u.span()._mult(this.tileToMeter);y=(Math.max(r.x,1)<<3)+Math.min(7,Math.round(k.x/10)),b=(Math.max(r.y,1)<<3)+Math.min(7,Math.round(k.y/10))}else y=Math.ceil(7*(r.x+450)),b=0;else y=0,b=+p;let E=p?this.centroidVertexArray.length:u.vertexArrayOffset;for(const k of u.polyCount){p&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*k.edges+k.top);for(let N=0;N<2*k.edges;N++)this.centroidVertexArray.emplace(E++,0,b),this.centroidVertexArray.emplace(E++,y,b);for(let N=0;N<k.top;N++)this.centroidVertexArray.emplace(E++,y,b)}}}function Ng(c,r){return c.x===r.x&&(c.x<0||c.x>cn)||c.y===r.y&&(c.y<0||c.y>cn)}Bt("FillExtrusionBucket",gs,{omit:["layers","features"]}),Bt("PartMetadata",ph);var Qy={paint:new rt({"fill-extrusion-opacity":new be(d["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ke(d["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new be(d["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new be(d["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Fe(d["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ke(d["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ke(d["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new be(d["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function fh(c,r){return c.x*r.x+c.y*r.y}function ms(c,r){if(1===c.length){let u=0;const p=r[u++];let y;for(;!y||p.equals(y);)if(y=r[u++],!y)return 1/0;for(;u<r.length;u++){const b=r[u],E=c[0],k=y.sub(p),N=b.sub(p),z=E.sub(p),j=fh(k,k),W=fh(k,N),Y=fh(N,N),ie=fh(z,k),ce=fh(z,N),pe=j*Y-W*W,Ce=(Y*ie-W*ce)/pe,Te=(j*ce-W*ie)/pe,Pe=p.z*(1-Ce-Te)+y.z*Ce+b.z*Te;if(isFinite(Pe))return Pe}return 1/0}{let u=1/0;for(const p of r)u=Math.min(u,p.z);return u}}function gh(c){const r=new Je(c[0],c[1]);return r.z=c[2],r}function Fg(c,r,u,p,y,b,E,k){const N=E*y.getElevationAt(c,r,!0,!0),z=0!==b[0],j=z?0===b[1]?E*(b[0]/7-450):E*function(W,Y,ie){const ce=Math.floor(Y[0]/8),pe=Math.floor(Y[1]/8),Ce=10*(Y[0]-8*ce),Te=10*(Y[1]-8*pe),Pe=W.getElevationAt(ce,pe,!0,!0),Be=W.getMeterToDEM(ie),je=Math.floor(.5*(Ce*Be-1)),He=Math.floor(.5*(Te*Be-1)),Ge=W.tileCoordToPixel(ce,pe),ot=2*je+1,nt=2*He+1,Mt=(Si=ot,Jt=nt,[(It=W).getElevationAtPixel(Ot=Ge.x-je,rn=Ge.y-He,!0),It.getElevationAtPixel(Ot+Jt,rn,!0),It.getElevationAtPixel(Ot,rn+Jt,!0),It.getElevationAtPixel(Ot+Si,rn+Jt,!0)]),ft=Math.abs(Mt[0]-Mt[1]),lt=Math.abs(Mt[2]-Mt[3]),gt=Math.abs(Mt[0]-Mt[2])+Math.abs(Mt[1]-Mt[3]),Ct=Math.min(.25,.5*Be*(ft+lt)/ot),ct=Math.min(.25,.5*Be*gt/nt);var It,Ot,rn,Si,Jt;return Pe+Math.max(Ct*Ce,ct*Te)}(y,b,k):N;return{base:N+(0===u)?-1:u,top:z?Math.max(j+p,N+u+2):N+p}}const rb=Ye([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:sb}=rb,e_=Ye([{name:"a_packed",components:3,type:"Float32"}]),{members:ob}=e_,t_=vu.VectorTileFeature.types,ab=Math.cos(Math.PI/180*37.5);class Cd{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(u=>u.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new Zt,this.layoutVertexArray2=new tn,this.indexArray=new lr,this.programConfigurations=new rh(r.layers,r.zoom),this.segments=new yi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(r,u,p,y){this.hasPattern=Mg("line",this.layers,u);const b=this.layers[0].layout.get("line-sort-key"),E=[];for(const{feature:j,id:W,index:Y,sourceLayerIndex:ie}of r){const ce=this.layers[0]._featureFilter.needGeometry,pe=Pa(j,ce);if(!this.layers[0]._featureFilter.filter(new ne(this.zoom),pe,p))continue;const Ce=b?b.evaluate(pe,{},p):void 0,Te={id:W,properties:j.properties,type:j.type,sourceLayerIndex:ie,index:Y,geometry:ce?pe.geometry:Nl(j,p,y),patterns:{},sortKey:Ce};E.push(Te)}b&&E.sort((j,W)=>j.sortKey-W.sortKey);const{lineAtlas:k,featureIndex:N}=u,z=this.addConstantDashes(k);for(const j of E){const{geometry:W,index:Y,sourceLayerIndex:ie}=j;if(z&&this.addFeatureDashes(j,k),this.hasPattern){const ce=kg("line",this.layers,j,this.zoom,u);this.patternFeatures.push(ce)}else this.addFeature(j,W,Y,p,k.positions,u.availableImages);N.insert(r[Y].feature,W,Y,ie,this.index)}}addConstantDashes(r){let u=!1;for(const p of this.layers){const y=p.paint.get("line-dasharray").value,b=p.layout.get("line-cap").value;if("constant"!==y.kind||"constant"!==b.kind)u=!0;else{const E=b.value,k=y.value;if(!k)continue;r.addDash(k.from,E),r.addDash(k.to,E),k.other&&r.addDash(k.other,E)}}return u}addFeatureDashes(r,u){const p=this.zoom;for(const y of this.layers){const b=y.paint.get("line-dasharray").value,E=y.layout.get("line-cap").value;if("constant"===b.kind&&"constant"===E.kind)continue;let k,N,z,j,W,Y;if("constant"===b.kind){const Ce=b.value;if(!Ce)continue;k=Ce.other||Ce.to,N=Ce.to,z=Ce.from}else k=b.evaluate({zoom:p-1},r),N=b.evaluate({zoom:p},r),z=b.evaluate({zoom:p+1},r);"constant"===E.kind?j=W=Y=E.value:(j=E.evaluate({zoom:p-1},r),W=E.evaluate({zoom:p},r),Y=E.evaluate({zoom:p+1},r)),u.addDash(k,j),u.addDash(N,W),u.addDash(z,Y);const ie=u.getKey(k,j),ce=u.getKey(N,W),pe=u.getKey(z,Y);r.patterns[y.id]={min:ie,mid:ce,max:pe}}}update(r,u,p,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,u,this.stateDependentLayers,p,y)}addFeatures(r,u,p,y){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,u,p,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,ob)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,sb),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,u,p,y,b,E){const k=this.layers[0].layout,N=k.get("line-join").evaluate(r,{}),z=k.get("line-cap").evaluate(r,{}),j=k.get("line-miter-limit"),W=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const Y of u)this.addLine(Y,r,N,z,j,W);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,p,b,E,y)}addLine(r,u,p,y,b,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Te=0;Te<r.length-1;Te++)this.totalDistance+=r[Te].dist(r[Te+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const k="Polygon"===t_[u.type];let N=r.length;for(;N>=2&&r[N-1].equals(r[N-2]);)N--;let z=0;for(;z<N-1&&r[z].equals(r[z+1]);)z++;if(N<(k?3:2))return;"bevel"===p&&(b=1.05);const j=this.overscaling<=16?122880/(512*this.overscaling):0,W=this.segments.prepareSegment(10*N,this.layoutVertexArray,this.indexArray);let Y,ie,ce,pe,Ce;this.e1=this.e2=-1,k&&(Y=r[N-2],Ce=r[z].sub(Y)._unit()._perp());for(let Te=z;Te<N;Te++){if(ce=Te===N-1?k?r[z+1]:void 0:r[Te+1],ce&&r[Te].equals(ce))continue;Ce&&(pe=Ce),Y&&(ie=Y),Y=r[Te],Ce=ce?ce.sub(Y)._unit()._perp():pe,pe=pe||Ce;let Pe=pe.add(Ce);0===Pe.x&&0===Pe.y||Pe._unit();const Be=pe.x*Ce.x+pe.y*Ce.y,je=Pe.x*Ce.x+Pe.y*Ce.y,He=0!==je?1/je:1/0,Ge=2*Math.sqrt(2-2*je),ot=je<ab&&ie&&ce,nt=pe.x*Ce.y-pe.y*Ce.x>0;if(ot&&Te>z){const lt=Y.dist(ie);if(lt>2*j){const gt=Y.sub(Y.sub(ie)._mult(j/lt)._round());this.updateDistance(ie,gt),this.addCurrentVertex(gt,pe,0,0,W),ie=gt}}const Mt=ie&&ce;let ft=Mt?p:k?"butt":y;if(Mt&&"round"===ft&&(He<E?ft="miter":He<=2&&(ft="fakeround")),"miter"===ft&&He>b&&(ft="bevel"),"bevel"===ft&&(He>2&&(ft="flipbevel"),He<b&&(ft="miter")),ie&&this.updateDistance(ie,Y),"miter"===ft)Pe._mult(He),this.addCurrentVertex(Y,Pe,0,0,W);else if("flipbevel"===ft){if(He>100)Pe=Ce.mult(-1);else{const lt=He*pe.add(Ce).mag()/pe.sub(Ce).mag();Pe._perp()._mult(lt*(nt?-1:1))}this.addCurrentVertex(Y,Pe,0,0,W),this.addCurrentVertex(Y,Pe.mult(-1),0,0,W)}else if("bevel"===ft||"fakeround"===ft){const lt=-Math.sqrt(He*He-1),gt=nt?lt:0,Ct=nt?0:lt;if(ie&&this.addCurrentVertex(Y,pe,gt,Ct,W),"fakeround"===ft){const ct=Math.round(180*Ge/Math.PI/20);for(let It=1;It<ct;It++){let Ot=It/ct;if(.5!==Ot){const Si=Ot-.5;Ot+=Ot*Si*(Ot-1)*((1.0904+Be*(Be*(3.55645-1.43519*Be)-3.2452))*Si*Si+(.848013+Be*(.215638*Be-1.06021)))}const rn=Ce.sub(pe)._mult(Ot)._add(pe)._unit()._mult(nt?-1:1);this.addHalfVertex(Y,rn.x,rn.y,!1,nt,0,W)}}ce&&this.addCurrentVertex(Y,Ce,-gt,-Ct,W)}else if("butt"===ft)this.addCurrentVertex(Y,Pe,0,0,W);else if("square"===ft){const lt=ie?1:-1;ie||this.addCurrentVertex(Y,Pe,lt,lt,W),this.addCurrentVertex(Y,Pe,0,0,W),ie&&this.addCurrentVertex(Y,Pe,lt,lt,W)}else"round"===ft&&(ie&&(this.addCurrentVertex(Y,pe,0,0,W),this.addCurrentVertex(Y,pe,1,1,W,!0)),ce&&(this.addCurrentVertex(Y,Ce,-1,-1,W,!0),this.addCurrentVertex(Y,Ce,0,0,W)));if(ot&&Te<N-1){const lt=Y.dist(ce);if(lt>2*j){const gt=Y.add(ce.sub(Y)._mult(j/lt)._round());this.updateDistance(Y,gt),this.addCurrentVertex(gt,Ce,0,0,W),Y=gt}}}}addCurrentVertex(r,u,p,y,b,E=!1){const k=u.y*y-u.x,N=-u.y-u.x*y;this.addHalfVertex(r,u.x+u.y*p,u.y-u.x*p,E,!1,p,b),this.addHalfVertex(r,k,N,E,!0,-y,b)}addHalfVertex({x:r,y:u},p,y,b,E,k,N){this.layoutVertexArray.emplaceBack((r<<1)+(b?1:0),(u<<1)+(E?1:0),Math.round(63*p)+128,Math.round(63*y)+128,1+(0===k?0:k<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const z=N.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),N.primitiveLength++),E?this.e2=z:this.e1=z}updateScaledDistance(){if(this.lineClips){const r=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=r*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(r,u){this.distance+=r.dist(u),this.updateScaledDistance()}}Bt("LineBucket",Cd,{omit:["layers","patternFeatures"]});const lb=new rt({"line-cap":new ke(d.layout_line["line-cap"]),"line-join":new ke(d.layout_line["line-join"]),"line-miter-limit":new be(d.layout_line["line-miter-limit"]),"line-round-limit":new be(d.layout_line["line-round-limit"]),"line-sort-key":new ke(d.layout_line["line-sort-key"])});var n_={paint:new rt({"line-opacity":new ke(d.paint_line["line-opacity"]),"line-color":new ke(d.paint_line["line-color"]),"line-translate":new be(d.paint_line["line-translate"]),"line-translate-anchor":new be(d.paint_line["line-translate-anchor"]),"line-width":new ke(d.paint_line["line-width"]),"line-gap-width":new ke(d.paint_line["line-gap-width"]),"line-offset":new ke(d.paint_line["line-offset"]),"line-blur":new ke(d.paint_line["line-blur"]),"line-dasharray":new Fe(d.paint_line["line-dasharray"]),"line-pattern":new Fe(d.paint_line["line-pattern"]),"line-gradient":new Ke(d.paint_line["line-gradient"])}),layout:lb};const i_=new class extends ke{possiblyEvaluate(c,r){return r=new ne(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(c,r)}evaluate(c,r,u,p){return r=Mi({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(c,r,u,p)}}(n_.paint.properties["line-width"].specification);function Og(c,r){return r>0?r+2*c:c}i_.useIntegerZoom=!0;const Lg=Ye([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),r_=Ye([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ye([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const cb=Ye([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),dC=Ye([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const zg=Ye([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Wp=Ye([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ye([{name:"triangle",components:3,type:"Uint16"}]),Ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ye([{type:"Float32",name:"offsetX"}]),Ye([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const tl=128;function zl(c,r){const{expression:u}=r;if("constant"===u.kind)return{kind:"constant",layoutSize:u.evaluate(new ne(c+1))};if("source"===u.kind)return{kind:"source"};{const{zoomStops:p,interpolationType:y}=u;let b=0;for(;b<p.length&&p[b]<=c;)b++;b=Math.max(0,b-1);let E=b;for(;E<p.length&&p[E]<c+1;)E++;E=Math.min(p.length-1,E);const k=p[b],N=p[E];return"composite"===u.kind?{kind:"composite",minZoom:k,maxZoom:N,interpolationType:y}:{kind:"camera",minZoom:k,maxZoom:N,minSize:u.evaluate(new ne(k)),maxSize:u.evaluate(new ne(N)),interpolationType:y}}}function Xp(c,{uSize:r,uSizeT:u},{lowerSize:p,upperSize:y}){return"source"===c.kind?p/tl:"composite"===c.kind?ln(p/tl,y/tl,u):r}function mh(c,r){let u=0,p=0;if("constant"===c.kind)p=c.layoutSize;else if("source"!==c.kind){const{interpolationType:y,minZoom:b,maxZoom:E}=c,k=y?On(ks.interpolationFactor(y,r,b,E),0,1):0;"camera"===c.kind?p=ln(c.minSize,c.maxSize,k):u=k}return{uSizeT:u,uSize:p}}var ub=Object.freeze({__proto__:null,getSizeData:zl,evaluateSizeForFeature:Xp,evaluateSizeForZoom:mh,SIZE_PACK_FACTOR:tl});function hb(c,r,u){return c.sections.forEach(p=>{p.text=function(y,b,E){const k=b.layout.get("text-transform").evaluate(E,{});return"uppercase"===k?y=y.toLocaleUpperCase():"lowercase"===k&&(y=y.toLocaleLowerCase()),ee.applyArabicShaping&&(y=ee.applyArabicShaping(y)),y}(p.text,r,u)}),c}const Sd={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function Yp(c){return"\ufe36"===c||"\ufe48"===c||"\ufe38"===c||"\ufe44"===c||"\ufe42"===c||"\ufe3e"===c||"\ufe3c"===c||"\ufe3a"===c||"\ufe18"===c||"\ufe40"===c||"\ufe10"===c||"\ufe13"===c||"\ufe14"===c||"\uff40"===c||"\uffe3"===c||"\ufe11"===c||"\ufe12"===c}function s_(c){return"\ufe35"===c||"\ufe47"===c||"\ufe37"===c||"\ufe43"===c||"\ufe41"===c||"\ufe3d"===c||"\ufe3b"===c||"\ufe39"===c||"\ufe17"===c||"\ufe3f"===c}var o_=function(c,r,u,p,y){var b,E,k=8*y-p-1,N=(1<<k)-1,z=N>>1,j=-7,W=u?y-1:0,Y=u?-1:1,ie=c[r+W];for(W+=Y,b=ie&(1<<-j)-1,ie>>=-j,j+=k;j>0;b=256*b+c[r+W],W+=Y,j-=8);for(E=b&(1<<-j)-1,b>>=-j,j+=p;j>0;E=256*E+c[r+W],W+=Y,j-=8);if(0===b)b=1-z;else{if(b===N)return E?NaN:1/0*(ie?-1:1);E+=Math.pow(2,p),b-=z}return(ie?-1:1)*E*Math.pow(2,b-p)},a_=function(c,r,u,p,y,b){var E,k,N,z=8*b-y-1,j=(1<<z)-1,W=j>>1,Y=23===y?Math.pow(2,-24)-Math.pow(2,-77):0,ie=p?0:b-1,ce=p?1:-1,pe=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(k=isNaN(r)?1:0,E=j):(E=Math.floor(Math.log(r)/Math.LN2),r*(N=Math.pow(2,-E))<1&&(E--,N*=2),(r+=E+W>=1?Y/N:Y*Math.pow(2,1-W))*N>=2&&(E++,N/=2),E+W>=j?(k=0,E=j):E+W>=1?(k=(r*N-1)*Math.pow(2,y),E+=W):(k=r*Math.pow(2,W-1)*Math.pow(2,y),E=0));y>=8;c[u+ie]=255&k,ie+=ce,k/=256,y-=8);for(E=E<<y|k,z+=y;z>0;c[u+ie]=255&E,ie+=ce,E/=256,z-=8);c[u+ie-ce]|=128*pe},yh=si;function si(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}si.Varint=0,si.Fixed64=1,si.Bytes=2,si.Fixed32=5;var Bg=4294967296,l_=1/Bg,c_="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function So(c){return c.type===si.Bytes?c.readVarint()+c.pos:c.pos+1}function db(c,r,u){var p=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));u.realloc(p);for(var y=u.pos-1;y>=c;y--)u.buf[y+p]=u.buf[y]}function pC(c,r){for(var u=0;u<c.length;u++)r.writeVarint(c[u])}function u_(c,r){for(var u=0;u<c.length;u++)r.writeSVarint(c[u])}function fC(c,r){for(var u=0;u<c.length;u++)r.writeFloat(c[u])}function Jo(c,r){for(var u=0;u<c.length;u++)r.writeDouble(c[u])}function Vg(c,r){for(var u=0;u<c.length;u++)r.writeBoolean(c[u])}function Ug(c,r){for(var u=0;u<c.length;u++)r.writeFixed32(c[u])}function pb(c,r){for(var u=0;u<c.length;u++)r.writeSFixed32(c[u])}function h_(c,r){for(var u=0;u<c.length;u++)r.writeFixed64(c[u])}function Dd(c,r){for(var u=0;u<c.length;u++)r.writeSFixed64(c[u])}function Ed(c,r){return(c[r]|c[r+1]<<8|c[r+2]<<16)+16777216*c[r+3]}function xu(c,r,u){c[u]=r,c[u+1]=r>>>8,c[u+2]=r>>>16,c[u+3]=r>>>24}function qp(c,r){return(c[r]|c[r+1]<<8|c[r+2]<<16)+(c[r+3]<<24)}function Hg(c,r,u){r.glyphs=[],1===c&&u.readMessage(d_,r)}function d_(c,r,u){if(3===c){const{id:p,bitmap:y,width:b,height:E,left:k,top:N,advance:z}=u.readMessage(gC,{});r.glyphs.push({id:p,bitmap:new Fl({width:b+6,height:E+6},y),metrics:{width:b,height:E,left:k,top:N,advance:z}})}else 4===c?r.ascender=u.readSVarint():5===c&&(r.descender=u.readSVarint())}function gC(c,r,u){1===c?r.id=u.readVarint():2===c?r.bitmap=u.readBytes():3===c?r.width=u.readVarint():4===c?r.height=u.readVarint():5===c?r.left=u.readSVarint():6===c?r.top=u.readSVarint():7===c&&(r.advance=u.readVarint())}function Uc(c){let r=0,u=0;for(const E of c)r+=E.w*E.h,u=Math.max(u,E.w);c.sort((E,k)=>k.h-E.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),u),h:1/0}];let y=0,b=0;for(const E of c)for(let k=p.length-1;k>=0;k--){const N=p[k];if(!(E.w>N.w||E.h>N.h)){if(E.x=N.x,E.y=N.y,b=Math.max(b,E.y+E.h),y=Math.max(y,E.x+E.w),E.w===N.w&&E.h===N.h){const z=p.pop();k<p.length&&(p[k]=z)}else E.h===N.h?(N.x+=E.w,N.w-=E.w):E.w===N.w?(N.y+=E.h,N.h-=E.h):(p.push({x:N.x+E.w,y:N.y,w:N.w-E.w,h:E.h}),N.y+=E.h,N.h-=E.h);break}}return{w:y,h:b,fill:r/(y*b)||0}}si.prototype={destroy:function(){this.buf=null},readFields:function(c,r,u){for(u=u||this.length;this.pos<u;){var p=this.readVarint(),y=p>>3,b=this.pos;this.type=7&p,c(y,r,this),this.pos===b&&this.skip(p)}return r},readMessage:function(c,r){return this.readFields(c,r,this.readVarint()+this.pos)},readFixed32:function(){var c=Ed(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=qp(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=Ed(this.buf,this.pos)+Ed(this.buf,this.pos+4)*Bg;return this.pos+=8,c},readSFixed64:function(){var c=Ed(this.buf,this.pos)+qp(this.buf,this.pos+4)*Bg;return this.pos+=8,c},readFloat:function(){var c=o_(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=o_(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var r,u,p=this.buf;return r=127&(u=p[this.pos++]),u<128?r:(r|=(127&(u=p[this.pos++]))<<7,u<128?r:(r|=(127&(u=p[this.pos++]))<<14,u<128?r:(r|=(127&(u=p[this.pos++]))<<21,u<128?r:function(y,b,E){var k,N,z=E.buf;if(k=(112&(N=z[E.pos++]))>>4,N<128||(k|=(127&(N=z[E.pos++]))<<3,N<128)||(k|=(127&(N=z[E.pos++]))<<10,N<128)||(k|=(127&(N=z[E.pos++]))<<17,N<128)||(k|=(127&(N=z[E.pos++]))<<24,N<128)||(k|=(1&(N=z[E.pos++]))<<31,N<128))return function(c,r,u){return u?4294967296*r+(c>>>0):4294967296*(r>>>0)+(c>>>0)}(y,k,b);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(u=p[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var c=this.readVarint()+this.pos,r=this.pos;return this.pos=c,c-r>=12&&c_?c_.decode(this.buf.subarray(r,c)):function(u,p,y){for(var b="",E=p;E<y;){var k,N,z,j=u[E],W=null,Y=j>239?4:j>223?3:j>191?2:1;if(E+Y>y)break;1===Y?j<128&&(W=j):2===Y?128==(192&(k=u[E+1]))&&(W=(31&j)<<6|63&k)<=127&&(W=null):3===Y?(N=u[E+2],128==(192&(k=u[E+1]))&&128==(192&N)&&((W=(15&j)<<12|(63&k)<<6|63&N)<=2047||W>=55296&&W<=57343)&&(W=null)):4===Y&&(N=u[E+2],z=u[E+3],128==(192&(k=u[E+1]))&&128==(192&N)&&128==(192&z)&&((W=(15&j)<<18|(63&k)<<12|(63&N)<<6|63&z)<=65535||W>=1114112)&&(W=null)),null===W?(W=65533,Y=1):W>65535&&(W-=65536,b+=String.fromCharCode(W>>>10&1023|55296),W=56320|1023&W),b+=String.fromCharCode(W),E+=Y}return b}(this.buf,r,c)},readBytes:function(){var c=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,c);return this.pos=c,r},readPackedVarint:function(c,r){if(this.type!==si.Bytes)return c.push(this.readVarint(r));var u=So(this);for(c=c||[];this.pos<u;)c.push(this.readVarint(r));return c},readPackedSVarint:function(c){if(this.type!==si.Bytes)return c.push(this.readSVarint());var r=So(this);for(c=c||[];this.pos<r;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==si.Bytes)return c.push(this.readBoolean());var r=So(this);for(c=c||[];this.pos<r;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==si.Bytes)return c.push(this.readFloat());var r=So(this);for(c=c||[];this.pos<r;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==si.Bytes)return c.push(this.readDouble());var r=So(this);for(c=c||[];this.pos<r;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==si.Bytes)return c.push(this.readFixed32());var r=So(this);for(c=c||[];this.pos<r;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==si.Bytes)return c.push(this.readSFixed32());var r=So(this);for(c=c||[];this.pos<r;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==si.Bytes)return c.push(this.readFixed64());var r=So(this);for(c=c||[];this.pos<r;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==si.Bytes)return c.push(this.readSFixed64());var r=So(this);for(c=c||[];this.pos<r;)c.push(this.readSFixed64());return c},skip:function(c){var r=7&c;if(r===si.Varint)for(;this.buf[this.pos++]>127;);else if(r===si.Bytes)this.pos=this.readVarint()+this.pos;else if(r===si.Fixed32)this.pos+=4;else{if(r!==si.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(c,r){this.writeVarint(c<<3|r)},realloc:function(c){for(var r=this.length||16;r<this.pos+c;)r*=2;if(r!==this.length){var u=new Uint8Array(r);u.set(this.buf),this.buf=u,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),xu(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),xu(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),xu(this.buf,-1&c,this.pos),xu(this.buf,Math.floor(c*l_),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),xu(this.buf,-1&c,this.pos),xu(this.buf,Math.floor(c*l_),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(r,u){var p,y,b,k;if(r>=0?(p=r%4294967296|0,y=r/4294967296|0):(y=~(-r/4294967296),4294967295^(p=~(-r%4294967296))?p=p+1|0:(p=0,y=y+1|0)),r>=0x10000000000000000||r<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),b=p,(k=u).buf[k.pos++]=127&b|128,b>>>=7,k.buf[k.pos++]=127&b|128,b>>>=7,k.buf[k.pos++]=127&b|128,b>>>=7,k.buf[k.pos++]=127&b|128,k.buf[k.pos]=127&(b>>>=7),function(b,E){var k=(7&b)<<4;E.buf[E.pos++]|=k|((b>>>=3)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b)))))}(y,u)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(Boolean(c))},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var r=this.pos;this.pos=function(p,y,b){for(var E,k,N=0;N<y.length;N++){if((E=y.charCodeAt(N))>55295&&E<57344){if(!k){E>56319||N+1===y.length?(p[b++]=239,p[b++]=191,p[b++]=189):k=E;continue}if(E<56320){p[b++]=239,p[b++]=191,p[b++]=189,k=E;continue}E=k-55296<<10|E-56320|65536,k=null}else k&&(p[b++]=239,p[b++]=191,p[b++]=189,k=null);E<128?p[b++]=E:(E<2048?p[b++]=E>>6|192:(E<65536?p[b++]=E>>12|224:(p[b++]=E>>18|240,p[b++]=E>>12&63|128),p[b++]=E>>6&63|128),p[b++]=63&E|128)}return b}(this.buf,c,this.pos);var u=this.pos-r;u>=128&&db(r,u,this),this.pos=r-1,this.writeVarint(u),this.pos+=u},writeFloat:function(c){this.realloc(4),a_(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),a_(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var r=c.length;this.writeVarint(r),this.realloc(r);for(var u=0;u<r;u++)this.buf[this.pos++]=c[u]},writeRawMessage:function(c,r){this.pos++;var u=this.pos;c(r,this);var p=this.pos-u;p>=128&&db(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeMessage:function(c,r,u){this.writeTag(c,si.Bytes),this.writeRawMessage(r,u)},writePackedVarint:function(c,r){r.length&&this.writeMessage(c,pC,r)},writePackedSVarint:function(c,r){r.length&&this.writeMessage(c,u_,r)},writePackedBoolean:function(c,r){r.length&&this.writeMessage(c,Vg,r)},writePackedFloat:function(c,r){r.length&&this.writeMessage(c,fC,r)},writePackedDouble:function(c,r){r.length&&this.writeMessage(c,Jo,r)},writePackedFixed32:function(c,r){r.length&&this.writeMessage(c,Ug,r)},writePackedSFixed32:function(c,r){r.length&&this.writeMessage(c,pb,r)},writePackedFixed64:function(c,r){r.length&&this.writeMessage(c,h_,r)},writePackedSFixed64:function(c,r){r.length&&this.writeMessage(c,Dd,r)},writeBytesField:function(c,r){this.writeTag(c,si.Bytes),this.writeBytes(r)},writeFixed32Field:function(c,r){this.writeTag(c,si.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(c,r){this.writeTag(c,si.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(c,r){this.writeTag(c,si.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(c,r){this.writeTag(c,si.Fixed64),this.writeSFixed64(r)},writeVarintField:function(c,r){this.writeTag(c,si.Varint),this.writeVarint(r)},writeSVarintField:function(c,r){this.writeTag(c,si.Varint),this.writeSVarint(r)},writeStringField:function(c,r){this.writeTag(c,si.Bytes),this.writeString(r)},writeFloatField:function(c,r){this.writeTag(c,si.Fixed32),this.writeFloat(r)},writeDoubleField:function(c,r){this.writeTag(c,si.Fixed64),this.writeDouble(r)},writeBooleanField:function(c,r){this.writeVarintField(c,Boolean(r))}};class Ad{constructor(r,{pixelRatio:u,version:p,stretchX:y,stretchY:b,content:E}){this.paddedRect=r,this.pixelRatio=u,this.stretchX=y,this.stretchY=b,this.content=E,this.version=p}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class jg{constructor(r,u){const p={},y={};this.haveRenderCallbacks=[];const b=[];this.addImages(r,p,b),this.addImages(u,y,b);const{w:E,h:k}=Uc(b),N=new Co({width:E||1,height:k||1});for(const z in r){const j=r[z],W=p[z].paddedRect;Co.copy(j.data,N,{x:0,y:0},{x:W.x+1,y:W.y+1},j.data)}for(const z in u){const j=u[z],W=y[z].paddedRect,Y=W.x+1,ie=W.y+1,ce=j.data.width,pe=j.data.height;Co.copy(j.data,N,{x:0,y:0},{x:Y,y:ie},j.data),Co.copy(j.data,N,{x:0,y:pe-1},{x:Y,y:ie-1},{width:ce,height:1}),Co.copy(j.data,N,{x:0,y:0},{x:Y,y:ie+pe},{width:ce,height:1}),Co.copy(j.data,N,{x:ce-1,y:0},{x:Y-1,y:ie},{width:1,height:pe}),Co.copy(j.data,N,{x:0,y:0},{x:Y+ce,y:ie},{width:1,height:pe})}this.image=N,this.iconPositions=p,this.patternPositions=y}addImages(r,u,p){for(const y in r){const b=r[y],E={x:0,y:0,w:b.data.width+2,h:b.data.height+2};p.push(E),u[y]=new Ad(E,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(y)}}patchUpdatedImages(r,u){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in r.updatedImages)this.patchUpdatedImage(this.iconPositions[p],r.getImage(p),u),this.patchUpdatedImage(this.patternPositions[p],r.getImage(p),u)}patchUpdatedImage(r,u,p){if(!r||!u||r.version===u.version)return;r.version=u.version;const[y,b]=r.tl;p.update(u.data,void 0,{x:y,y:b})}}Bt("ImagePosition",Ad),Bt("ImageAtlas",jg);const Ko={horizontal:1,vertical:2,horizontalOnly:3};class bu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,u){const p=new bu;return p.scale=r||1,p.fontStack=u,p}static forImage(r){const u=new bu;return u.imageName=r,u}}class _h{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,u){const p=new _h;for(let y=0;y<r.sections.length;y++){const b=r.sections[y];b.image?p.addImageSection(b):p.addTextSection(b,u)}return p}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSections(){return this.sections}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(r){this.text=function(u,p){let y="";for(let b=0;b<u.length;b++){const E=u.charCodeAt(b+1)||null,k=u.charCodeAt(b-1)||null;y+=!p&&(E&&th(E)&&!Sd[u[b+1]]||k&&th(k)&&!Sd[u[b-1]])||!Sd[u[b]]?u[b]:Sd[u[b]]}return y}(this.text,r)}trim(){let r=0;for(let p=0;p<this.text.length&&Zp[this.text.charCodeAt(p)];p++)r++;let u=this.text.length;for(let p=this.text.length-1;p>=0&&p>=r&&Zp[this.text.charCodeAt(p)];p--)u--;this.text=this.text.substring(r,u),this.sectionIndex=this.sectionIndex.slice(r,u)}substring(r,u){const p=new _h;return p.text=this.text.substring(r,u),p.sectionIndex=this.sectionIndex.slice(r,u),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,u)=>Math.max(r,this.sections[u].scale),0)}addTextSection(r,u){this.text+=r.text,this.sections.push(bu.forText(r.scale,r.fontStack||u));const p=this.sections.length-1;for(let y=0;y<r.text.length;++y)this.sectionIndex.push(p)}addImageSection(r){const u=r.image?r.image.name:"";if(0===u.length)return void mn("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(bu.forImage(u)),this.sectionIndex.push(this.sections.length-1)):mn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function $g(c,r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce,pe){const Ce=_h.fromFeature(c,y);let Te;W===Ko.vertical&&Ce.verticalizePunctuation(Y);const{processBidirectionalText:Pe,processStyledBidirectionalText:Be}=ee;if(Pe&&1===Ce.sections.length){Te=[];const Ge=Pe(Ce.toString(),Td(Ce,z,b,r,p,ie,ce));for(const ot of Ge){const nt=new _h;nt.text=ot,nt.sections=Ce.sections;for(let Mt=0;Mt<ot.length;Mt++)nt.sectionIndex.push(0);Te.push(nt)}}else if(Be){Te=[];const Ge=Be(Ce.text,Ce.sectionIndex,Td(Ce,z,b,r,p,ie,ce));for(const ot of Ge){const nt=new _h;nt.text=ot[0],nt.sectionIndex=ot[1],nt.sections=Ce.sections,Te.push(nt)}}else Te=function(Ge,ot){const nt=[],Mt=Ge.text;let ft=0;for(const lt of ot)nt.push(Ge.substring(ft,lt)),ft=lt;return ft<Mt.length&&nt.push(Ge.substring(ft,Mt.length)),nt}(Ce,Td(Ce,z,b,r,p,ie,ce));const je=[],He={positionedLines:je,text:Ce.toString(),top:j[1],bottom:j[1],left:j[0],right:j[0],writingMode:W,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Ge,ot,nt,Mt,ft,lt,gt,Ct,ct,It,Ot,rn){let Si=0,Jt=0,Wn=0;const Pt="right"===Ct?1:"left"===Ct?0:.5;let ci=!1;for(const oi of ft){const Kn=oi.getSections();for(const ei of Kn){if(ei.imageName)continue;const Gr=ot[ei.fontStack];if(Gr&&(ci=void 0!==Gr.ascender&&void 0!==Gr.descender,!ci))break}if(!ci)break}let Hn=0;for(const oi of ft){oi.trim();const Kn=oi.getMaxScale(),ei=24*(Kn-1),Gr={positionedGlyphs:[],lineOffset:0};Ge.positionedLines[Hn]=Gr;const zi=Gr.positionedGlyphs;let Wi=0;if(!oi.length()){Jt+=lt,++Hn;continue}let ts=0,Ni=0;for(let vi=0;vi<oi.length();vi++){const Qi=oi.getSection(vi),ur=oi.getSectionIndex(vi),Ui=oi.getCharCode(vi);let Xi=Qi.scale,vr=null,ui=null,hr=null,ga=24,Qo=0;const ma=!(ct===Ko.horizontal||!Ot&&!id(Ui)||Ot&&(Zp[Ui]||(Ki=Ui,Ep(Ki)||Ma(Ki)||td(Ki)||Tl(Ki)||Vr(Ki))));if(Qi.imageName){const ns=Mt[Qi.imageName];if(!ns)continue;hr=Qi.imageName,Ge.iconsInText=Ge.iconsInText||!0,ui=ns.paddedRect;const ys=ns.displaySize;Xi=24*Xi/rn,vr={width:ys[0],height:ys[1],left:1,top:-3,advance:ma?ys[1]:ys[0],localGlyph:!1},Qo=ci?-vr.height*Xi:24*Kn-17-ys[1]*Xi,ga=vr.advance;const Xl=(ma?ys[0]:ys[1])*Xi-24*Kn;Xl>0&&Xl>Wi&&(Wi=Xl)}else{const ns=nt[Qi.fontStack];if(!ns)continue;ns[Ui]&&(ui=ns[Ui]);const ys=ot[Qi.fontStack];if(!ys)continue;const Xl=ys.glyphs[Ui];if(!Xl)continue;if(vr=Xl.metrics,ga=8203!==Ui?24:0,ci){const Dh=void 0!==ys.ascender?Math.abs(ys.ascender):0,Eh=void 0!==ys.descender?Math.abs(ys.descender):0,Bd=(Dh+Eh)*Xi;ts<Bd&&(ts=Bd,Ni=(Dh-Eh)/2*Xi),Qo=-Dh*Xi}else Qo=24*(Kn-Xi)-17}ma?(Ge.verticalizable=!0,zi.push({glyph:Ui,imageName:hr,x:Si,y:Jt+Qo,vertical:ma,scale:Xi,localGlyph:vr.localGlyph,fontStack:Qi.fontStack,sectionIndex:ur,metrics:vr,rect:ui}),Si+=ga*Xi+It):(zi.push({glyph:Ui,imageName:hr,x:Si,y:Jt+Qo,vertical:ma,scale:Xi,localGlyph:vr.localGlyph,fontStack:Qi.fontStack,sectionIndex:ur,metrics:vr,rect:ui}),Si+=vr.advance*Xi+It)}0!==zi.length&&(Wn=Math.max(Si-It,Wn),ci?m_(zi,Pt,Wi,Ni,lt*Kn/2):m_(zi,Pt,Wi,0,lt/2)),Si=0;const Ns=lt*Kn+Wi;Gr.lineOffset=Math.max(Wi,ei),Jt+=Ns,++Hn}var Ki;const _i=Jt,{horizontalAlign:Gi,verticalAlign:$r}=Wg(gt);(function(oi,Kn,ei,Gr,zi,Wi){const ts=(Kn-ei)*zi,Ni=-Wi*Gr;for(const Ns of oi)for(const vi of Ns.positionedGlyphs)vi.x+=ts,vi.y+=Ni})(Ge.positionedLines,Pt,Gi,$r,Wn,_i),Ge.top+=-$r*_i,Ge.bottom=Ge.top+_i,Ge.left+=-Gi*Wn,Ge.right=Ge.left+Wn,Ge.hasBaseline=ci}(He,r,u,p,Te,E,k,N,W,z,Y,pe),!function(Ge){for(const ot of Ge)if(0!==ot.positionedGlyphs.length)return!1;return!0}(je)&&He}const Zp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},fb={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function p_(c,r,u,p,y,b){if(r.imageName){const E=p[r.imageName];return E?E.displaySize[0]*r.scale*24/b+y:0}{const E=u[r.fontStack],k=E&&E.glyphs[c];return k?k.metrics.advance*r.scale+y:0}}function f_(c,r,u,p){const y=Math.pow(c-r,2);return p?c<r?y/2:2*y:y+Math.abs(u)*u}function g_(c,r,u){let p=0;return 10===c&&(p-=1e4),u&&(p+=150),40!==c&&65288!==c||(p+=50),41!==r&&65289!==r||(p+=50),p}function Jp(c,r,u,p,y,b){let E=null,k=f_(r,u,y,b);for(const N of p){const z=f_(r-N.x,u,y,b)+N.badness;z<=k&&(E=N,k=z)}return{index:c,x:r,priorBreak:E,badness:k}}function Gg(c){return c?Gg(c.priorBreak).concat(c.index):[]}function Td(c,r,u,p,y,b,E){if("point"!==b)return[];if(!c)return[];const k=[],N=function(Y,ie,ce,pe,Ce,Te){let Pe=0;for(let Be=0;Be<Y.length();Be++){const je=Y.getSection(Be);Pe+=p_(Y.getCharCode(Be),je,pe,Ce,ie,Te)}return Pe/Math.max(1,Math.ceil(Pe/ce))}(c,r,u,p,y,E),z=c.text.indexOf("\u200b")>=0;let j=0;for(let Y=0;Y<c.length();Y++){const ie=c.getSection(Y),ce=c.getCharCode(Y);if(Zp[ce]||(j+=p_(ce,ie,p,y,r,E)),Y<c.length()-1){const pe=!((W=ce)<11904||!(Ap(W)||Qu(W)||Ya(W)||eh(W)||qn(W)||Zu(W)||nd(W)||Ju(W)||$i(W)||Tc(W)||zn(W)||Yo(W)||Ac(W)||fg(W)||en(W)||bt(W)||Ku(W)||Tp(W)||Xo(W)||Mc(W)));(fb[ce]||pe||ie.imageName)&&k.push(Jp(Y+1,j,N,k,g_(ce,c.getCharCode(Y+1),pe&&z),!1))}}var W;return Gg(Jp(c.length(),j,N,k,0,!0))}function Wg(c){let r=.5,u=.5;switch(c){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:r,verticalAlign:u}}function m_(c,r,u,p,y){if(!(r||u||p||y))return;const b=c.length-1,E=c[b],k=(E.x+E.metrics.advance*E.scale)*r;for(let N=0;N<=b;N++)c[N].x-=k,c[N].y+=u+p+y}function y_(c,r,u){const{horizontalAlign:p,verticalAlign:y}=Wg(u),b=r[0]-c.displaySize[0]*p,E=r[1]-c.displaySize[1]*y;return{image:c,top:E,bottom:E+c.displaySize[1],left:b,right:b+c.displaySize[0]}}function Xg(c,r,u,p,y,b){const E=c.image;let k;if(E.content){const Ce=E.content,Te=E.pixelRatio||1;k=[Ce[0]/Te,Ce[1]/Te,E.displaySize[0]-Ce[2]/Te,E.displaySize[1]-Ce[3]/Te]}const N=r.left*b,z=r.right*b;let j,W,Y,ie;"width"===u||"both"===u?(ie=y[0]+N-p[3],W=y[0]+z+p[1]):(ie=y[0]+(N+z-E.displaySize[0])/2,W=ie+E.displaySize[0]);const ce=r.top*b,pe=r.bottom*b;return"height"===u||"both"===u?(j=y[1]+ce-p[0],Y=y[1]+pe+p[2]):(j=y[1]+(ce+pe-E.displaySize[1])/2,Y=j+E.displaySize[1]),{image:E,top:j,right:W,bottom:Y,left:ie,collisionPadding:k}}class Do extends Je{constructor(r,u,p,y,b){super(r,u),this.angle=y,this.z=p,void 0!==b&&(this.segment=b)}clone(){return new Do(this.x,this.y,this.z,this.angle,this.segment)}}function Yg(c,r,u,p,y){if(void 0===r.segment)return!0;let b=r,E=r.segment+1,k=0;for(;k>-u/2;){if(E--,E<0)return!1;k-=c[E].dist(b),b=c[E]}k+=c[E].dist(c[E+1]),E++;const N=[];let z=0;for(;k<u/2;){const j=c[E],W=c[E+1];if(!W)return!1;let Y=c[E-1].angleTo(j)-j.angleTo(W);for(Y=Math.abs((Y+3*Math.PI)%(2*Math.PI)-Math.PI),N.push({distance:k,angleDelta:Y}),z+=Y;k-N[0].distance>p;)z-=N.shift().angleDelta;if(z>y)return!1;E++,k+=j.dist(W)}return!0}function qg(c){let r=0;for(let u=0;u<c.length-1;u++)r+=c[u].dist(c[u+1]);return r}function __(c,r,u){return c?.6*r*u:0}function Md(c,r){return Math.max(c?c.right-c.left:0,r?r.right-r.left:0)}function gb(c,r,u,p,y,b){const E=__(u,y,b),k=Md(u,p)*b;let N=0;const z=qg(c)/2;for(let j=0;j<c.length-1;j++){const W=c[j],Y=c[j+1],ie=W.dist(Y);if(N+ie>z){const ce=(z-N)/ie,pe=ln(W.x,Y.x,ce),Ce=ln(W.y,Y.y,ce),Te=new Do(pe,Ce,0,Y.angleTo(W),j);return!E||Yg(c,Te,k,E,r)?Te:void 0}N+=ie}}function v_(c,r,u,p,y,b,E,k,N){const z=__(p,b,E),j=Md(p,y),W=j*E,Y=0===c[0].x||c[0].x===N||0===c[0].y||c[0].y===N;return r-W<r/4&&(r=W+r/4),Zg(c,Y?r/2*k%r:(j/2+2*b)*E*k%r,r,z,u,W,Y,!1,N)}function Zg(c,r,u,p,y,b,E,k,N){const z=b/2,j=qg(c);let W=0,Y=r-u,ie=[];for(let ce=0;ce<c.length-1;ce++){const pe=c[ce],Ce=c[ce+1],Te=pe.dist(Ce),Pe=Ce.angleTo(pe);for(;Y+u<W+Te;){Y+=u;const Be=(Y-W)/Te,je=ln(pe.x,Ce.x,Be),He=ln(pe.y,Ce.y,Be);if(je>=0&&je<N&&He>=0&&He<N&&Y-z>=0&&Y+z<=j){const Ge=new Do(je,He,0,Pe,ce);Ge._round(),p&&!Yg(c,Ge,b,p,y)||ie.push(Ge)}}W+=Te}return k||ie.length||E||(ie=Zg(c,W/2,u,p,y,b,E,!0,N)),ie}function Jg(c,r,u,p,y){const b=[];for(let E=0;E<c.length;E++){const k=c[E];let N;for(let z=0;z<k.length-1;z++){let j=k[z],W=k[z+1];j.x<r&&W.x<r||(j.x<r?j=new Je(r,j.y+(r-j.x)/(W.x-j.x)*(W.y-j.y))._round():W.x<r&&(W=new Je(r,j.y+(r-j.x)/(W.x-j.x)*(W.y-j.y))._round()),j.y<u&&W.y<u||(j.y<u?j=new Je(j.x+(u-j.y)/(W.y-j.y)*(W.x-j.x),u)._round():W.y<u&&(W=new Je(j.x+(u-j.y)/(W.y-j.y)*(W.x-j.x),u)._round()),j.x>=p&&W.x>=p||(j.x>=p?j=new Je(p,j.y+(p-j.x)/(W.x-j.x)*(W.y-j.y))._round():W.x>=p&&(W=new Je(p,j.y+(p-j.x)/(W.x-j.x)*(W.y-j.y))._round()),j.y>=y&&W.y>=y||(j.y>=y?j=new Je(j.x+(y-j.y)/(W.y-j.y)*(W.x-j.x),y)._round():W.y>=y&&(W=new Je(j.x+(y-j.y)/(W.y-j.y)*(W.x-j.x),y)._round()),N&&j.equals(N[N.length-1])||(N=[j],b.push(N)),N.push(W)))))}}return b}Bt("Anchor",Do);const wu=1e20;function Kg(c,r,u,p,y,b,E,k,N){for(let z=r;z<r+p;z++)kd(c,u*b+z,b,y,E,k,N);for(let z=u;z<u+y;z++)kd(c,z*b+r,1,p,E,k,N)}function kd(c,r,u,p,y,b,E){b[0]=0,E[0]=-wu,E[1]=wu,y[0]=c[r];for(let k=1,N=0,z=0;k<p;k++){y[k]=c[r+k*u];const j=k*k;do{const W=b[N];z=(y[k]-y[W]+j-W*W)/(k-W)/2}while(z<=E[N]&&--N>-1);N++,b[N]=k,E[N]=z,E[N+1]=wu}for(let k=0,N=0;k<p;k++){for(;E[N+1]<k;)N++;const z=b[N],j=k-z;c[r+k*u]=y[z]+j*j}}const vh={none:0,ideographs:1,all:2};class Cu{constructor(r,u,p){this.requestManager=r,this.localGlyphMode=u,this.localFontFamily=p,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(r){this.url=r}getGlyphs(r,u){const p=[];for(const y in r)for(const b of r[y])p.push({stack:y,id:b});fi(p,({stack:y,id:b},E)=>{let k=this.entries[y];k||(k=this.entries[y]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let N=k.glyphs[b];if(void 0!==N)return void E(null,{stack:y,id:b,glyph:N});if(N=this._tinySDF(k,y,b),N)return k.glyphs[b]=N,void E(null,{stack:y,id:b,glyph:N});const z=Math.floor(b/256);if(256*z>65535)return void E(new Error("glyphs > 65535 not supported"));if(k.ranges[z])return void E(null,{stack:y,id:b,glyph:N});let j=k.requests[z];j||(j=k.requests[z]=[],Cu.loadGlyphRange(y,z,this.url,this.requestManager,(W,Y)=>{if(Y){k.ascender=Y.ascender,k.descender=Y.descender;for(const ie in Y.glyphs)this._doesCharSupportLocalGlyph(+ie)||(k.glyphs[+ie]=Y.glyphs[+ie]);k.ranges[z]=!0}for(const ie of j)ie(W,Y);delete k.requests[z]})),j.push((W,Y)=>{W?E(W):Y&&E(null,{stack:y,id:b,glyph:Y.glyphs[b]||null})})},(y,b)=>{if(y)u(y);else if(b){const E={};for(const{stack:k,id:N,glyph:z}of b)void 0===E[k]&&(E[k]={}),void 0===E[k].glyphs&&(E[k].glyphs={}),E[k].glyphs[N]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics},E[k].ascender=this.entries[k].ascender,E[k].descender=this.entries[k].descender;u(null,E)}})}_doesCharSupportLocalGlyph(r){return this.localGlyphMode!==vh.none&&(this.localGlyphMode===vh.all?!!this.localFontFamily:!!this.localFontFamily&&(Tc(r)||Al(r)||Ac(r)||Ku(r))||Ju(r))}_tinySDF(r,u,p){const y=this.localFontFamily;if(!y||!this._doesCharSupportLocalGlyph(p))return;let b=r.tinySDF;if(!b){let pe="400";/bold/i.test(u)?pe="900":/medium/i.test(u)?pe="500":/light/i.test(u)&&(pe="200"),b=r.tinySDF=new Cu.TinySDF({fontFamily:y,fontWeight:pe,fontSize:48,buffer:6,radius:16}),b.fontWeight=pe}if(this.localGlyphs[b.fontWeight][p])return this.localGlyphs[b.fontWeight][p];const E=String.fromCharCode(p),{data:k,width:N,height:z,glyphWidth:j,glyphHeight:W,glyphLeft:Y,glyphTop:ie,glyphAdvance:ce}=b.draw(E);return this.localGlyphs[b.fontWeight][p]={id:p,bitmap:new Fl({width:N,height:z},k),metrics:{width:j/2,height:W/2,left:Y/2,top:ie/2-27,advance:ce/2,localGlyph:!0}}}}function Kp(c,r,u,p){const y=[],b=c.image,E=b.pixelRatio,k=b.paddedRect.w-2,N=b.paddedRect.h-2,z=c.right-c.left,j=c.bottom-c.top,W=b.stretchX||[[0,k]],Y=b.stretchY||[[0,N]],ie=(lt,gt)=>lt+gt[1]-gt[0],ce=W.reduce(ie,0),pe=Y.reduce(ie,0),Ce=k-ce,Te=N-pe;let Pe=0,Be=ce,je=0,He=pe,Ge=0,ot=Ce,nt=0,Mt=Te;if(b.content&&p){const lt=b.content;Pe=Id(W,0,lt[0]),je=Id(Y,0,lt[1]),Be=Id(W,lt[0],lt[2]),He=Id(Y,lt[1],lt[3]),Ge=lt[0]-Pe,nt=lt[1]-je,ot=lt[2]-lt[0]-Be,Mt=lt[3]-lt[1]-He}const ft=(lt,gt,Ct,ct)=>{const It=Hc(lt.stretch-Pe,Be,z,c.left),Ot=ef(lt.fixed-Ge,ot,lt.stretch,ce),rn=Hc(gt.stretch-je,He,j,c.top),Si=ef(gt.fixed-nt,Mt,gt.stretch,pe),Jt=Hc(Ct.stretch-Pe,Be,z,c.left),Wn=ef(Ct.fixed-Ge,ot,Ct.stretch,ce),Pt=Hc(ct.stretch-je,He,j,c.top),ci=ef(ct.fixed-nt,Mt,ct.stretch,pe),Hn=new Je(It,rn),Ki=new Je(Jt,rn),_i=new Je(Jt,Pt),Gi=new Je(It,Pt),$r=new Je(Ot/E,Si/E),oi=new Je(Wn/E,ci/E),Kn=r*Math.PI/180;if(Kn){const zi=Math.sin(Kn),Wi=Math.cos(Kn),ts=[Wi,-zi,zi,Wi];Hn._matMult(ts),Ki._matMult(ts),Gi._matMult(ts),_i._matMult(ts)}const ei=lt.stretch+lt.fixed,Gr=gt.stretch+gt.fixed;return{tl:Hn,tr:Ki,bl:Gi,br:_i,tex:{x:b.paddedRect.x+1+ei,y:b.paddedRect.y+1+Gr,w:Ct.stretch+Ct.fixed-ei,h:ct.stretch+ct.fixed-Gr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:$r,pixelOffsetBR:oi,minFontScaleX:ot/E/z,minFontScaleY:Mt/E/j,isSDF:u}};if(p&&(b.stretchX||b.stretchY)){const lt=Qp(W,Ce,ce),gt=Qp(Y,Te,pe);for(let Ct=0;Ct<lt.length-1;Ct++){const ct=lt[Ct],It=lt[Ct+1];for(let Ot=0;Ot<gt.length-1;Ot++)y.push(ft(ct,gt[Ot],It,gt[Ot+1]))}}else y.push(ft({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:N+1}));return y}function Id(c,r,u){let p=0;for(const y of c)p+=Math.max(r,Math.min(u,y[1]))-Math.max(r,Math.min(u,y[0]));return p}function Qp(c,r,u){const p=[{fixed:-1,stretch:0}];for(const[y,b]of c){const E=p[p.length-1];p.push({fixed:y-E.stretch,stretch:E.stretch}),p.push({fixed:y-E.stretch,stretch:E.stretch+(b-y)})}return p.push({fixed:r+1,stretch:u}),p}function Hc(c,r,u,p){return c/r*u+p}function ef(c,r,u,p){return c-r*u/p}function x_(c,r,u,p){const y=r+c.positionedLines[p].lineOffset;return 0===p?u+y/2:u+(y+(r+c.positionedLines[p-1].lineOffset))/2}Cu.loadGlyphRange=function(c,r,u,p,y){const b=256*r,E=b+255,k=p.transformRequest(p.normalizeGlyphsURL(u).replace("{fontstack}",c).replace("{range}",`${b}-${E}`),Sa.Glyphs);ue(k,(N,z)=>{if(N)y(N);else if(z){const j={},W=new yh(z).readFields(Hg,{});for(const Y of W.glyphs)j[Y.id]=Y;y(null,{glyphs:j,ascender:W.ascender,descender:W.descender})}})},Cu.TinySDF=class{constructor({fontSize:c=24,buffer:r=3,radius:u=8,cutoff:p=.25,fontFamily:y="sans-serif",fontWeight:b="normal",fontStyle:E="normal"}){this.buffer=r,this.cutoff=p,this.radius=u;const k=this.size=c+4*r,N=this._createCanvas(k),z=this.ctx=N.getContext("2d",{willReadFrequently:!0});z.font=`${E} ${b} ${c}px ${y}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Uint16Array(k)}_createCanvas(c){const r=document.createElement("canvas");return r.width=r.height=c,r}draw(c){const{width:r,actualBoundingBoxAscent:u,actualBoundingBoxDescent:p,actualBoundingBoxLeft:y,actualBoundingBoxRight:b}=this.ctx.measureText(c),E=Math.floor(u),k=Math.min(this.size-this.buffer,Math.ceil(b-y)),N=Math.min(this.size-this.buffer,Math.ceil(u)+Math.ceil(p)),z=k+2*this.buffer,j=N+2*this.buffer,W=z*j,Y=new Uint8ClampedArray(W),ie={data:Y,width:z,height:j,glyphWidth:k,glyphHeight:N,glyphTop:E,glyphLeft:0,glyphAdvance:r};if(0===k||0===N)return ie;const{ctx:ce,buffer:pe,gridInner:Ce,gridOuter:Te}=this;ce.clearRect(pe,pe,k,N),ce.fillText(c,pe,pe+E+1);const Pe=ce.getImageData(pe,pe,k,N);Te.fill(wu,0,W),Ce.fill(0,0,W);for(let Be=0;Be<N;Be++)for(let je=0;je<k;je++){const He=Pe.data[4*(Be*k+je)+3]/255;if(0===He)continue;const Ge=(Be+pe)*z+je+pe;if(1===He)Te[Ge]=0,Ce[Ge]=wu;else{const ot=.5-He;Te[Ge]=ot>0?ot*ot:0,Ce[Ge]=ot<0?ot*ot:0}}Kg(Te,0,0,z,j,z,this.f,this.v,this.z),Kg(Ce,pe,pe,k,N,z,this.f,this.v,this.z);for(let Be=0;Be<W;Be++){const je=Math.sqrt(Te[Be])-Math.sqrt(Ce[Be]);Y[Be]=Math.round(255-255*(je/this.radius+this.cutoff))}return ie}};class mb{constructor(r=[],u=yb){if(this.data=r,this.length=this.data.length,this.compare=u,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const r=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:u,compare:p}=this,y=u[r];for(;r>0;){const b=r-1>>1,E=u[b];if(p(y,E)>=0)break;u[r]=E,r=b}u[r]=y}_down(r){const{data:u,compare:p}=this,y=this.length>>1,b=u[r];for(;r<y;){let E=1+(r<<1),k=u[E];const N=E+1;if(N<this.length&&p(u[N],k)<0&&(E=N,k=u[N]),p(k,b)>=0)break;u[r]=k,r=E}u[r]=b}}function yb(c,r){return c<r?-1:c>r?1:0}function b_(c,r=1,u=!1){let p=1/0,y=1/0,b=-1/0,E=-1/0;const k=c[0];for(let ie=0;ie<k.length;ie++){const ce=k[ie];(!ie||ce.x<p)&&(p=ce.x),(!ie||ce.y<y)&&(y=ce.y),(!ie||ce.x>b)&&(b=ce.x),(!ie||ce.y>E)&&(E=ce.y)}const N=Math.min(b-p,E-y);let z=N/2;const j=new mb([],Qg);if(0===N)return new Je(p,y);for(let ie=p;ie<b;ie+=N)for(let ce=y;ce<E;ce+=N)j.push(new Su(ie+z,ce+z,z,c));let W=function(ie){let ce=0,pe=0,Ce=0;const Te=ie[0];for(let Pe=0,Be=Te.length,je=Be-1;Pe<Be;je=Pe++){const He=Te[Pe],Ge=Te[je],ot=He.x*Ge.y-Ge.x*He.y;pe+=(He.x+Ge.x)*ot,Ce+=(He.y+Ge.y)*ot,ce+=3*ot}return new Su(pe/ce,Ce/ce,0,ie)}(c),Y=j.length;for(;j.length;){const ie=j.pop();(ie.d>W.d||!W.d)&&(W=ie,u&&console.log("found best %d after %d probes",Math.round(1e4*ie.d)/1e4,Y)),ie.max-W.d<=r||(z=ie.h/2,j.push(new Su(ie.p.x-z,ie.p.y-z,z,c)),j.push(new Su(ie.p.x+z,ie.p.y-z,z,c)),j.push(new Su(ie.p.x-z,ie.p.y+z,z,c)),j.push(new Su(ie.p.x+z,ie.p.y+z,z,c)),Y+=4)}return u&&(console.log(`num probes: ${Y}`),console.log(`best distance: ${W.d}`)),W.p}function Qg(c,r){return r.max-c.max}function Su(c,r,u,p){this.p=new Je(c,r),this.h=u,this.d=function(y,b){let E=!1,k=1/0;for(let N=0;N<b.length;N++){const z=b[N];for(let j=0,W=z.length,Y=W-1;j<W;Y=j++){const ie=z[j],ce=z[Y];ie.y>y.y!=ce.y>y.y&&y.x<(ce.x-ie.x)*(y.y-ie.y)/(ce.y-ie.y)+ie.x&&(E=!E),k=Math.min(k,Pp(y,ie,ce))}}return(E?1:-1)*Math.sqrt(k)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}const w_=Number.POSITIVE_INFINITY,C_=Math.sqrt(2);function S_(c,r){return r[1]!==w_?function(u,p,y){let b=0,E=0;switch(p=Math.abs(p),y=Math.abs(y),u){case"top-right":case"top-left":case"top":E=y-7;break;case"bottom-right":case"bottom-left":case"bottom":E=7-y}switch(u){case"top-right":case"bottom-right":case"right":b=-p;break;case"top-left":case"bottom-left":case"left":b=p}return[b,E]}(c,r[0],r[1]):function(u,p){let y=0,b=0;p<0&&(p=0);const E=p/C_;switch(u){case"top-right":case"top-left":b=E-7;break;case"bottom-right":case"bottom-left":b=7-E;break;case"bottom":b=7-p;break;case"top":b=p-7}switch(u){case"top-right":case"bottom-right":y=-E;break;case"top-left":case"bottom-left":y=E;break;case"left":y=p;break;case"right":y=-p}return[y,b]}(c,r[0])}function D_(c,r,u,p,y,b,E,k,N){c.createArrays(),c.tilePixelRatio=cn/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const z=c.layers[0].layout,j=c.layers[0]._unevaluatedLayout._values,W={};if("composite"===c.textSizeData.kind){const{minZoom:ce,maxZoom:pe}=c.textSizeData;W.compositeTextSizes=[j["text-size"].possiblyEvaluate(new ne(ce),k),j["text-size"].possiblyEvaluate(new ne(pe),k)]}if("composite"===c.iconSizeData.kind){const{minZoom:ce,maxZoom:pe}=c.iconSizeData;W.compositeIconSizes=[j["icon-size"].possiblyEvaluate(new ne(ce),k),j["icon-size"].possiblyEvaluate(new ne(pe),k)]}W.layoutTextSize=j["text-size"].possiblyEvaluate(new ne(N+1),k),W.layoutIconSize=j["icon-size"].possiblyEvaluate(new ne(N+1),k),W.textMaxSize=j["text-size"].possiblyEvaluate(new ne(18),k);const Y="map"===z.get("text-rotation-alignment")&&"point"!==z.get("symbol-placement"),ie=z.get("text-size");for(const ce of c.features){const pe=z.get("text-font").evaluate(ce,{},k).join(","),Ce=ie.evaluate(ce,{},k),Te=W.layoutTextSize.evaluate(ce,{},k),Pe=(W.layoutIconSize.evaluate(ce,{},k),{horizontal:{},vertical:void 0}),Be=ce.text;let je,He=[0,0];if(Be){const nt=Be.toString(),Mt=24*z.get("text-letter-spacing").evaluate(ce,{},k),ft=24*z.get("text-line-height").evaluate(ce,{},k),lt=Ia(nt)?Mt:0,gt=z.get("text-anchor").evaluate(ce,{},k),Ct=z.get("text-variable-anchor");if(!Ct){const Jt=z.get("text-radial-offset").evaluate(ce,{},k);He=Jt?S_(gt,[24*Jt,w_]):z.get("text-offset").evaluate(ce,{},k).map(Wn=>24*Wn)}let ct=Y?"center":z.get("text-justify").evaluate(ce,{},k);const It=z.get("symbol-placement"),Ot="point"===It,rn="point"===It?24*z.get("text-max-width").evaluate(ce,{},k):0,Si=Jt=>{c.allowVerticalPlacement&&ka(nt)&&(Pe.vertical=$g(Be,r,u,y,pe,rn,ft,gt,Jt,lt,He,Ko.vertical,!0,It,Te,Ce))};if(!Y&&Ct){const Jt="auto"===ct?Ct.map(Pt=>em(Pt)):[ct];let Wn=!1;for(let Pt=0;Pt<Jt.length;Pt++){const ci=Jt[Pt];if(!Pe.horizontal[ci])if(Wn)Pe.horizontal[ci]=Pe.horizontal[0];else{const Hn=$g(Be,r,u,y,pe,rn,ft,"center",ci,lt,He,Ko.horizontal,!1,It,Te,Ce);Hn&&(Pe.horizontal[ci]=Hn,Wn=1===Hn.positionedLines.length)}}Si("left")}else{if("auto"===ct&&(ct=em(gt)),Ot||z.get("text-writing-mode").indexOf("horizontal")>=0||!ka(nt)){const Jt=$g(Be,r,u,y,pe,rn,ft,gt,ct,lt,He,Ko.horizontal,!1,It,Te,Ce);Jt&&(Pe.horizontal[ct]=Jt)}Si("point"===It?"left":ct)}}let Ge=!1;if(ce.icon&&ce.icon.name){const nt=p[ce.icon.name];nt&&(je=y_(y[ce.icon.name],z.get("icon-offset").evaluate(ce,{},k),z.get("icon-anchor").evaluate(ce,{},k)),Ge=nt.sdf,void 0===c.sdfIcons?c.sdfIcons=nt.sdf:c.sdfIcons!==nt.sdf&&mn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(nt.pixelRatio!==c.pixelRatio||0!==z.get("icon-rotate").constantOr(1))&&(c.iconsNeedLinear=!0))}const ot=tm(Pe.horizontal)||Pe.vertical;c.iconsInText||(c.iconsInText=!!ot&&ot.iconsInText),(ot||je)&&_b(c,ce,Pe,je,p,W,Te,0,He,Ge,E,k)}b&&c.generateCollisionDebugBuffers(N,c.collisionBoxArray)}function em(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function _b(c,r,u,p,y,b,E,k,N,z,j,W){let Y=b.textMaxSize.evaluate(r,{},W);void 0===Y&&(Y=E);const ie=c.layers[0].layout,ce=ie.get("icon-offset").evaluate(r,{},W),pe=tm(u.horizontal)||u.vertical,Ce=E/24,Te=c.tilePixelRatio*Y/24,Pe=c.tilePixelRatio*ie.get("symbol-spacing"),Be=ie.get("text-padding")*c.tilePixelRatio,je=ie.get("icon-padding")*c.tilePixelRatio,He=wn(ie.get("text-max-angle")),Ge="map"===ie.get("text-rotation-alignment")&&"point"!==ie.get("symbol-placement"),ot="map"===ie.get("icon-rotation-alignment")&&"point"!==ie.get("symbol-placement"),nt=ie.get("symbol-placement"),Mt=Pe/2,ft=ie.get("icon-text-fit");let lt;p&&"none"!==ft&&(c.allowVerticalPlacement&&u.vertical&&(lt=Xg(p,u.vertical,ft,ie.get("icon-text-fit-padding"),ce,Ce)),pe&&(p=Xg(p,pe,ft,ie.get("icon-text-fit-padding"),ce,Ce)));const gt=(Ct,ct)=>{ct.x<0||ct.x>=cn||ct.y<0||ct.y>=cn||function(It,Ot,rn,Si,Jt,Wn,Pt,ci,Hn,Ki,_i,Gi,$r,oi,Kn,ei,Gr,zi,Wi,ts,Ni,Ns,vi,Qi,ur){const Ui=It.addToLineVertexArray(Ot,Si);let Xi,vr,ui,hr,ga,Qo,ma,ns=0,ys=0,Xl=0,Dh=0,Eh=-1,Bd=-1;const il={};let _m=Za(""),Bn=0,Vd=0;if(void 0===Hn._unevaluatedLayout.getValue("text-radial-offset")?[Bn,Vd]=Hn.layout.get("text-offset").evaluate(Ni,{},ur).map(Ao=>24*Ao):(Bn=24*Hn.layout.get("text-radial-offset").evaluate(Ni,{},ur),Vd=w_),It.allowVerticalPlacement&&Jt.vertical){const Ao=Jt.vertical;if(Kn)Qo=nm(Ao),ci&&(ma=nm(ci));else{const To=Hn.layout.get("text-rotate").evaluate(Ni,{},ur)+90;ui=tf(Ki,rn,Ot,_i,Gi,$r,Ao,oi,To,ei),ci&&(hr=tf(Ki,rn,Ot,_i,Gi,$r,ci,zi,To))}}if(Wn){const Ao=Hn.layout.get("icon-rotate").evaluate(Ni,{},ur),To="none"!==Hn.layout.get("icon-text-fit"),Ah=Kp(Wn,Ao,vi,To),mf=ci?Kp(ci,Ao,vi,To):void 0;vr=tf(Ki,rn,Ot,_i,Gi,$r,Wn,zi,Ao),ns=4*Ah.length;const xm=It.iconSizeData;let Gc=null;"source"===xm.kind?(Gc=[tl*Hn.layout.get("icon-size").evaluate(Ni,{},ur)],Gc[0]>Qr&&mn(`${It.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===xm.kind&&(Gc=[tl*Ns.compositeIconSizes[0].evaluate(Ni,{},ur),tl*Ns.compositeIconSizes[1].evaluate(Ni,{},ur)],(Gc[0]>Qr||Gc[1]>Qr)&&mn(`${It.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),It.addSymbols(It.icon,Ah,Gc,ts,Wi,Ni,!1,rn,Ot,Ui.lineStartIndex,Ui.lineLength,-1,Qi,ur),Eh=It.icon.placedSymbolArray.length-1,mf&&(ys=4*mf.length,It.addSymbols(It.icon,mf,Gc,ts,Wi,Ni,Ko.vertical,rn,Ot,Ui.lineStartIndex,Ui.lineLength,-1,Qi,ur),Bd=It.icon.placedSymbolArray.length-1)}for(const Ao in Jt.horizontal){const To=Jt.horizontal[Ao];Xi||(_m=Za(To.text),Kn?ga=nm(To):Xi=tf(Ki,rn,Ot,_i,Gi,$r,To,oi,Hn.layout.get("text-rotate").evaluate(Ni,{},ur),ei));const Ah=1===To.positionedLines.length;if(Xl+=E_(It,rn,Ot,To,Pt,Hn,Kn,Ni,ei,Ui,Jt.vertical?Ko.horizontal:Ko.horizontalOnly,Ah?Object.keys(Jt.horizontal):[Ao],il,Eh,Ns,Qi,ur),Ah)break}Jt.vertical&&(Dh+=E_(It,rn,Ot,Jt.vertical,Pt,Hn,Kn,Ni,ei,Ui,Ko.vertical,["vertical"],il,Bd,Ns,Qi,ur));let Fs=-1;const Ud=(Ao,To)=>Ao?Math.max(Ao,To):To;Fs=Ud(ga,Fs),Fs=Ud(Qo,Fs),Fs=Ud(ma,Fs);const vm=Fs>-1?1:0;It.glyphOffsetArray.length>=Bl.MAX_GLYPHS&&mn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Ni.sortKey&&It.addToSortKeyRanges(It.symbolInstances.length,Ni.sortKey),It.symbolInstances.emplaceBack(rn.x,rn.y,rn.z,Ot.x,Ot.y,il.right>=0?il.right:-1,il.center>=0?il.center:-1,il.left>=0?il.left:-1,il.vertical>=0?il.vertical:-1,Eh,Bd,_m,void 0!==Xi?Xi:It.collisionBoxArray.length,void 0!==Xi?Xi+1:It.collisionBoxArray.length,void 0!==ui?ui:It.collisionBoxArray.length,void 0!==ui?ui+1:It.collisionBoxArray.length,void 0!==vr?vr:It.collisionBoxArray.length,void 0!==vr?vr+1:It.collisionBoxArray.length,hr||It.collisionBoxArray.length,hr?hr+1:It.collisionBoxArray.length,_i,Xl,Dh,ns,ys,vm,0,Bn,Vd,Fs)}(c,ct,ct,Ct,u,p,y,lt,c.layers[0],c.collisionBoxArray,r.index,r.sourceLayerIndex,c.index,Be,Ge,N,0,je,ot,ce,r,b,z,j,W)};if("line"===nt)for(const Ct of Jg(r.geometry,0,0,cn,cn)){const ct=v_(Ct,Pe,He,u.vertical||pe,p,24,Te,c.overscaling,cn);for(const It of ct){const Ot=pe;Ot&&vb(c,Ot.text,Mt,It)||gt(Ct,It)}}else if("line-center"===nt){for(const Ct of r.geometry)if(Ct.length>1){const ct=gb(Ct,He,u.vertical||pe,p,24,Te);ct&&gt(Ct,ct)}}else if("Polygon"===r.type)for(const Ct of Hp(r.geometry,0)){const ct=b_(Ct,16);gt(Ct[0],new Do(ct.x,ct.y,0,0,void 0))}else if("LineString"===r.type)for(const Ct of r.geometry)gt(Ct,new Do(Ct[0].x,Ct[0].y,0,0,void 0));else if("Point"===r.type)for(const Ct of r.geometry)for(const ct of Ct)gt([ct],new Do(ct.x,ct.y,0,0,void 0))}const Qr=32640;function E_(c,r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce,pe,Ce){const Te=function(je,He,Ge,ot,nt,Mt,ft,lt){const gt=[];if(0===He.positionedLines.length)return gt;const Ct=ot.layout.get("text-rotate").evaluate(Mt,{})*Math.PI/180,ct=function(Jt){const Wn=Jt[0],Pt=Jt[1],ci=Wn*Pt;return ci>0?[Wn,-Pt]:ci<0?[-Wn,Pt]:0===Wn?[Pt,Wn]:[Pt,-Wn]}(Ge);let It=Math.abs(He.top-He.bottom);for(const Jt of He.positionedLines)It-=Jt.lineOffset;const Ot=He.positionedLines.length,rn=It/Ot;let Si=He.top-Ge[1];for(let Jt=0;Jt<Ot;++Jt){const Wn=He.positionedLines[Jt];Si=x_(He,rn,Si,Jt);for(const Pt of Wn.positionedGlyphs){if(!Pt.rect)continue;const ci=Pt.rect||{};let Hn=4,Ki=!0,_i=1,Gi=0;if(Pt.imageName){const ui=ft[Pt.imageName];if(!ui)continue;if(ui.sdf){mn("SDF images are not supported in formatted text and will be ignored.");continue}Ki=!1,_i=ui.pixelRatio,Hn=1/_i}const $r=(nt||lt)&&Pt.vertical,oi=Pt.metrics.advance*Pt.scale/2,Kn=Pt.metrics,ei=Pt.rect;if(null===ei)continue;lt&&He.verticalizable&&(Gi=Pt.imageName?oi-Pt.metrics.width*Pt.scale/2:0);const Gr=nt?[Pt.x+oi,Pt.y]:[0,0];let zi=[0,0],Wi=[0,0],ts=!1;nt||($r?(Wi=[Pt.x+oi+ct[0],Pt.y+ct[1]-Gi],ts=!0):zi=[Pt.x+oi+Ge[0],Pt.y+Ge[1]-Gi]);const Ni=ei.w*Pt.scale/(_i*(Pt.localGlyph?2:1)),Ns=ei.h*Pt.scale/(_i*(Pt.localGlyph?2:1));let vi,Qi,ur,Ui;if($r){const ui=Pt.y-Si,hr=new Je(-oi,oi-ui),ga=-Math.PI/2,Qo=new Je(...Wi);vi=new Je(-oi+zi[0],zi[1]),vi._rotateAround(ga,hr)._add(Qo),vi.x+=-ui+oi,vi.y-=(Kn.left-Hn)*Pt.scale;const ma=Pt.imageName?Kn.advance*Pt.scale:24*Pt.scale,ns=String.fromCharCode(Pt.glyph);Yp(ns)?vi.x+=(1-Hn)*Pt.scale:s_(ns)?vi.x+=ma-Kn.height*Pt.scale+(-Hn-1)*Pt.scale:vi.x+=Pt.imageName||Kn.width+2*Hn===ei.w&&Kn.height+2*Hn===ei.h?(ma-Ns)/2:(ma-(Kn.height+2*Hn)*Pt.scale)/2,Qi=new Je(vi.x,vi.y-Ni),ur=new Je(vi.x+Ns,vi.y),Ui=new Je(vi.x+Ns,vi.y-Ni)}else{const ui=(Kn.left-Hn)*Pt.scale-oi+zi[0],hr=(-Kn.top-Hn)*Pt.scale+zi[1],ga=ui+Ni,Qo=hr+Ns;vi=new Je(ui,hr),Qi=new Je(ga,hr),ur=new Je(ui,Qo),Ui=new Je(ga,Qo)}if(Ct){let ui;ui=nt?new Je(0,0):ts?new Je(ct[0],ct[1]):new Je(Ge[0],Ge[1]),vi._rotateAround(Ct,ui),Qi._rotateAround(Ct,ui),ur._rotateAround(Ct,ui),Ui._rotateAround(Ct,ui)}const Xi=new Je(0,0),vr=new Je(0,0);gt.push({tl:vi,tr:Qi,bl:ur,br:Ui,tex:ci,writingMode:He.writingMode,glyphOffset:Gr,sectionIndex:Pt.sectionIndex,isSDF:Ki,pixelOffsetTL:Xi,pixelOffsetBR:vr,minFontScaleX:0,minFontScaleY:0})}}return gt}(0,p,N,b,E,k,y,c.allowVerticalPlacement),Pe=c.textSizeData;let Be=null;"source"===Pe.kind?(Be=[tl*b.layout.get("text-size").evaluate(k,{},Ce)],Be[0]>Qr&&mn(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===Pe.kind&&(Be=[tl*ce.compositeTextSizes[0].evaluate(k,{},Ce),tl*ce.compositeTextSizes[1].evaluate(k,{},Ce)],(Be[0]>Qr||Be[1]>Qr)&&mn(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,Te,Be,N,E,k,j,r,u,z.lineStartIndex,z.lineLength,ie,pe,Ce);for(const je of W)Y[je]=c.text.placedSymbolArray.length-1;return 4*Te.length}function tm(c){for(const r in c)return c[r];return null}function tf(c,r,u,p,y,b,E,k,N,z){let j=E.top,W=E.bottom,Y=E.left,ie=E.right;const ce=E.collisionPadding;if(ce&&(Y-=ce[0],j-=ce[1],ie+=ce[2],W+=ce[3]),N){const pe=new Je(Y,j),Ce=new Je(ie,j),Te=new Je(Y,W),Pe=new Je(ie,W),Be=wn(N);let je=new Je(0,0);z&&(je=new Je(z[0],z[1])),pe._rotateAround(Be,je),Ce._rotateAround(Be,je),Te._rotateAround(Be,je),Pe._rotateAround(Be,je),Y=Math.min(pe.x,Ce.x,Te.x,Pe.x),ie=Math.max(pe.x,Ce.x,Te.x,Pe.x),j=Math.min(pe.y,Ce.y,Te.y,Pe.y),W=Math.max(pe.y,Ce.y,Te.y,Pe.y)}return c.emplaceBack(r.x,r.y,r.z,u.x,u.y,Y,j,ie,W,k,p,y,b),c.length-1}function nm(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const r=c.bottom-c.top;return r>0?Math.max(10,r):null}function vb(c,r,u,p){const y=c.compareText;if(r in y){const b=y[r];for(let E=b.length-1;E>=0;E--)if(p.dist(b[E])<u)return!0}else y[r]=[];return y[r].push(p),!1}const xb=vu.VectorTileFeature.types,A_=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function nf(c,r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce,pe){const Ce=j?Math.min(Qr,Math.round(j[0])):0,Te=j?Math.min(Qr,Math.round(j[1])):0;c.emplaceBack(r,u,Math.round(32*E),Math.round(32*k),N,z,(Ce<<1)+(W?1:0),Te,16*Y,16*ie,256*ce,256*pe,p,y,b,0)}function im(c,r,u){c.emplaceBack(r.x,r.y,u),c.emplaceBack(r.x,r.y,u),c.emplaceBack(r.x,r.y,u),c.emplaceBack(r.x,r.y,u)}function bb(c){for(const r of c.sections)if(rd(r.text))return!0;return!1}class dn{constructor(r){this.layoutVertexArray=new sn,this.indexArray=new lr,this.programConfigurations=r,this.segments=new yi,this.dynamicLayoutVertexArray=new tn,this.opacityVertexArray=new Un,this.placedSymbolArray=new fu}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(r,u,p,y){this.isEmpty()||(p&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Lg.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,r_.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,A_,!0),this.opacityVertexBuffer.itemSize=1),(p||y)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Bt("SymbolBuffers",dn);class wt{constructor(r,u,p){this.layoutVertexArray=new r,this.layoutAttributes=u,this.indexArray=new p,this.segments=new yi,this.collisionVertexArray=new ar,this.collisionVertexArrayExt=new tn}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,cb.members,!0),this.collisionVertexBufferExt=r.createVertexBuffer(this.collisionVertexArrayExt,dC.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Bt("CollisionBuffers",wt);class Bl{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(E=>E.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Bc([]),this.placementViewportMatrix=Bc([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=zl(this.zoom,u["text-size"]),this.iconSizeData=zl(this.zoom,u["icon-size"]);const p=this.layers[0].layout,y=p.get("symbol-sort-key"),b=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==b&&void 0!==y.constantOr(1),this.sortFeaturesByY=("viewport-y"===b||"auto"===b&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(E=>Ko[E]),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=r.sourceID}createArrays(){this.text=new dn(new rh(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new dn(new rh(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new sd,this.lineVertexArray=new Ic,this.symbolInstances=new kl}calculateGlyphDependencies(r,u,p,y,b){for(let E=0;E<r.length;E++)if(u[r.charCodeAt(E)]=!0,y&&b){const k=Sd[r.charAt(E)];k&&(u[k.charCodeAt(0)]=!0)}}populate(r,u,p,y){const b=this.layers[0],E=b.layout,k=E.get("text-font"),N=E.get("text-field"),z=E.get("icon-image"),j=("constant"!==N.value.kind||N.value.value instanceof pn&&!N.value.value.isEmpty()||N.value.value.toString().length>0)&&("constant"!==k.value.kind||k.value.value.length>0),W="constant"!==z.value.kind||!!z.value.value||Object.keys(z.parameters).length>0,Y=E.get("symbol-sort-key");if(this.features=[],!j&&!W)return;const ie=u.iconDependencies,ce=u.glyphDependencies,pe=u.availableImages,Ce=new ne(this.zoom);for(const{feature:Te,id:Pe,index:Be,sourceLayerIndex:je}of r){const He=b._featureFilter.needGeometry,Ge=Pa(Te,He);if(!b._featureFilter.filter(Ce,Ge,p))continue;let ot,nt;if(He||(Ge.geometry=Nl(Te,p,y)),j){const ft=b.getValueAndResolveTokens("text-field",Ge,p,pe),lt=pn.factory(ft);bb(lt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===X()||this.hasRTLText&&ee.isParsed())&&(ot=hb(lt,b,Ge))}if(W){const ft=b.getValueAndResolveTokens("icon-image",Ge,p,pe);nt=ft instanceof xi?ft:xi.fromString(ft)}if(!ot&&!nt)continue;const Mt=this.sortFeaturesByKey?Y.evaluate(Ge,{},p):void 0;if(this.features.push({id:Pe,text:ot,icon:nt,index:Be,sourceLayerIndex:je,geometry:Ge.geometry,properties:Te.properties,type:xb[Te.type],sortKey:Mt}),nt&&(ie[nt.name]=!0),ot){const ft=k.evaluate(Ge,{},p).join(","),lt="map"===E.get("text-rotation-alignment")&&"point"!==E.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ko.vertical)>=0;for(const gt of ot.sections)if(gt.image)ie[gt.image.name]=!0;else{const Ct=ka(ot.toString()),ct=gt.fontStack||ft,It=ce[ct]=ce[ct]||{};this.calculateGlyphDependencies(gt.text,It,lt,this.allowVerticalPlacement,Ct)}}}"line"===E.get("symbol-placement")&&(this.features=function(Te){const Pe={},Be={},je=[];let He=0;function Ge(ft){je.push(Te[ft]),He++}function ot(ft,lt,gt){const Ct=Be[ft];return delete Be[ft],Be[lt]=Ct,je[Ct].geometry[0].pop(),je[Ct].geometry[0]=je[Ct].geometry[0].concat(gt[0]),Ct}function nt(ft,lt,gt){const Ct=Pe[lt];return delete Pe[lt],Pe[ft]=Ct,je[Ct].geometry[0].shift(),je[Ct].geometry[0]=gt[0].concat(je[Ct].geometry[0]),Ct}function Mt(ft,lt,gt){const Ct=gt?lt[0][lt[0].length-1]:lt[0][0];return`${ft}:${Ct.x}:${Ct.y}`}for(let ft=0;ft<Te.length;ft++){const lt=Te[ft],gt=lt.geometry,Ct=lt.text?lt.text.toString():null;if(!Ct){Ge(ft);continue}const ct=Mt(Ct,gt),It=Mt(Ct,gt,!0);if(ct in Be&&It in Pe&&Be[ct]!==Pe[It]){const Ot=nt(ct,It,gt),rn=ot(ct,It,je[Ot].geometry);delete Pe[ct],delete Be[It],Be[Mt(Ct,je[rn].geometry,!0)]=rn,je[Ot].geometry=null}else ct in Be?ot(ct,It,gt):It in Pe?nt(ct,It,gt):(Ge(ft),Pe[ct]=He-1,Be[It]=He-1)}return je.filter(ft=>ft.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Te,Pe)=>Te.sortKey-Pe.sortKey)}update(r,u,p,y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,u,this.layers,p,y),this.icon.programConfigurations.updatePaintArrays(r,u,this.layers,p,y))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,u){const p=this.lineVertexArray.length;if(void 0!==r.segment){let y=r.dist(u[r.segment+1]),b=r.dist(u[r.segment]);const E={};for(let k=r.segment+1;k<u.length;k++)E[k]={x:u[k].x,y:u[k].y,tileUnitDistanceFromAnchor:y},k<u.length-1&&(y+=u[k+1].dist(u[k]));for(let k=r.segment||0;k>=0;k--)E[k]={x:u[k].x,y:u[k].y,tileUnitDistanceFromAnchor:b},k>0&&(b+=u[k-1].dist(u[k]));for(let k=0;k<u.length;k++){const N=E[k];this.lineVertexArray.emplaceBack(N.x,N.y,N.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(r,u,p,y,b,E,k,N,z,j,W,Y,ie,ce){const pe=r.indexArray,Ce=r.layoutVertexArray,Te=r.segments.prepareSegment(4*u.length,Ce,pe,this.canOverlap?E.sortKey:void 0),Pe=this.glyphOffsetArray.length,Be=Te.vertexLength,je=this.allowVerticalPlacement&&k===Ko.vertical?Math.PI/2:0,He=E.text&&E.text.sections;for(let Ge=0;Ge<u.length;Ge++){const{tl:ot,tr:nt,bl:Mt,br:ft,tex:lt,pixelOffsetTL:gt,pixelOffsetBR:Ct,minFontScaleX:ct,minFontScaleY:It,glyphOffset:Ot,isSDF:rn,sectionIndex:Si}=u[Ge],Jt=Te.vertexLength,Wn=Ot[1];nf(Ce,N.x,N.y,N.z,z.x,z.y,ot.x,Wn+ot.y,lt.x,lt.y,p,rn,gt.x,gt.y,ct,It),nf(Ce,N.x,N.y,N.z,z.x,z.y,nt.x,Wn+nt.y,lt.x+lt.w,lt.y,p,rn,Ct.x,gt.y,ct,It),nf(Ce,N.x,N.y,N.z,z.x,z.y,Mt.x,Wn+Mt.y,lt.x,lt.y+lt.h,p,rn,gt.x,Ct.y,ct,It),nf(Ce,N.x,N.y,N.z,z.x,z.y,ft.x,Wn+ft.y,lt.x+lt.w,lt.y+lt.h,p,rn,Ct.x,Ct.y,ct,It),im(r.dynamicLayoutVertexArray,N,je),pe.emplaceBack(Jt,Jt+1,Jt+2),pe.emplaceBack(Jt+1,Jt+2,Jt+3),Te.vertexLength+=4,Te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ot[0]),Ge!==u.length-1&&Si===u[Ge+1].sectionIndex||r.programConfigurations.populatePaintArrays(Ce.length,E,E.index,{},ie,ce,He&&He[Si])}r.placedSymbolArray.emplaceBack(N.x,N.y,N.z,z.x,z.y,Pe,this.glyphOffsetArray.length-Pe,Be,j,W,z.segment,p?p[0]:0,p?p[1]:0,y[0],y[1],k,0,!1,0,Y,0)}_commitLayoutVertex(r,u,p,y,b,E,k){r.emplaceBack(u,p,y,b,E,Math.round(k.x),Math.round(k.y))}_addCollisionDebugVertices(r,u,p,y,b,E,k){const N=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),z=N.vertexLength,j=k.tileAnchorX,W=k.tileAnchorY;for(let ie=0;ie<4;ie++)p.collisionVertexArray.emplaceBack(0,0,0,0);p.collisionVertexArrayExt.emplaceBack(u,-r.padding,-r.padding),p.collisionVertexArrayExt.emplaceBack(u,r.padding,-r.padding),p.collisionVertexArrayExt.emplaceBack(u,r.padding,r.padding),p.collisionVertexArrayExt.emplaceBack(u,-r.padding,r.padding),this._commitLayoutVertex(p.layoutVertexArray,y,b,E,j,W,new Je(r.x1,r.y1)),this._commitLayoutVertex(p.layoutVertexArray,y,b,E,j,W,new Je(r.x2,r.y1)),this._commitLayoutVertex(p.layoutVertexArray,y,b,E,j,W,new Je(r.x2,r.y2)),this._commitLayoutVertex(p.layoutVertexArray,y,b,E,j,W,new Je(r.x1,r.y2)),N.vertexLength+=4;const Y=p.indexArray;Y.emplaceBack(z,z+1),Y.emplaceBack(z+1,z+2),Y.emplaceBack(z+2,z+3),Y.emplaceBack(z+3,z),N.primitiveLength+=4}_addTextDebugCollisionBoxes(r,u,p,y,b,E){for(let k=y;k<b;k++){const N=p.get(k),z=this.getSymbolInstanceTextSize(r,E,u,k);this._addCollisionDebugVertices(N,z,this.textCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,E)}}_addIconDebugCollisionBoxes(r,u,p,y,b,E){for(let k=y;k<b;k++){const N=p.get(k),z=this.getSymbolInstanceIconSize(r,u,k);this._addCollisionDebugVertices(N,z,this.iconCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,E)}}generateCollisionDebugBuffers(r,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new wt(Tr,zg.members,wi),this.iconCollisionBox=new wt(Tr,zg.members,wi);const p=mh(this.iconSizeData,r),y=mh(this.textSizeData,r);for(let b=0;b<this.symbolInstances.length;b++){const E=this.symbolInstances.get(b);this._addTextDebugCollisionBoxes(y,r,u,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(y,r,u,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(p,r,u,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(p,r,u,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(r,u,p,y){const b=this.text.placedSymbolArray.get(u.rightJustifiedTextSymbolIndex>=0?u.rightJustifiedTextSymbolIndex:u.centerJustifiedTextSymbolIndex>=0?u.centerJustifiedTextSymbolIndex:u.leftJustifiedTextSymbolIndex>=0?u.leftJustifiedTextSymbolIndex:u.verticalPlacedTextSymbolIndex>=0?u.verticalPlacedTextSymbolIndex:y),E=Xp(this.textSizeData,r,b)/24;return this.tilePixelRatio*E}getSymbolInstanceIconSize(r,u,p){const y=this.icon.placedSymbolArray.get(p),b=Xp(this.iconSizeData,r,y);return this.tilePixelRatio*b}_commitDebugCollisionVertexUpdate(r,u,p){r.emplaceBack(u,-p,-p),r.emplaceBack(u,p,-p),r.emplaceBack(u,p,p),r.emplaceBack(u,-p,p)}_updateTextDebugCollisionBoxes(r,u,p,y,b,E){for(let k=y;k<b;k++){const N=p.get(k),z=this.getSymbolInstanceTextSize(r,E,u,k);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,z,N.padding)}}_updateIconDebugCollisionBoxes(r,u,p,y,b){for(let E=y;E<b;E++){const k=p.get(E),N=this.getSymbolInstanceIconSize(r,u,E);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,N,k.padding)}}updateCollisionDebugBuffers(r,u){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const p=mh(this.iconSizeData,r),y=mh(this.textSizeData,r);for(let b=0;b<this.symbolInstances.length;b++){const E=this.symbolInstances.get(b);this._updateTextDebugCollisionBoxes(y,r,u,E.textBoxStartIndex,E.textBoxEndIndex,E),this._updateTextDebugCollisionBoxes(y,r,u,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._updateIconDebugCollisionBoxes(p,r,u,E.iconBoxStartIndex,E.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(p,r,u,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(r,u,p,y,b,E,k,N,z){const j={};for(let W=u;W<p;W++){const Y=r.get(W);j.textBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,padding:Y.padding,projectedAnchorX:Y.projectedAnchorX,projectedAnchorY:Y.projectedAnchorY,projectedAnchorZ:Y.projectedAnchorZ,tileAnchorX:Y.tileAnchorX,tileAnchorY:Y.tileAnchorY},j.textFeatureIndex=Y.featureIndex;break}for(let W=y;W<b;W++){const Y=r.get(W);j.verticalTextBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,padding:Y.padding,projectedAnchorX:Y.projectedAnchorX,projectedAnchorY:Y.projectedAnchorY,projectedAnchorZ:Y.projectedAnchorZ,tileAnchorX:Y.tileAnchorX,tileAnchorY:Y.tileAnchorY},j.verticalTextFeatureIndex=Y.featureIndex;break}for(let W=E;W<k;W++){const Y=r.get(W);j.iconBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,padding:Y.padding,projectedAnchorX:Y.projectedAnchorX,projectedAnchorY:Y.projectedAnchorY,projectedAnchorZ:Y.projectedAnchorZ,tileAnchorX:Y.tileAnchorX,tileAnchorY:Y.tileAnchorY},j.iconFeatureIndex=Y.featureIndex;break}for(let W=N;W<z;W++){const Y=r.get(W);j.verticalIconBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,padding:Y.padding,projectedAnchorX:Y.projectedAnchorX,projectedAnchorY:Y.projectedAnchorY,projectedAnchorZ:Y.projectedAnchorZ,tileAnchorX:Y.tileAnchorX,tileAnchorY:Y.tileAnchorY},j.verticalIconFeatureIndex=Y.featureIndex;break}return j}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const p=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,u){const p=r.placedSymbolArray.get(u),y=p.vertexStartIndex+4*p.numGlyphs;for(let b=p.vertexStartIndex;b<y;b+=4)r.indexArray.emplaceBack(b,b+1,b+2),r.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const u=Math.sin(r),p=Math.cos(r),y=[],b=[],E=[];for(let k=0;k<this.symbolInstances.length;++k){E.push(k);const N=this.symbolInstances.get(k);y.push(0|Math.round(u*N.tileAnchorX+p*N.tileAnchorY)),b.push(N.featureIndex)}return E.sort((k,N)=>y[k]-y[N]||b[N]-b[k]),E}addToSortKeyRanges(r,u){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===u?p.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const p=this.symbolInstances.get(u);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((y,b,E)=>{y>=0&&E.indexOf(y)===b&&this.addIndicesForPlacedSymbol(this.text,y)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Bt("SymbolBucket",Bl,{omit:["layers","collisionBoxArray","features","compareText"]}),Bl.MAX_GLYPHS=65535,Bl.addDynamicAttributes=im;const T_=new rt({"symbol-placement":new be(d.layout_symbol["symbol-placement"]),"symbol-spacing":new be(d.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new be(d.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ke(d.layout_symbol["symbol-sort-key"]),"symbol-z-order":new be(d.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new be(d.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new be(d.layout_symbol["icon-ignore-placement"]),"icon-optional":new be(d.layout_symbol["icon-optional"]),"icon-rotation-alignment":new be(d.layout_symbol["icon-rotation-alignment"]),"icon-size":new ke(d.layout_symbol["icon-size"]),"icon-text-fit":new be(d.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new be(d.layout_symbol["icon-text-fit-padding"]),"icon-image":new ke(d.layout_symbol["icon-image"]),"icon-rotate":new ke(d.layout_symbol["icon-rotate"]),"icon-padding":new be(d.layout_symbol["icon-padding"]),"icon-keep-upright":new be(d.layout_symbol["icon-keep-upright"]),"icon-offset":new ke(d.layout_symbol["icon-offset"]),"icon-anchor":new ke(d.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new be(d.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new be(d.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new be(d.layout_symbol["text-rotation-alignment"]),"text-field":new ke(d.layout_symbol["text-field"]),"text-font":new ke(d.layout_symbol["text-font"]),"text-size":new ke(d.layout_symbol["text-size"]),"text-max-width":new ke(d.layout_symbol["text-max-width"]),"text-line-height":new ke(d.layout_symbol["text-line-height"]),"text-letter-spacing":new ke(d.layout_symbol["text-letter-spacing"]),"text-justify":new ke(d.layout_symbol["text-justify"]),"text-radial-offset":new ke(d.layout_symbol["text-radial-offset"]),"text-variable-anchor":new be(d.layout_symbol["text-variable-anchor"]),"text-anchor":new ke(d.layout_symbol["text-anchor"]),"text-max-angle":new be(d.layout_symbol["text-max-angle"]),"text-writing-mode":new be(d.layout_symbol["text-writing-mode"]),"text-rotate":new ke(d.layout_symbol["text-rotate"]),"text-padding":new be(d.layout_symbol["text-padding"]),"text-keep-upright":new be(d.layout_symbol["text-keep-upright"]),"text-transform":new ke(d.layout_symbol["text-transform"]),"text-offset":new ke(d.layout_symbol["text-offset"]),"text-allow-overlap":new be(d.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new be(d.layout_symbol["text-ignore-placement"]),"text-optional":new be(d.layout_symbol["text-optional"])});var xh={paint:new rt({"icon-opacity":new ke(d.paint_symbol["icon-opacity"]),"icon-color":new ke(d.paint_symbol["icon-color"]),"icon-halo-color":new ke(d.paint_symbol["icon-halo-color"]),"icon-halo-width":new ke(d.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ke(d.paint_symbol["icon-halo-blur"]),"icon-translate":new be(d.paint_symbol["icon-translate"]),"icon-translate-anchor":new be(d.paint_symbol["icon-translate-anchor"]),"text-opacity":new ke(d.paint_symbol["text-opacity"]),"text-color":new ke(d.paint_symbol["text-color"],{runtimeType:K,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new ke(d.paint_symbol["text-halo-color"]),"text-halo-width":new ke(d.paint_symbol["text-halo-width"]),"text-halo-blur":new ke(d.paint_symbol["text-halo-blur"]),"text-translate":new be(d.paint_symbol["text-translate"]),"text-translate-anchor":new be(d.paint_symbol["text-translate-anchor"])}),layout:T_};class fa{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:B,this.defaultValue=r}evaluate(r){if(r.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(r.formattedSection))return u.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Bt("FormatSectionOverride",fa,{omit:["defaultValue"]});class Pd extends Zs{constructor(r){super(r,xh)}recalculate(r,u){super.recalculate(r,u),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const y=[];for(const b of p)y.indexOf(b)<0&&y.push(b);this.layout._values["text-writing-mode"]=y}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(r,u,p,y){const b=this.layout.get(r).evaluate(u,{},p,y),E=this._unevaluatedLayout._values[r];return E.isDataDriven()||$o(E.value)||!b?b:(k=u.properties,b.replace(/{([^{}]+)}/g,(z,j)=>j in k?String(k[j]):""));var k}createBucket(r){return new Bl(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of xh.paint.overridableProperties){if(!Pd.hasPaintOverride(this.layout,r))continue;const u=this.paint.get(r),p=new fa(u),y=new Dr(p,u.property.specification);let b=null;b="constant"===u.value.kind||"source"===u.value.kind?new Er("source",y):new bc("composite",y,u.value.zoomStops,u.value._interpolationType),this.paint._values[r]=new Ee(u.property,b,u.parameters)}}_handleOverridablePaintPropertyUpdate(r,u,p){return!(!this.layout||u.isDataDriven()||p.isDataDriven())&&Pd.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,u){const p=r.get("text-field"),y=xh.paint.properties[u];let b=!1;const E=k=>{for(const N of k)if(y.overrides&&y.overrides.hasOverride(N))return void(b=!0)};if("constant"===p.value.kind&&p.value.value instanceof pn)E(p.value.value.sections);else if("source"===p.value.kind){const k=z=>{b||(z instanceof $a&&bi(z.value)===ge?E(z.value.sections):z instanceof yr?E(z.sections):z.eachChild(k))},N=p.value;N._styleExpression&&k(N._styleExpression.expression)}return b}getProgramConfiguration(r){return new Fc(this,r)}}var wb={paint:new rt({"background-color":new be(d.paint_background["background-color"]),"background-pattern":new Qe(d.paint_background["background-pattern"]),"background-opacity":new be(d.paint_background["background-opacity"])})},rm={paint:new rt({"raster-opacity":new be(d.paint_raster["raster-opacity"]),"raster-hue-rotate":new be(d.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new be(d.paint_raster["raster-brightness-min"]),"raster-brightness-max":new be(d.paint_raster["raster-brightness-max"]),"raster-saturation":new be(d.paint_raster["raster-saturation"]),"raster-contrast":new be(d.paint_raster["raster-contrast"]),"raster-resampling":new be(d.paint_raster["raster-resampling"]),"raster-fade-duration":new be(d.paint_raster["raster-fade-duration"])})};class Vl extends Zs{constructor(r){super(r,{}),this.implementation=r}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)}onRemove(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)}}var sm={paint:new rt({"sky-type":new be(d.paint_sky["sky-type"]),"sky-atmosphere-sun":new be(d.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new be(d.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new be(d.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new be(d.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ke(d.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new be(d.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new be(d.paint_sky["sky-atmosphere-color"]),"sky-opacity":new be(d.paint_sky["sky-opacity"])})};function rf(c,r,u){const p=_u(0,0,1),y=Lx(Dg());return function(b,E,k){k*=.5;var N=E[0],z=E[1],j=E[2],W=E[3],Y=Math.sin(k),ie=Math.cos(k);b[0]=N*ie-j*Y,b[1]=z*ie+W*Y,b[2]=j*ie+N*Y,b[3]=W*ie-z*Y}(y,y,u?-wn(c)+Math.PI:wn(c)),Hy(y,y,-wn(r)),Uy(p,p,y),Vy(p,p)}const om={circle:class extends Zs{constructor(c){super(c,Fx)}createBucket(c){return new ah(c)}queryRadius(c){const r=c;return dt("circle-radius",this,r)+dt("circle-stroke-width",this,r)+dd(this.paint.get("circle-translate"))}queryIntersectsFeature(c,r,u,p,y,b,E,k){const N=zc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),z=this.paint.get("circle-radius").evaluate(r,u)+this.paint.get("circle-stroke-width").evaluate(r,u);return $y(c,p,b,E,k,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),N,z)}getProgramIds(){return["circle"]}getProgramConfiguration(c){return new Fc(this,c)}},heatmap:class extends Zs{createBucket(c){return new Gy(c)}constructor(c){super(c,Xy),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){"heatmap-color"===c&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ol({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return dt("heatmap-radius",this,c)}queryIntersectsFeature(c,r,u,p,y,b,E,k){const N=this.paint.get("heatmap-radius").evaluate(r,u);return $y(c,p,b,E,k,!0,!0,new Je(0,0),N)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(c){return new Fc(this,c)}},hillshade:class extends Zs{constructor(c){super(c,Bx)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(c){return new Fc(this,c)}},fill:class extends Zs{constructor(c){super(c,$p)}getProgramIds(){const c=this.paint.get("fill-pattern"),r=c&&c.constantOr(1),u=[r?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&u.push(r&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),u}getProgramConfiguration(c){return new Fc(this,c)}recalculate(c,r){super.recalculate(c,r);const u=this.paint._values["fill-outline-color"];"constant"===u.value.kind&&void 0===u.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new jp(c)}queryRadius(){return dd(this.paint.get("fill-translate"))}queryIntersectsFeature(c,r,u,p,y,b){return!c.queryGeometry.isAboveHorizon&&Ip(Nx(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),p)}isTileClipped(){return!0}},"fill-extrusion":class extends Zs{constructor(c){super(c,Qy)}createBucket(c){return new gs(c)}queryRadius(){return dd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(c){return new Fc(this,c)}queryIntersectsFeature(c,r,u,p,y,b,E,k,N){const z=zc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),j=this.paint.get("fill-extrusion-height").evaluate(r,u),W=this.paint.get("fill-extrusion-base").evaluate(r,u),Y=[0,0],ie=k&&b.elevation,ce=b.elevation?b.elevation.exaggeration():1;if(ie){const Te=c.tile.getBucket(this).centroidVertexArray,Pe=N+1;if(Pe<Te.length){const Be=Te.get(Pe);Y[0]=Be.a_centroid_pos0,Y[1]=Be.a_centroid_pos1}}if(0===Y[0]&&1===Y[1])return!1;const pe=(Te=p,Pe=W,Be=j,je=z,He=E,(Ge=ie?k:null)?function(ft,lt,gt,Ct,ct,It,Ot,rn,Si){const Jt=[],Wn=[],Pt=[0,0,0,1];for(const ci of ft){const Hn=[],Ki=[];for(const _i of ci){const Gi=_i.x+Ct.x,$r=_i.y+Ct.y,oi=Fg(Gi,$r,lt,gt,It,Ot,rn,Si);Pt[0]=Gi,Pt[1]=$r,Pt[2]=oi.base,Pt[3]=1,ch(Pt,Pt,ct),Pt[3]=Math.max(Pt[3],1e-5);const Kn=gh([Pt[0]/Pt[3],Pt[1]/Pt[3],Pt[2]/Pt[3]]);Pt[0]=Gi,Pt[1]=$r,Pt[2]=oi.top,Pt[3]=1,ch(Pt,Pt,ct),Pt[3]=Math.max(Pt[3],1e-5);const ei=gh([Pt[0]/Pt[3],Pt[1]/Pt[3],Pt[2]/Pt[3]]);Hn.push(Kn),Ki.push(ei)}Jt.push(Hn),Wn.push(Ki)}return[Jt,Wn]}(Te,Pe,Be,je,He,Ge,Y,ce,b.center.lat):function(ft,lt,gt,Ct,ct){const It=[],Ot=[],rn=ct[8]*lt,Si=ct[9]*lt,Jt=ct[10]*lt,Wn=ct[11]*lt,Pt=ct[8]*gt,ci=ct[9]*gt,Hn=ct[10]*gt,Ki=ct[11]*gt;for(const _i of ft){const Gi=[],$r=[];for(const oi of _i){const Kn=oi.x+Ct.x,ei=oi.y+Ct.y,Gr=ct[0]*Kn+ct[4]*ei+ct[12],zi=ct[1]*Kn+ct[5]*ei+ct[13],Wi=ct[2]*Kn+ct[6]*ei+ct[14],ts=ct[3]*Kn+ct[7]*ei+ct[15],Ni=Gr+rn,Ns=zi+Si,vi=Wi+Jt,Qi=Math.max(ts+Wn,1e-5),ur=Gr+Pt,Ui=zi+ci,Xi=Wi+Hn,vr=Math.max(ts+Ki,1e-5),ui=new Je(Ni/Qi,Ns/Qi);ui.z=vi/Qi,Gi.push(ui);const hr=new Je(ur/vr,Ui/vr);hr.z=Xi/vr,$r.push(hr)}It.push(Gi),Ot.push($r)}return[It,Ot]}(Te,Pe,Be,je,He)),Ce=c.queryGeometry;var Te,Pe,Be,je,He,Ge;return function(Te,Pe,Be){let je=1/0;Ip(Be,Pe)&&(je=ms(Be,Pe[0]));for(let He=0;He<Pe.length;He++){const Ge=Pe[He],ot=Te[He];for(let nt=0;nt<Ge.length-1;nt++){const Mt=Ge[nt],ft=[Mt,Ge[nt+1],ot[nt+1],ot[nt],Mt];Ix(Be,ft)&&(je=Math.min(je,ms(Be,ft)))}}return je!==1/0&&je}(pe[0],pe[1],Ce.isPointQuery()?Ce.screenBounds:Ce.screenGeometry)}},line:class extends Zs{constructor(c){super(c,n_),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if("line-gradient"===c){const r=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=r._styleExpression&&r._styleExpression.expression instanceof Bu,this.gradientVersion=(this.gradientVersion+1)%Ss}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,r){super.recalculate(c,r),this.paint._values["line-floorwidth"]=i_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new Cd(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(c){return new Fc(this,c)}queryRadius(c){const r=c,u=Og(dt("line-width",this,r),dt("line-gap-width",this,r)),p=dt("line-offset",this,r);return u/2+Math.abs(p)+dd(this.paint.get("line-translate"))}queryIntersectsFeature(c,r,u,p,y,b){if(c.queryGeometry.isAboveHorizon)return!1;const E=Nx(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),k=c.pixelToTileUnitsFactor/2*Og(this.paint.get("line-width").evaluate(r,u),this.paint.get("line-gap-width").evaluate(r,u)),N=this.paint.get("line-offset").evaluate(r,u);return N&&(p=function(z,j){const W=[],Y=new Je(0,0);for(let ie=0;ie<z.length;ie++){const ce=z[ie],pe=[];for(let Ce=0;Ce<ce.length;Ce++){const Te=ce[Ce-1],Pe=ce[Ce],Be=ce[Ce+1],je=0===Ce?Y:Pe.sub(Te)._unit()._perp(),He=Ce===ce.length-1?Y:Be.sub(Pe)._unit()._perp(),Ge=je._add(He)._unit();Ge._mult(1/(Ge.x*He.x+Ge.y*He.y)),pe.push(Ge._mult(j)._add(Pe))}W.push(pe)}return W}(p,N*c.pixelToTileUnitsFactor)),function(z,j,W){for(let Y=0;Y<j.length;Y++){const ie=j[Y];if(z.length>=3)for(let ce=0;ce<ie.length;ce++)if(Qa(z,ie[ce]))return!0;if(lh(z,ie,W))return!0}return!1}(E,p,k)}isTileClipped(){return!0}},symbol:Pd,background:class extends Zs{constructor(c){super(c,wb)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Zs{constructor(c){super(c,rm)}getProgramIds(){return["raster"]}},sky:class extends Zs{constructor(c){super(c,sm),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){"sky-gradient"===c?this._updateColorRamp():"sky-atmosphere-sun"!==c&&"sky-atmosphere-halo-color"!==c&&"sky-atmosphere-color"!==c&&"sky-atmosphere-sun-intensity"!==c||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Ol({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const r=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==r.azimuthal||this._lightPosition.polar!==r.polar}}getCenter(c,r){const u=this.paint.get("sky-type");if("atmosphere"===u){const p=this.paint.get("sky-atmosphere-sun"),y=!p,b=c.style.light,E=b.properties.get("position");return y&&"viewport"===b.properties.get("anchor")&&mn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),y?rf(E.azimuthal,90-E.polar,r):rf(p[0],90-p[1],r)}if("gradient"===u){const p=this.paint.get("sky-gradient-center");return rf(p[0],90-p[1],r)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return"atmosphere"===c?["skyboxCapture","skybox"]:"gradient"===c?["skyboxGradient"]:null}}},{HTMLImageElement:Cb,HTMLCanvasElement:am,HTMLVideoElement:Sb,ImageData:Rd,ImageBitmap:Du}=$t;class bh{constructor(r,u,p,y){this.context=r,this.format=p,this.texture=r.gl.createTexture(),this.update(u,y)}update(r,u,p){const{width:y,height:b}=r,{context:E}=this,{gl:k}=E;if(k.bindTexture(k.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!u||!1!==u.premultiply)),p||this.size&&this.size[0]===y&&this.size[1]===b){const{x:N,y:z}=p||{x:0,y:0};r instanceof Cb||r instanceof am||r instanceof Sb||r instanceof Rd||Du&&r instanceof Du?k.texSubImage2D(k.TEXTURE_2D,0,N,z,k.RGBA,k.UNSIGNED_BYTE,r):k.texSubImage2D(k.TEXTURE_2D,0,N,z,y,b,k.RGBA,k.UNSIGNED_BYTE,r.data)}else this.size=[y,b],r instanceof Cb||r instanceof am||r instanceof Sb||r instanceof Rd||Du&&r instanceof Du?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,r):k.texImage2D(k.TEXTURE_2D,0,this.format,y,b,0,this.format,k.UNSIGNED_BYTE,r.data);this.useMipmap=Boolean(u&&u.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&k.generateMipmap(k.TEXTURE_2D)}bind(r,u){const{context:p}=this,{gl:y}=p;y.bindTexture(y.TEXTURE_2D,this.texture),r!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,r),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,this.useMipmap?r===y.NEAREST?y.NEAREST_MIPMAP_NEAREST:y.LINEAR_MIPMAP_NEAREST:r),this.filter=r),u!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,u),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class Nd{constructor(r,u){this.width=r,this.height=u,this.nextRow=0,this.image=new Fl({width:r,height:u}),this.positions={},this.uploaded=!1}getDash(r,u){const p=this.getKey(r,u);return this.positions[p]}trim(){const r=this.width,u=this.height=Xr(this.nextRow);this.image.resize({width:r,height:u})}getKey(r,u){return r.join(",")+u}getDashRanges(r,u,p){const y=[];let b=r.length%2==1?-r[r.length-1]*p:0,E=r[0]*p,k=!0;y.push({left:b,right:E,isDash:k,zeroLength:0===r[0]});let N=r[0];for(let z=1;z<r.length;z++){k=!k;const j=r[z];b=N*p,N+=j,E=N*p,y.push({left:b,right:E,isDash:k,zeroLength:0===j})}return y}addRoundDash(r,u,p){const y=u/2;for(let b=-p;b<=p;b++){const E=this.width*(this.nextRow+p+b);let k=0,N=r[k];for(let z=0;z<this.width;z++){z/N.right>1&&(N=r[++k]);const j=Math.abs(z-N.left),W=Math.abs(z-N.right),Y=Math.min(j,W);let ie;const ce=b/p*(y+1);if(N.isDash){const pe=y-Math.abs(ce);ie=Math.sqrt(Y*Y+pe*pe)}else ie=y-Math.sqrt(Y*Y+ce*ce);this.image.data[E+z]=Math.max(0,Math.min(255,ie+128))}}}addRegularDash(r,u){for(let N=r.length-1;N>=0;--N){const z=r[N],j=r[N+1];z.zeroLength?r.splice(N,1):j&&j.isDash===z.isDash&&(j.left=z.left,r.splice(N,1))}const p=r[0],y=r[r.length-1];p.isDash===y.isDash&&(p.left=y.left-this.width,y.right=p.right+this.width);const b=this.width*this.nextRow;let E=0,k=r[E];for(let N=0;N<this.width;N++){N/k.right>1&&(k=r[++E]);const z=Math.abs(N-k.left),j=Math.abs(N-k.right),W=Math.min(z,j);this.image.data[b+N]=Math.max(0,Math.min(255,(k.isDash?W:-W)+u+128))}}addDash(r,u){const p=this.getKey(r,u);if(this.positions[p])return this.positions[p];const y="round"===u,b=y?7:0,E=2*b+1;if(this.nextRow+E>this.height)return mn("LineAtlas out of space"),null;0===r.length&&r.push(1);let k=0;for(let j=0;j<r.length;j++)r[j]<0&&(mn("Negative value is found in line dasharray, replacing values with 0"),r[j]=0),k+=r[j];if(0!==k){const j=this.width/k,W=this.getDashRanges(r,this.width,j);y?this.addRoundDash(W,j,b):this.addRegularDash(W,"square"===u?.5*j:0)}const N=this.nextRow+b;this.nextRow+=E;const z={tl:[N,b],br:[k,0]};return this.positions[p]=z,z}}Bt("LineAtlas",Nd);class lm{constructor(r){this._callback=r,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const mC=$t.performance;function M_(c){const r=c?c.url.toString():void 0;return mC.getEntriesByName(r)}class Db{constructor(){this.tasks={},this.taskQueue=[],Cn(["process"],this),this.invoker=new lm(this.process),this.nextId=0}add(r,u){const p=this.nextId++,y=function({type:b,isSymbolTile:E,zoom:k}){return k=k||0,"message"===b?0:"maybePrepare"!==b||E?"parseTile"!==b||E?"parseTile"===b&&E?300-k:"maybePrepare"===b&&E?400-k:500:200-k:100-k}(u);if(0===y){vn();try{r()}finally{}return{cancel:()=>{}}}return this.tasks[p]={fn:r,metadata:u,priority:y,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){vn();try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const r=this.pick();if(null===r)return;const u=this.tasks[r];if(delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),!u)return;u.fn()}finally{}}pick(){let r=null,u=1/0;for(let y=0;y<this.taskQueue.length;y++){const b=this.tasks[this.taskQueue[y]];b.priority<u&&(u=b.priority,r=y)}if(null===r)return null;const p=this.taskQueue[r];return this.taskQueue.splice(r,1),p}remove(){this.invoker.remove()}}function sf(c,r){const u=Math.pow(2,-c.z),p=c.x*u,y=(c.x+1)*u,b=c.y*u,E=(c.y+1)*u;if("mercator"===r.name)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:r};const k=Lc(p),N=Lc(y),z=cr(b),j=cr(E),W=r.project(k,z),Y=r.project(N,z),ie=r.project(N,j),ce=r.project(k,j);let pe=Math.min(W.x,Y.x,ie.x,ce.x),Ce=Math.min(W.y,Y.y,ie.y,ce.y),Te=Math.max(W.x,Y.x,ie.x,ce.x),Pe=Math.max(W.y,Y.y,ie.y,ce.y);const Be=u/16;function je(Ge,ot,nt,Mt,ft,lt){const gt=(nt+ft)/2,Ct=(Mt+lt)/2,ct=r.project(Lc(gt),cr(Ct)),It=Math.max(0,pe-ct.x,Ce-ct.y,ct.x-Te,ct.y-Pe);pe=Math.min(pe,ct.x),Te=Math.max(Te,ct.x),Ce=Math.min(Ce,ct.y),Pe=Math.max(Pe,ct.y),It>Be&&(je(Ge,ct,nt,Mt,gt,Ct),je(ct,ot,gt,Ct,ft,lt))}je(W,Y,p,b,y,b),je(Y,ie,y,b,y,E),je(ie,ce,y,E,p,E),je(ce,W,p,E,p,b),pe-=Be,Ce-=Be,Te+=Be,Pe+=Be;const He=1/Math.max(Te-pe,Pe-Ce);return{scale:He,x:pe*He,y:Ce*He,x2:Te*He,y2:Pe*He,projection:r}}function k_(c,r,u){var p=2*Math.PI*6378137/256/Math.pow(2,u);return[c*p-2*Math.PI*6378137/2,r*p-2*Math.PI*6378137/2]}class of{constructor(r,u,p){this.z=r,this.x=u,this.y=p,this.key=af(0,r,r,u,p)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,u){const p=(b=this.y,E=this.z,k=k_(256*(y=this.x),256*(b=Math.pow(2,E)-b-1),E),N=k_(256*(y+1),256*(b+1),E),k[0]+","+k[1]+","+N[0]+","+N[1]);var y,b,E,k,N;const z=function(j,W,Y){let ie,ce="";for(let pe=j;pe>0;pe--)ie=1<<pe-1,ce+=(W&ie?1:0)+(Y&ie?2:0);return ce}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===u?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",z).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Eb{constructor(r,u){this.wrap=r,this.canonical=u,this.key=af(r,u.z,u.z,u.x,u.y)}}class Qs{constructor(r,u,p,y,b){this.overscaledZ=r,this.wrap=u,this.canonical=new of(p,+y,+b),this.key=0===u&&r===p?this.canonical.key:af(u,r,p,y,b)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const u=this.canonical.z-r;return r>this.canonical.z?new Qs(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Qs(r,this.wrap,r,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(r,u=!0){if(this.overscaledZ===r&&u)return this.key;if(r>this.canonical.z)return af(this.wrap*+u,r,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-r;return af(this.wrap*+u,r,r,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(r){if(r.wrap!==this.wrap)return!1;const u=this.canonical.z-r.canonical.z;return 0===r.overscaledZ||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>u&&r.canonical.y===this.canonical.y>>u}children(r){if(this.overscaledZ>=r)return[new Qs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,p=2*this.canonical.x,y=2*this.canonical.y;return[new Qs(u,this.wrap,u,p,y),new Qs(u,this.wrap,u,p+1,y),new Qs(u,this.wrap,u,p,y+1),new Qs(u,this.wrap,u,p+1,y+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Qs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Qs(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Eb(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function af(c,r,u,p,y){const b=1<<Math.min(u,22);let E=b*(y%b)+p%b;return c&&u<22&&(E+=b*b*((c<0?-2*c-1:2*c)%(1<<2*(22-u)))),16*(32*E+u)+(r-u)}Bt("CanonicalTileID",of),Bt("OverscaledTileID",Qs,{omit:["projMatrix"]});class cm{constructor(r){this._stringToNumber={},this._numberToString=[];for(let u=0;u<r.length;u++){const p=r[u];this._stringToNumber[p]=u,this._numberToString[u]=p}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}class um{constructor(r,u,p,y,b){this.type="Feature",this._vectorTileFeature=r,r._z=u,r._x=p,r._y=y,this.properties=r.properties,this.id=b}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const u in this)"_geometry"!==u&&"_vectorTileFeature"!==u&&(r[u]=this[u]);return r}}var Ab=Ye([{name:"a_pos",type:"Int16",components:2}]);const Eu=new Uint16Array(8184);for(let c=0;c<2046;c++){let r=c+2,u=0,p=0,y=0,b=0,E=0,k=0;for(1&r?y=b=E=32:u=p=k=32;(r>>=1)>1;){const z=u+y>>1,j=p+b>>1;1&r?(y=u,b=p,u=E,p=k):(u=y,p=b,y=E,b=k),E=z,k=j}const N=4*c;Eu[N+0]=u,Eu[N+1]=p,Eu[N+2]=y,Eu[N+3]=b}const Hl=new Uint16Array(2178),Au=new Uint8Array(1089),hm=new Uint16Array(1089);function Tb(c){return 0===c?-.03125:32===c?.03125:0}var I_=Ye([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Mb={type:2,extent:cn,loadGeometry:()=>[[new Je(0,0),new Je(8193,0),new Je(8193,8193),new Je(0,8193),new Je(0,0)]]};class kb{constructor(r,u,p,y,b){this.tileID=r,this.uid=Fr(),this.uses=0,this.tileSize=u,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=b,this.expiredRequestCount=0,this.state="loading",y&&y.transform&&(this.projection=y.transform.projection)}registerFadeDuration(r){const u=r+this.timeAdded;u<cs.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=sf(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,u,p){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(y,b){const E={};if(!b)return E;for(const k of y){const N=k.layerIds.map(z=>b.getLayer(z)).filter(Boolean);if(0!==N.length){k.layers=N,k.stateDependentLayerIds&&(k.stateDependentLayers=k.stateDependentLayerIds.map(z=>N.filter(j=>j.id===z)[0]));for(const z of N)E[z.id]=k}}return E}(r.buckets,u.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const b=this.buckets[y];if(b instanceof Bl){if(this.hasSymbolBuckets=!0,!p)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const b=this.buckets[y];if(b instanceof Bl&&b.hasRTLText){this.hasRTLText=!0,ee.isLoading()||ee.isLoaded()||"deferred"!==X()||Z();break}}this.queryPadding=0;for(const y in this.buckets){const b=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(y).queryRadius(b))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas)}else this.collisionBoxArray=new Zr}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(r){return this.buckets[r.id]}upload(r){for(const p in this.buckets){const y=this.buckets[p];y.uploadPending()&&y.upload(r)}const u=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new bh(r,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new bh(r,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new bh(r,this.lineAtlas.image,u.ALPHA),this.lineAtlas.uploaded=!0)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,u,p,y,b,E,k,N){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:y,pixelPosMatrix:k,transform:E,params:b,tileTransform:this.tileTransform},r,u,p):{}}querySourceFeatures(r,u){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const y=p.loadVTLayers(),b=u?u.sourceLayer:"",E=y._geojsonTileLayer||y[b];if(!E)return;const k=Wu(u&&u.filter),{z:N,x:z,y:j}=this.tileID.canonical,W={z:N,x:z,y:j};for(let Y=0;Y<E.length;Y++){const ie=E.feature(Y);if(k.needGeometry){const Ce=Pa(ie,!0);if(!k.filter(new ne(this.tileID.overscaledZ),Ce,this.tileID.canonical))continue}else if(!k.filter(new ne(this.tileID.overscaledZ),ie))continue;const ce=p.getId(ie,b),pe=new um(ie,N,z,j,ce);pe.tile=W,r.push(pe)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const u=this.expirationTime;if(r.cacheControl){const p=Kt(r.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const p=Date.now();let y=!1;if(this.expirationTime>p)y=!1;else if(u)if(this.expirationTime<u)y=!0;else{const b=this.expirationTime-u;b?this.expirationTime=p+Math.max(b,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(r,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(r).length||!u)return;const p=this.latestFeatureIndex.loadVTLayers(),y=u.style.listImages();for(const b in this.buckets){if(!u.style.hasLayer(b))continue;const E=this.buckets[b],k=E.layers[0].sourceLayer||"_geojsonTileLayer",N=p[k],z=r[k];if(!N||!z||0===Object.keys(z).length)continue;if(E.update(z,N,y,this.imageAtlas&&this.imageAtlas.patternPositions||{}),E instanceof Cd||E instanceof jp){const W=u.style._getSourceCache(E.layers[0].source);u._terrain&&u._terrain.enabled&&W&&E.programConfigurations.needsUpload&&u._terrain._clearRenderCacheForTile(W.id,this.tileID)}const j=u&&u.style&&u.style.getLayer(b);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(E)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<cs.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=cs.now()+r}setDependencies(r,u){const p={};for(const y of u)p[y]=!0;this.dependencies[r]=p}hasDependency(r,u){for(const p of r){const y=this.dependencies[p];if(y)for(const b of u)if(y[b])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,u){if(!u||"mercator"===u.name||this._tileDebugBuffer)return;const p=Nl(Mb,this.tileID.canonical,this.tileTransform)[0],y=new Lt,b=new Hr;for(let E=0;E<p.length;E++){const{x:k,y:N}=p[E];y.emplaceBack(k,N),b.emplaceBack(E)}b.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(b),this._tileDebugBuffer=r.createVertexBuffer(y,I_.members),this._tileDebugSegments=yi.simpleSegment(0,0,y.length,b.length)}_makeTileBoundsBuffers(r,u){if(this._tileBoundsBuffer||!u||"mercator"===u.name)return;const p=Nl(Mb,this.tileID.canonical,this.tileTransform)[0];let y,b;if(this.isRaster){const E=function(k,N){const z=sf(k,N),j=Math.pow(2,k.z);for(let Ce=0;Ce<33;Ce++)for(let Te=0;Te<33;Te++){const Pe=Lc((k.x+(Te+Tb(Te))/32)/j),Be=cr((k.y+(Ce+Tb(Ce))/32)/j),je=N.project(Pe,Be),He=33*Ce+Te;Hl[2*He+0]=Math.round((je.x*z.scale-z.x)*cn),Hl[2*He+1]=Math.round((je.y*z.scale-z.y)*cn)}Au.fill(0),hm.fill(0);for(let Ce=2045;Ce>=0;Ce--){const Te=4*Ce,Pe=Eu[Te+0],Be=Eu[Te+1],je=Eu[Te+2],He=Eu[Te+3],Ge=Pe+je>>1,ot=Be+He>>1,nt=Ge+ot-Be,Mt=ot+Pe-Ge,ft=33*Be+Pe,lt=33*He+je,gt=33*ot+Ge,Ct=Math.hypot((Hl[2*ft+0]+Hl[2*lt+0])/2-Hl[2*gt+0],(Hl[2*ft+1]+Hl[2*lt+1])/2-Hl[2*gt+1])>=16;if(Au[gt]=Au[gt]||(Ct?1:0),Ce<1022){const ct=33*(Be+Mt>>1)+(Pe+nt>>1),It=33*(He+Mt>>1)+(je+nt>>1);Au[gt]=Au[gt]||Au[ct]||Au[It]}}const W=new Yt,Y=new lr;let ie=0;function ce(Ce,Te){const Pe=33*Te+Ce;return 0===hm[Pe]&&(W.emplaceBack(Hl[2*Pe+0],Hl[2*Pe+1],Ce*cn/32,Te*cn/32),hm[Pe]=++ie),hm[Pe]-1}function pe(Ce,Te,Pe,Be,je,He){const Ge=Ce+Pe>>1,ot=Te+Be>>1;if(Math.abs(Ce-je)+Math.abs(Te-He)>1&&Au[33*ot+Ge])pe(je,He,Ce,Te,Ge,ot),pe(Pe,Be,je,He,Ge,ot);else{const nt=ce(Ce,Te),Mt=ce(Pe,Be),ft=ce(je,He);Y.emplaceBack(nt,Mt,ft)}}return pe(0,0,32,32,32,0),pe(32,32,0,0,0,32),{vertices:W,indices:Y}}(this.tileID.canonical,u);y=E.vertices,b=E.indices}else{y=new Yt,b=new lr;for(const{x:k,y:N}of p)y.emplaceBack(k,N,0,0);const E=zp(y.int16,void 0,4);for(let k=0;k<E.length;k+=3)b.emplaceBack(E[k],E[k+1],E[k+2])}this._tileBoundsBuffer=r.createVertexBuffer(y,I_.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(b),this._tileBoundsSegments=yi.simpleSegment(0,0,y.length,b.length)}}class yC{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,u,p){const y=String(u);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][y]=this.stateChanges[r][y]||{},Mi(this.stateChanges[r][y],p),null===this.deletedStates[r]){this.deletedStates[r]={};for(const b in this.state[r])b!==y&&(this.deletedStates[r][b]=null)}else if(this.deletedStates[r]&&null===this.deletedStates[r][y]){this.deletedStates[r][y]={};for(const b in this.state[r][y])p[b]||(this.deletedStates[r][y][b]=null)}else for(const b in p)this.deletedStates[r]&&this.deletedStates[r][y]&&null===this.deletedStates[r][y][b]&&delete this.deletedStates[r][y][b]}removeFeatureState(r,u,p){if(null===this.deletedStates[r])return;const y=String(u);if(this.deletedStates[r]=this.deletedStates[r]||{},p&&void 0!==u)null!==this.deletedStates[r][y]&&(this.deletedStates[r][y]=this.deletedStates[r][y]||{},this.deletedStates[r][y][p]=null);else if(void 0!==u)if(this.stateChanges[r]&&this.stateChanges[r][y])for(p in this.deletedStates[r][y]={},this.stateChanges[r][y])this.deletedStates[r][y][p]=null;else this.deletedStates[r][y]=null;else this.deletedStates[r]=null}getState(r,u){const p=String(u),y=Mi({},(this.state[r]||{})[p],(this.stateChanges[r]||{})[p]);if(null===this.deletedStates[r])return{};if(this.deletedStates[r]){const b=this.deletedStates[r][u];if(null===b)return{};for(const E in b)delete y[E]}return y}initializeTileState(r,u){r.setFeatureState(this.state,u)}coalesceChanges(r,u){const p={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const b={};for(const E in this.stateChanges[y])this.state[y][E]||(this.state[y][E]={}),Mi(this.state[y][E],this.stateChanges[y][E]),b[E]=this.state[y][E];p[y]=b}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const b={};if(null===this.deletedStates[y])for(const E in this.state[y])b[E]={},this.state[y][E]={};else for(const E in this.deletedStates[y]){if(null===this.deletedStates[y][E])this.state[y][E]={};else for(const k of Object.keys(this.deletedStates[y][E]))delete this.state[y][E][k];b[E]=this.state[y][E]}p[y]=p[y]||{},Mi(p[y],b)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(p).length)for(const y in r)r[y].setFeatureState(p,u)}}class jl{constructor(r){this.size=r,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(r,u){const p=this.toIdx(r,u);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(r,u){return this.leaves[this.toIdx(r,u)]}toIdx(r,u){return u*this.size+r}}function lf(c,r,u,p){let y=0,b=Number.MAX_VALUE;for(let E=0;E<3;E++)if(Math.abs(p[E])<1e-15){if(u[E]<c[E]||u[E]>r[E])return null}else{const k=1/p[E];let N=(c[E]-u[E])*k,z=(r[E]-u[E])*k;if(N>z){const j=N;N=z,z=j}if(N>y&&(y=N),z<b&&(b=z),y>b)return null}return y}function P_(c,r,u,p,y,b,E,k,N,z,j){const W=p-c,Y=y-r,ie=b-u,ce=E-c,pe=k-r,Ce=N-u,Te=j[1]*Ce-j[2]*pe,Pe=j[2]*ce-j[0]*Ce,Be=j[0]*pe-j[1]*ce,je=W*Te+Y*Pe+ie*Be;if(Math.abs(je)<1e-15)return null;const He=1/je,Ge=z[0]-c,ot=z[1]-r,nt=z[2]-u,Mt=(Ge*Te+ot*Pe+nt*Be)*He;if(Mt<0||Mt>1)return null;const ft=ot*ie-nt*Y,lt=nt*W-Ge*ie,gt=Ge*Y-ot*W,Ct=(j[0]*ft+j[1]*lt+j[2]*gt)*He;return Ct<0||Mt+Ct>1?null:(ce*ft+pe*lt+Ce*gt)*He}function dm(c,r,u){return(c-r)/(u-r)}function cf(c,r,u,p,y,b,E,k,N){const z=1<<u,j=b-p,W=E-y,Y=(c+1)/z*j+p,ie=(r+0)/z*W+y,ce=(r+1)/z*W+y;k[0]=(c+0)/z*j+p,k[1]=ie,N[0]=Y,N[1]=ce}class pm{constructor(r){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=r,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const u=function(b){const E=Math.ceil(Math.log2(b.dim/8)),k=[];let N=Math.ceil(Math.pow(2,E));const z=1/N,j=(ie,ce,pe,Ce,Te)=>{const Pe=Ce?1:0,Be=(ie+1)*pe-Pe,je=ce*pe,He=(ce+1)*pe-Pe;Te[0]=ie*pe,Te[1]=je,Te[2]=Be,Te[3]=He};let W=new jl(N);const Y=[];for(let ie=0;ie<N*N;ie++){j(ie%N,Math.floor(ie/N),z,!1,Y);const ce=jc(Y[0],Y[1],b),pe=jc(Y[2],Y[1],b),Ce=jc(Y[2],Y[3],b),Te=jc(Y[0],Y[3],b);W.minimums.push(Math.min(ce,pe,Ce,Te)),W.maximums.push(Math.max(ce,pe,Ce,Te)),W.leaves.push(1)}for(k.push(W),N/=2;N>=1;N/=2){const ie=k[k.length-1];W=new jl(N);for(let ce=0;ce<N*N;ce++){j(ce%N,Math.floor(ce/N),2,!0,Y);const pe=ie.getElevation(Y[0],Y[1]),Ce=ie.getElevation(Y[2],Y[1]),Te=ie.getElevation(Y[2],Y[3]),Pe=ie.getElevation(Y[0],Y[3]),Be=ie.isLeaf(Y[0],Y[1]),je=ie.isLeaf(Y[2],Y[1]),He=ie.isLeaf(Y[2],Y[3]),Ge=ie.isLeaf(Y[0],Y[3]),ot=Math.min(pe.min,Ce.min,Te.min,Pe.min),nt=Math.max(pe.max,Ce.max,Te.max,Pe.max),Mt=Be&&je&&He&&Ge;W.maximums.push(nt),W.minimums.push(ot),W.leaves.push(nt-ot<=5&&Mt?1:0)}k.push(W)}return k}(this.dem),p=u.length-1,y=u[p];this._addNode(y.minimums[0],y.maximums[0],y.leaves[0]),this._construct(u,0,0,p,0)}raycastRoot(r,u,p,y,b,E,k=1){return lf([r,u,-100],[p,y,this.maximums[0]*k],b,E)}raycast(r,u,p,y,b,E,k=1){if(!this.nodeCount)return null;const N=this.raycastRoot(r,u,p,y,b,E,k);if(null==N)return null;const z=[],j=[],W=[],Y=[],ie=[{idx:0,t:N,nodex:0,nodey:0,depth:0}];for(;ie.length>0;){const{idx:ce,t:pe,nodex:Ce,nodey:Te,depth:Pe}=ie.pop();if(this.leaves[ce]){cf(Ce,Te,Pe,r,u,p,y,W,Y);const je=1<<Pe,He=(Ce+0)/je,Ge=(Ce+1)/je,ot=(Te+0)/je,nt=(Te+1)/je,Mt=jc(He,ot,this.dem)*k,ft=jc(Ge,ot,this.dem)*k,lt=jc(Ge,nt,this.dem)*k,gt=jc(He,nt,this.dem)*k,Ct=P_(W[0],W[1],Mt,Y[0],W[1],ft,Y[0],Y[1],lt,b,E),ct=P_(Y[0],Y[1],lt,W[0],Y[1],gt,W[0],W[1],Mt,b,E),It=Math.min(null!==Ct?Ct:Number.MAX_VALUE,null!==ct?ct:Number.MAX_VALUE);if(It!==Number.MAX_VALUE)return It;{const Ot=Sg([],b,E,pe);if(uf(Mt,ft,gt,lt,dm(Ot[0],W[0],Y[0]),dm(Ot[1],W[1],Y[1]))>=Ot[2])return pe}continue}let Be=0;for(let je=0;je<this._siblingOffset.length;je++){cf((Ce<<1)+this._siblingOffset[je][0],(Te<<1)+this._siblingOffset[je][1],Pe+1,r,u,p,y,W,Y),W[2]=-100,Y[2]=this.maximums[this.childOffsets[ce]+je]*k;const He=lf(W,Y,b,E);if(null!=He){const Ge=He;z[je]=Ge;let ot=!1;for(let nt=0;nt<Be&&!ot;nt++)Ge>=z[j[nt]]&&(j.splice(nt,0,je),ot=!0);ot||(j[Be]=je),Be++}}for(let je=0;je<Be;je++){const He=j[je];ie.push({idx:this.childOffsets[ce]+He,t:z[He],nodex:(Ce<<1)+this._siblingOffset[He][0],nodey:(Te<<1)+this._siblingOffset[He][1],depth:Pe+1})}}return null}_addNode(r,u,p){return this.minimums.push(r),this.maximums.push(u),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(r,u,p,y,b){if(1===r[y].isLeaf(u,p))return;this.childOffsets[b]||(this.childOffsets[b]=this.nodeCount);const E=y-1,k=r[E];let N,z=0;for(let j=0;j<this._siblingOffset.length;j++){const W=2*u+this._siblingOffset[j][0],Y=2*p+this._siblingOffset[j][1],ie=k.getElevation(W,Y),ce=k.isLeaf(W,Y),pe=this._addNode(ie.min,ie.max,ce);ce&&(z|=1<<j),N||(N=pe)}for(let j=0;j<this._siblingOffset.length;j++)z&1<<j||this._construct(r,2*u+this._siblingOffset[j][0],2*p+this._siblingOffset[j][1],E,N+j)}}function uf(c,r,u,p,y,b){return ln(ln(c,u,b),ln(r,p,b),y)}function jc(c,r,u){const p=u.dim,y=On(c*p-.5,0,p-1),b=On(r*p-.5,0,p-1),E=Math.floor(y),k=Math.floor(b),N=Math.min(E+1,p-1),z=Math.min(k+1,p-1);return uf(u.get(E,k),u.get(N,k),u.get(E,z),u.get(N,z),y-E,b-k)}const $l={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Fd{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(r,u,p,y=!1,b=!1){if(this.uid=r,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(p&&"mapbox"!==p&&"terrarium"!==p)return mn(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const E=this.dim=u.height-2;if(this.data=new Uint32Array(u.data.buffer),this.encoding=p||"mapbox",this.borderReady=y,!y){for(let k=0;k<E;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(E,k)]=this.data[this._idx(E-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,E)]=this.data[this._idx(k,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)],b&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new pm(this)}get(r,u,p=!1){const y=new Uint8Array(this.data.buffer);p&&(r=On(r,-1,this.dim),u=On(u,-1,this.dim));const b=4*this._idx(r,u);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(y[b],y[b+1],y[b+2])}static getUnpackVector(r){return $l[r]}get unpackVector(){return $l[this.encoding]}_idx(r,u){if(r<-1||r>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(r+1)}_unpackMapbox(r,u,p){return(256*r*256+256*u+p)/10-1e4}_unpackTerrarium(r,u,p){return 256*r+u+p/256-32768}static pack(r,u){const p=[0,0,0,0],y=Fd.getUnpackVector(u);let b=Math.floor((r+y[3])/y[2]);return p[2]=b%256,b=Math.floor(b/256),p[1]=b%256,b=Math.floor(b/256),p[0]=b,p}getPixels(){return new Co({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,u,p){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let y=u*this.dim,b=u*this.dim+this.dim,E=p*this.dim,k=p*this.dim+this.dim;switch(u){case-1:y=b-1;break;case 1:b=y+1}switch(p){case-1:E=k-1;break;case 1:k=E+1}const N=-u*this.dim,z=-p*this.dim;for(let j=E;j<k;j++)for(let W=y;W<b;W++)this.data[this._idx(W,j)]=r.data[this._idx(W+N,j+z)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}Bt("DEMData",Fd),Bt("DemMinMaxQuadTree",pm,{omit:["dem"]});class Ib{constructor(r,u){this.max=r,this.onRemove=u,this.reset()}reset(){for(const r in this.data)for(const u of this.data[r])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(r,u,p){const y=r.wrapped().key;void 0===this.data[y]&&(this.data[y]=[]);const b={value:u,timeout:void 0};if(void 0!==p&&(b.timeout=setTimeout(()=>{this.remove(r,b)},p)),this.data[y].push(b),this.order.push(y),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const u=this.data[r].shift();return u.timeout&&clearTimeout(u.timeout),0===this.data[r].length&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),u.value}getByKey(r){const u=this.data[r];return u?u[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,u){if(!this.has(r))return this;const p=r.wrapped().key,y=void 0===u?0:this.data[p].indexOf(u),b=this.data[p][y];return this.data[p].splice(y,1),b.timeout&&clearTimeout(b.timeout),0===this.data[p].length&&delete this.data[p],this.onRemove(b.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(r){const u=[];for(const p in this.data)for(const y of this.data[p])r(y.value)||u.push(y);for(const p of u)this.remove(p.value.tileID,p)}}class $c{constructor(r,u,p){this.func=r,this.mask=u,this.range=p}}$c.ReadOnly=!1,$c.ReadWrite=!0,$c.disabled=new $c(519,$c.ReadOnly,[0,1]);class hf{constructor(r,u,p,y,b,E){this.test=r,this.ref=u,this.mask=p,this.fail=y,this.depthFail=b,this.pass=E}}hf.disabled=new hf({func:519,mask:0},0,0,7680,7680,7680);class nl{constructor(r,u,p){this.blendFunction=r,this.blendColor=u,this.mask=p}}nl.Replace=[1,0],nl.disabled=new nl(nl.Replace,qe.transparent,[!1,!1,!1,!1]),nl.unblended=new nl(nl.Replace,qe.transparent,[!0,!0,!0,!0]),nl.alphaBlended=new nl([1,771],qe.transparent,[!0,!0,!0,!0]);class Rs{constructor(r,u,p){this.enable=r,this.mode=u,this.frontFace=p}}Rs.disabled=new Rs(!1,1029,2305),Rs.backCCW=new Rs(!0,1029,2305),Rs.backCW=new Rs(!0,1029,2304),Rs.frontCW=new Rs(!0,1028,2304),Rs.frontCCW=new Rs(!0,1028,2305);class Gl extends a{constructor(r,u,p){super(),this.id=r,this._onlySymbols=p,u.on("data",y=>{"source"===y.dataType&&"metadata"===y.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===y.dataType&&"content"===y.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new Ib(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new yC}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const u=this._tiles[r];if("loaded"!==u.state&&"errored"!==u.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,u){return r.isSymbolTile=this._onlySymbols,this._source.loadTile(r,u)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r,()=>{})}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const p=this._tiles[u];p.upload(r),p.prepare(this.map.style.imageManager)}}getIds(){return va(this._tiles).map(r=>r.tileID).sort(Mu).map(r=>r.key)}getRenderableIds(r){const u=[];for(const p in this._tiles)this._isIdRenderable(+p,r)&&u.push(this._tiles[p]);return r?u.sort((p,y)=>{const b=p.tileID,E=y.tileID,k=new Je(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),N=new Je(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-E.overscaledZ||N.y-k.y||N.x-k.x}).map(p=>p.tileID.key):u.map(p=>p.tileID).sort(Mu).map(p=>p.key)}hasRenderableParent(r){const u=this.findLoadedParent(r,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(r,u){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(u||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)"errored"!==this._tiles[r].state&&this._reloadTile(+r,"reloading")}}_reloadTile(r,u){const p=this._tiles[r];p&&("loading"!==p.state&&(p.state=u),this._loadTile(p,this._tileLoaded.bind(this,p,r,u)))}_tileLoaded(r,u,p,y){if(y)return r.state="errored",void(404!==y.status?this._source.fire(new o(y,{tile:r})):this.update(this.transform));r.timeAdded=cs.now(),"expired"===p&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(u,r),"raster-dem"===this.getSource().type&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new te("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const u=this.getRenderableIds();for(let y=0;y<u.length;y++){const b=u[y];if(r.neighboringTiles&&r.neighboringTiles[b]){const E=this.getTileByID(b);p(r,E),p(E,r)}}function p(y,b){if(!y.dem||y.dem.borderReady)return;y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0;let E=b.tileID.canonical.x-y.tileID.canonical.x;const k=b.tileID.canonical.y-y.tileID.canonical.y,N=Math.pow(2,y.tileID.canonical.z),z=b.tileID.key;0===E&&0===k||Math.abs(k)>1||(Math.abs(E)>1&&(1===Math.abs(E+N)?E+=N:1===Math.abs(E-N)&&(E-=N)),b.dem&&y.dem&&(y.dem.backfillBorder(b.dem,E,k),y.neighboringTiles&&y.neighboringTiles[z]&&(y.neighboringTiles[z].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,u,p,y){for(const b in this._tiles){let E=this._tiles[b];if(y[b]||!E.hasData()||E.tileID.overscaledZ<=u||E.tileID.overscaledZ>p)continue;let k=E.tileID;for(;E&&E.tileID.overscaledZ>u+1;){const z=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[z.key],E&&E.hasData()&&(k=z)}let N=k;for(;N.overscaledZ>u;)if(N=N.scaledTo(N.overscaledZ-1),r[N.key]){y[k.key]=k;break}}}findLoadedParent(r,u){if(r.key in this._loadedParentTiles){const p=this._loadedParentTiles[r.key];return p&&p.tileID.overscaledZ>=u?p:null}for(let p=r.overscaledZ-1;p>=u;p--){const y=r.scaledTo(p),b=this._getLoadedTile(y);if(b)return b}}_getLoadedTile(r){const u=this._tiles[r.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,u){u=u||this._source.tileSize;const p=Math.ceil(r.width/u)+1,y=Math.ceil(r.height/u)+1,b=Math.floor(p*y*5),E="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(E)}handleWrapJump(r){const u=Math.round((r-(void 0===this._prevLng?r:this._prevLng))/360);if(this._prevLng=r,u){const p={};for(const y in this._tiles){const b=this._tiles[y];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+u),p[b.tileID.key]=b}this._tiles=p;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(+y,this._tiles[y])}}update(r,u,p){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;let y;this.updateCacheSize(r,u),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?y=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new Qs(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(y=r.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(y=y.filter(k=>this._source.hasTile(k)))):y=[];const b=this._updateRetainedTiles(y);if(wh(this._source.type)&&0!==y.length){const k={},N={},z=Object.keys(b);for(const W of z){const Y=b[W],ie=this._tiles[W];if(!ie||ie.fadeEndTime&&ie.fadeEndTime<=cs.now())continue;const ce=this.findLoadedParent(Y,Math.max(Y.overscaledZ-Gl.maxOverzooming,this._source.minzoom));ce&&(this._addTile(ce.tileID),k[ce.tileID.key]=ce.tileID),N[W]=Y}const j=y[y.length-1].overscaledZ;for(const W in this._tiles){const Y=this._tiles[W];if(b[W]||!Y.hasData())continue;let ie=Y.tileID;for(;ie.overscaledZ>j;){ie=ie.scaledTo(ie.overscaledZ-1);const ce=this._tiles[ie.key];if(ce&&ce.hasData()&&N[ie.key]){b[W]=Y.tileID;break}}}for(const W in k)b[W]||(this._coveredTiles[W]=!0,b[W]=k[W])}for(const k in b)this._tiles[k].clearFadeHold();const E=function(k,N){const z=[];for(const j in k)j in N||z.push(j);return z}(this._tiles,b);for(const k of E){const N=this._tiles[k];N.hasSymbolBuckets&&!N.holdingForFade()?N.setHoldDuration(this.map._fadeDuration):N.hasSymbolBuckets&&!N.symbolFadeFinished()||this._removeTile(+k)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const u={};if(0===r.length)return u;const p={},y=r.reduce((z,j)=>Math.min(z,j.overscaledZ),1/0),b=r[0].overscaledZ,E=Math.max(b-Gl.maxOverzooming,this._source.minzoom),k=Math.max(b+Gl.maxUnderzooming,this._source.minzoom),N={};for(const z of r){const j=this._addTile(z);u[z.key]=z,j.hasData()||y<this._source.maxzoom&&(N[z.key]=z)}this._retainLoadedChildren(N,y,k,u);for(const z of r){let j=this._tiles[z.key];if(j.hasData())continue;if(z.canonical.z>=this._source.maxzoom){const Y=z.children(this._source.maxzoom)[0],ie=this.getTile(Y);if(ie&&ie.hasData()){u[Y.key]=Y;continue}}else{const Y=z.children(this._source.maxzoom);if(u[Y[0].key]&&u[Y[1].key]&&u[Y[2].key]&&u[Y[3].key])continue}let W=j.wasRequested();for(let Y=z.overscaledZ-1;Y>=E;--Y){const ie=z.scaledTo(Y);if(p[ie.key]||(p[ie.key]=!0,j=this.getTile(ie),!j&&W&&(j=this._addTile(ie)),j&&(u[ie.key]=ie,W=j.wasRequested(),j.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const u=[];let p,y=this._tiles[r].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){p=this._loadedParentTiles[y.key];break}u.push(y.key);const b=y.scaledTo(y.overscaledZ-1);if(p=this._getLoadedTile(b),p)break;y=b}for(const b of u)this._loadedParentTiles[b]=p}}_addTile(r){let u=this._tiles[r.key];if(u)return u;u=this._cache.getAndRemove(r),u&&(this._setTileReloadTimer(r.key,u),u.tileID=r,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,u)));const p=Boolean(u);if(!p){const y=this.map?this.map.painter:null;u=new kb(r,this._source.tileSize*r.overscaleFactor(),this.transform.tileZoom,y,"raster"===this._source.type||"raster-dem"===this._source.type),this._loadTile(u,this._tileLoaded.bind(this,u,r.key,u.state))}return u?(u.uses++,this._tiles[r.key]=u,p||this._source.fire(new te("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null}_setTileReloadTimer(r,u){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const p=u.getExpiryTimeout();p&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},p))}_removeTile(r){const u=this._tiles[r];u&&(u.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),u.uses>0||(u.hasData()&&"reloading"!==u.state?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset()}tilesIn(r,u,p){const y=[],b=this.transform;if(!b)return y;for(const E in this._tiles){const k=this._tiles[E];if(p&&k.clearQueryDebugViz(),k.holdingForFade())continue;const N=r.containsTile(k,b,u);N&&y.push(N)}return y}getVisibleCoordinates(r){const u=this.getRenderableIds(r).map(p=>this._tiles[p].tileID);for(const p of u)p.projMatrix=this.transform.calculateProjMatrix(p.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(wh(this._source.type))for(const r in this._tiles){const u=this._tiles[r];if(void 0!==u.fadeEndTime&&u.fadeEndTime>=cs.now())return!0}return!1}setFeatureState(r,u,p){this._state.updateState(r=r||"_geojsonTileLayer",u,p)}removeFeatureState(r,u,p){this._state.removeFeatureState(r=r||"_geojsonTileLayer",u,p)}getFeatureState(r,u){return this._state.getState(r=r||"_geojsonTileLayer",u)}setDependencies(r,u,p){const y=this._tiles[r];y&&y.setDependencies(u,p)}reloadTilesForDependencies(r,u){for(const p in this._tiles)this._tiles[p].hasDependency(r,u)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(r,u))}}function Mu(c,r){const u=Math.abs(2*c.wrap)-+(c.wrap<0),p=Math.abs(2*r.wrap)-+(r.wrap<0);return c.overscaledZ-r.overscaledZ||p-u||r.canonical.y-c.canonical.y||r.canonical.x-c.canonical.x}function wh(c){return"raster"===c||"image"===c||"video"===c}Gl.maxOverzooming=10,Gl.maxUnderzooming=3;class Wl{constructor(r,u,p){this._demTile=r,this._dem=this._demTile.dem,this._scale=u,this._offset=p}static create(r,u,p){const y=p||r.findDEMTileFor(u);if(!y||!y.dem)return;const b=y.dem,E=y.tileID,k=1<<u.canonical.z-E.canonical.z;return new Wl(y,y.tileSize/cn/k,[(u.canonical.x/k-E.canonical.x)*b.dim,(u.canonical.y/k-E.canonical.y)*b.dim])}tileCoordToPixel(r,u){const p=u*this._scale+this._offset[1],y=Math.floor(r*this._scale+this._offset[0]),b=Math.floor(p);return new Je(y,b)}getElevationAt(r,u,p,y){const b=r*this._scale+this._offset[0],E=u*this._scale+this._offset[1],k=Math.floor(b),N=Math.floor(E),z=this._dem;return y=!!y,p?ln(ln(z.get(k,N,y),z.get(k,N+1,y),E-N),ln(z.get(k+1,N,y),z.get(k+1,N+1,y),E-N),b-k):z.get(k,N,y)}getElevationAtPixel(r,u,p){return this._dem.get(r,u,!!p)}getMeterToDEM(r){return(1<<this._demTile.tileID.canonical.z)*Ly(1,r)*this._dem.stride}}class R_{constructor(r,u){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Pi(cn,16,0),this.featureIndexArray=new Iy,this.promoteId=u}insert(r,u,p,y,b,E=0){const k=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,y,b,E);const N=this.grid;for(let z=0;z<u.length;z++){const j=u[z],W=[1/0,1/0,-1/0,-1/0];for(let Y=0;Y<j.length;Y++){const ie=j[Y];W[0]=Math.min(W[0],ie.x),W[1]=Math.min(W[1],ie.y),W[2]=Math.max(W[2],ie.x),W[3]=Math.max(W[3],ie.y)}W[0]<cn&&W[1]<cn&&W[2]>=0&&W[3]>=0&&N.insert(k,W[0],W[1],W[2],W[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new vu.VectorTile(new yh(this.rawTileData)).layers,this.sourceLayerCoder=new cm(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const r in this.vtLayers)this.vtFeatures[r]=[]}return this.vtLayers}query(r,u,p,y){this.loadVTLayers();const b=r.params||{},E=Wu(b.filter),k=r.tileResult,N=r.transform,z=k.bufferedTilespaceBounds,j=this.grid.query(z.min.x,z.min.y,z.max.x,z.max.y,(ce,pe,Ce,Te)=>yu(k.bufferedTilespaceGeometry,ce,pe,Ce,Te));j.sort(N_);let W=null;N.elevation&&j.length>0&&(W=Wl.create(N.elevation,this.tileID));const Y={};let ie;for(let ce=0;ce<j.length;ce++){const pe=j[ce];if(pe===ie)continue;ie=pe;const Ce=this.featureIndexArray.get(pe);let Te=null;this.loadMatchingFeature(Y,Ce,E,b.layers,b.availableImages,u,p,y,(Pe,Be,je,He=0)=>(Te||(Te=Nl(Pe,this.tileID.canonical,r.tileTransform)),Be.queryIntersectsFeature(k,Pe,je,Te,this.z,r.transform,r.pixelPosMatrix,W,He)))}return Y}loadMatchingFeature(r,u,p,y,b,E,k,N,z){const{featureIndex:j,bucketIndex:W,sourceLayerIndex:Y,layoutVertexArrayOffset:ie}=u,ce=this.bucketLayerIDs[W];if(y&&!function(Pe,Be){for(let je=0;je<Pe.length;je++)if(Be.indexOf(Pe[je])>=0)return!0;return!1}(y,ce))return;const pe=this.sourceLayerCoder.decode(Y),Ce=this.vtLayers[pe].feature(j);if(p.needGeometry){const Pe=Pa(Ce,!0);if(!p.filter(new ne(this.tileID.overscaledZ),Pe,this.tileID.canonical))return}else if(!p.filter(new ne(this.tileID.overscaledZ),Ce))return;const Te=this.getId(Ce,pe);for(let Pe=0;Pe<ce.length;Pe++){const Be=ce[Pe];if(y&&y.indexOf(Be)<0)continue;const je=E[Be];if(!je)continue;let He={};void 0!==Te&&N&&(He=N.getState(je.sourceLayer||"_geojsonTileLayer",Te));const Ge=Mi({},k[Be]);Ge.paint=mm(Ge.paint,je.paint,Ce,He,b),Ge.layout=mm(Ge.layout,je.layout,Ce,He,b);const ot=!z||z(Ce,je,He,ie);if(!ot)continue;const nt=new um(Ce,this.z,this.x,this.y,Te);nt.layer=Ge;let Mt=r[Be];void 0===Mt&&(Mt=r[Be]=[]),Mt.push({featureIndex:j,feature:nt,intersectionZ:ot})}}lookupSymbolFeatures(r,u,p,y,b,E,k,N){const z={};this.loadVTLayers();const j=Wu(b);for(const W of r)this.loadMatchingFeature(z,{bucketIndex:p,sourceLayerIndex:y,featureIndex:W,layoutVertexArrayOffset:0},j,E,k,N,u);return z}loadFeature(r){const{featureIndex:u,sourceLayerIndex:p}=r;this.loadVTLayers();const y=this.sourceLayerCoder.decode(p),b=this.vtFeatures[y];if(b[u])return b[u];const E=this.vtLayers[y].feature(u);return b[u]=E,E}hasLayer(r){for(const u of this.bucketLayerIDs)for(const p of u)if(r===p)return!0;return!1}getId(r,u){let p=r.id;return this.promoteId&&(p=r.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[u]],"boolean"==typeof p&&(p=Number(p))),p}}function mm(c,r,u,p,y){return No(c,(b,E)=>{const k=r instanceof Me?r.get(E):null;return k&&k.evaluate?k.evaluate(u,p,y):k})}function N_(c,r){return r-c}Bt("FeatureIndex",R_,{omit:["rawTileData","sourceLayerCoder"]});class df{constructor(r){const u={},p=[];for(const k in r){const N=r[k],z=u[k]={};for(const j in N.glyphs){const W=N.glyphs[+j];if(!W||0===W.bitmap.width||0===W.bitmap.height)continue;const Y=W.metrics.localGlyph?2:1,ie={x:0,y:0,w:W.bitmap.width+2*Y,h:W.bitmap.height+2*Y};p.push(ie),z[j]=ie}}const{w:y,h:b}=Uc(p),E=new Fl({width:y||1,height:b||1});for(const k in r){const N=r[k];for(const z in N.glyphs){const j=N.glyphs[+z];if(!j||0===j.bitmap.width||0===j.bitmap.height)continue;const W=u[k][z],Y=j.metrics.localGlyph?2:1;Fl.copy(j.bitmap,E,{x:0,y:0},{x:W.x+Y,y:W.y+Y},j.bitmap)}}this.image=E,this.positions=u}}Bt("GlyphAtlas",df);class ym{constructor(r){this.tileID=new Qs(r.tileID.overscaledZ,r.tileID.wrap,r.tileID.canonical.z,r.tileID.canonical.x,r.tileID.canonical.y),this.tileZoom=r.tileZoom,this.uid=r.uid,this.zoom=r.zoom,this.canonical=r.tileID.canonical,this.pixelRatio=r.pixelRatio,this.tileSize=r.tileSize,this.source=r.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=r.showCollisionBoxes,this.collectResourceTiming=!!r.collectResourceTiming,this.returnDependencies=!!r.returnDependencies,this.promoteId=r.promoteId,this.enableTerrain=!!r.enableTerrain,this.isSymbolTile=r.isSymbolTile,r.projection&&(this.tileTransform=sf(r.tileID.canonical,r.projection))}parse(r,u,p,y,b){this.status="parsing",this.data=r,this.collisionBoxArray=new Zr;const E=new cm(Object.keys(r.layers).sort()),k=new R_(this.tileID,this.promoteId);k.bucketLayerIDs=[];const N={},z=new Nd(256,256),j={featureIndex:k,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:z,availableImages:p},W=u.familiesBySource[this.source];for(const He in W){const Ge=r.layers[He];if(!Ge)continue;let ot=!1,nt=!1;for(const lt of W[He])"symbol"===lt[0].type?ot=!0:nt=!0;if(!0===this.isSymbolTile&&!ot||!1===this.isSymbolTile&&!nt)continue;1===Ge.version&&mn(`Vector tile source "${this.source}" layer "${He}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Mt=E.encode(He),ft=[];for(let lt=0;lt<Ge.length;lt++){const gt=Ge.feature(lt),Ct=k.getId(gt,He);ft.push({feature:gt,id:Ct,index:lt,sourceLayerIndex:Mt})}for(const lt of W[He]){const gt=lt[0];void 0!==this.isSymbolTile&&"symbol"===gt.type!==this.isSymbolTile||gt.minzoom&&this.zoom<Math.floor(gt.minzoom)||gt.maxzoom&&this.zoom>=gt.maxzoom||"none"!==gt.visibility&&(pf(lt,this.zoom,p),(N[gt.id]=gt.createBucket({index:k.bucketLayerIDs.length,layers:lt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Mt,sourceID:this.source,enableTerrain:this.enableTerrain,availableImages:p})).populate(ft,j,this.tileID.canonical,this.tileTransform),k.bucketLayerIDs.push(lt.map(Ct=>Ct.id)))}}let Y,ie,ce,pe;z.trim();const Ce={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Te=No(j.glyphDependencies,He=>Object.keys(He).map(Number));Object.keys(Te).length?y.send("getGlyphs",{uid:this.uid,stacks:Te},(He,Ge)=>{Y||(Y=He,ie=Ge,je.call(this))},void 0,!1,Ce):ie={};const Pe=Object.keys(j.iconDependencies);Pe.length?y.send("getImages",{icons:Pe,source:this.source,tileID:this.tileID,type:"icons"},(He,Ge)=>{Y||(Y=He,ce=Ge,je.call(this))},void 0,!1,Ce):ce={};const Be=Object.keys(j.patternDependencies);function je(){if(Y)return b(Y);if(ie&&ce&&pe){const He=new df(ie),Ge=new jg(ce,pe);for(const ot in N){const nt=N[ot];nt instanceof Bl?(pf(nt.layers,this.zoom,p),D_(nt,ie,He.positions,ce,Ge.iconPositions,this.showCollisionBoxes,p,this.tileID.canonical,this.tileZoom)):nt.hasPattern&&(nt instanceof Cd||nt instanceof jp||nt instanceof gs)&&(pf(nt.layers,this.zoom,p),nt.addFeatures(j,this.tileID.canonical,Ge.patternPositions,p))}this.status="done",b(null,{buckets:va(N).filter(ot=>!ot.isEmpty()),featureIndex:k,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:He.image,lineAtlas:z,imageAtlas:Ge,glyphMap:this.returnDependencies?ie:null,iconMap:this.returnDependencies?ce:null,glyphPositions:this.returnDependencies?He.positions:null})}}Be.length?y.send("getImages",{icons:Be,source:this.source,tileID:this.tileID,type:"patterns"},(He,Ge)=>{Y||(Y=He,pe=Ge,je.call(this))},void 0,!1,Ce):pe={},je.call(this)}}function pf(c,r,u){const p=new ne(r);for(const y of c)y.recalculate(p,u)}class Od{constructor(r){this.entries={},this.scheduler=r}request(r,u,p,y){const b=this.entries[r]=this.entries[r]||{callbacks:[]};if(b.result){const[E,k]=b.result;return this.scheduler?this.scheduler.add(()=>{y(E,k)},u):y(E,k),()=>{}}return b.callbacks.push(y),b.cancel||(b.cancel=p((E,k)=>{b.result=[E,k];for(const N of b.callbacks)this.scheduler?this.scheduler.add(()=>{N(E,k)},u):N(E,k);setTimeout(()=>delete this.entries[r],3e3)})),()=>{b.result||(b.callbacks=b.callbacks.filter(E=>E!==y),b.callbacks.length||(b.cancel(),delete this.entries[r]))}}}function F_(c,r,u){const p=JSON.stringify(c.request);return c.data&&(this.deduped.entries[p]={result:[null,c.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},y=>{const b=ue(c.request,(E,k,N,z)=>{E?y(E):k&&y(null,{vectorTile:u?void 0:new vu.VectorTile(new yh(k)),rawData:k,cacheControl:N,expires:z})});return()=>{b.cancel(),y()}},r)}var O_={name:"albers",range:[4,7],center:[-96,37.5],parallels:[29.5,45.5],conic:!0,initializeConstants(){if(this.constants&&jy(this.parallels,this.constants.parallels))return;const c=Math.sin(wn(this.parallels[0])),r=(c+Math.sin(wn(this.parallels[1])))/2,u=1+c*(2*r-c),p=Math.sqrt(u)/r;this.constants={n:r,c:u,r0:p,parallels:this.parallels}},project(c,r){this.initializeConstants();const u=wn(c-this.center[0]),p=wn(r),{n:y,c:b,r0:E}=this.constants,k=Math.sqrt(b-2*y*Math.sin(p))/y;return{x:k*Math.sin(u*y),y:k*Math.cos(u*y)-E}},unproject(c,r){this.initializeConstants();const{n:u,c:p,r0:y}=this.constants,b=y+r;let E=Math.atan2(c,Math.abs(b))*Math.sign(b);b*u<0&&(E-=Math.PI*Math.sign(c)*Math.sign(b));const k=wn(this.center[0])*u;E=Ro(E,-Math.PI-k,Math.PI-k);const N=Cr(E/u)+this.center[0],z=Math.asin(On((p-(c*c+b*b)*u*u)/(2*u),-1,1)),j=On(Cr(z),-85.051129,Zo);return new Rn(N,j)}};const ff=1.340264,Ch=-.081106,Sh=893e-6,Ld=.003796,zd=Math.sqrt(3)/2;var Pb={name:"equalEarth",center:[0,0],range:[3.5,7],project(c,r){r=r/180*Math.PI,c=c/180*Math.PI;const u=Math.asin(zd*Math.sin(r)),p=u*u,y=p*p*p;return{x:.5*(c*Math.cos(u)/(zd*(ff+3*Ch*p+y*(7*Sh+9*Ld*p)))/Math.PI+.5),y:1-.5*(u*(ff+Ch*p+y*(Sh+Ld*p))/Math.PI+1)}},unproject(c,r){c=(2*c-.5)*Math.PI;let u=r=(2*(1-r)-1)*Math.PI,p=u*u,y=p*p*p;for(let z,j,W,Y=0;Y<12&&(j=u*(ff+Ch*p+y*(Sh+Ld*p))-r,W=ff+3*Ch*p+y*(7*Sh+9*Ld*p),z=j/W,u=On(u-z,-Math.PI/3,Math.PI/3),p=u*u,y=p*p*p,!(Math.abs(z)<1e-12));++Y);const b=zd*c*(ff+3*Ch*p+y*(7*Sh+9*Ld*p))/Math.cos(u),E=Math.asin(Math.sin(u)/zd),k=On(180*b/Math.PI,-180,180),N=On(180*E/Math.PI,-85.051129,Zo);return new Rn(k,N)}},Rb={name:"equirectangular",wrap:!0,center:[0,0],range:[3.5,7],project:(c,r)=>({x:.5+c/360,y:.5-r/360}),unproject(c,r){const u=360*(c-.5),p=On(360*(.5-r),-85.051129,Zo);return new Rn(u,p)}};const es=Math.PI/2;function gf(c){return Math.tan((es+c)/2)}var Nb={name:"lambertConformalConic",range:[3.5,7],center:[0,30],parallels:[30,30],conic:!0,initializeConstants(){if(this.constants&&jy(this.parallels,this.constants.parallels))return;const c=wn(this.parallels[0]),r=wn(this.parallels[1]),u=Math.cos(c),p=c===r?Math.sin(c):Math.log(u/Math.cos(r))/Math.log(gf(r)/gf(c)),y=u*Math.pow(gf(c),p)/p;this.constants={n:p,f:y,parallels:this.parallels}},project(c,r){this.initializeConstants(),r=wn(r),c=wn(c-this.center[0]);const u=1e-6,{n:p,f:y}=this.constants;y>0?r<-es+u&&(r=-es+u):r>es-u&&(r=es-u);const b=y/Math.pow(gf(r),p),E=b*Math.sin(p*c),k=y-b*Math.cos(p*c);return{x:.5*(E/Math.PI+.5),y:1-.5*(k/Math.PI+.5)}},unproject(c,r){this.initializeConstants(),c=(2*c-.5)*Math.PI,r=(2*(1-r)-.5)*Math.PI;const{n:u,f:p}=this.constants,y=p-r,b=Math.sign(y),E=Math.sign(u)*Math.sqrt(c*c+y*y);let k=Math.atan2(c,Math.abs(y))*b;y*u<0&&(k-=Math.PI*Math.sign(c)*b);const N=On(Cr(k/u)+this.center[0],-180,180),z=On(Cr(2*Math.atan(Math.pow(p/E,1/u))-es),-85.051129,Zo);return new Rn(N,z)}},_C={name:"mercator",wrap:!0,center:[0,0],project:(c,r)=>({x:_g(c),y:Oy(r)}),unproject(c,r){const u=Lc(c),p=cr(r);return new Rn(u,p)}};const Fb=wn(Zo);var L_={name:"naturalEarth",center:[0,0],range:[3.5,7],project(c,r){const u=(r=wn(r))*r,p=u*u;return{x:.5*((c=wn(c))*(.8707-.131979*u+p*(p*(.003971*u-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+u*(.015085+p*(.028874*u-.044475-.005916*p)))/Math.PI+1)}},unproject(c,r){c=(2*c-.5)*Math.PI;let u=r=(2*(1-r)-1)*Math.PI,p=25,y=0,b=u*u;do{b=u*u;const N=b*b;y=(u*(1.007226+b*(.015085+N*(.028874*b-.044475-.005916*N)))-r)/(1.007226+b*(.045255+N*(.259866*b-.311325-.005916*11*N))),u=On(u-y,-Fb,Fb)}while(Math.abs(y)>1e-6&&--p>0);b=u*u;const E=On(Cr(c/(.8707+b*(b*(b*b*b*(.003971-.001529*b)-.013791)-.131979))),-180,180),k=Cr(u);return new Rn(E,k)}};const Ob=wn(Zo),z_={albers:O_,equalEarth:Pb,equirectangular:Rb,lambertConformalConic:Nb,mercator:_C,naturalEarth:L_,winkelTripel:{name:"winkelTripel",center:[0,0],range:[3.5,7],project(c,r){r=wn(r),c=wn(c);const u=Math.cos(r),p=2/Math.PI,y=Math.acos(u*Math.cos(c/2)),b=Math.sin(y)/y,E=.5*(c*p+2*u*Math.sin(c/2)/b)||0,k=.5*(r+Math.sin(r)/b)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(k/Math.PI+1)}},unproject(c,r){let u=c=(2*c-.5)*Math.PI,p=r=(2*(1-r)-1)*Math.PI,y=25;const b=1e-6;let E=0,k=0;do{const N=Math.cos(p),z=Math.sin(p),j=2*z*N,W=z*z,Y=N*N,ie=Math.cos(u/2),ce=Math.sin(u/2),pe=2*ie*ce,Ce=ce*ce,Te=1-Y*ie*ie,Pe=Te?1/Te:0,Be=Te?Math.acos(N*ie)*Math.sqrt(1/Te):0,je=.5*(2*Be*N*ce+2*u/Math.PI)-c,He=.5*(Be*z+p)-r,Ge=.5*Pe*(Y*Ce+Be*N*ie*W)+1/Math.PI,ot=Pe*(pe*j/4-Be*z*ce),nt=.125*Pe*(j*ce-Be*z*Y*pe),Mt=.5*Pe*(W*ie+Be*Ce*N)+.5,ft=ot*nt-Mt*Ge;E=(He*ot-je*Mt)/ft,k=(je*nt-He*Ge)/ft,u=On(u-E,-Math.PI,Math.PI),p=On(p-k,-Ob,Ob)}while((Math.abs(E)>b||Math.abs(k)>b)&&--y>0);return new Rn(Cr(u),Cr(p))}}};v.ARRAY_TYPE=fs,v.AUTH_ERR_MSG=Es,v.Actor=class{constructor(c,r,u){this.target=c,this.parent=r,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Cn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=vn()?c:$t,this.scheduler=new Db}send(c,r,u,p,y=!1,b){const E=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=b,this.callbacks[E]=u);const k=Va(this.globalScope)?void 0:[];return this.target.postMessage({id:E,type:c,hasCallback:!!u,targetMapId:p,mustQueue:y,sourceMapId:this.mapId,data:Br(r,k)},k),{cancel:()=>{u&&delete this.callbacks[E],this.target.postMessage({id:E,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(c){const r=c.data,u=r.id;if(u&&(!r.targetMapId||this.mapId===r.targetMapId))if("<cancel>"===r.type){const p=this.cancelCallbacks[u];delete this.cancelCallbacks[u],p&&p.cancel()}else if(r.mustQueue||vn()){const p=this.callbacks[u];this.cancelCallbacks[u]=this.scheduler.add(()=>this.processTask(u,r),p&&p.metadata||{type:"message"})}else this.processTask(u,r)}processTask(c,r){if("<response>"===r.type){const u=this.callbacks[c];delete this.callbacks[c],u&&(r.error?u(Ec(r.error)):u(null,Ec(r.data)))}else{const u=Va(this.globalScope)?void 0:[],p=r.hasCallback?(b,E)=>{delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:b?Br(b):null,data:Br(E,u)},u)}:b=>{},y=Ec(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,y,p);else if(this.parent.getWorkerSource){const b=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,b[0],y.source)[b[1]](y,p)}else p(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},v.CanonicalTileID=of,v.Color=qe,v.ColorMode=nl,v.CullFaceMode=Rs,v.DEMData=Fd,v.DataConstantProperty=be,v.DedupedRequest=Od,v.DepthMode=$c,v.EXTENT=cn,v.Elevation=class{getAtPointOrZero(c,r=0){return this.getAtPoint(c,r)||0}getAtPoint(c,r,u=!0){null==r&&(r=null);const p=this._source();if(!p||c.y<0||c.y>1)return r;const y=p.getSource().maxzoom,b=1<<y,E=Math.floor(c.x),k=c.x-E,N=new Qs(y,E,y,Math.floor(k*b),Math.floor(c.y*b)),z=this.findDEMTileFor(N);if(!z||!z.dem)return r;const j=z.dem,W=1<<z.tileID.canonical.z,Y=(k*W-z.tileID.canonical.x)*j.dim,ie=(c.y*W-z.tileID.canonical.y)*j.dim,ce=Math.floor(Y),pe=Math.floor(ie);return(u?this.exaggeration():1)*ln(ln(j.get(ce,pe),j.get(ce,pe+1),ie-pe),ln(j.get(ce+1,pe),j.get(ce+1,pe+1),ie-pe),Y-ce)}getAtTileOffset(c,r,u){const p=1<<c.canonical.z;return this.getAtPointOrZero(new vg(c.wrap+(c.canonical.x+r/cn)/p,(c.canonical.y+u/cn)/p))}getForTilePoints(c,r,u,p){const y=Wl.create(this,c,p);return!!y&&(r.forEach(b=>{b[2]=this.exaggeration()*y.getElevationAt(b[0],b[1],u)}),!0)}getMinMaxForTile(c){const r=this.findDEMTileFor(c);if(!r||!r.dem)return null;const u=r.dem.tree,p=r.tileID,y=1<<c.canonical.z-p.canonical.z;let b=c.canonical.x/y-p.canonical.x,E=c.canonical.y/y-p.canonical.y,k=0;for(let N=0;N<c.canonical.z-p.canonical.z&&!u.leaves[k];N++){b*=2,E*=2;const z=2*Math.floor(E)+Math.floor(b);k=u.childOffsets[k]+z,b%=1,E%=1}return{min:this.exaggeration()*u.minimums[k],max:this.exaggeration()*u.maximums[k]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,r,u){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},v.ErrorEvent=o,v.EvaluationParameters=ne,v.Event=te,v.Evented=a,v.GlyphManager=Cu,v.ImagePosition=Ad,v.LineAtlas=Nd,v.LngLat=Rn,v.LngLatBounds=Ka,v.LocalGlyphMode=vh,v.MAX_MERCATOR_LATITUDE=Zo,v.MAX_SAFE_INTEGER=Ss,v.MercatorCoordinate=vg,v.ONE_EM=24,v.OverscaledTileID=Qs,v.Properties=rt,v.RGBAImage=Co,v.RequestManager=class{constructor(c,r,u){this._transformRequestFn=c,this._customAccessToken=r,this._silenceAuthErrors=!!u,this._createSkuToken()}_createSkuToken(){const c=function(){let r="";for(let u=0;u<10;u++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",pl,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(c,r){return this._transformRequestFn&&this._transformRequestFn(c,r)||{url:c}}normalizeStyleURL(c,r){if(!As(c))return c;const u=$s(c);return u.path=`/styles/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||r)}normalizeGlyphsURL(c,r){if(!As(c))return c;const u=$s(c);return u.path=`/fonts/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||r)}normalizeSourceURL(c,r){if(!As(c))return c;const u=$s(c);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||r)}normalizeSpriteURL(c,r,u,p){const y=$s(c);return As(c)?(y.path=`/styles/v1${y.path}/sprite${r}${u}`,this._makeAPIURL(y,this._customAccessToken||p)):(y.path+=`${r}${u}`,rr(y))}normalizeTileURL(c,r,u){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!As(c))return c;const p=$s(c);p.path=p.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||u&&"raster"!==p.authority&&512===u?"@2x":""}${fo.supported?".webp":"$1"}`),"raster"===p.authority?p.path=`/${xn.RASTER_URL_PREFIX}${p.path}`:(p.path=p.path.replace(/^.+\/v4\//,"/"),p.path=`/${xn.TILE_URL_VERSION}${p.path}`);const y=this._customAccessToken||function(b){for(const E of b){const k=E.match(/^access_token=(.*)$/);if(k)return k[1]}return null}(p.params)||xn.ACCESS_TOKEN;return xn.REQUIRE_ACCESS_TOKEN&&y&&this._skuToken&&p.params.push(`sku=${this._skuToken}`),this._makeAPIURL(p,y)}canonicalizeTileURL(c,r){const u=$s(c);if(!u.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!u.path.match(/\.[\w]+$/))return c;let p="mapbox://";u.path.match(/^\/raster\/v1\//)?p+=`raster/${u.path.replace(`/${xn.RASTER_URL_PREFIX}/`,"")}`:p+=`tiles/${u.path.replace(`/${xn.TILE_URL_VERSION}/`,"")}`;let y=u.params;return r&&(y=y.filter(b=>!b.match(/^access_token=/))),y.length&&(p+=`?${y.join("&")}`),p}canonicalizeTileset(c,r){const u=!!r&&As(r),p=[];for(const y of c.tiles||[])ba(y)?p.push(this.canonicalizeTileURL(y,u)):p.push(y);return p}_makeAPIURL(c,r){const u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",p=$s(xn.API_URL);if(c.protocol=p.protocol,c.authority=p.authority,"http"===c.protocol){const y=c.params.indexOf("secure");y>=0&&c.params.splice(y,1)}if("/"!==p.path&&(c.path=`${p.path}${c.path}`),!xn.REQUIRE_ACCESS_TOKEN)return rr(c);if(r=r||xn.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${u}`);if("s"===r[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${u}`)}return c.params=c.params.filter(y=>-1===y.indexOf("access_token")),c.params.push(`access_token=${r||""}`),rr(c)}},v.ResourceType=Sa,v.SegmentVector=yi,v.SourceCache=Gl,v.StencilMode=hf,v.StructArrayLayout1ui2=Hr,v.StructArrayLayout2f1f2i16=Ur,v.StructArrayLayout2i4=Lt,v.StructArrayLayout2ui4=wi,v.StructArrayLayout3f12=tn,v.StructArrayLayout3ui6=lr,v.StructArrayLayout4i8=Yt,v.Texture=bh,v.Tile=kb,v.Transitionable=me,v.Uniform1f=Rc,v.Uniform1i=class extends wo{constructor(c,r){super(c,r),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},v.Uniform2f=class extends wo{constructor(c,r){super(c,r),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},v.Uniform3f=class extends wo{constructor(c,r){super(c,r),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},v.Uniform4f=Mp,v.UniformColor=Nc,v.UniformMatrix2f=class extends wo{constructor(c,r){super(c,r),this.current=Ax}set(c){for(let r=0;r<4;r++)if(c[r]!==this.current[r]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}},v.UniformMatrix3f=class extends wo{constructor(c,r){super(c,r),this.current=rC}set(c){for(let r=0;r<9;r++)if(c[r]!==this.current[r]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}},v.UniformMatrix4f=class extends wo{constructor(c,r){super(c,r),this.current=iC}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let r=1;r<16;r++)if(c[r]!==this.current[r]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},v.UnwrappedTileID=Eb,v.ValidationError=g,v.VectorTileWorkerSource=class extends a{constructor(c,r,u,p,y){super(),this.actor=c,this.layerIndex=r,this.availableImages=u,this.loadVectorData=y||F_,this.loading={},this.loaded={},this.deduped=new Od(c.scheduler),this.isSpriteLoaded=p,this.scheduler=c.scheduler}loadTile(c,r){const u=c.uid,p=c&&c.request,y=p&&p.collectResourceTiming,b=this.loading[u]=new ym(c);b.abort=this.loadVectorData(c,(E,k)=>{const N=!this.loading[u];if(delete this.loading[u],N||E||!k)return b.status="done",N||(this.loaded[u]=b),r(E);const z=k.rawData,j={};k.expires&&(j.expires=k.expires),k.cacheControl&&(j.cacheControl=k.cacheControl),b.vectorTile=k.vectorTile||new vu.VectorTile(new yh(z));const W=()=>{b.parse(b.vectorTile,this.layerIndex,this.availableImages,this.actor,(Y,ie)=>{if(Y||!ie)return r(Y);const ce={};if(y){const pe=M_(p);pe.length>0&&(ce.resourceTiming=JSON.parse(JSON.stringify(pe)))}r(null,Mi({rawTileData:z.slice(0)},ie,j,ce))})};this.isSpriteLoaded?W():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(W,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom}):W()}),this.loaded=this.loaded||{},this.loaded[u]=b})}reloadTile(c,r){const u=this.loaded,p=c.uid,y=this;if(u&&u[p]){const b=u[p];b.showCollisionBoxes=c.showCollisionBoxes,b.enableTerrain=!!c.enableTerrain;const E=(k,N)=>{const z=b.reloadCallback;z&&(delete b.reloadCallback,b.parse(b.vectorTile,y.layerIndex,this.availableImages,y.actor,z)),r(k,N)};"parsing"===b.status?b.reloadCallback=E:"done"===b.status&&(b.vectorTile?b.parse(b.vectorTile,this.layerIndex,this.availableImages,this.actor,E):E())}}abortTile(c,r){const u=c.uid,p=this.loading[u];p&&(p.abort&&p.abort(),delete this.loading[u]),r()}removeTile(c,r){const u=this.loaded,p=c.uid;u&&u[p]&&delete u[p],r()}},v.WritingMode=Ko,v.ZoomHistory=qu,v.add=function(c,r,u){return c[0]=r[0]+u[0],c[1]=r[1]+u[1],c[2]=r[2]+u[2],c},v.addDynamicAttributes=im,v.altitudeFromMercatorZ=ud,v.asyncAll=fi,v.bezier=pi,v.bindAll=Cn,v.boundsAttributes=I_,v.bufferConvexPolygon=function(c,r){const u=[];for(let p=0;p<c.length;p++){const y=Ro(p-1,-1,c.length-1),b=Ro(p+1,-1,c.length-1),E=c[p],k=c[b],N=c[y].sub(E).unit(),z=k.sub(E).unit(),j=z.angleWithSep(N.x,N.y),W=N.add(z).unit().mult(-1*r/Math.sin(j/2));u.push(E.add(W))}return u},v.cacheEntryPossiblyAdded=function(c){ja++,ja>Bo&&(c.getActor().send("enforceCacheSizeLimit",wa),ja=0)},v.clamp=On,v.clearTileCache=function(c){const r=$t.caches.delete(ml);c&&r.catch(c).then(()=>c())},v.clipLine=Jg,v.clone=function(c){var r=new fs(3);return r[0]=c[0],r[1]=c[1],r[2]=c[2],r},v.clone$1=function(c){var r=new fs(16);return r[0]=c[0],r[1]=c[1],r[2]=c[2],r[3]=c[3],r[4]=c[4],r[5]=c[5],r[6]=c[6],r[7]=c[7],r[8]=c[8],r[9]=c[9],r[10]=c[10],r[11]=c[11],r[12]=c[12],r[13]=c[13],r[14]=c[14],r[15]=c[15],r},v.clone$2=ir,v.collisionCircleLayout=Wp,v.config=xn,v.conjugate=function(c,r){return c[0]=-r[0],c[1]=-r[1],c[2]=-r[2],c[3]=r[3],c},v.copy=function(c,r){return c[0]=r[0],c[1]=r[1],c[2]=r[2],c},v.create=Ra,v.create$1=function(){var c=new fs(16);return fs!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},v.create$2=Cg,v.createExpression=ds,v.createLayout=Ye,v.createStyleLayer=function(c){return"custom"===c.type?new Vl(c):new om[c.type](c)},v.cross=function(c,r,u){var p=r[0],y=r[1],b=r[2],E=u[0],k=u[1],N=u[2];return c[0]=y*N-b*k,c[1]=b*E-p*N,c[2]=p*k-y*E,c},v.degToRad=wn,v.div=function(c,r,u){return c[0]=r[0]/u[0],c[1]=r[1]/u[1],c[2]=r[2]/u[2],c},v.dot=function(c,r){return c[0]*r[0]+c[1]*r[1]+c[2]*r[2]},v.dot$1=function(c,r){return c[0]*r[0]+c[1]*r[1]+c[2]*r[2]+c[3]*r[3]},v.ease=yt,v.easeCubicInOut=mr,v.emitValidationErrors=Dp,v.endsWith=ls,v.enforceCacheSizeLimit=function(c){Ei(),us&&us.then(r=>{r.keys().then(u=>{for(let p=0;p<u.length-c;p++)r.delete(u[p])})})},v.evaluateSizeForFeature=Xp,v.evaluateSizeForZoom=mh,v.evaluateVariableOffset=S_,v.evented=U,v.exactEquals=function(c,r){return c[0]===r[0]&&c[1]===r[1]&&c[2]===r[2]&&c[3]===r[3]},v.exactEquals$1=function(c,r){return c[0]===r[0]&&c[1]===r[1]&&c[2]===r[2]},v.exported=cs,v.exported$1=fo,v.extend=Mi,v.filterObject=Bi,v.fromMat4=function(c,r){return c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[4],c[4]=r[5],c[5]=r[6],c[6]=r[8],c[7]=r[9],c[8]=r[10],c},v.fromQuat=function(c,r){var u=r[0],p=r[1],y=r[2],b=r[3],E=u+u,k=p+p,N=y+y,z=u*E,j=p*E,W=p*k,Y=y*E,ie=y*k,ce=y*N,pe=b*E,Ce=b*k,Te=b*N;return c[0]=1-W-ce,c[1]=j+Te,c[2]=Y-Ce,c[3]=0,c[4]=j-Te,c[5]=1-z-ce,c[6]=ie+pe,c[7]=0,c[8]=Y+Ce,c[9]=ie-pe,c[10]=1-z-W,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},v.fromRotation=function(c,r){var u=Math.sin(r),p=Math.cos(r);return c[0]=p,c[1]=u,c[2]=0,c[3]=-u,c[4]=p,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},v.fromScaling=function(c,r){return c[0]=r[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=r[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=r[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},v.furthestTileCorner=function(c){const r=Math.round((c+45+360)%360/90)%4;return Xe[r]},v.getAABBPointSquareDist=function(c,r,u){let p=0;for(let y=0;y<2;++y){const b=u?u[y]:0;c[y]>b&&(p+=(c[y]-b)*(c[y]-b)),r[y]<b&&(p+=(b-r[y])*(b-r[y]))}return p},v.getAnchorAlignment=Wg,v.getAnchorJustification=em,v.getBounds=function(c){let r=1/0,u=1/0,p=-1/0,y=-1/0;for(const b of c)r=Math.min(r,b.x),u=Math.min(u,b.y),p=Math.max(p,b.x),y=Math.max(y,b.y);return{min:new Je(r,u),max:new Je(p,y)}},v.getImage=We,v.getJSON=function(c,r){return se(Mi(c,{type:"json"}),r)},v.getMapSessionAPI=gl,v.getPerformanceMeasurement=M_,v.getProjection=function(c){const r=z_[c.name];if(!r)throw new Error(`Invalid projection name: ${c.name}`);return r.conic?function(u,p){if(p.parallels&&Math.abs(p.parallels[0]+p.parallels[1])<.01){let y=function(b){const E=Math.max(.01,Math.cos(wn(b))),k=1/(2*Math.max(Math.PI*E,1/E));return{wrap:!0,project(N,z){const j=wn(N)*E,W=Math.sin(wn(z))/E;return{x:j*k+.5,y:-W*k+.5}},unproject(N,z){const j=-(z-.5)/k,W=On(Cr((N-.5)/k)/E,-180,180),Y=Math.asin(On(j*E,-1,1)),ie=On(Cr(Y),-85.051129,Zo);return new Rn(W,ie)}}}(p.parallels[0]);if("lambertConformalConic"===p.name){const{project:b,unproject:E}=z_.mercator;y={wrap:!0,project:b,unproject:E}}return Mi({},u,p,y)}return Mi({},u,p)}(r,c):r},v.getRTLTextPluginStatus=X,v.getReferrer=we,v.getTilePoint=function(c,{x:r,y:u},p=0){return new Je(((r-p)*c.scale-c.x)*cn,(u*c.scale-c.y)*cn)},v.getTileVec3=function(c,r,u=0){return _u(((r.x-u)*c.scale-c.x)*cn,(r.y*c.scale-c.y)*cn,ud(r.z,r.y))},v.getVideo=function(c,r){const u=$t.document.createElement("video");u.muted=!0,u.onloadstart=function(){r(null,u)};for(let p=0;p<c.length;p++){const y=$t.document.createElement("source");Ie(c[p])||(u.crossOrigin="Anonymous"),y.src=c[p],u.appendChild(y)}return{cancel:()=>{}}},v.identity=Bc,v.identity$1=Lx,v.invert=function(c,r){var u=r[0],p=r[1],y=r[2],b=r[3],E=r[4],k=r[5],N=r[6],z=r[7],j=r[8],W=r[9],Y=r[10],ie=r[11],ce=r[12],pe=r[13],Ce=r[14],Te=r[15],Pe=u*k-p*E,Be=u*N-y*E,je=u*z-b*E,He=p*N-y*k,Ge=p*z-b*k,ot=y*z-b*N,nt=j*pe-W*ce,Mt=j*Ce-Y*ce,ft=j*Te-ie*ce,lt=W*Ce-Y*pe,gt=W*Te-ie*pe,Ct=Y*Te-ie*Ce,ct=Pe*Ct-Be*gt+je*lt+He*ft-Ge*Mt+ot*nt;return ct?(c[0]=(k*Ct-N*gt+z*lt)*(ct=1/ct),c[1]=(y*gt-p*Ct-b*lt)*ct,c[2]=(pe*ot-Ce*Ge+Te*He)*ct,c[3]=(Y*Ge-W*ot-ie*He)*ct,c[4]=(N*ft-E*Ct-z*Mt)*ct,c[5]=(u*Ct-y*ft+b*Mt)*ct,c[6]=(Ce*je-ce*ot-Te*Be)*ct,c[7]=(j*ot-Y*je+ie*Be)*ct,c[8]=(E*gt-k*ft+z*nt)*ct,c[9]=(p*ft-u*gt-b*nt)*ct,c[10]=(ce*Ge-pe*je+Te*Pe)*ct,c[11]=(W*je-j*Ge-ie*Pe)*ct,c[12]=(k*Mt-E*lt-N*nt)*ct,c[13]=(u*lt-p*Mt+y*nt)*ct,c[14]=(pe*Be-ce*He-Ce*Pe)*ct,c[15]=(j*He-W*Be+Y*Pe)*ct,c):null},v.isMapAuthenticated=function(c){return Lo.has(c)},v.isMapboxURL=As,v.latFromMercatorY=cr,v.len=cC,v.length=By,v.length$1=function(c){return Math.hypot(c[0],c[1],c[2],c[3])},v.loadVectorTile=F_,v.makeRequest=se,v.mercatorXfromLng=_g,v.mercatorYfromLat=Oy,v.mercatorZfromAltitude=Ly,v.mul=function(c,r,u){return c[0]=r[0]*u[0],c[1]=r[1]*u[1],c[2]=r[2]*u[2],c[3]=r[3]*u[3],c},v.mul$1=Np,v.mul$2=Ox,v.multiply=Js,v.multiply$1=fd,v.nextPowerOfTwo=Xr,v.normalize=Vy,v.normalize$1=function(c,r){var u=r[0],p=r[1],y=r[2],b=r[3],E=u*u+p*p+y*y+b*b;return E>0&&(E=1/Math.sqrt(E)),c[0]=u*E,c[1]=p*E,c[2]=y*E,c[3]=b*E,c},v.number=ln,v.ortho=function(c,r,u,p,y,b,E){var k=1/(r-u),N=1/(p-y),z=1/(b-E);return c[0]=-2*k,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*N,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*z,c[11]=0,c[12]=(r+u)*k,c[13]=(y+p)*N,c[14]=(E+b)*z,c[15]=1,c},v.pbf=yh,v.perspective=function(c,r,u,p,y){var b,E=1/Math.tan(r/2);return c[0]=E/u,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=E,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,null!=y&&y!==1/0?(c[10]=(y+p)*(b=1/(p-y)),c[14]=2*y*p*b):(c[10]=-1,c[14]=-2*p),c},v.pick=function(c,r){const u={};for(let p=0;p<r.length;p++){const y=r[p];y in c&&(u[y]=c[y])}return u},v.plugin=ee,v.pointGeometry=Je,v.polygonIntersectsBox=yu,v.polygonIntersectsPolygon=Ix,v.polygonizeBounds=function(c,r,u=0,p=!0){const y=new Je(u,u),b=c.sub(y),E=r.add(y),k=[b,new Je(E.x,b.y),E,new Je(b.x,E.y)];return p&&k.push(b),k},v.posAttributes=Ab,v.postMapLoadEvent=dc,v.postTurnstileEvent=hc,v.potpack=Uc,v.prevPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},v.radToDeg=Cr,v.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],v.registerForPluginStateChange=function(c){return c({pluginStatus:w,pluginURL:A}),U.on("pluginStateChange",c),c},v.removeAuthState=function(c){Lo.delete(c)},v.renderColorRamp=Ol,v.rotateX=function(c,r,u){var p=Math.sin(u),y=Math.cos(u),b=r[4],E=r[5],k=r[6],N=r[7],z=r[8],j=r[9],W=r[10],Y=r[11];return r!==c&&(c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[3],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c[4]=b*y+z*p,c[5]=E*y+j*p,c[6]=k*y+W*p,c[7]=N*y+Y*p,c[8]=z*y-b*p,c[9]=j*y-E*p,c[10]=W*y-k*p,c[11]=Y*y-N*p,c},v.rotateX$1=Hy,v.rotateY=function(c,r,u){var p=Math.sin(u),y=Math.cos(u),b=r[0],E=r[1],k=r[2],N=r[3],z=r[8],j=r[9],W=r[10],Y=r[11];return r!==c&&(c[4]=r[4],c[5]=r[5],c[6]=r[6],c[7]=r[7],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c[0]=b*y-z*p,c[1]=E*y-j*p,c[2]=k*y-W*p,c[3]=N*y-Y*p,c[8]=b*p+z*y,c[9]=E*p+j*y,c[10]=k*p+W*y,c[11]=N*p+Y*y,c},v.rotateZ=function(c,r,u){var p=Math.sin(u),y=Math.cos(u),b=r[0],E=r[1],k=r[2],N=r[3],z=r[4],j=r[5],W=r[6],Y=r[7];return r!==c&&(c[8]=r[8],c[9]=r[9],c[10]=r[10],c[11]=r[11],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c[0]=b*y+z*p,c[1]=E*y+j*p,c[2]=k*y+W*p,c[3]=N*y+Y*p,c[4]=z*y-b*p,c[5]=j*y-E*p,c[6]=W*y-k*p,c[7]=Y*y-N*p,c},v.rotateZ$1=function(c,r,u){u*=.5;var p=r[0],y=r[1],b=r[2],E=r[3],k=Math.sin(u),N=Math.cos(u);return c[0]=p*N+y*k,c[1]=y*N-p*k,c[2]=b*N+E*k,c[3]=E*N-b*k,c},v.scale=function(c,r,u){return c[0]=r[0]*u,c[1]=r[1]*u,c[2]=r[2]*u,c},v.scale$1=function(c,r,u){var p=u[0],y=u[1],b=u[2];return c[0]=r[0]*p,c[1]=r[1]*p,c[2]=r[2]*p,c[3]=r[3]*p,c[4]=r[4]*y,c[5]=r[5]*y,c[6]=r[6]*y,c[7]=r[7]*y,c[8]=r[8]*b,c[9]=r[9]*b,c[10]=r[10]*b,c[11]=r[11]*b,c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15],c},v.scale$2=function(c,r,u){return c[0]=r[0]*u,c[1]=r[1]*u,c[2]=r[2]*u,c[3]=r[3]*u,c},v.scaleAndAdd=Sg,v.setCacheLimits=function(c,r){wa=c,Bo=r},v.setRTLTextPlugin=function(c,r,u=!1){if(w===qa||w===x||w===l)throw new Error("setRTLTextPlugin cannot be called multiple times.");A=cs.resolveURL(c),w=qa,f=r,O(),u||Z()},v.smoothstep=function(c,r,u){return(u=On((u-c)/(r-c),0,1))*u*(3-2*u)},v.spec=d,v.storeAuthState=function(c,r){r?Lo.add(c):Lo.delete(c)},v.sub=gd,v.subtract=Fp,v.symbolSize=ub,v.tileTransform=sf,v.transformMat3=function(c,r,u){var p=r[0],y=r[1],b=r[2];return c[0]=p*u[0]+y*u[3]+b*u[6],c[1]=p*u[1]+y*u[4]+b*u[7],c[2]=p*u[2]+y*u[5]+b*u[8],c},v.transformMat4=ch,v.transformMat4$1=function(c,r,u){var p=r[0],y=r[1],b=r[2],E=u[3]*p+u[7]*y+u[11]*b+u[15];return c[0]=(u[0]*p+u[4]*y+u[8]*b+u[12])/(E=E||1),c[1]=(u[1]*p+u[5]*y+u[9]*b+u[13])/E,c[2]=(u[2]*p+u[6]*y+u[10]*b+u[14])/E,c},v.transformQuat=Uy,v.translate=function(c,r,u){var p,y,b,E,k,N,z,j,W,Y,ie,ce,pe=u[0],Ce=u[1],Te=u[2];return r===c?(c[12]=r[0]*pe+r[4]*Ce+r[8]*Te+r[12],c[13]=r[1]*pe+r[5]*Ce+r[9]*Te+r[13],c[14]=r[2]*pe+r[6]*Ce+r[10]*Te+r[14],c[15]=r[3]*pe+r[7]*Ce+r[11]*Te+r[15]):(y=r[1],b=r[2],E=r[3],k=r[4],N=r[5],z=r[6],j=r[7],W=r[8],Y=r[9],ie=r[10],ce=r[11],c[0]=p=r[0],c[1]=y,c[2]=b,c[3]=E,c[4]=k,c[5]=N,c[6]=z,c[7]=j,c[8]=W,c[9]=Y,c[10]=ie,c[11]=ce,c[12]=p*pe+k*Ce+W*Te+r[12],c[13]=y*pe+N*Ce+Y*Te+r[13],c[14]=b*pe+z*Ce+ie*Te+r[14],c[15]=E*pe+j*Ce+ce*Te+r[15]),c},v.triggerPluginCompletionEvent=M,v.uniqueId=Fr,v.validateCustomStyleLayer=function(c){const r=[],u=c.id;return void 0===u&&r.push({message:`layers.${u}: missing required property "id"`}),void 0===c.render&&r.push({message:`layers.${u}: missing required method "render"`}),c.renderingMode&&"2d"!==c.renderingMode&&"3d"!==c.renderingMode&&r.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),r},v.validateFog=Sp,v.validateLight=Kh,v.validateStyle=El,v.values=va,v.vectorTile=vu,v.version="2.6.1",v.warnOnce=mn,v.window=$t,v.wrap=Ro}),nr(0,function(v){function St(we){const se=typeof we;if("number"===se||"boolean"===se||"string"===se||null==we)return JSON.stringify(we);if(Array.isArray(we)){let Ae="[";for(const Ie of we)Ae+=`${St(Ie)},`;return`${Ae}]`}const ue=Object.keys(we).sort();let xe="{";for(let Ae=0;Ae<ue.length;Ae++)xe+=`${JSON.stringify(ue[Ae])}:${St(we[ue[Ae]])},`;return`${xe}}`}function Cs(we){let se="";for(const ue of v.refProperties)se+=`/${St(we[ue])}`;return se}class Nr{constructor(se){this.keyCache={},se&&this.replace(se)}replace(se){this._layerConfigs={},this._layers={},this.update(se,[])}update(se,ue){for(const Ae of se)this._layerConfigs[Ae.id]=Ae,(this._layers[Ae.id]=v.createStyleLayer(Ae)).compileFilter(),this.keyCache[Ae.id]&&delete this.keyCache[Ae.id];for(const Ae of ue)delete this.keyCache[Ae],delete this._layerConfigs[Ae],delete this._layers[Ae];this.familiesBySource={};const xe=function(Ae,Ie){const $e={};for(let Oe=0;Oe<Ae.length;Oe++){const We=Ie&&Ie[Ae[Oe].id]||Cs(Ae[Oe]);Ie&&(Ie[Ae[Oe].id]=We);let at=$e[We];at||(at=$e[We]=[]),at.push(Ae[Oe])}const Ue=[];for(const Oe in $e)Ue.push($e[Oe]);return Ue}(v.values(this._layerConfigs),this.keyCache);for(const Ae of xe){const Ie=Ae.map(Tt=>this._layers[Tt.id]),$e=Ie[0];if("none"===$e.visibility)continue;const Ue=$e.source||"";let Oe=this.familiesBySource[Ue];Oe||(Oe=this.familiesBySource[Ue]={});const We=$e.sourceLayer||"_geojsonTileLayer";let at=Oe[We];at||(at=Oe[We]=[]),at.push(Ie)}}}const{ImageBitmap:Je}=v.window;class ht{loadTile(se,ue){const{uid:xe,encoding:Ae,rawImageData:Ie,padding:$e,buildQuadTree:Ue}=se,Oe=Je&&Ie instanceof Je?this.getImageData(Ie,$e):Ie;ue(null,new v.DEMData(xe,Oe,Ae,$e<1,Ue))}getImageData(se,ue){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(se.width,se.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=se.width,this.offscreenCanvas.height=se.height,this.offscreenCanvasContext.drawImage(se,0,0,se.width,se.height);const xe=this.offscreenCanvasContext.getImageData(-ue,-ue,se.width+2*ue,se.height+2*ue);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new v.RGBAImage({width:xe.width,height:xe.height},xe.data)}}var $t=function we(se,ue){var xe,Ae=se&&se.type;if("FeatureCollection"===Ae)for(xe=0;xe<se.features.length;xe++)we(se.features[xe],ue);else if("GeometryCollection"===Ae)for(xe=0;xe<se.geometries.length;xe++)we(se.geometries[xe],ue);else if("Feature"===Ae)we(se.geometry,ue);else if("Polygon"===Ae)Ss(se.coordinates,ue);else if("MultiPolygon"===Ae)for(xe=0;xe<se.coordinates.length;xe++)Ss(se.coordinates[xe],ue);return se};function Ss(we,se){if(0!==we.length){Ds(we[0],se);for(var ue=1;ue<we.length;ue++)Ds(we[ue],!se)}}function Ds(we,se){for(var ue=0,xe=0,Ae=0,Ie=we.length,$e=Ie-1;Ae<Ie;$e=Ae++){var Ue=(we[Ae][0]-we[$e][0])*(we[$e][1]+we[Ae][1]),Oe=ue+Ue;xe+=Math.abs(ue)>=Math.abs(Ue)?ue-Oe+Ue:Ue-Oe+ue,ue=Oe}ue+xe>=0!=!!se&&we.reverse()}const co=v.vectorTile.VectorTileFeature.prototype.toGeoJSON;class wn{constructor(se){this._feature=se,this.extent=v.EXTENT,this.type=se.type,this.properties=se.tags,"id"in se&&!isNaN(se.id)&&(this.id=parseInt(se.id,10))}loadGeometry(){if(1===this._feature.type){const se=[];for(const ue of this._feature.geometry)se.push([new v.pointGeometry(ue[0],ue[1])]);return se}{const se=[];for(const ue of this._feature.geometry){const xe=[];for(const Ae of ue)xe.push(new v.pointGeometry(Ae[0],Ae[1]));se.push(xe)}return se}}toGeoJSON(se,ue,xe){return co.call(this,se,ue,xe)}}class Cr{constructor(se){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.EXTENT,this.length=se.length,this._features=se}feature(se){return new wn(this._features[se])}}var Xe=v.vectorTile.VectorTileFeature,mr=pi;function pi(we,se){this.options=se||{},this.features=we,this.length=we.length}function yt(we,se){this.id="number"==typeof we.id?we.id:void 0,this.type=we.type,this.rawGeometry=1===we.type?[we.geometry]:we.geometry,this.properties=we.tags,this.extent=se||4096}pi.prototype.feature=function(we){return new yt(this.features[we],this.options.extent)},yt.prototype.loadGeometry=function(){var we=this.rawGeometry;this.geometry=[];for(var se=0;se<we.length;se++){for(var ue=we[se],xe=[],Ae=0;Ae<ue.length;Ae++)xe.push(new v.pointGeometry(ue[Ae][0],ue[Ae][1]));this.geometry.push(xe)}return this.geometry},yt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var we=this.geometry,se=1/0,ue=-1/0,xe=1/0,Ae=-1/0,Ie=0;Ie<we.length;Ie++)for(var $e=we[Ie],Ue=0;Ue<$e.length;Ue++){var Oe=$e[Ue];se=Math.min(se,Oe.x),ue=Math.max(ue,Oe.x),xe=Math.min(xe,Oe.y),Ae=Math.max(Ae,Oe.y)}return[se,xe,ue,Ae]},yt.prototype.toGeoJSON=Xe.prototype.toGeoJSON;var On=fi,Ro=mr;function fi(we){var se=new v.pbf;return function(ue,xe){for(var Ae in ue.layers)xe.writeMessage(3,va,ue.layers[Ae])}(we,se),se.finish()}function va(we,se){var ue;se.writeVarintField(15,we.version||1),se.writeStringField(1,we.name||""),se.writeVarintField(5,we.extent||4096);var xe={keys:[],values:[],keycache:{},valuecache:{}};for(ue=0;ue<we.length;ue++)xe.feature=we.feature(ue),se.writeMessage(2,Mi,xe);var Ae=xe.keys;for(ue=0;ue<Ae.length;ue++)se.writeStringField(3,Ae[ue]);var Ie=xe.values;for(ue=0;ue<Ie.length;ue++)se.writeMessage(4,uo,Ie[ue])}function Mi(we,se){var ue=we.feature;void 0!==ue.id&&se.writeVarintField(1,ue.id),se.writeMessage(2,cc,we),se.writeVarintField(3,ue.type),se.writeMessage(4,Xr,ue)}function cc(we,se){var ue=we.feature,xe=we.keys,Ae=we.values,Ie=we.keycache,$e=we.valuecache;for(var Ue in ue.properties){var Oe=ue.properties[Ue],We=Ie[Ue];if(null!==Oe){void 0===We&&(xe.push(Ue),Ie[Ue]=We=xe.length-1),se.writeVarint(We);var at=typeof Oe;"string"!==at&&"boolean"!==at&&"number"!==at&&(Oe=JSON.stringify(Oe));var Tt=at+":"+Oe,te=$e[Tt];void 0===te&&(Ae.push(Oe),$e[Tt]=te=Ae.length-1),se.writeVarint(te)}}}function Fr(we,se){return(se<<3)+(7&we)}function as(we){return we<<1^we>>31}function Xr(we,se){for(var ue=we.loadGeometry(),xe=we.type,Ae=0,Ie=0,$e=ue.length,Ue=0;Ue<$e;Ue++){var Oe=ue[Ue],We=1;1===xe&&(We=Oe.length),se.writeVarint(Fr(1,We));for(var at=3===xe?Oe.length-1:Oe.length,Tt=0;Tt<at;Tt++){1===Tt&&1!==xe&&se.writeVarint(Fr(2,at-1));var te=Oe[Tt].x-Ae,o=Oe[Tt].y-Ie;se.writeVarint(as(te)),se.writeVarint(as(o)),Ae+=te,Ie+=o}3===xe&&se.writeVarint(Fr(7,1))}}function uo(we,se){var ue=typeof we;"string"===ue?se.writeStringField(1,we):"boolean"===ue?se.writeBooleanField(7,we):"number"===ue&&(we%1!=0?se.writeDoubleField(3,we):we<0?se.writeSVarintField(6,we):se.writeVarintField(5,we))}function Cn(we,se,ue,xe,Ae,Ie){if(Ae-xe<=ue)return;const $e=xe+Ae>>1;ls(we,se,$e,xe,Ae,Ie%2),Cn(we,se,ue,xe,$e-1,Ie+1),Cn(we,se,ue,$e+1,Ae,Ie+1)}function ls(we,se,ue,xe,Ae,Ie){for(;Ae>xe;){if(Ae-xe>600){const We=Ae-xe+1,at=ue-xe+1,Tt=Math.log(We),te=.5*Math.exp(2*Tt/3),o=.5*Math.sqrt(Tt*te*(We-te)/We)*(at-We/2<0?-1:1);ls(we,se,ue,Math.max(xe,Math.floor(ue-at*te/We+o)),Math.min(Ae,Math.floor(ue+(We-at)*te/We+o)),Ie)}const $e=se[2*ue+Ie];let Ue=xe,Oe=Ae;for(No(we,se,xe,ue),se[2*Ae+Ie]>$e&&No(we,se,xe,Ae);Ue<Oe;){for(No(we,se,Ue,Oe),Ue++,Oe--;se[2*Ue+Ie]<$e;)Ue++;for(;se[2*Oe+Ie]>$e;)Oe--}se[2*xe+Ie]===$e?No(we,se,xe,Oe):(Oe++,No(we,se,Oe,Ae)),Oe<=ue&&(xe=Oe+1),ue<=Oe&&(Ae=Oe-1)}}function No(we,se,ue,xe){Bi(we,ue,xe),Bi(se,2*ue,2*xe),Bi(se,2*ue+1,2*xe+1)}function Bi(we,se,ue){const xe=we[se];we[se]=we[ue],we[ue]=xe}function ir(we,se,ue,xe){const Ae=we-ue,Ie=se-xe;return Ae*Ae+Ie*Ie}On.fromVectorTileJs=fi,On.fromGeojsonVt=function(we,se){se=se||{};var ue={};for(var xe in we)ue[xe]=new mr(we[xe].features,se),ue[xe].name=xe,ue[xe].version=se.version,ue[xe].extent=se.extent;return fi({layers:ue})},On.GeoJSONWrapper=Ro;const Dn=we=>we[0],mn=we=>we[1];class Or{constructor(se,ue=Dn,xe=mn,Ae=64,Ie=Float64Array){this.nodeSize=Ae,this.points=se;const $e=se.length<65536?Uint16Array:Uint32Array,Ue=this.ids=new $e(se.length),Oe=this.coords=new Ie(2*se.length);for(let We=0;We<se.length;We++)Ue[We]=We,Oe[2*We]=ue(se[We]),Oe[2*We+1]=xe(se[We]);Cn(Ue,Oe,Ae,0,Ue.length-1,0)}range(se,ue,xe,Ae){return function(Ie,$e,Ue,Oe,We,at,Tt){const te=[0,Ie.length-1,0],o=[];let a,d;for(;te.length;){const g=te.pop(),_=te.pop(),D=te.pop();if(_-D<=Tt){for(let P=D;P<=_;P++)a=$e[2*P],d=$e[2*P+1],a>=Ue&&a<=We&&d>=Oe&&d<=at&&o.push(Ie[P]);continue}const C=Math.floor((D+_)/2);a=$e[2*C],d=$e[2*C+1],a>=Ue&&a<=We&&d>=Oe&&d<=at&&o.push(Ie[C]);const T=(g+1)%2;(0===g?Ue<=a:Oe<=d)&&(te.push(D),te.push(C-1),te.push(T)),(0===g?We>=a:at>=d)&&(te.push(C+1),te.push(_),te.push(T))}return o}(this.ids,this.coords,se,ue,xe,Ae,this.nodeSize)}within(se,ue,xe){return function(Ae,Ie,$e,Ue,Oe,We){const at=[0,Ae.length-1,0],Tt=[],te=Oe*Oe;for(;at.length;){const o=at.pop(),a=at.pop(),d=at.pop();if(a-d<=We){for(let T=d;T<=a;T++)ir(Ie[2*T],Ie[2*T+1],$e,Ue)<=te&&Tt.push(Ae[T]);continue}const g=Math.floor((d+a)/2),_=Ie[2*g],D=Ie[2*g+1];ir(_,D,$e,Ue)<=te&&Tt.push(Ae[g]);const C=(o+1)%2;(0===o?$e-Oe<=_:Ue-Oe<=D)&&(at.push(d),at.push(g-1),at.push(C)),(0===o?$e+Oe>=_:Ue+Oe>=D)&&(at.push(g+1),at.push(a),at.push(C))}return Tt}(this.ids,this.coords,se,ue,xe,this.nodeSize)}}const ni={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:we=>we},vn=Math.fround||(Kt=new Float32Array(1),we=>(Kt[0]=+we,Kt[0]));var Kt;class ua{constructor(se){this.options=xn(Object.create(ni),se),this.trees=new Array(this.options.maxZoom+1)}load(se){const{log:ue,minZoom:xe,maxZoom:Ae,nodeSize:Ie}=this.options;ue&&console.time("total time");const $e=`prepare ${se.length} points`;ue&&console.time($e),this.points=se;let Ue=[];for(let Oe=0;Oe<se.length;Oe++)se[Oe].geometry&&Ue.push(ho(se[Oe],Oe));this.trees[Ae+1]=new Or(Ue,fo,xa,Ie,Float32Array),ue&&console.timeEnd($e);for(let Oe=Ae;Oe>=xe;Oe--){const We=+Date.now();Ue=this._cluster(Ue,Oe),this.trees[Oe]=new Or(Ue,fo,xa,Ie,Float32Array),ue&&console.log("z%d: %d clusters in %dms",Oe,Ue.length,+Date.now()-We)}return ue&&console.timeEnd("total time"),this}getClusters(se,ue){let xe=((se[0]+180)%360+360)%360-180;const Ae=Math.max(-90,Math.min(90,se[1]));let Ie=180===se[2]?180:((se[2]+180)%360+360)%360-180;const $e=Math.max(-90,Math.min(90,se[3]));if(se[2]-se[0]>=360)xe=-180,Ie=180;else if(xe>Ie){const at=this.getClusters([xe,Ae,180,$e],ue),Tt=this.getClusters([-180,Ae,Ie,$e],ue);return at.concat(Tt)}const Ue=this.trees[this._limitZoom(ue)],Oe=Ue.range(po(xe),cs($e),po(Ie),cs(Ae)),We=[];for(const at of Oe){const Tt=Ue.points[at];We.push(Tt.numPoints?Us(Tt):this.points[Tt.index])}return We}getChildren(se){const ue=this._getOriginId(se),xe=this._getOriginZoom(se),Ae="No cluster with the specified id.",Ie=this.trees[xe];if(!Ie)throw new Error(Ae);const $e=Ie.points[ue];if(!$e)throw new Error(Ae);const Ue=this.options.radius/(this.options.extent*Math.pow(2,xe-1)),Oe=Ie.within($e.x,$e.y,Ue),We=[];for(const at of Oe){const Tt=Ie.points[at];Tt.parentId===se&&We.push(Tt.numPoints?Us(Tt):this.points[Tt.index])}if(0===We.length)throw new Error(Ae);return We}getLeaves(se,ue,xe){const Ae=[];return this._appendLeaves(Ae,se,ue=ue||10,xe=xe||0,0),Ae}getTile(se,ue,xe){const Ae=this.trees[this._limitZoom(se)],Ie=Math.pow(2,se),{extent:$e,radius:Ue}=this.options,Oe=Ue/$e,We=(xe-Oe)/Ie,at=(xe+1+Oe)/Ie,Tt={features:[]};return this._addTileFeatures(Ae.range((ue-Oe)/Ie,We,(ue+1+Oe)/Ie,at),Ae.points,ue,xe,Ie,Tt),0===ue&&this._addTileFeatures(Ae.range(1-Oe/Ie,We,1,at),Ae.points,Ie,xe,Ie,Tt),ue===Ie-1&&this._addTileFeatures(Ae.range(0,We,Oe/Ie,at),Ae.points,-1,xe,Ie,Tt),Tt.features.length?Tt:null}getClusterExpansionZoom(se){let ue=this._getOriginZoom(se)-1;for(;ue<=this.options.maxZoom;){const xe=this.getChildren(se);if(ue++,1!==xe.length)break;se=xe[0].properties.cluster_id}return ue}_appendLeaves(se,ue,xe,Ae,Ie){const $e=this.getChildren(ue);for(const Ue of $e){const Oe=Ue.properties;if(Oe&&Oe.cluster?Ie+Oe.point_count<=Ae?Ie+=Oe.point_count:Ie=this._appendLeaves(se,Oe.cluster_id,xe,Ae,Ie):Ie<Ae?Ie++:se.push(Ue),se.length===xe)break}return Ie}_addTileFeatures(se,ue,xe,Ae,Ie,$e){for(const Ue of se){const Oe=ue[Ue],We=Oe.numPoints;let at,Tt,te;if(We)at=Va(Oe),Tt=Oe.x,te=Oe.y;else{const d=this.points[Oe.index];at=d.properties,Tt=po(d.geometry.coordinates[0]),te=cs(d.geometry.coordinates[1])}const o={type:1,geometry:[[Math.round(this.options.extent*(Tt*Ie-xe)),Math.round(this.options.extent*(te*Ie-Ae))]],tags:at};let a;We?a=Oe.id:this.options.generateId?a=Oe.index:this.points[Oe.index].id&&(a=this.points[Oe.index].id),void 0!==a&&(o.id=a),$e.features.push(o)}}_limitZoom(se){return Math.max(this.options.minZoom,Math.min(+se,this.options.maxZoom+1))}_cluster(se,ue){const xe=[],{radius:Ae,extent:Ie,reduce:$e,minPoints:Ue}=this.options,Oe=Ae/(Ie*Math.pow(2,ue));for(let We=0;We<se.length;We++){const at=se[We];if(at.zoom<=ue)continue;at.zoom=ue;const Tt=this.trees[ue+1],te=Tt.within(at.x,at.y,Oe),o=at.numPoints||1;let a=o;for(const d of te){const g=Tt.points[d];g.zoom>ue&&(a+=g.numPoints||1)}if(a>o&&a>=Ue){let d=at.x*o,g=at.y*o,_=$e&&o>1?this._map(at,!0):null;const D=(We<<5)+(ue+1)+this.points.length;for(const C of te){const T=Tt.points[C];if(T.zoom<=ue)continue;T.zoom=ue;const P=T.numPoints||1;d+=T.x*P,g+=T.y*P,T.parentId=D,$e&&(_||(_=this._map(at,!0)),$e(_,this._map(T)))}at.parentId=D,xe.push(Tn(d/a,g/a,D,a,_))}else if(xe.push(at),a>1)for(const d of te){const g=Tt.points[d];g.zoom<=ue||(g.zoom=ue,xe.push(g))}}return xe}_getOriginId(se){return se-this.points.length>>5}_getOriginZoom(se){return(se-this.points.length)%32}_map(se,ue){if(se.numPoints)return ue?xn({},se.properties):se.properties;const xe=this.points[se.index].properties,Ae=this.options.map(xe);return ue&&Ae===xe?xn({},Ae):Ae}}function Tn(we,se,ue,xe,Ae){return{x:vn(we),y:vn(se),zoom:1/0,id:ue,parentId:-1,numPoints:xe,properties:Ae}}function ho(we,se){const[ue,xe]=we.geometry.coordinates;return{x:vn(po(ue)),y:vn(cs(xe)),zoom:1/0,index:se,parentId:-1}}function Us(we){return{type:"Feature",id:we.id,properties:Va(we),geometry:{type:"Point",coordinates:[(se=we.x,360*(se-.5)),Hs(we.y)]}};var se}function Va(we){const se=we.numPoints,ue=se>=1e4?`${Math.round(se/1e3)}k`:se>=1e3?Math.round(se/100)/10+"k":se;return xn(xn({},we.properties),{cluster:!0,cluster_id:we.id,point_count:se,point_count_abbreviated:ue})}function po(we){return we/360+.5}function cs(we){const se=Math.sin(we*Math.PI/180),ue=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return ue<0?0:ue>1?1:ue}function Hs(we){const se=(180-360*we)*Math.PI/180;return 360*Math.atan(Math.exp(se))/Math.PI-90}function xn(we,se){for(const ue in se)we[ue]=se[ue];return we}function fo(we){return we.x}function xa(we){return we.y}function js(we,se,ue,xe){for(var Ae,Ie=xe,$e=ue-se>>1,Ue=ue-se,Oe=we[se],We=we[se+1],at=we[ue],Tt=we[ue+1],te=se+3;te<ue;te+=3){var o=hl(we[te],we[te+1],Oe,We,at,Tt);if(o>Ie)Ae=te,Ie=o;else if(o===Ie){var a=Math.abs(te-$e);a<Ue&&(Ae=te,Ue=a)}}Ie>xe&&(Ae-se>3&&js(we,se,Ae,xe),we[Ae+2]=Ie,ue-Ae>3&&js(we,Ae,ue,xe))}function hl(we,se,ue,xe,Ae,Ie){var $e=Ae-ue,Ue=Ie-xe;if(0!==$e||0!==Ue){var Oe=((we-ue)*$e+(se-xe)*Ue)/($e*$e+Ue*Ue);Oe>1?(ue=Ae,xe=Ie):Oe>0&&(ue+=$e*Oe,xe+=Ue*Oe)}return($e=we-ue)*$e+(Ue=se-xe)*Ue}function Fo(we,se,ue,xe){var Ae={id:void 0===we?null:we,type:se,geometry:ue,tags:xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ie){var $e=Ie.geometry,Ue=Ie.type;if("Point"===Ue||"MultiPoint"===Ue||"LineString"===Ue)dl(Ie,$e);else if("Polygon"===Ue||"MultiLineString"===Ue)for(var Oe=0;Oe<$e.length;Oe++)dl(Ie,$e[Oe]);else if("MultiPolygon"===Ue)for(Oe=0;Oe<$e.length;Oe++)for(var We=0;We<$e[Oe].length;We++)dl(Ie,$e[Oe][We])}(Ae),Ae}function dl(we,se){for(var ue=0;ue<se.length;ue+=3)we.minX=Math.min(we.minX,se[ue]),we.minY=Math.min(we.minY,se[ue+1]),we.maxX=Math.max(we.maxX,se[ue]),we.maxY=Math.max(we.maxY,se[ue+1])}function pl(we,se,ue,xe){if(se.geometry){var Ae=se.geometry.coordinates,Ie=se.geometry.type,$e=Math.pow(ue.tolerance/((1<<ue.maxZoom)*ue.extent),2),Ue=[],Oe=se.id;if(ue.promoteId?Oe=se.properties[ue.promoteId]:ue.generateId&&(Oe=xe||0),"Point"===Ie)Es(Ae,Ue);else if("MultiPoint"===Ie)for(var We=0;We<Ae.length;We++)Es(Ae[We],Ue);else if("LineString"===Ie)As(Ae,Ue,$e,!1);else if("MultiLineString"===Ie){if(ue.lineMetrics){for(We=0;We<Ae.length;We++)As(Ae[We],Ue=[],$e,!1),we.push(Fo(Oe,"LineString",Ue,se.properties));return}ba(Ae,Ue,$e,!1)}else if("Polygon"===Ie)ba(Ae,Ue,$e,!0);else{if("MultiPolygon"!==Ie){if("GeometryCollection"===Ie){for(We=0;We<se.geometry.geometries.length;We++)pl(we,{id:Oe,geometry:se.geometry.geometries[We],properties:se.properties},ue,xe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(We=0;We<Ae.length;We++){var at=[];ba(Ae[We],at,$e,!0),Ue.push(at)}}we.push(Fo(Oe,Ie,Ue,se.properties))}}function Es(we,se){se.push(uc(we[0])),se.push($s(we[1])),se.push(0)}function As(we,se,ue,xe){for(var Ae,Ie,$e=0,Ue=0;Ue<we.length;Ue++){var Oe=uc(we[Ue][0]),We=$s(we[Ue][1]);se.push(Oe),se.push(We),se.push(0),Ue>0&&($e+=xe?(Ae*We-Oe*Ie)/2:Math.sqrt(Math.pow(Oe-Ae,2)+Math.pow(We-Ie,2))),Ae=Oe,Ie=We}var at=se.length-3;se[2]=1,js(se,0,at,ue),se[at+2]=1,se.size=Math.abs($e),se.start=0,se.end=se.size}function ba(we,se,ue,xe){for(var Ae=0;Ae<we.length;Ae++){var Ie=[];As(we[Ae],Ie,ue,xe),se.push(Ie)}}function uc(we){return we/360+.5}function $s(we){var se=Math.sin(we*Math.PI/180),ue=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return ue<0?0:ue>1?1:ue}function rr(we,se,ue,xe,Ae,Ie,$e,Ue){if(xe/=se,Ie>=(ue/=se)&&$e<xe)return we;if($e<ue||Ie>=xe)return null;for(var Oe=[],We=0;We<we.length;We++){var at=we[We],Tt=at.geometry,te=at.type,o=0===Ae?at.minX:at.minY,a=0===Ae?at.maxX:at.maxY;if(o>=ue&&a<xe)Oe.push(at);else if(!(a<ue||o>=xe)){var d=[];if("Point"===te||"MultiPoint"===te)tu(Tt,d,ue,xe,Ae);else if("LineString"===te)Ua(Tt,d,ue,xe,Ae,!1,Ue.lineMetrics);else if("MultiLineString"===te)hc(Tt,d,ue,xe,Ae,!1);else if("Polygon"===te)hc(Tt,d,ue,xe,Ae,!0);else if("MultiPolygon"===te)for(var g=0;g<Tt.length;g++){var _=[];hc(Tt[g],_,ue,xe,Ae,!0),_.length&&d.push(_)}if(d.length){if(Ue.lineMetrics&&"LineString"===te){for(g=0;g<d.length;g++)Oe.push(Fo(at.id,te,d[g],at.tags));continue}"LineString"!==te&&"MultiLineString"!==te||(1===d.length?(te="LineString",d=d[0]):te="MultiLineString"),"Point"!==te&&"MultiPoint"!==te||(te=3===d.length?"Point":"MultiPoint"),Oe.push(Fo(at.id,te,d,at.tags))}}}return Oe.length?Oe:null}function tu(we,se,ue,xe,Ae){for(var Ie=0;Ie<we.length;Ie+=3){var $e=we[Ie+Ae];$e>=ue&&$e<=xe&&(se.push(we[Ie]),se.push(we[Ie+1]),se.push(we[Ie+2]))}}function Ua(we,se,ue,xe,Ae,Ie,$e){for(var Ue,Oe,We=fl(we),at=0===Ae?dc:Ha,Tt=we.start,te=0;te<we.length-3;te+=3){var o=we[te],a=we[te+1],d=we[te+2],g=we[te+3],_=we[te+4],D=0===Ae?o:a,C=0===Ae?g:_,T=!1;$e&&(Ue=Math.sqrt(Math.pow(o-g,2)+Math.pow(a-_,2))),D<ue?C>ue&&(Oe=at(We,o,a,g,_,ue),$e&&(We.start=Tt+Ue*Oe)):D>xe?C<xe&&(Oe=at(We,o,a,g,_,xe),$e&&(We.start=Tt+Ue*Oe)):Oo(We,o,a,d),C<ue&&D>=ue&&(Oe=at(We,o,a,g,_,ue),T=!0),C>xe&&D<=xe&&(Oe=at(We,o,a,g,_,xe),T=!0),!Ie&&T&&($e&&(We.end=Tt+Ue*Oe),se.push(We),We=fl(we)),$e&&(Tt+=Ue)}var P=we.length-3;o=we[P],a=we[P+1],d=we[P+2],(D=0===Ae?o:a)>=ue&&D<=xe&&Oo(We,o,a,d),P=We.length-3,Ie&&P>=3&&(We[P]!==We[0]||We[P+1]!==We[1])&&Oo(We,We[0],We[1],We[2]),We.length&&se.push(We)}function fl(we){var se=[];return se.size=we.size,se.start=we.start,se.end=we.end,se}function hc(we,se,ue,xe,Ae,Ie){for(var $e=0;$e<we.length;$e++)Ua(we[$e],se,ue,xe,Ae,Ie,!1)}function Oo(we,se,ue,xe){we.push(se),we.push(ue),we.push(xe)}function dc(we,se,ue,xe,Ae,Ie){var $e=(Ie-se)/(xe-se);return we.push(Ie),we.push(ue+(Ae-ue)*$e),we.push(1),$e}function Ha(we,se,ue,xe,Ae,Ie){var $e=(Ie-ue)/(Ae-ue);return we.push(se+(xe-se)*$e),we.push(Ie),we.push(1),$e}function gl(we,se){for(var ue=[],xe=0;xe<we.length;xe++){var Ae,Ie=we[xe],$e=Ie.type;if("Point"===$e||"MultiPoint"===$e||"LineString"===$e)Ae=Lo(Ie.geometry,se);else if("MultiLineString"===$e||"Polygon"===$e){Ae=[];for(var Ue=0;Ue<Ie.geometry.length;Ue++)Ae.push(Lo(Ie.geometry[Ue],se))}else if("MultiPolygon"===$e)for(Ae=[],Ue=0;Ue<Ie.geometry.length;Ue++){for(var Oe=[],We=0;We<Ie.geometry[Ue].length;We++)Oe.push(Lo(Ie.geometry[Ue][We],se));Ae.push(Oe)}ue.push(Fo(Ie.id,$e,Ae,Ie.tags))}return ue}function Lo(we,se){var ue=[];ue.size=we.size,void 0!==we.start&&(ue.start=we.start,ue.end=we.end);for(var xe=0;xe<we.length;xe+=3)ue.push(we[xe]+se,we[xe+1],we[xe+2]);return ue}function ml(we,se){if(we.transformed)return we;var ue,xe,Ae,Ie=1<<we.z,$e=we.x,Ue=we.y;for(ue=0;ue<we.features.length;ue++){var Oe=we.features[ue],We=Oe.geometry,at=Oe.type;if(Oe.geometry=[],1===at)for(xe=0;xe<We.length;xe+=2)Oe.geometry.push(us(We[xe],We[xe+1],se,Ie,$e,Ue));else for(xe=0;xe<We.length;xe++){var Tt=[];for(Ae=0;Ae<We[xe].length;Ae+=2)Tt.push(us(We[xe][Ae],We[xe][Ae+1],se,Ie,$e,Ue));Oe.geometry.push(Tt)}}return we.transformed=!0,we}function us(we,se,ue,xe,Ae,Ie){return[Math.round(ue*(we*xe-Ae)),Math.round(ue*(se*xe-Ie))]}function zo(we,se,ue,xe,Ae){for(var Ie=se===Ae.maxZoom?0:Ae.tolerance/((1<<se)*Ae.extent),$e={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ue,y:xe,z:se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ue=0;Ue<we.length;Ue++){$e.numFeatures++,wa($e,we[Ue],Ie,Ae);var Oe=we[Ue].minX,We=we[Ue].minY,at=we[Ue].maxX,Tt=we[Ue].maxY;Oe<$e.minX&&($e.minX=Oe),We<$e.minY&&($e.minY=We),at>$e.maxX&&($e.maxX=at),Tt>$e.maxY&&($e.maxY=Tt)}return $e}function wa(we,se,ue,xe){var Ae=se.geometry,Ie=se.type,$e=[];if("Point"===Ie||"MultiPoint"===Ie)for(var Ue=0;Ue<Ae.length;Ue+=3)$e.push(Ae[Ue]),$e.push(Ae[Ue+1]),we.numPoints++,we.numSimplified++;else if("LineString"===Ie)Bo($e,Ae,we,ue,!1,!1);else if("MultiLineString"===Ie||"Polygon"===Ie)for(Ue=0;Ue<Ae.length;Ue++)Bo($e,Ae[Ue],we,ue,"Polygon"===Ie,0===Ue);else if("MultiPolygon"===Ie)for(var Oe=0;Oe<Ae.length;Oe++){var We=Ae[Oe];for(Ue=0;Ue<We.length;Ue++)Bo($e,We[Ue],we,ue,!0,0===Ue)}if($e.length){var at=se.tags||null;if("LineString"===Ie&&xe.lineMetrics){for(var Tt in at={},se.tags)at[Tt]=se.tags[Tt];at.mapbox_clip_start=Ae.start/Ae.size,at.mapbox_clip_end=Ae.end/Ae.size}var te={geometry:$e,type:"Polygon"===Ie||"MultiPolygon"===Ie?3:"LineString"===Ie||"MultiLineString"===Ie?2:1,tags:at};null!==se.id&&(te.id=se.id),we.features.push(te)}}function Bo(we,se,ue,xe,Ae,Ie){var $e=xe*xe;if(xe>0&&se.size<(Ae?$e:xe))ue.numPoints+=se.length/3;else{for(var Ue=[],Oe=0;Oe<se.length;Oe+=3)(0===xe||se[Oe+2]>$e)&&(ue.numSimplified++,Ue.push(se[Oe]),Ue.push(se[Oe+1])),ue.numPoints++;Ae&&function(We,at){for(var Tt=0,te=0,o=We.length,a=o-2;te<o;a=te,te+=2)Tt+=(We[te]-We[a])*(We[te+1]+We[a+1]);if(Tt>0===at)for(te=0,o=We.length;te<o/2;te+=2){var d=We[te],g=We[te+1];We[te]=We[o-2-te],We[te+1]=We[o-1-te],We[o-2-te]=d,We[o-1-te]=g}}(Ue,Ie),we.push(Ue)}}function Ei(we,se){var ue=(se=this.options=function(Ae,Ie){for(var $e in Ie)Ae[$e]=Ie[$e];return Ae}(Object.create(this.options),se)).debug;if(ue&&console.time("preprocess data"),se.maxZoom<0||se.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(se.promoteId&&se.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ae,Ie,$e,Ue,Oe,We,xe=function(Ae,Ie){var $e=[];if("FeatureCollection"===Ae.type)for(var Ue=0;Ue<Ae.features.length;Ue++)pl($e,Ae.features[Ue],Ie,Ue);else pl($e,"Feature"===Ae.type?Ae:{geometry:Ae},Ie);return $e}(we,se);this.tiles={},this.tileCoords=[],ue&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",se.indexMaxZoom,se.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Ae=xe,Ie=se,$e=Ie.buffer/Ie.extent,Ue=Ae,Oe=rr(Ae,1,-1-$e,$e,0,-1,2,Ie),We=rr(Ae,1,1-$e,2+$e,0,-1,2,Ie),(Oe||We)&&(Ue=rr(Ae,1,-$e,1+$e,0,-1,2,Ie)||[],Oe&&(Ue=gl(Oe,1).concat(Ue)),We&&(Ue=Ue.concat(gl(We,-1)))),xe=Ue).length&&this.splitTile(xe,0,0,0),ue&&(xe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ca(we,se,ue){return 32*((1<<we)*ue+se)+we}function ja(we,se){const ue=we.tileID.canonical;if(!this._geoJSONIndex)return se(null,null);const xe=this._geoJSONIndex.getTile(ue.z,ue.x,ue.y);if(!xe)return se(null,null);const Ae=new Cr(xe.features);let Ie=On(Ae);0===Ie.byteOffset&&Ie.byteLength===Ie.buffer.byteLength||(Ie=new Uint8Array(Ie)),se(null,{vectorTile:Ae,rawData:Ie.buffer})}Ei.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ei.prototype.splitTile=function(we,se,ue,xe,Ae,Ie,$e){for(var Ue=[we,se,ue,xe],Oe=this.options,We=Oe.debug;Ue.length;){xe=Ue.pop(),ue=Ue.pop(),se=Ue.pop(),we=Ue.pop();var at=1<<se,Tt=Ca(se,ue,xe),te=this.tiles[Tt];if(!te&&(We>1&&console.time("creation"),te=this.tiles[Tt]=zo(we,se,ue,xe,Oe),this.tileCoords.push({z:se,x:ue,y:xe}),We)){We>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",se,ue,xe,te.numFeatures,te.numPoints,te.numSimplified),console.timeEnd("creation"));var o="z"+se;this.stats[o]=(this.stats[o]||0)+1,this.total++}if(te.source=we,Ae){if(se===Oe.maxZoom||se===Ae)continue;var a=1<<Ae-se;if(ue!==Math.floor(Ie/a)||xe!==Math.floor($e/a))continue}else if(se===Oe.indexMaxZoom||te.numPoints<=Oe.indexMaxPoints)continue;if(te.source=null,0!==we.length){We>1&&console.time("clipping");var d,g,_,D,C,T,P=.5*Oe.buffer/Oe.extent,L=.5-P,B=.5+P,V=1+P;d=g=_=D=null,C=rr(we,at,ue-P,ue+B,0,te.minX,te.maxX,Oe),T=rr(we,at,ue+L,ue+V,0,te.minX,te.maxX,Oe),we=null,C&&(d=rr(C,at,xe-P,xe+B,1,te.minY,te.maxY,Oe),g=rr(C,at,xe+L,xe+V,1,te.minY,te.maxY,Oe),C=null),T&&(_=rr(T,at,xe-P,xe+B,1,te.minY,te.maxY,Oe),D=rr(T,at,xe+L,xe+V,1,te.minY,te.maxY,Oe),T=null),We>1&&console.timeEnd("clipping"),Ue.push(d||[],se+1,2*ue,2*xe),Ue.push(g||[],se+1,2*ue,2*xe+1),Ue.push(_||[],se+1,2*ue+1,2*xe),Ue.push(D||[],se+1,2*ue+1,2*xe+1)}}},Ei.prototype.getTile=function(we,se,ue){var xe=this.options,Ae=xe.extent,Ie=xe.debug;if(we<0||we>24)return null;var $e=1<<we,Ue=Ca(we,se=(se%$e+$e)%$e,ue);if(this.tiles[Ue])return ml(this.tiles[Ue],Ae);Ie>1&&console.log("drilling down to z%d-%d-%d",we,se,ue);for(var Oe,We=we,at=se,Tt=ue;!Oe&&We>0;)We--,at=Math.floor(at/2),Tt=Math.floor(Tt/2),Oe=this.tiles[Ca(We,at,Tt)];return Oe&&Oe.source?(Ie>1&&console.log("found parent tile z%d-%d-%d",We,at,Tt),Ie>1&&console.time("drilling down"),this.splitTile(Oe.source,We,at,Tt,we,se,ue),Ie>1&&console.timeEnd("drilling down"),this.tiles[Ue]?ml(this.tiles[Ue],Ae):null):null};class Sa extends v.VectorTileWorkerSource{constructor(se,ue,xe,Ae,Ie){super(se,ue,xe,Ae,ja),Ie&&(this.loadGeoJSON=Ie)}loadData(se,ue){const xe=se&&se.request,Ae=xe&&xe.collectResourceTiming;this.loadGeoJSON(se,(Ie,$e)=>{if(Ie||!$e)return ue(Ie);if("object"!=typeof $e)return ue(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`));{$t($e,!0);try{if(se.filter){const Oe=v.createExpression(se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Oe.result)throw new Error(Oe.value.map(at=>`${at.key}: ${at.message}`).join(", "));const We=$e.features.filter(at=>Oe.value.evaluate({zoom:0},at));$e={type:"FeatureCollection",features:We}}this._geoJSONIndex=se.cluster?new ua(function({superclusterOptions:Oe,clusterProperties:We}){if(!We||!Oe)return Oe;const at={},Tt={},te={accumulated:null,zoom:0},o={properties:null},a=Object.keys(We);for(const d of a){const[g,_]=We[d],D=v.createExpression(_),C=v.createExpression("string"==typeof g?[g,["accumulated"],["get",d]]:g);at[d]=D.value,Tt[d]=C.value}return Oe.map=d=>{o.properties=d;const g={};for(const _ of a)g[_]=at[_].evaluate(te,o);return g},Oe.reduce=(d,g)=>{o.properties=g;for(const _ of a)te.accumulated=d[_],d[_]=Tt[_].evaluate(te,o)},Oe}(se)).load($e.features):new Ei(Oe=$e,se.geojsonVtOptions)}catch(Oe){return ue(Oe)}this.loaded={};const Ue={};if(Ae){const Oe=v.getPerformanceMeasurement(xe);Oe&&(Ue.resourceTiming={},Ue.resourceTiming[se.source]=JSON.parse(JSON.stringify(Oe)))}ue(null,Ue)}var Oe})}reloadTile(se,ue){const xe=this.loaded;return xe&&xe[se.uid]?super.reloadTile(se,ue):this.loadTile(se,ue)}loadGeoJSON(se,ue){if(se.request)v.getJSON(se.request,ue);else{if("string"!=typeof se.data)return ue(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`));try{return ue(null,JSON.parse(se.data))}catch(xe){return ue(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(se,ue){try{ue(null,this._geoJSONIndex.getClusterExpansionZoom(se.clusterId))}catch(xe){ue(xe)}}getClusterChildren(se,ue){try{ue(null,this._geoJSONIndex.getChildren(se.clusterId))}catch(xe){ue(xe)}}getClusterLeaves(se,ue){try{ue(null,this._geoJSONIndex.getLeaves(se.clusterId,se.limit,se.offset))}catch(xe){ue(xe)}}}class Da{constructor(se){this.self=se,this.actor=new v.Actor(se,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=v.getProjection({name:"mercator"}),this.workerSourceTypes={vector:v.VectorTileWorkerSource,geojson:Sa},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ue,xe)=>{if(this.workerSourceTypes[ue])throw new Error(`Worker source with name "${ue}" already registered.`);this.workerSourceTypes[ue]=xe},this.self.registerRTLTextPlugin=ue=>{if(v.plugin.isParsed())throw new Error("RTL text plugin already registered.");v.plugin.applyArabicShaping=ue.applyArabicShaping,v.plugin.processBidirectionalText=ue.processBidirectionalText,v.plugin.processStyledBidirectionalText=ue.processStyledBidirectionalText}}clearCaches(se,ue,xe){delete this.layerIndexes[se],delete this.availableImages[se],delete this.workerSources[se],delete this.demWorkerSources[se],xe()}checkIfReady(se,ue,xe){xe()}setReferrer(se,ue){this.referrer=ue}spriteLoaded(se,ue){this.isSpriteLoaded[se]=ue;for(const xe in this.workerSources[se]){const Ae=this.workerSources[se][xe];for(const Ie in Ae)Ae[Ie]instanceof v.VectorTileWorkerSource&&(Ae[Ie].isSpriteLoaded=ue,Ae[Ie].fire(new v.Event("isSpriteLoaded")))}}setImages(se,ue,xe){this.availableImages[se]=ue;for(const Ae in this.workerSources[se]){const Ie=this.workerSources[se][Ae];for(const $e in Ie)Ie[$e].availableImages=ue}xe()}enableTerrain(se,ue,xe){this.terrain=ue,xe()}setProjection(se,ue){this.projections[se]=v.getProjection(ue)}setLayers(se,ue,xe){this.getLayerIndex(se).replace(ue),xe()}updateLayers(se,ue,xe){this.getLayerIndex(se).update(ue.layers,ue.removedIds),xe()}loadTile(se,ue,xe){const Ae=this.enableTerrain?v.extend({enableTerrain:this.terrain},ue):ue;Ae.projection=this.projections[se]||this.defaultProjection,this.getWorkerSource(se,ue.type,ue.source).loadTile(Ae,xe)}loadDEMTile(se,ue,xe){const Ae=this.enableTerrain?v.extend({buildQuadTree:this.terrain},ue):ue;this.getDEMWorkerSource(se,ue.source).loadTile(Ae,xe)}reloadTile(se,ue,xe){const Ae=this.enableTerrain?v.extend({enableTerrain:this.terrain},ue):ue;Ae.projection=this.projections[se]||this.defaultProjection,this.getWorkerSource(se,ue.type,ue.source).reloadTile(Ae,xe)}abortTile(se,ue,xe){this.getWorkerSource(se,ue.type,ue.source).abortTile(ue,xe)}removeTile(se,ue,xe){this.getWorkerSource(se,ue.type,ue.source).removeTile(ue,xe)}removeSource(se,ue,xe){if(!this.workerSources[se]||!this.workerSources[se][ue.type]||!this.workerSources[se][ue.type][ue.source])return;const Ae=this.workerSources[se][ue.type][ue.source];delete this.workerSources[se][ue.type][ue.source],void 0!==Ae.removeSource?Ae.removeSource(ue,xe):xe()}loadWorkerSource(se,ue,xe){try{this.self.importScripts(ue.url),xe()}catch(Ae){xe(Ae.toString())}}syncRTLPluginState(se,ue,xe){try{v.plugin.setState(ue);const Ae=v.plugin.getPluginURL();if(v.plugin.isLoaded()&&!v.plugin.isParsed()&&null!=Ae){this.self.importScripts(Ae);const Ie=v.plugin.isParsed();xe(Ie?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ae}`),Ie)}}catch(Ae){xe(Ae.toString())}}getAvailableImages(se){let ue=this.availableImages[se];return ue||(ue=[]),ue}getLayerIndex(se){let ue=this.layerIndexes[se];return ue||(ue=this.layerIndexes[se]=new Nr),ue}getWorkerSource(se,ue,xe){return this.workerSources[se]||(this.workerSources[se]={}),this.workerSources[se][ue]||(this.workerSources[se][ue]={}),this.workerSources[se][ue][xe]||(this.workerSources[se][ue][xe]=new this.workerSourceTypes[ue]({send:(Ae,Ie,$e,Ue,Oe,We)=>{this.actor.send(Ae,Ie,$e,se,Oe,We)},scheduler:this.actor.scheduler},this.getLayerIndex(se),this.getAvailableImages(se),this.isSpriteLoaded[se])),this.workerSources[se][ue][xe]}getDEMWorkerSource(se,ue){return this.demWorkerSources[se]||(this.demWorkerSources[se]={}),this.demWorkerSources[se][ue]||(this.demWorkerSources[se][ue]=new ht),this.demWorkerSources[se][ue]}enforceCacheSizeLimit(se,ue){v.enforceCacheSizeLimit(ue)}getWorkerPerformanceMetrics(se,ue,xe){xe(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Da(self)),Da}),nr(0,function(v){var St=Cs;function Cs(x){return l=x,!("undefined"==typeof window||"undefined"==typeof document||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,A,M=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(M);try{A=new Worker(O),w=!0}catch(U){w=!1}return A&&A.terminate(),URL.revokeObjectURL(O),w}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var w=document.createElement("canvas");w.width=w.height=1;var A=w.getContext("2d");if(!A)return!1;var M=A.getImageData(0,0,1,1);return M&&M.width===w.width}()||(void 0===Nr[f=l&&l.failIfMajorPerformanceCaveat]&&(Nr[f]=function(w){var A,O,U,X,M=(O=w,U=document.createElement("canvas"),(X=Object.create(Cs.webGLContextAttributes)).failIfMajorPerformanceCaveat=O,U.getContext("webgl",X)||U.getContext("experimental-webgl",X));if(!M)return!1;try{A=M.createShader(M.VERTEX_SHADER)}catch(O){return!1}return!(!A||M.isContextLost())&&(M.shaderSource(A,"void main() {}"),M.compileShader(A),!0===M.getShaderParameter(A,M.COMPILE_STATUS))}(f)),!Nr[f]||document.documentMode));var l,f}var Nr={};function Je(x,l){if(Array.isArray(x)){if(!Array.isArray(l)||x.length!==l.length)return!1;for(let f=0;f<x.length;f++)if(!Je(x[f],l[f]))return!1;return!0}if("object"==typeof x&&null!==x&&null!==l){if("object"!=typeof l||Object.keys(x).length!==Object.keys(l).length)return!1;for(const f in x)if(!Je(x[f],l[f]))return!1;return!0}return x===l}Cs.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ht={create:function(x,l,f){const w=v.window.document.createElement(x);return void 0!==l&&(w.className=l),f&&f.appendChild(w),w},createNS:function(x,l){return v.window.document.createElementNS(x,l)}},$t=v.window.document&&v.window.document.documentElement.style,Ss=$t&&void 0!==$t.userSelect?"userSelect":"WebkitUserSelect";let Ds;ht.disableDrag=function(){$t&&Ss&&(Ds=$t[Ss],$t[Ss]="none")},ht.enableDrag=function(){$t&&Ss&&($t[Ss]=Ds)},ht.setTransform=function(x,l){x.style.transform=l};let co=!1;try{const x=Object.defineProperty({},"passive",{get(){co=!0}});v.window.addEventListener("test",x,x),v.window.removeEventListener("test",x,x)}catch(x){co=!1}ht.addEventListener=function(x,l,f,w={}){x.addEventListener(l,f,"passive"in w&&co?w:w.capture)},ht.removeEventListener=function(x,l,f,w={}){x.removeEventListener(l,f,"passive"in w&&co?w:w.capture)};const wn=function(x){x.preventDefault(),x.stopPropagation(),v.window.removeEventListener("click",wn,!0)};function Cr(x,l,f){const w=x.offsetWidth===l.width?1:x.offsetWidth/l.width;return new v.pointGeometry((f.clientX-l.left)*w,(f.clientY-l.top)*w)}function Xe(x,l){var f=l[0],w=l[1],A=l[2],M=l[3],O=f*M-A*w;return O?(x[0]=M*(O=1/O),x[1]=-w*O,x[2]=-A*O,x[3]=f*O,x):null}ht.suppressClick=function(){v.window.addEventListener("click",wn,!0),v.window.setTimeout(()=>{v.window.removeEventListener("click",wn,!0)},0)},ht.mousePos=function(x,l){const f=x.getBoundingClientRect();return Cr(x,f,l)},ht.touchPos=function(x,l){const f=x.getBoundingClientRect(),w=[];for(let A=0;A<l.length;A++)w.push(Cr(x,f,l[A]));return w},ht.mouseButton=function(x){return void 0!==v.window.InstallTrigger&&2===x.button&&x.ctrlKey&&v.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:x.button},ht.remove=function(x){x.parentNode&&x.parentNode.removeChild(x)};class mr{constructor(l,f){this.pos=l,this.dir=f}intersectsPlane(l,f,w){const A=v.dot(f,this.dir);if(Math.abs(A)<1e-6)return!1;const M=v.dot(v.sub(v.create(),l,this.pos),f)/A,O=v.scaleAndAdd(v.create(),this.pos,this.dir,M);return v.copy(w,O),!0}}class pi{constructor(l,f){this.points=l,this.planes=f}static fromInvProjectionMatrix(l,f,w){const A=Math.pow(2,w),M=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(U=>{const X=v.transformMat4([],U,l),Z=1/X[3]/f*A;return v.mul(X,X,[Z,Z,1/X[3],Z])}),O=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(U=>{const X=v.sub([],M[U[0]],M[U[1]]),Z=v.sub([],M[U[2]],M[U[1]]),ee=v.normalize([],v.cross([],X,Z)),ne=-v.dot(ee,M[U[1]]);return ee.concat(ne)});return new pi(M,O)}}class yt{constructor(l,f){this.min=l,this.max=f,this.center=v.scale([],v.add([],this.min,this.max),.5)}quadrant(l){const f=[l%2==0,l<2],w=v.clone(this.min),A=v.clone(this.max);for(let M=0;M<f.length;M++)w[M]=f[M]?this.min[M]:this.center[M],A[M]=f[M]?this.center[M]:this.max[M];return A[2]=this.max[2],new yt(w,A)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}distanceZ(l){return Math.max(Math.min(this.max[2],l[2]),this.min[2])-l[2]}intersects(l){const f=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let w=!0;for(let A=0;A<l.planes.length;A++){const M=l.planes[A];let O=0;for(let U=0;U<f.length;U++)O+=v.dot$1(M,f[U])>=0;if(0===O)return 0;O!==f.length&&(w=!1)}if(w)return 2;for(let A=0;A<3;A++){let M=Number.MAX_VALUE,O=-Number.MAX_VALUE;for(let U=0;U<l.points.length;U++){const X=l.points[U][A]-this.min[A];M=Math.min(M,X),O=Math.max(O,X)}if(O<0||M>this.max[A]-this.min[A])return 0}return 1}}function On(x){const{userImage:l}=x;return!!(l&&l.render&&l.render())&&(x.data.replace(new Uint8Array(l.data.buffer)),!0)}class Ro extends v.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new v.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:f,callback:w}of this.requestors)this._notify(f,w);this.requestors=[]}}getImage(l){return this.images[l]}addImage(l,f){this._validate(l,f)&&(this.images[l]=f)}_validate(l,f){let w=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new v.ErrorEvent(new Error(`Image "${l}" has invalid "stretchX" value`))),w=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new v.ErrorEvent(new Error(`Image "${l}" has invalid "stretchY" value`))),w=!1),this._validateContent(f.content,f)||(this.fire(new v.ErrorEvent(new Error(`Image "${l}" has invalid "content" value`))),w=!1),w}_validateStretch(l,f){if(!l)return!0;let w=0;for(const A of l){if(A[0]<w||A[1]<A[0]||f<A[1])return!1;w=A[1]}return!0}_validateContent(l,f){return!(l&&(4!==l.length||l[0]<0||f.data.width<l[0]||l[1]<0||f.data.height<l[1]||l[2]<0||f.data.width<l[2]||l[3]<0||f.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,f){f.version=this.images[l].version+1,this.images[l]=f,this.updatedImages[l]=!0}removeImage(l){const f=this.images[l];delete this.images[l],delete this.patterns[l],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l,f){let w=!0;if(!this.isLoaded())for(const A of l)this.images[A]||(w=!1);this.isLoaded()||w?this._notify(l,f):this.requestors.push({ids:l,callback:f})}_notify(l,f){const w={};for(const A of l){this.images[A]||this.fire(new v.Event("styleimagemissing",{id:A}));const M=this.images[A];M?w[A]={data:M.data.clone(),pixelRatio:M.pixelRatio,sdf:M.sdf,version:M.version,stretchX:M.stretchX,stretchY:M.stretchY,content:M.content,hasRenderCallback:Boolean(M.userImage&&M.userImage.render)}:v.warnOnce(`Image "${A}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}f(null,w)}getPixelSize(){const{width:l,height:f}=this.atlasImage;return{width:l,height:f}}getPattern(l){const f=this.patterns[l],w=this.getImage(l);if(!w)return null;if(f&&f.position.version===w.version)return f.position;if(f)f.position.version=w.version;else{const A={w:w.data.width+2,h:w.data.height+2,x:0,y:0},M=new v.ImagePosition(A,w);this.patterns[l]={bin:A,position:M}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const f=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new v.Texture(l,this.atlasImage,f.RGBA),this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const M in this.patterns)l.push(this.patterns[M].bin);const{w:f,h:w}=v.potpack(l),A=this.atlasImage;A.resize({width:f||1,height:w||1});for(const M in this.patterns){const{bin:O}=this.patterns[M],U=O.x+1,X=O.y+1,Z=this.images[M].data,ee=Z.width,ne=Z.height;v.RGBAImage.copy(Z,A,{x:0,y:0},{x:U,y:X},{width:ee,height:ne}),v.RGBAImage.copy(Z,A,{x:0,y:ne-1},{x:U,y:X-1},{width:ee,height:1}),v.RGBAImage.copy(Z,A,{x:0,y:0},{x:U,y:X+ne},{width:ee,height:1}),v.RGBAImage.copy(Z,A,{x:ee-1,y:0},{x:U-1,y:X},{width:1,height:ne}),v.RGBAImage.copy(Z,A,{x:0,y:0},{x:U+ee,y:X},{width:1,height:ne})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const f of l){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const w=this.images[f];On(w)&&this.updateImage(f,w)}}}const fi=new v.Properties({anchor:new v.DataConstantProperty(v.spec.light.anchor),position:new class{constructor(){this.specification=v.spec.light.position}possiblyEvaluate(x,l){return function([f,w,A]){const M=v.degToRad(w+90),O=v.degToRad(A);return{x:f*Math.cos(M)*Math.sin(O),y:f*Math.sin(M)*Math.sin(O),z:f*Math.cos(O),azimuthal:w,polar:A}}(x.expression.evaluate(l))}interpolate(x,l,f){return{x:v.number(x.x,l.x,f),y:v.number(x.y,l.y,f),z:v.number(x.z,l.z,f),azimuthal:v.number(x.azimuthal,l.azimuthal,f),polar:v.number(x.polar,l.polar,f)}}},color:new v.DataConstantProperty(v.spec.light.color),intensity:new v.DataConstantProperty(v.spec.light.intensity)}),va="-transition";class Mi extends v.Evented{constructor(l){super(),this._transitionable=new v.Transitionable(fi),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,f={}){if(!this._validate(v.validateLight,l,f))for(const w in l){const A=l[w];v.endsWith(w,va)?this._transitionable.setTransition(w.slice(0,-va.length),A):this._transitionable.setValue(w,A)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,f,w){return(!w||!1!==w.validate)&&v.emitValidationErrors(this,l.call(v.validateStyle,v.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:v.spec})))}}const cc=new v.Properties({source:new v.DataConstantProperty(v.spec.terrain.source),exaggeration:new v.DataConstantProperty(v.spec.terrain.exaggeration)}),Fr="-transition";class as extends v.Evented{constructor(l){super(),this._transitionable=new v.Transitionable(cc),this.set(l),this._transitioning=this._transitionable.untransitioned()}get(){return this._transitionable.serialize()}set(l){for(const f in l){const w=l[f];v.endsWith(f,Fr)?this._transitionable.setTransition(f.slice(0,-Fr.length),w):this._transitionable.setValue(f,w)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}}function Xr(x,l,f,w){const A=v.smoothstep(45,65,f),[M,O]=uo(x,w),U=v.length(l);let X=1-Math.min(1,Math.exp((U-M)/(O-M)*-6));return X*=X*X,X=Math.min(1,1.00747*X),X*A*x.alpha}function uo(x,l){const f=.5/Math.tan(.5*l);return[x.range[0]+f,x.range[1]+f]}const Cn=new v.Properties({range:new v.DataConstantProperty(v.spec.fog.range),color:new v.DataConstantProperty(v.spec.fog.color),"horizon-blend":new v.DataConstantProperty(v.spec.fog["horizon-blend"])}),ls="-transition";class No extends v.Evented{constructor(l,f){super(),this._transitionable=new v.Transitionable(Cn),this.set(l),this._transitioning=this._transitionable.untransitioned(),this._transform=f}isSoftDisabled(){return"mercator"!==this._transform.projection.name}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(l,f={}){if(!this._validate(v.validateFog,l,f))for(const w in l){const A=l[w];v.endsWith(w,ls)?this._transitionable.setTransition(w.slice(0,-ls.length),A):this._transitionable.setValue(w,A)}}getOpacity(l){if(this.isSoftDisabled())return 0;const f=this.properties&&this.properties.get("color")||1;return v.smoothstep(45,65,l)*f.a}getOpacityAtLatLng(l,f){return this.isSoftDisabled()?0:function(w,A,M){const O=v.MercatorCoordinate.fromLngLat(A),U=M.elevation?M.elevation.getAtPointOrZero(O):0,X=[O.x,O.y,U];return v.transformMat4$1(X,X,M.mercatorFogMatrix),Xr(w,X,M.pitch,M._fov)}(this.state,l,f)}getFovAdjustedRange(l){return this.isSoftDisabled()?[0,1]:uo(this.state,l)}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,f,w){return(!w||!1!==w.validate)&&v.emitValidationErrors(this,l.call(v.validateStyle,v.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:v.spec})))}}class Bi{constructor(l,f){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=v.uniqueId();const w=this.workerPool.acquire(this.id);for(let A=0;A<w.length;A++){const M=new Bi.Actor(w[A],f,this.id);M.name=`Worker ${A}`,this.actors.push(M)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(l,f,w){v.asyncAll(this.actors,(A,M)=>{A.send(l,f,M)},w=w||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(l=>{l.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ir(x,l,f){return l*(v.EXTENT/(x.tileSize*Math.pow(2,f-x.tileID.overscaledZ)))}Bi.Actor=v.Actor;class Dn{constructor(l,f,w,A){this.screenBounds=l,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=w,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(M=>A.pointCoordinate3D(M)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(l,f){let w,A;if(l instanceof v.pointGeometry||"number"==typeof l[0]){const M=v.pointGeometry.convert(l);w=[v.pointGeometry.convert(l)],A=f.isPointAboveHorizon(M)}else{const M=v.pointGeometry.convert(l[0]),O=v.pointGeometry.convert(l[1]);w=[M,O],A=v.polygonizeBounds(M,O).every(U=>f.isPointAboveHorizon(U))}return new Dn(w,f.getCameraPoint(),A,f)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(l){return v.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],l)}bufferedCameraGeometry(l){const f=this.screenBounds[0],w=1===this.screenBounds.length?this.screenBounds[0].add(new v.pointGeometry(1,1)):this.screenBounds[1],A=v.polygonizeBounds(f,w,0,!1);return this.cameraPoint.y>w.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<w.x?A.splice(3,0,this.cameraPoint):this.cameraPoint.x>=w.x?A[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(A[3]=this.cameraPoint)),v.bufferConvexPolygon(A,l)}containsTile(l,f,w){const A=l.queryPadding+1,M=l.tileID.wrap,O=w?this._bufferedCameraMercator(A,f).map(me=>v.getTilePoint(l.tileTransform,me,M)):this._bufferedScreenMercator(A,f).map(me=>v.getTilePoint(l.tileTransform,me,M)),U=this.screenGeometryMercator.map(me=>v.getTileVec3(l.tileTransform,me,M)),X=U.map(me=>new v.pointGeometry(me[0],me[1])),Z=f.getFreeCameraOptions().position||new v.MercatorCoordinate(0,0,0),ee=v.getTileVec3(l.tileTransform,Z,M),ne=U.map(me=>{const _e=v.sub(me,me,ee);return v.normalize(_e,_e),new mr(ee,_e)}),de=ir(l,1,f.zoom);if(v.polygonIntersectsBox(O,0,0,v.EXTENT,v.EXTENT))return{queryGeometry:this,tilespaceGeometry:X,tilespaceRays:ne,bufferedTilespaceGeometry:O,bufferedTilespaceBounds:(ye=v.getBounds(O),ye.min.x=v.clamp(ye.min.x,0,v.EXTENT),ye.min.y=v.clamp(ye.min.y,0,v.EXTENT),ye.max.x=v.clamp(ye.max.x,0,v.EXTENT),ye.max.y=v.clamp(ye.max.y,0,v.EXTENT),ye),tile:l,tileID:l.tileID,pixelToTileUnitsFactor:de};var ye}_bufferedScreenMercator(l,f){const w=mn(l);if(this._screenRaycastCache[w])return this._screenRaycastCache[w];{const A=this.bufferedScreenGeometry(l).map(M=>f.pointCoordinate3D(M));return this._screenRaycastCache[w]=A,A}}_bufferedCameraMercator(l,f){const w=mn(l);if(this._cameraRaycastCache[w])return this._cameraRaycastCache[w];{const A=this.bufferedCameraGeometry(l).map(M=>f.pointCoordinate3D(M));return this._cameraRaycastCache[w]=A,A}}}function mn(x){return 100*x|0}function Or(x,l,f){const w=function(A,M){if(A)return f(A);if(M){const O=v.pick(v.extend(M,x),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(O.vectorLayers=M.vector_layers,O.vectorLayerIds=O.vectorLayers.map(U=>U.id)),O.tiles=l.canonicalizeTileset(O,x.url),f(null,O)}};return x.url?v.getJSON(l.transformRequest(l.normalizeSourceURL(x.url),v.ResourceType.Source),w):v.exported.frame(()=>w(null,x))}class ni{constructor(l,f,w){this.bounds=v.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=f||0,this.maxzoom=w||24}validateBounds(l){return Array.isArray(l)&&4===l.length?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const f=Math.pow(2,l.z),w=Math.floor(v.mercatorXfromLng(this.bounds.getWest())*f),A=Math.floor(v.mercatorYfromLat(this.bounds.getNorth())*f),M=Math.ceil(v.mercatorXfromLng(this.bounds.getEast())*f),O=Math.ceil(v.mercatorYfromLat(this.bounds.getSouth())*f);return l.x>=w&&l.x<M&&l.y>=A&&l.y<O}}class vn{constructor(l,f,w){this.context=l;const A=l.gl;this.buffer=A.createBuffer(),this.dynamicDraw=Boolean(w),this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Kt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ua{constructor(l,f,w,A){this.length=f.length,this.attributes=w,this.itemSize=f.bytesPerElement,this.dynamicDraw=A,this.context=l;const M=l.gl;this.buffer=M.createBuffer(),l.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,f){for(let w=0;w<this.attributes.length;w++){const A=f.attributes[this.attributes[w].name];void 0!==A&&l.enableVertexAttribArray(A)}}setVertexAttribPointers(l,f,w){for(let A=0;A<this.attributes.length;A++){const M=this.attributes[A],O=f.attributes[M.name];void 0!==O&&l.vertexAttribPointer(O,M.components,l[Kt[M.type]],!1,this.itemSize,M.offset+this.itemSize*(w||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Tn{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ho extends Tn{getDefault(){return v.Color.transparent}set(l){const f=this.current;(l.r!==f.r||l.g!==f.g||l.b!==f.b||l.a!==f.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Us extends Tn{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class Va extends Tn{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class po extends Tn{getDefault(){return[!0,!0,!0,!0]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||l[3]!==f[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class cs extends Tn{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class Hs extends Tn{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class xn extends Tn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const f=this.current;(l.func!==f.func||l.ref!==f.ref||l.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class fo extends Tn{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class xa extends Tn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;l?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=l,this.dirty=!1}}class js extends Tn{getDefault(){return[0,1]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class hl extends Tn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;l?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=l,this.dirty=!1}}class Fo extends Tn{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class dl extends Tn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;l?f.enable(f.BLEND):f.disable(f.BLEND),this.current=l,this.dirty=!1}}class pl extends Tn{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class Es extends Tn{getDefault(){return v.Color.transparent}set(l){const f=this.current;(l.r!==f.r||l.g!==f.g||l.b!==f.b||l.a!==f.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class As extends Tn{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class ba extends Tn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;l?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=l,this.dirty=!1}}class uc extends Tn{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class $s extends Tn{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class rr extends Tn{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class tu extends Tn{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class Ua extends Tn{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||l[3]!==f[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class fl extends Tn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class hc extends Tn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Oo extends Tn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class dc extends Tn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Ha extends Tn{getDefault(){return null}set(l){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class gl extends Tn{constructor(l){super(l),this.vao=l.extVertexArrayObject}getDefault(){return null}set(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)}}class Lo extends Tn{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class ml extends Tn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class us extends Tn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class zo extends Tn{constructor(l,f){super(l),this.context=l,this.parent=f}getDefault(){return null}}class wa extends zo{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Bo extends zo{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Ei extends Bo{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ca{constructor(l,f,w,A){this.context=l,this.width=f,this.height=w;const M=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new wa(l,M),A&&(this.depthAttachment=new Bo(l,M))}destroy(){const l=this.context.gl,f=this.colorAttachment.get();if(f&&l.deleteTexture(f),this.depthAttachment){const w=this.depthAttachment.get();w&&l.deleteRenderbuffer(w)}l.deleteFramebuffer(this.framebuffer)}}class ja{constructor(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ho(this),this.clearDepth=new Us(this),this.clearStencil=new Va(this),this.colorMask=new po(this),this.depthMask=new cs(this),this.stencilMask=new Hs(this),this.stencilFunc=new xn(this),this.stencilOp=new fo(this),this.stencilTest=new xa(this),this.depthRange=new js(this),this.depthTest=new hl(this),this.depthFunc=new Fo(this),this.blend=new dl(this),this.blendFunc=new pl(this),this.blendColor=new Es(this),this.blendEquation=new As(this),this.cullFace=new ba(this),this.cullFaceSide=new uc(this),this.frontFace=new $s(this),this.program=new rr(this),this.activeTexture=new tu(this),this.viewport=new Ua(this),this.bindFramebuffer=new fl(this),this.bindRenderbuffer=new hc(this),this.bindTexture=new Oo(this),this.bindVertexBuffer=new dc(this),this.bindElementBuffer=new Ha(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new gl(this),this.pixelStoreUnpack=new Lo(this),this.pixelStoreUnpackPremultiplyAlpha=new ml(this),this.pixelStoreUnpackFlipY=new us(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,f){return new vn(this,l,f)}createVertexBuffer(l,f,w){return new ua(this,l,f,w)}createRenderbuffer(l,f,w){const A=this.gl,M=A.createRenderbuffer();return this.bindRenderbuffer.set(M),A.renderbufferStorage(A.RENDERBUFFER,l,f,w),this.bindRenderbuffer.set(null),M}createFramebuffer(l,f,w){return new Ca(this,l,f,w)}clear({color:l,depth:f,stencil:w}){const A=this.gl;let M=0;l&&(M|=A.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),void 0!==f&&(M|=A.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),void 0!==w&&(M|=A.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),A.clear(M)}setCullFace(l){!1===l.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){Je(l.blendFunction,v.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Sa extends v.Evented{constructor(l,f,w,A){super(),this.id=l,this.dispatcher=w,this.setEventedParent(A),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=v.extend({type:"raster"},f),v.extend(this,v.pick(f,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Or(this._options,this.map._requestManager,(l,f)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new v.ErrorEvent(l)):f&&(v.extend(this,f),f.bounds&&(this.tileBounds=new ni(f.bounds,this.minzoom,this.maxzoom)),v.postTurnstileEvent(f.tiles),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return v.extend({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,f){const w=v.exported.devicePixelRatio>=2,A=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),w,this.tileSize);l.request=v.getImage(this.map._requestManager.transformRequest(A,v.ResourceType.Tile),(M,O,U,X)=>{if(delete l.request,l.aborted)l.state="unloaded",f(null);else if(M)l.state="errored",f(M);else if(O){this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:U,expires:X});const Z=this.map.painter.context,ee=Z.gl;l.texture=this.map.painter.getTileTexture(O.width),l.texture?l.texture.update(O,{useMipmap:!0}):(l.texture=new v.Texture(Z,O,ee.RGBA,{useMipmap:!0}),l.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),Z.extTextureFilterAnisotropic&&ee.texParameterf(ee.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax)),l.state="loaded",v.cacheEntryPossiblyAdded(this.dispatcher),f(null)}})}abortTile(l,f){l.request&&(l.request.cancel(),delete l.request),f()}unloadTile(l,f){l.texture&&this.map.painter.saveTileTexture(l.texture),f()}hasTransition(){return!1}}let Da;class we extends v.Evented{constructor(l,f,w,A){super(),this.id=l,this.dispatcher=w,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(A),this.options=f}load(l,f){this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this.url=this.options.url,v.getImage(this.map._requestManager.transformRequest(this.url,v.ResourceType.Image),(w,A)=>{this._loaded=!0,w?this.fire(new v.ErrorEvent(w)):A&&(this.image=v.exported.getImageData(A),l&&(this.coordinates=l),f&&f(),this._finishLoading())})}loaded(){return this._loaded}updateImage(l){return this.image&&l.url?(this.options.url=l.url,this.load(l.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}setCoordinates(l){this.coordinates=l,delete this._boundsArray;const f=l.map(v.MercatorCoordinate.fromLngLat);return this.tileID=function(w){let A=1/0,M=1/0,O=-1/0,U=-1/0;for(const ne of w)A=Math.min(A,ne.x),M=Math.min(M,ne.y),O=Math.max(O,ne.x),U=Math.max(U,ne.y);const X=Math.max(O-A,U-M),Z=Math.max(0,Math.floor(-Math.log(X)/Math.LN2)),ee=Math.pow(2,Z);return new v.CanonicalTileID(Z,Math.floor((A+O)/2*ee),Math.floor((M+U)/2*ee))}(f),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){delete this._boundsArray}_makeBoundsArray(){const l=v.tileTransform(this.tileID,this.map.transform.projection),f=this.coordinates.map(w=>{const A=l.projection.project(w[0],w[1]);return v.getTilePoint(l,A)._round()});return this._boundsArray=new v.StructArrayLayout4i8,this._boundsArray.emplaceBack(f[0].x,f[0].y,0,0),this._boundsArray.emplaceBack(f[1].x,f[1].y,v.EXTENT,0),this._boundsArray.emplaceBack(f[3].x,f[3].y,0,v.EXTENT),this._boundsArray.emplaceBack(f[2].x,f[2].y,v.EXTENT,v.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const l=this.map.painter.context,f=l.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,v.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new v.Texture(l,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));for(const w in this.tiles){const A=this.tiles[w];"loaded"!==A.state&&(A.state="loaded",A.texture=this.texture)}}loadTile(l,f){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},f(null)):(l.state="errored",f(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const se={vector:class extends v.Evented{constructor(x,l,f,w){if(super(),this.id=x,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,v.extend(this,v.pick(l,["url","scheme","tileSize","promoteId"])),this._options=v.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new v.DedupedRequest}load(){this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Or(this._options,this.map._requestManager,(x,l)=>{this._tileJSONRequest=null,this._loaded=!0,x?this.fire(new v.ErrorEvent(x)):l&&(v.extend(this,l),l.bounds&&(this.tileBounds=new ni(l.bounds,this.minzoom,this.maxzoom)),v.postTurnstileEvent(l.tiles,this.map._requestManager._customAccessToken),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(x){return!this.tileBounds||this.tileBounds.contains(x.canonical)}onAdd(x){this.map=x,this.load()}setSourceProperty(x){this._tileJSONRequest&&this._tileJSONRequest.cancel(),x();const l=this.map.style._getSourceCaches(this.id);for(const f of l)f.clearTiles();this.load()}setTiles(x){return this.setSourceProperty(()=>{this._options.tiles=x}),this}setUrl(x){return this.setSourceProperty(()=>{this.url=x,this._options.url=x}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return v.extend({},this._options)}loadTile(x,l){const f=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(f,v.ResourceType.Tile),data:void 0,uid:x.uid,tileID:x.tileID,tileZoom:x.tileZoom,zoom:x.tileID.overscaledZ,tileSize:this.tileSize*x.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:v.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:x.isSymbolTile};if(w.request.collectResourceTiming=this._collectResourceTiming,x.actor&&"expired"!==x.state)"loading"===x.state?x.reloadCallback=l:x.request=x.actor.send("reloadTile",w,A.bind(this));else if(x.actor=this._tileWorkers[f]=this._tileWorkers[f]||this.dispatcher.getActor(),this.dispatcher.ready)x.request=x.actor.send("loadTile",w,A.bind(this),void 0,!0);else{const M=v.loadVectorTile.call({deduped:this._deduped},w,(O,U)=>{O||!U?A.call(this,O):(w.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},x.actor&&x.actor.send("loadTile",w,A.bind(this),void 0,!0))},!0);x.request={cancel:M}}function A(M,O){return delete x.request,x.aborted?l(null):M&&404!==M.status?l(M):(O&&O.resourceTiming&&(x.resourceTiming=O.resourceTiming),this.map._refreshExpiredTiles&&O&&x.setExpiryData(O),x.loadVectorData(O,this.map.painter),v.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(x.reloadCallback&&(this.loadTile(x,x.reloadCallback),x.reloadCallback=null)))}}abortTile(x){x.request&&(x.request.cancel(),delete x.request),x.actor&&x.actor.send("abortTile",{uid:x.uid,type:this.type,source:this.id})}unloadTile(x){x.unloadVectorData(),x.actor&&x.actor.send("removeTile",{uid:x.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:Sa,"raster-dem":class extends Sa{constructor(x,l,f,w){super(x,l,f,w),this.type="raster-dem",this.maxzoom=22,this._options=v.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}loadTile(x,l){const f=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function w(A,M){A&&(x.state="errored",l(A)),M&&(x.dem=M,x.dem.onDeserialize(),x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0,x.state="loaded",l(null))}x.request=v.getImage(this.map._requestManager.transformRequest(f,v.ResourceType.Tile),function(A,M,O,U){if(delete x.request,x.aborted)x.state="unloaded",l(null);else if(A)x.state="errored",l(A);else if(M){this.map._refreshExpiredTiles&&x.setExpiryData({cacheControl:O,expires:U});const X=v.window.ImageBitmap&&M instanceof v.window.ImageBitmap&&(null==Da&&(Da=v.window.OffscreenCanvas&&new v.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof v.window.createImageBitmap),Da),Z=1-(M.width-v.prevPowerOfTwo(M.width))/2;Z<1||x.neighboringTiles||(x.neighboringTiles=this._getNeighboringTiles(x.tileID));const ee=X?M:v.exported.getImageData(M,Z),ne={uid:x.uid,coord:x.tileID,source:this.id,rawImageData:ee,encoding:this.encoding,padding:Z};x.actor&&"expired"!==x.state||(x.actor=this.dispatcher.getActor(),x.actor.send("loadDEMTile",ne,w.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(x){const l=x.canonical,f=Math.pow(2,l.z),w=(l.x-1+f)%f,A=0===l.x?x.wrap-1:x.wrap,M=(l.x+1+f)%f,O=l.x+1===f?x.wrap+1:x.wrap,U={};return U[new v.OverscaledTileID(x.overscaledZ,A,l.z,w,l.y).key]={backfilled:!1},U[new v.OverscaledTileID(x.overscaledZ,O,l.z,M,l.y).key]={backfilled:!1},l.y>0&&(U[new v.OverscaledTileID(x.overscaledZ,A,l.z,w,l.y-1).key]={backfilled:!1},U[new v.OverscaledTileID(x.overscaledZ,x.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},U[new v.OverscaledTileID(x.overscaledZ,O,l.z,M,l.y-1).key]={backfilled:!1}),l.y+1<f&&(U[new v.OverscaledTileID(x.overscaledZ,A,l.z,w,l.y+1).key]={backfilled:!1},U[new v.OverscaledTileID(x.overscaledZ,x.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},U[new v.OverscaledTileID(x.overscaledZ,O,l.z,M,l.y+1).key]={backfilled:!1}),U}unloadTile(x){x.demTexture&&this.map.painter.saveTileTexture(x.demTexture),x.fbo&&(x.fbo.destroy(),delete x.fbo),x.dem&&delete x.dem,delete x.neighboringTiles,x.state="unloaded"}},geojson:class extends v.Evented{constructor(x,l,f,w){super(),this.id=x,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(w),this._data=l.data,this._options=v.extend({},l),this._collectResourceTiming=l.collectResourceTiming,void 0!==l.maxzoom&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const A=v.EXTENT/this.tileSize;this.workerOptions=v.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(void 0!==l.buffer?l.buffer:128)*A,tolerance:(void 0!==l.tolerance?l.tolerance:.375)*A,extent:v.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:void 0!==l.clusterMaxZoom?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:v.EXTENT,radius:(void 0!==l.clusterRadius?l.clusterRadius:50)*A,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}onAdd(x){this.map=x,this.setData(this._data)}setData(x){return this._data=x,this._updateWorkerData(),this}getClusterExpansionZoom(x,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:x,source:this.id},l),this}getClusterChildren(x,l){return this.actor.send("geojson.getClusterChildren",{clusterId:x,source:this.id},l),this}getClusterLeaves(x,l,f,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:x,limit:l,offset:f},w),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new v.Event("dataloading",{dataType:"source"})),this._loaded=!1;const x=v.extend({},this.workerOptions),l=this._data;"string"==typeof l?(x.request=this.map._requestManager.transformRequest(v.exported.resolveURL(l),v.ResourceType.Source),x.request.collectResourceTiming=this._collectResourceTiming):x.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,x,(f,w)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new v.ErrorEvent(f));else{const A={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&w&&w.resourceTiming&&w.resourceTiming[this.id]&&(A.resourceTiming=w.resourceTiming[this.id]),this.fire(new v.Event("data",A)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(x,l){const f=x.actor?"reloadTile":"loadTile";x.actor=this.actor,x.request=this.actor.send(f,{type:this.type,uid:x.uid,tileID:x.tileID,tileZoom:x.tileZoom,zoom:x.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:v.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(w,A)=>(delete x.request,x.unloadVectorData(),x.aborted?l(null):w?l(w):(x.loadVectorData(A,this.map.painter,"reloadTile"===f),l(null))),void 0,"loadTile"===f)}abortTile(x){x.request&&(x.request.cancel(),delete x.request),x.aborted=!0}unloadTile(x){x.unloadVectorData(),this.actor.send("removeTile",{uid:x.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return v.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends we{constructor(x,l,f,w){super(x,l,f,w),this.roundZoom=!0,this.type="video",this.options=l}load(){this._loaded=!1;const x=this.options;this.urls=[];for(const l of x.urls)this.urls.push(this.map._requestManager.transformRequest(l,v.ResourceType.Source).url);v.getVideo(this.urls,(l,f)=>{this._loaded=!0,l?this.fire(new v.ErrorEvent(l)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(x){if(this.video){const l=this.video.seekable;x<l.start(0)||x>l.end(0)?this.fire(new v.ErrorEvent(new v.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=x}}getVideo(){return this.video}onAdd(x){this.map||(this.map=x,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const x=this.map.painter.context,l=x.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,v.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new v.Texture(x,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));for(const f in this.tiles){const w=this.tiles[f];"loaded"!==w.state&&(w.state="loaded",w.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:we,canvas:class extends we{constructor(x,l,f,w){super(x,l,f,w),l.coordinates?Array.isArray(l.coordinates)&&4===l.coordinates.length&&!l.coordinates.some(A=>!Array.isArray(A)||2!==A.length||A.some(M=>"number"!=typeof M))||this.fire(new v.ErrorEvent(new v.ValidationError(`sources.${x}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new v.ErrorEvent(new v.ValidationError(`sources.${x}`,null,'missing required property "coordinates"'))),l.animate&&"boolean"!=typeof l.animate&&this.fire(new v.ErrorEvent(new v.ValidationError(`sources.${x}`,null,'optional "animate" property must be a boolean value'))),l.canvas?"string"==typeof l.canvas||l.canvas instanceof v.window.HTMLCanvasElement||this.fire(new v.ErrorEvent(new v.ValidationError(`sources.${x}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new v.ErrorEvent(new v.ValidationError(`sources.${x}`,null,'missing required property "canvas"'))),this.options=l,this.animate=void 0===l.animate||l.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof v.window.HTMLCanvasElement?this.options.canvas:v.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new v.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(x){this.map=x,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let x=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,x=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,x=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const l=this.map.painter.context,f=l.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,v.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(x||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new v.Texture(l,this.canvas,f.RGBA,{premultiply:!0});for(const w in this.tiles){const A=this.tiles[w];"loaded"!==A.state&&(A.state="loaded",A.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const x of[this.canvas.width,this.canvas.height])if(isNaN(x)||x<=0)return!0;return!1}}},ue=function(x,l,f,w){const A=new se[l.type](x,l,f,w);if(A.id!==x)throw new Error(`Expected Source id to be ${x} instead of ${A.id}`);return v.bindAll(["load","abort","unload","serialize","prepare"],A),A};function xe(x,l){const f=v.identity([]);return v.scale$1(f,f,[.5*x.width,.5*-x.height,1]),v.translate(f,f,[1,-1,0]),v.multiply(f,f,x.calculateProjMatrix(l.toUnwrapped()))}function Ae(x,l,f,w,A,M,O,U=!1){const X=x.tilesIn(w,O,U);X.sort($e);const Z=[];for(const ne of X)Z.push({wrappedTileID:ne.tile.tileID.wrapped().key,queryResults:ne.tile.queryRenderedFeatures(l,f,x._state,ne,A,M,xe(x.transform,ne.tile.tileID),U)});const ee=function(ne){const de={},ye={};for(const me of ne){const _e=me.queryResults,De=me.wrappedTileID,ve=ye[De]=ye[De]||{};for(const Ee in _e){const Me=_e[Ee],be=ve[Ee]=ve[Ee]||{},ke=de[Ee]=de[Ee]||[];for(const Fe of Me)be[Fe.featureIndex]||(be[Fe.featureIndex]=!0,ke.push(Fe))}}return de}(Z);for(const ne in ee)ee[ne].forEach(de=>{const ye=de.feature,me=x.getFeatureState(ye.layer["source-layer"],ye.id);ye.source=ye.layer.source,ye.layer["source-layer"]&&(ye.sourceLayer=ye.layer["source-layer"]),ye.state=me});return ee}function Ie(x,l){const f=x.getRenderableIds().map(M=>x.getTileByID(M)),w=[],A={};for(let M=0;M<f.length;M++){const O=f[M],U=O.tileID.canonical.key;A[U]||(A[U]=!0,O.querySourceFeatures(w,l))}return w}function $e(x,l){const f=x.tileID,w=l.tileID;return f.overscaledZ-w.overscaledZ||f.canonical.y-w.canonical.y||f.wrap-w.wrap||f.canonical.x-w.canonical.x}function Ue(){return null!=qa.workerClass?new qa.workerClass:new v.window.Worker(qa.workerUrl)}const Oe="mapboxgl_preloaded_worker_pool";class We{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<We.workerCount;)this.workers.push(new Ue);return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],0===this.numActive()&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Oe]}numActive(){return Object.keys(this.active).length}}let at;function Tt(){return at||(at=new We),at}function te(x,l){const f={};for(const w in x)"ref"!==w&&(f[w]=x[w]);return v.refProperties.forEach(w=>{w in l&&(f[w]=l[w])}),f}function o(x){x=x.slice();const l=Object.create(null);for(let f=0;f<x.length;f++)l[x[f].id]=x[f];for(let f=0;f<x.length;f++)"ref"in x[f]&&(x[f]=te(x[f],l[x[f].ref]));return x}We.workerCount=2;const a={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function d(x,l,f){f.push({command:a.addSource,args:[x,l[x]]})}function g(x,l,f){l.push({command:a.removeSource,args:[x]}),f[x]=!0}function _(x,l,f,w){g(x,f,w),d(x,l,f)}function D(x,l,f){let w;for(w in x[f])if(x[f].hasOwnProperty(w)&&"data"!==w&&!Je(x[f][w],l[f][w]))return!1;for(w in l[f])if(l[f].hasOwnProperty(w)&&"data"!==w&&!Je(x[f][w],l[f][w]))return!1;return!0}function C(x,l,f,w,A,M){let O;for(O in l=l||{},x=x||{})x.hasOwnProperty(O)&&(Je(x[O],l[O])||f.push({command:M,args:[w,O,l[O],A]}));for(O in l)l.hasOwnProperty(O)&&!x.hasOwnProperty(O)&&(Je(x[O],l[O])||f.push({command:M,args:[w,O,l[O],A]}))}function T(x){return x.id}function P(x,l){return x[l.id]=l,x}class L{constructor(l,f){this.reset(l,f)}reset(l,f){this.points=l||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(1===this.points.length)return this.points[0];l=v.clamp(l,0,1);let f=1,w=this._distances[f];const A=l*this.paddedLength+this.padding;for(;w<A&&f<this._distances.length;)w=this._distances[++f];const M=f-1,O=this._distances[M],U=w-O,X=U>0?(A-O)/U:0;return this.points[M].mult(1-X).add(this.points[f].mult(X))}}class B{constructor(l,f,w){const A=this.boxCells=[],M=this.circleCells=[];this.xCellCount=Math.ceil(l/w),this.yCellCount=Math.ceil(f/w);for(let O=0;O<this.xCellCount*this.yCellCount;O++)A.push([]),M.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=f,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,f,w,A,M){this._forEachCell(f,w,A,M,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(f),this.bboxes.push(w),this.bboxes.push(A),this.bboxes.push(M)}insertCircle(l,f,w,A){this._forEachCell(f-A,w-A,f+A,w+A,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(f),this.circles.push(w),this.circles.push(A)}_insertBoxCell(l,f,w,A,M,O){this.boxCells[M].push(O)}_insertCircleCell(l,f,w,A,M,O){this.circleCells[M].push(O)}_query(l,f,w,A,M,O){if(w<0||l>this.width||A<0||f>this.height)return!M&&[];const U=[];if(l<=0&&f<=0&&this.width<=w&&this.height<=A){if(M)return!0;for(let X=0;X<this.boxKeys.length;X++)U.push({key:this.boxKeys[X],x1:this.bboxes[4*X],y1:this.bboxes[4*X+1],x2:this.bboxes[4*X+2],y2:this.bboxes[4*X+3]});for(let X=0;X<this.circleKeys.length;X++){const Z=this.circles[3*X],ee=this.circles[3*X+1],ne=this.circles[3*X+2];U.push({key:this.circleKeys[X],x1:Z-ne,y1:ee-ne,x2:Z+ne,y2:ee+ne})}return O?U.filter(O):U}return this._forEachCell(l,f,w,A,this._queryCell,U,{hitTest:M,seenUids:{box:{},circle:{}}},O),M?U.length>0:U}_queryCircle(l,f,w,A,M){const O=l-w,U=l+w,X=f-w,Z=f+w;if(U<0||O>this.width||Z<0||X>this.height)return!A&&[];const ee=[];return this._forEachCell(O,X,U,Z,this._queryCellCircle,ee,{hitTest:A,circle:{x:l,y:f,radius:w},seenUids:{box:{},circle:{}}},M),A?ee.length>0:ee}query(l,f,w,A,M){return this._query(l,f,w,A,!1,M)}hitTest(l,f,w,A,M){return this._query(l,f,w,A,!0,M)}hitTestCircle(l,f,w,A){return this._queryCircle(l,f,w,!0,A)}_queryCell(l,f,w,A,M,O,U,X){const Z=U.seenUids,ee=this.boxCells[M];if(null!==ee){const de=this.bboxes;for(const ye of ee)if(!Z.box[ye]){Z.box[ye]=!0;const me=4*ye;if(l<=de[me+2]&&f<=de[me+3]&&w>=de[me+0]&&A>=de[me+1]&&(!X||X(this.boxKeys[ye]))){if(U.hitTest)return O.push(!0),!0;O.push({key:this.boxKeys[ye],x1:de[me],y1:de[me+1],x2:de[me+2],y2:de[me+3]})}}}const ne=this.circleCells[M];if(null!==ne){const de=this.circles;for(const ye of ne)if(!Z.circle[ye]){Z.circle[ye]=!0;const me=3*ye;if(this._circleAndRectCollide(de[me],de[me+1],de[me+2],l,f,w,A)&&(!X||X(this.circleKeys[ye]))){if(U.hitTest)return O.push(!0),!0;{const _e=de[me],De=de[me+1],ve=de[me+2];O.push({key:this.circleKeys[ye],x1:_e-ve,y1:De-ve,x2:_e+ve,y2:De+ve})}}}}}_queryCellCircle(l,f,w,A,M,O,U,X){const Z=U.circle,ee=U.seenUids,ne=this.boxCells[M];if(null!==ne){const ye=this.bboxes;for(const me of ne)if(!ee.box[me]){ee.box[me]=!0;const _e=4*me;if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,ye[_e+0],ye[_e+1],ye[_e+2],ye[_e+3])&&(!X||X(this.boxKeys[me])))return O.push(!0),!0}}const de=this.circleCells[M];if(null!==de){const ye=this.circles;for(const me of de)if(!ee.circle[me]){ee.circle[me]=!0;const _e=3*me;if(this._circlesCollide(ye[_e],ye[_e+1],ye[_e+2],Z.x,Z.y,Z.radius)&&(!X||X(this.circleKeys[me])))return O.push(!0),!0}}}_forEachCell(l,f,w,A,M,O,U,X){const Z=this._convertToXCellCoord(l),ee=this._convertToYCellCoord(f),ne=this._convertToXCellCoord(w),de=this._convertToYCellCoord(A);for(let ye=Z;ye<=ne;ye++)for(let me=ee;me<=de;me++)if(M.call(this,l,f,w,A,this.xCellCount*me+ye,O,U,X))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,f,w,A,M,O){const U=A-l,X=M-f,Z=w+O;return Z*Z>U*U+X*X}_circleAndRectCollide(l,f,w,A,M,O,U){const X=(O-A)/2,Z=Math.abs(l-(A+X));if(Z>X+w)return!1;const ee=(U-M)/2,ne=Math.abs(f-(M+ee));if(ne>ee+w)return!1;if(Z<=X||ne<=ee)return!0;const de=Z-X,ye=ne-ee;return de*de+ye*ye<=w*w}}const V=Math.tan(85*Math.PI/180);function $(x,l,f,w,A){const M=v.create$1();if(l){const O=Xe([],A);M[0]=O[0],M[1]=O[1],M[4]=O[2],M[5]=O[3],f||v.rotateZ(M,M,w.angle)}else v.multiply(M,w.labelPlaneMatrix,x);return M}function q(x,l,f,w,A){if(l){const M=v.clone$1(x),O=v.identity([]);return O[0]=A[0],O[1]=A[1],O[4]=A[2],O[5]=A[3],v.multiply(M,M,O),f||v.rotateZ(M,M,-w.angle),M}return w.glCoordMatrix}function K(x,l,f=0){const w=[x.x,x.y,f,1];f?v.transformMat4(w,w,l):Dt(w,w,l);const A=w[3];return{point:new v.pointGeometry(w[0]/A,w[1]/A),signedDistanceFromCamera:A}}function oe(x,l){return Math.min(.5+x/l*.5,1.5)}function ae(x,l){const f=x[0]/x[3],w=x[1]/x[3];return f>=-l[0]&&f<=l[0]&&w>=-l[1]&&w<=l[1]}function fe(x,l,f,w,A,M,O,U,X){const Z=w?x.textSizeData:x.iconSizeData,ee=v.evaluateSizeForZoom(Z,f.transform.zoom),ne=[256/f.width*2+1,256/f.height*2+1],de=w?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;de.clear();const ye=x.lineVertexArray,me=w?x.text.placedSymbolArray:x.icon.placedSymbolArray,_e=f.transform.width/f.transform.height;let De=!1;for(let ve=0;ve<me.length;ve++){const Ee=me.get(ve);if(Ee.writingMode!==v.WritingMode.vertical||De||0!==ve&&me.get(ve-1).writingMode===v.WritingMode.horizontal||(De=!0),Ee.hidden||Ee.writingMode===v.WritingMode.vertical&&!De){Ve(Ee.numGlyphs,de);continue}De=!1;const Me=new v.pointGeometry(Ee.tileAnchorX,Ee.tileAnchorY),be=X?X(Me):0,ke=[Me.x,Me.y,be],Fe=[...ke,1];if(v.transformMat4(Fe,Fe,l),!ae(Fe,ne)){Ve(Ee.numGlyphs,de);continue}const Qe=oe(f.transform.cameraToCenterDistance,Fe[3]),Ke=v.evaluateSizeForFeature(Z,ee,Ee),rt=O?Ke/Qe:Ke*Qe,st=K(new v.pointGeometry(ke[0],ke[1]),A,ke[2]);if(st.signedDistanceFromCamera<=0){Ve(Ee.numGlyphs,de);continue}let _t={};const it=O?null:X,At=H(Ee,rt,!1,U,l,A,M,x.glyphOffsetArray,ye,de,st.point,Me,_t,_e,it);De=At.useVertical,it&&At.needsFlipping&&(_t={}),(At.notEnoughRoom||De||At.needsFlipping&&H(Ee,rt,!0,U,l,A,M,x.glyphOffsetArray,ye,de,st.point,Me,_t,_e,it).notEnoughRoom)&&Ve(Ee.numGlyphs,de)}w?x.text.dynamicLayoutVertexBuffer.updateData(de):x.icon.dynamicLayoutVertexBuffer.updateData(de)}function ge(x,l,f,w,A,M,O,U,X,Z,ee,ne,de){const ye=U.glyphStartIndex+U.numGlyphs,me=U.lineStartIndex,_e=U.lineStartIndex+U.lineLength,De=l.getoffsetX(U.glyphStartIndex),ve=l.getoffsetX(ye-1),Ee=Re(x*De,f,w,A,M,O,U.segment,me,_e,X,Z,ee,ne,de,!0);if(!Ee)return null;const Me=Re(x*ve,f,w,A,M,O,U.segment,me,_e,X,Z,ee,ne,de,!0);return Me?{first:Ee,last:Me}:null}function R(x,l,f,w){return x.writingMode===v.WritingMode.horizontal&&Math.abs(f.y-l.y)>Math.abs(f.x-l.x)*w?{useVertical:!0}:x.writingMode===v.WritingMode.vertical?l.y<f.y?{needsFlipping:!0}:null:0!==x.flipState&&function(A,M,O){const U=(M.x-A.x)*O;return 0===U||Math.abs((M.y-A.y)/U)>V}(l,f,w)?1===x.flipState?{needsFlipping:!0}:null:l.x>f.x?{needsFlipping:!0}:null}function H(x,l,f,w,A,M,O,U,X,Z,ee,ne,de,ye,me){const _e=l/24,De=x.lineOffsetX*_e,ve=x.lineOffsetY*_e;let Ee;if(x.numGlyphs>1){const Me=x.glyphStartIndex+x.numGlyphs,be=x.lineStartIndex,ke=x.lineStartIndex+x.lineLength,Fe=ge(_e,U,De,ve,f,ee,ne,x,X,M,de,me,!1);if(!Fe)return{notEnoughRoom:!0};const Qe=K(Fe.first.point,O).point,Ke=K(Fe.last.point,O).point;if(w&&!f){const rt=R(x,Qe,Ke,ye);if(x.flipState=rt&&rt.needsFlipping?1:2,rt)return rt}Ee=[Fe.first];for(let rt=x.glyphStartIndex+1;rt<Me-1;rt++)Ee.push(Re(_e*U.getoffsetX(rt),De,ve,f,ee,ne,x.segment,be,ke,X,M,de,me,!1,!1));Ee.push(Fe.last)}else{if(w&&!f){const be=K(ne,A).point,ke=x.lineStartIndex+x.segment+1,Fe=new v.pointGeometry(X.getx(ke),X.gety(ke)),Qe=K(Fe,A),Ke=R(x,be,Qe.signedDistanceFromCamera>0?Qe.point:le(ne,Fe,be,1,A,void 0),ye);if(x.flipState=Ke&&Ke.needsFlipping?1:2,Ke)return Ke}const Me=Re(_e*U.getoffsetX(x.glyphStartIndex),De,ve,f,ee,ne,x.segment,x.lineStartIndex,x.lineStartIndex+x.lineLength,X,M,de,me,!1,!1);if(!Me)return{notEnoughRoom:!0};Ee=[Me]}for(const Me of Ee)v.addDynamicAttributes(Z,Me.point,Me.angle);return{}}function Q(x,l,f){const w={x:x.x,y:x.y,z:0};if(!f)return K(w,l,w.z);const A=f(x);return K(new v.pointGeometry(w.x,w.y),l,w.z+A)}function le(x,l,f,w,A,M){const O=Q(x.add(x.sub(l)._unit()),A,M).point,U=f.sub(O);return f.add(U._mult(w/U.mag()))}function Re(x,l,f,w,A,M,O,U,X,Z,ee,ne,de,ye,me){const _e=w?x-l:x+l;let De=_e>0?1:-1,ve=0;w&&(De*=-1,ve=Math.PI),De<0&&(ve+=Math.PI);let Ee=De>0?U+O:U+O+1,Me=A,be=A,ke=0,Fe=0;const Qe=Math.abs(_e),Ke=[],rt=[];let st=M;const _t=()=>{const Yt=Ee-De;return 0===ke?M:new v.pointGeometry(Z.getx(Yt),Z.gety(Yt))},it=()=>le(_t(),st,be,Qe-ke+1,ee,de);for(;ke+Fe<=Qe;){if(Ee+=De,Ee<U||Ee>=X)return null;if(be=Me,Ke.push(Me),ye&&rt.push(st||_t()),Me=ne[Ee],void 0===Me){st=new v.pointGeometry(Z.getx(Ee),Z.gety(Ee));const Yt=Q(st,ee,de);Me=Yt.signedDistanceFromCamera>0?ne[Ee]=Yt.point:it()}else st=null;ke+=Fe,Fe=be.dist(Me)}me&&de&&(st=st||new v.pointGeometry(Z.getx(Ee),Z.gety(Ee)),ne[Ee]=Me=void 0===ne[Ee]?Me:it(),Fe=be.dist(Me));const At=(Qe-ke)/Fe,Ye=Me.sub(be),Et=Ye.mult(At)._add(be);f&&Et._add(Ye._unit()._perp()._mult(f*De));const Lt=ve+Math.atan2(Me.y-be.y,Me.x-be.x);return Ke.push(Et),ye&&(st=st||new v.pointGeometry(Z.getx(Ee),Z.gety(Ee)),rt.push(function(Yt,Zt,tn){const nn=1-tn;return new v.pointGeometry(Yt.x*nn+Zt.x*tn,Yt.y*nn+Zt.y*tn)}(rt.length>0?rt[rt.length-1]:st,st,At))),{point:Et,angle:Lt,path:Ke,tilePath:rt}}const tt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ve(x,l){for(let f=0;f<x;f++){const w=l.length;l.resize(w+4),l.float32.set(tt,3*w)}}function Dt(x,l,f){const w=l[0],A=l[1];return x[0]=f[0]*w+f[4]*A+f[12],x[1]=f[1]*w+f[5]*A+f[13],x[3]=f[3]*w+f[7]*A+f[15],x}const pt=100;class qe{constructor(l,f,w=new B(l.width+200,l.height+200,25),A=new B(l.width+200,l.height+200,25)){this.transform=l,this.grid=w,this.ignoredGrid=A,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+pt,this.screenBottomBoundary=l.height+pt,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.fogState=f}placeCollisionBox(l,f,w,A,M,O,U){let X=f.projectedAnchorZ;f.elevation&&(X+=f.elevation);const Z=this.projectAndGetPerspectiveRatio(O,f.projectedAnchorX,f.projectedAnchorY,X,f.tileID),ee=M*Z.perspectiveRatio,ne=(f.x1*l+w.x-f.padding)*ee+Z.point.x,de=(f.y1*l+w.y-f.padding)*ee+Z.point.y,ye=(f.x2*l+w.x+f.padding)*ee+Z.point.x,me=(f.y2*l+w.y+f.padding)*ee+Z.point.y,_e=Z.perspectiveRatio<=.55||Z.aboveHorizon;return!this.isInsideGrid(ne,de,ye,me)||!A&&this.grid.hitTest(ne,de,ye,me,U)||_e?{box:[],offscreen:!1}:{box:[ne,de,ye,me],offscreen:this.isOffscreen(ne,de,ye,me)}}placeCollisionCircles(l,f,w,A,M,O,U,X,Z,ee,ne,de,ye,me){const _e=[],De=this.transform.elevation,ve=De?it=>De.getAtTileOffset(me,it.x,it.y):it=>0,Ee=new v.pointGeometry(f.tileAnchorX,f.tileAnchorY),Me=ve(Ee),be=this.projectAndGetPerspectiveRatio(O,Ee.x,Ee.y,Me,me),{perspectiveRatio:ke}=be,Fe=(ee?M/ke:M*ke)/v.ONE_EM,Qe=K(Ee,U,Me).point,Ke=be.signedDistanceFromCamera>0?ge(Fe,A,f.lineOffsetX*Fe,f.lineOffsetY*Fe,!1,Qe,Ee,f,w,U,{},De&&!ee?ve:null,ee&&!!De):null;let rt=!1,st=!1,_t=!0;if(Ke&&!be.aboveHorizon){const it=.5*de*ke+ye,At=new v.pointGeometry(-100,-100),Ye=new v.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Et=new L,Lt=Ke.first,Yt=Ke.last;let Zt=[];for(let Gt=Lt.path.length-1;Gt>=1;Gt--)Zt.push(Lt.path[Gt]);for(let Gt=1;Gt<Yt.path.length;Gt++)Zt.push(Yt.path[Gt]);const tn=2.5*it;if(X){const Gt=Zt.map(De?(sn,Un)=>{const Vi=ve(Un<Lt.path.length-1?Lt.tilePath[Lt.path.length-1-Un]:Yt.tilePath[Un-Lt.path.length+2]);return K(sn,X,Vi)}:sn=>K(sn,X));Zt=Gt.some(sn=>sn.signedDistanceFromCamera<=0)?[]:Gt.map(sn=>sn.point)}let nn=[];if(Zt.length>0){const Gt=Zt[0].clone(),sn=Zt[0].clone();for(let Un=1;Un<Zt.length;Un++)Gt.x=Math.min(Gt.x,Zt[Un].x),Gt.y=Math.min(Gt.y,Zt[Un].y),sn.x=Math.max(sn.x,Zt[Un].x),sn.y=Math.max(sn.y,Zt[Un].y);nn=Gt.x>=At.x&&sn.x<=Ye.x&&Gt.y>=At.y&&sn.y<=Ye.y?[Zt]:sn.x<At.x||Gt.x>Ye.x||sn.y<At.y||Gt.y>Ye.y?[]:v.clipLine([Zt],At.x,At.y,Ye.x,Ye.y)}for(const Gt of nn){Et.reset(Gt,.25*it);let sn=0;sn=Et.length<=.5*it?1:Math.ceil(Et.paddedLength/tn)+1;for(let Un=0;Un<sn;Un++){const Vi=Un/Math.max(sn-1,1),Tr=Et.lerp(Vi),Ur=Tr.x+pt,ar=Tr.y+pt;_e.push(Ur,ar,it,0);const lr=Ur-it,Is=ar-it,bo=Ur+it,ri=ar+it;if(_t=_t&&this.isOffscreen(lr,Is,bo,ri),st=st||this.isInsideGrid(lr,Is,bo,ri),!l&&this.grid.hitTestCircle(Ur,ar,it,ne)&&(rt=!0,!Z))return{circles:[],offscreen:!1,collisionDetected:rt}}}}return{circles:!Z&&rt||!st?[]:_e,offscreen:_t,collisionDetected:rt}}queryRenderedSymbols(l){if(0===l.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const f=[];let w=1/0,A=1/0,M=-1/0,O=-1/0;for(const ee of l){const ne=new v.pointGeometry(ee.x+pt,ee.y+pt);w=Math.min(w,ne.x),A=Math.min(A,ne.y),M=Math.max(M,ne.x),O=Math.max(O,ne.y),f.push(ne)}const U=this.grid.query(w,A,M,O).concat(this.ignoredGrid.query(w,A,M,O)),X={},Z={};for(const ee of U){const ne=ee.key;if(void 0===X[ne.bucketInstanceId]&&(X[ne.bucketInstanceId]={}),X[ne.bucketInstanceId][ne.featureIndex])continue;const de=[new v.pointGeometry(ee.x1,ee.y1),new v.pointGeometry(ee.x2,ee.y1),new v.pointGeometry(ee.x2,ee.y2),new v.pointGeometry(ee.x1,ee.y2)];v.polygonIntersectsPolygon(f,de)&&(X[ne.bucketInstanceId][ne.featureIndex]=!0,void 0===Z[ne.bucketInstanceId]&&(Z[ne.bucketInstanceId]=[]),Z[ne.bucketInstanceId].push(ne.featureIndex))}return Z}insertCollisionBox(l,f,w,A,M){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:w,featureIndex:A,collisionGroupID:M},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,f,w,A,M){const O=f?this.ignoredGrid:this.grid,U={bucketInstanceId:w,featureIndex:A,collisionGroupID:M};for(let X=0;X<l.length;X+=4)O.insertCircle(U,l[X],l[X+1],l[X+2])}projectAndGetPerspectiveRatio(l,f,w,A,M){const O=[f,w,A||0,1];let U=!1;if(A||this.transform.pitch>0){v.transformMat4(O,O,l);let X=!1;this.fogState&&M&&(X=function(Z,ee,ne,de,ye,me){const _e=me.calculateFogTileMatrix(ye),De=[ee,ne,de];return v.transformMat4$1(De,De,_e),Xr(Z,De,me.pitch,me._fov)}(this.fogState,f,w,A||0,M.toUnwrapped(),this.transform)>.9),U=O[2]>O[3]||X}else Dt(O,O,l);return{point:new v.pointGeometry((O[0]/O[3]+1)/2*this.transform.width+pt,(-O[1]/O[3]+1)/2*this.transform.height+pt),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/O[3]*.5,1.5),signedDistanceFromCamera:O[3],aboveHorizon:U}}isOffscreen(l,f,w,A){return w<pt||l>=this.screenRightBoundary||A<pt||f>this.screenBottomBoundary}isInsideGrid(l,f,w,A){return w>=0&&l<this.gridRightBoundary&&A>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const l=v.identity([]);return v.translate(l,l,[-100,-100,0]),l}}class Vt{constructor(l,f,w,A){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?f:-f))):A&&w?1:0,this.placed=w}isHidden(){return 0===this.opacity&&!this.placed}}class Yn{constructor(l,f,w,A,M,O=!1){this.text=new Vt(l?l.text:null,f,w,M),this.icon=new Vt(l?l.icon:null,f,A,M),this.clipped=O}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class pn{constructor(l,f,w,A=!1){this.text=l,this.icon=f,this.skipFade=w,this.clipped=A}}class xi{constructor(){this.invProjMatrix=v.create$1(),this.viewportMatrix=v.create$1(),this.circles=[]}}class sr{constructor(l,f,w,A,M){this.bucketInstanceId=l,this.featureIndex=f,this.sourceLayerIndex=w,this.bucketIndex=A,this.tileID=M}}class ki{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const f=++this.maxGroupID;this.collisionGroups[l]={ID:f,predicate:w=>w.collisionGroupID===f}}return this.collisionGroups[l]}}function bi(x,l,f,w,A){const{horizontalAlign:M,verticalAlign:O}=v.getAnchorAlignment(x),U=-(M-.5)*l,X=-(O-.5)*f,Z=v.evaluateVariableOffset(x,w);return new v.pointGeometry(U+Z[0]*A,X+Z[1]*A)}function Gs(x,l,f,w,A){const M=new v.pointGeometry(x,l);return f&&M._rotate(w?A:-A),M}class $a{constructor(l,f,w,A,M){this.transform=l.clone(),this.collisionIndex=new qe(this.transform,M),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new ki(w),this.collisionCircleArrays={},this.prevPlacement=A,A&&(A.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,f,w,A){const M=w.getBucket(f),O=w.latestFeatureIndex;if(!M||!O||f.id!==M.layerIds[0])return;const U=M.layers[0].layout,X=w.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),ee=w.tileSize/v.EXTENT,ne=w.tileID.toUnwrapped(),de=this.transform.calculateProjMatrix(ne),ye="map"===U.get("text-pitch-alignment"),me="map"===U.get("text-rotation-alignment");f.compileFilter();const _e=f.dynamicFilter(),De=f.dynamicFilterNeedsFeature(),ve=this.transform.calculatePixelsToTileUnitsMatrix(w),Ee=$(de,ye,me,this.transform,ve);let Me=null;if(ye){const Fe=q(de,ye,me,this.transform,ve);Me=v.multiply([],this.transform.labelPlaneMatrix,Fe)}let be=null;_e&&w.latestFeatureIndex&&(be={unwrappedTileID:ne,dynamicFilter:_e,dynamicFilterNeedsFeature:De,featureIndex:w.latestFeatureIndex}),this.retainedQueryData[M.bucketInstanceId]=new sr(M.bucketInstanceId,O,M.sourceLayerIndex,M.index,w.tileID);const ke={bucket:M,layout:U,posMatrix:de,textLabelPlaneMatrix:Ee,labelToScreenMatrix:Me,clippingData:be,scale:Z,textPixelRatio:ee,holdingForFade:w.holdingForFade(),collisionBoxArray:X,partiallyEvaluatedTextSize:v.evaluateSizeForZoom(M.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:v.evaluateSizeForZoom(M.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(M.sourceID)};if(A)for(const Fe of M.sortKeyRanges){const{sortKey:Qe,symbolInstanceStart:Ke,symbolInstanceEnd:rt}=Fe;l.push({sortKey:Qe,symbolInstanceStart:Ke,symbolInstanceEnd:rt,parameters:ke})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:M.symbolInstances.length,parameters:ke})}attemptAnchorPlacement(l,f,w,A,M,O,U,X,Z,ee,ne,de,ye,me,_e,De,ve,Ee){const Me=[de.textOffset0,de.textOffset1],be=bi(l,w,A,Me,M),ke=this.collisionIndex.placeCollisionBox(M,f,Gs(be.x,be.y,O,U,this.transform.angle),ne,X,Z,ee.predicate);if((!De||0!==this.collisionIndex.placeCollisionBox(me.getSymbolInstanceIconSize(Ee,this.transform.zoom,ye),De,Gs(be.x,be.y,O,U,this.transform.angle),ne,X,Z,ee.predicate).box.length)&&ke.box.length>0){let Fe;return this.prevPlacement&&this.prevPlacement.variableOffsets[de.crossTileID]&&this.prevPlacement.placements[de.crossTileID]&&this.prevPlacement.placements[de.crossTileID].text&&(Fe=this.prevPlacement.variableOffsets[de.crossTileID].anchor),this.variableOffsets[de.crossTileID]={textOffset:Me,width:w,height:A,anchor:l,textScale:M,prevAnchor:Fe},this.markUsedJustification(me,l,de,_e),me.allowVerticalPlacement&&(this.markUsedOrientation(me,_e,de),this.placedOrientations[de.crossTileID]=_e),{shift:be,placedGlyphBoxes:ke}}}placeLayerBucketPart(l,f,w,A){const{bucket:M,layout:O,posMatrix:U,textLabelPlaneMatrix:X,labelToScreenMatrix:Z,clippingData:ee,textPixelRatio:ne,holdingForFade:de,collisionBoxArray:ye,partiallyEvaluatedTextSize:me,partiallyEvaluatedIconSize:_e,collisionGroup:De}=l.parameters,ve=O.get("text-optional"),Ee=O.get("icon-optional"),Me=O.get("text-allow-overlap"),be=O.get("icon-allow-overlap"),ke="map"===O.get("text-rotation-alignment"),Fe="map"===O.get("text-pitch-alignment"),Qe="none"!==O.get("icon-text-fit"),Ke="viewport-y"===O.get("symbol-z-order"),rt=Me&&(be||!M.hasIconData()||Ee),st=be&&(Me||!M.hasTextData()||ve);!M.collisionArrays&&ye&&M.deserializeCollisionBoxes(ye),w&&A&&M.updateCollisionDebugBuffers(this.transform.zoom,ye);const _t=(it,At,Ye)=>{if(ee){const ri={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ji=null;if(ee.dynamicFilterNeedsFeature){const Pn=this.retainedQueryData[M.bucketInstanceId];Ji=ee.featureIndex.loadFeature({featureIndex:it.featureIndex,bucketIndex:Pn.bucketIndex,sourceLayerIndex:Pn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,ee.dynamicFilter)(ri,Ji,this.retainedQueryData[M.bucketInstanceId].tileID.canonical,new v.pointGeometry(it.tileAnchorX,it.tileAnchorY),this.transform.calculateDistanceTileData(ee.unwrappedTileID)))return this.placements[it.crossTileID]=new pn(!1,!1,!1,!0),void(f[it.crossTileID]=!0)}if(f[it.crossTileID])return;if(de)return void(this.placements[it.crossTileID]=new pn(!1,!1,!1));let Et=!1,Lt=!1,Yt=!0,Zt=null,tn={box:null,offscreen:null},nn={box:null,offscreen:null},Gt=null,sn=null,Un=null,Vi=0,Tr=0,Ur=0;Ye.textFeatureIndex?Vi=Ye.textFeatureIndex:it.useRuntimeCollisionCircles&&(Vi=it.featureIndex),Ye.verticalTextFeatureIndex&&(Tr=Ye.verticalTextFeatureIndex);const ar=ri=>{ri.tileID=this.retainedQueryData[M.bucketInstanceId].tileID,(this.transform.elevation||ri.elevation)&&(ri.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[M.bucketInstanceId].tileID,ri.tileAnchorX,ri.tileAnchorY):0)},lr=Ye.textBox;if(lr){ar(lr);const ri=Pn=>{let wi=v.WritingMode.horizontal;if(M.allowVerticalPlacement&&!Pn&&this.prevPlacement){const Hr=this.prevPlacement.placedOrientations[it.crossTileID];Hr&&(this.placedOrientations[it.crossTileID]=Hr,wi=Hr,this.markUsedOrientation(M,wi,it))}return wi},Ji=(Pn,wi)=>{if(M.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&Ye.verticalTextBox){for(const Hr of M.writingModes)if(Hr===v.WritingMode.vertical?(tn=wi(),nn=tn):tn=Pn(),tn&&tn.box&&tn.box.length)break}else tn=Pn()};if(O.get("text-variable-anchor")){let Pn=O.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[it.crossTileID]){const Ci=this.prevPlacement.variableOffsets[it.crossTileID];Pn.indexOf(Ci.anchor)>0&&(Pn=Pn.filter(jr=>jr!==Ci.anchor),Pn.unshift(Ci.anchor))}const wi=(Ci,jr,Ml)=>{const Zr=M.getSymbolInstanceTextSize(me,it,this.transform.zoom,At),qo=(Ci.x2-Ci.x1)*Zr+2*Ci.padding,fu=(Ci.y2-Ci.y1)*Zr+2*Ci.padding,nh=Qe&&!be?jr:null;nh&&ar(nh);let kl={box:[],offscreen:!1};const sd=Me?2*Pn.length:Pn.length;for(let Ic=0;Ic<sd;++Ic){const gu=this.attemptAnchorPlacement(Pn[Ic%Pn.length],Ci,qo,fu,Zr,ke,Fe,ne,U,De,Ic>=Pn.length,it,At,M,Ml,nh,me,_e);if(gu&&(kl=gu.placedGlyphBoxes,kl&&kl.box&&kl.box.length)){Et=!0,Zt=gu.shift;break}}return kl};Ji(()=>wi(lr,Ye.iconBox,v.WritingMode.horizontal),()=>{const Ci=Ye.verticalTextBox;return Ci&&ar(Ci),M.allowVerticalPlacement&&!(tn&&tn.box&&tn.box.length)&&it.numVerticalGlyphVertices>0&&Ci?wi(Ci,Ye.verticalIconBox,v.WritingMode.vertical):{box:null,offscreen:null}}),tn&&(Et=tn.box,Yt=tn.offscreen);const Hr=ri(tn&&tn.box);if(!Et&&this.prevPlacement){const Ci=this.prevPlacement.variableOffsets[it.crossTileID];Ci&&(this.variableOffsets[it.crossTileID]=Ci,this.markUsedJustification(M,Ci.anchor,it,Hr))}}else{const Pn=(wi,Hr)=>{const Ci=M.getSymbolInstanceTextSize(me,it,this.transform.zoom,At),jr=this.collisionIndex.placeCollisionBox(Ci,wi,new v.pointGeometry(0,0),Me,ne,U,De.predicate);return jr&&jr.box&&jr.box.length&&(this.markUsedOrientation(M,Hr,it),this.placedOrientations[it.crossTileID]=Hr),jr};Ji(()=>Pn(lr,v.WritingMode.horizontal),()=>{const wi=Ye.verticalTextBox;return M.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&wi?(ar(wi),Pn(wi,v.WritingMode.vertical)):{box:null,offscreen:null}}),ri(tn&&tn.box&&tn.box.length)}}if(Gt=tn,Et=Gt&&Gt.box&&Gt.box.length>0,Yt=Gt&&Gt.offscreen,it.useRuntimeCollisionCircles){const ri=M.text.placedSymbolArray.get(it.centerJustifiedTextSymbolIndex>=0?it.centerJustifiedTextSymbolIndex:it.verticalPlacedTextSymbolIndex),Ji=v.evaluateSizeForFeature(M.textSizeData,me,ri),Pn=O.get("text-padding");sn=this.collisionIndex.placeCollisionCircles(Me,ri,M.lineVertexArray,M.glyphOffsetArray,Ji,U,X,Z,w,Fe,De.predicate,it.collisionCircleDiameter*Ji/v.ONE_EM,Pn,this.retainedQueryData[M.bucketInstanceId].tileID),Et=Me||sn.circles.length>0&&!sn.collisionDetected,Yt=Yt&&sn.offscreen}if(Ye.iconFeatureIndex&&(Ur=Ye.iconFeatureIndex),Ye.iconBox){const ri=Ji=>{ar(Ji);const Pn=Qe&&Zt?Gs(Zt.x,Zt.y,ke,Fe,this.transform.angle):new v.pointGeometry(0,0),wi=M.getSymbolInstanceIconSize(_e,this.transform.zoom,At);return this.collisionIndex.placeCollisionBox(wi,Ji,Pn,be,ne,U,De.predicate)};nn&&nn.box&&nn.box.length&&Ye.verticalIconBox?(Un=ri(Ye.verticalIconBox),Lt=Un.box.length>0):(Un=ri(Ye.iconBox),Lt=Un.box.length>0),Yt=Yt&&Un.offscreen}const Is=ve||0===it.numHorizontalGlyphVertices&&0===it.numVerticalGlyphVertices,bo=Ee||0===it.numIconVertices;if(Is||bo?bo?Is||(Lt=Lt&&Et):Et=Lt&&Et:Lt=Et=Lt&&Et,Et&&Gt&&Gt.box&&this.collisionIndex.insertCollisionBox(Gt.box,O.get("text-ignore-placement"),M.bucketInstanceId,nn&&nn.box&&Tr?Tr:Vi,De.ID),Lt&&Un&&this.collisionIndex.insertCollisionBox(Un.box,O.get("icon-ignore-placement"),M.bucketInstanceId,Ur,De.ID),sn&&(Et&&this.collisionIndex.insertCollisionCircles(sn.circles,O.get("text-ignore-placement"),M.bucketInstanceId,Vi,De.ID),w)){const ri=M.bucketInstanceId;let Ji=this.collisionCircleArrays[ri];void 0===Ji&&(Ji=this.collisionCircleArrays[ri]=new xi);for(let Pn=0;Pn<sn.circles.length;Pn+=4)Ji.circles.push(sn.circles[Pn+0]),Ji.circles.push(sn.circles[Pn+1]),Ji.circles.push(sn.circles[Pn+2]),Ji.circles.push(sn.collisionDetected?1:0)}this.placements[it.crossTileID]=new pn(Et||rt,Lt||st,Yt||M.justReloaded),f[it.crossTileID]=!0};if(Ke){const it=M.getSortedSymbolIndexes(this.transform.angle);for(let At=it.length-1;At>=0;--At){const Ye=it[At];_t(M.symbolInstances.get(Ye),Ye,M.collisionArrays[Ye])}}else for(let it=l.symbolInstanceStart;it<l.symbolInstanceEnd;it++)_t(M.symbolInstances.get(it),it,M.collisionArrays[it]);if(w&&M.bucketInstanceId in this.collisionCircleArrays){const it=this.collisionCircleArrays[M.bucketInstanceId];v.invert(it.invProjMatrix,U),it.viewportMatrix=this.collisionIndex.getViewportMatrix()}M.justReloaded=!1}markUsedJustification(l,f,w,A){let M;M=A===v.WritingMode.vertical?w.verticalPlacedTextSymbolIndex:{left:w.leftJustifiedTextSymbolIndex,center:w.centerJustifiedTextSymbolIndex,right:w.rightJustifiedTextSymbolIndex}[v.getAnchorJustification(f)];const O=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex,w.verticalPlacedTextSymbolIndex];for(const U of O)U>=0&&(l.text.placedSymbolArray.get(U).crossTileID=M>=0&&U!==M?0:w.crossTileID)}markUsedOrientation(l,f,w){const A=f===v.WritingMode.horizontal||f===v.WritingMode.horizontalOnly?f:0,M=f===v.WritingMode.vertical?f:0,O=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex];for(const U of O)l.text.placedSymbolArray.get(U).placedOrientation=A;w.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(w.verticalPlacedTextSymbolIndex).placedOrientation=M)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let w=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const A=f?f.symbolFadeChange(l):1,M=f?f.opacities:{},O=f?f.variableOffsets:{},U=f?f.placedOrientations:{};for(const X in this.placements){const Z=this.placements[X],ee=M[X];ee?(this.opacities[X]=new Yn(ee,A,Z.text,Z.icon,null,Z.clipped),w=w||Z.text!==ee.text.placed||Z.icon!==ee.icon.placed):(this.opacities[X]=new Yn(null,A,Z.text,Z.icon,Z.skipFade,Z.clipped),w=w||Z.text||Z.icon)}for(const X in M){const Z=M[X];if(!this.opacities[X]){const ee=new Yn(Z,A,!1,!1);ee.isHidden()||(this.opacities[X]=ee,w=w||Z.text.placed||Z.icon.placed)}}for(const X in O)this.variableOffsets[X]||!this.opacities[X]||this.opacities[X].isHidden()||(this.variableOffsets[X]=O[X]);for(const X in U)this.placedOrientations[X]||!this.opacities[X]||this.opacities[X].isHidden()||(this.placedOrientations[X]=U[X]);w?this.lastPlacementChangeTime=l:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:l)}updateLayerOpacities(l,f){const w={};for(const A of f){const M=A.getBucket(l);M&&A.latestFeatureIndex&&l.id===M.layerIds[0]&&this.updateBucketOpacities(M,w,A.collisionBoxArray)}}updateBucketOpacities(l,f,w){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const A=l.layers[0].layout,M=!!l.layers[0].dynamicFilter(),O=new Yn(null,0,!1,!1,!0),U=A.get("text-allow-overlap"),X=A.get("icon-allow-overlap"),Z=A.get("text-variable-anchor"),ee="map"===A.get("text-rotation-alignment"),ne="map"===A.get("text-pitch-alignment"),de="none"!==A.get("icon-text-fit"),ye=new Yn(null,0,U&&(X||!l.hasIconData()||A.get("icon-optional")),X&&(U||!l.hasTextData()||A.get("text-optional")),!0);!l.collisionArrays&&w&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(w);const me=(_e,De,ve)=>{for(let Ee=0;Ee<De/4;Ee++)_e.opacityVertexArray.emplaceBack(ve)};for(let _e=0;_e<l.symbolInstances.length;_e++){const De=l.symbolInstances.get(_e),{numHorizontalGlyphVertices:ve,numVerticalGlyphVertices:Ee,crossTileID:Me}=De;let be=this.opacities[Me];f[Me]?be=O:be||(be=ye,this.opacities[Me]=be),f[Me]=!0;const ke=De.numIconVertices>0,Fe=this.placedOrientations[De.crossTileID],Qe=Fe===v.WritingMode.vertical,Ke=Fe===v.WritingMode.horizontal||Fe===v.WritingMode.horizontalOnly;if(ve>0||Ee>0){const rt=cp(be.text);me(l.text,ve,Qe?gi:rt),me(l.text,Ee,Ke?gi:rt);const st=be.text.isHidden();[De.rightJustifiedTextSymbolIndex,De.centerJustifiedTextSymbolIndex,De.leftJustifiedTextSymbolIndex].forEach(At=>{At>=0&&(l.text.placedSymbolArray.get(At).hidden=st||Qe?1:0)}),De.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(De.verticalPlacedTextSymbolIndex).hidden=st||Ke?1:0);const _t=this.variableOffsets[De.crossTileID];_t&&this.markUsedJustification(l,_t.anchor,De,Fe);const it=this.placedOrientations[De.crossTileID];it&&(this.markUsedJustification(l,"left",De,it),this.markUsedOrientation(l,it,De))}if(ke){const rt=cp(be.icon);De.placedIconSymbolIndex>=0&&(me(l.icon,De.numIconVertices,Qe?gi:rt),l.icon.placedSymbolArray.get(De.placedIconSymbolIndex).hidden=be.icon.isHidden()),De.verticalPlacedIconSymbolIndex>=0&&(me(l.icon,De.numVerticalIconVertices,Ke?gi:rt),l.icon.placedSymbolArray.get(De.verticalPlacedIconSymbolIndex).hidden=be.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const rt=l.collisionArrays[_e];if(rt){let st=new v.pointGeometry(0,0),_t=!0;if(rt.textBox||rt.verticalTextBox){if(Z){const At=this.variableOffsets[Me];At?(st=bi(At.anchor,At.width,At.height,At.textOffset,At.textScale),ee&&st._rotate(ne?this.transform.angle:-this.transform.angle)):_t=!1}M&&(_t=!be.clipped),rt.textBox&&Zn(l.textCollisionBox.collisionVertexArray,be.text.placed,!_t||Qe,st.x,st.y),rt.verticalTextBox&&Zn(l.textCollisionBox.collisionVertexArray,be.text.placed,!_t||Ke,st.x,st.y)}const it=_t&&Boolean(!Ke&&rt.verticalIconBox);rt.iconBox&&Zn(l.iconCollisionBox.collisionVertexArray,be.icon.placed,it,de?st.x:0,de?st.y:0),rt.verticalIconBox&&Zn(l.iconCollisionBox.collisionVertexArray,be.icon.placed,!it,de?st.x:0,de?st.y:0)}}}if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){const _e=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=_e.invProjMatrix,l.placementViewportMatrix=_e.viewportMatrix,l.collisionCircleArray=_e.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return 0===this.fadeDuration?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,f){const w=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*w>l}setStale(){this.stale=!0}}function Zn(x,l,f,w,A){x.emplaceBack(l?1:0,f?1:0,w||0,A||0),x.emplaceBack(l?1:0,f?1:0,w||0,A||0),x.emplaceBack(l?1:0,f?1:0,w||0,A||0),x.emplaceBack(l?1:0,f?1:0,w||0,A||0)}const pc=Math.pow(2,25),Ts=Math.pow(2,24),yr=Math.pow(2,17),or=Math.pow(2,16),Ou=Math.pow(2,9),yl=Math.pow(2,8),ag=Math.pow(2,1);function cp(x){if(0===x.opacity&&!x.placed)return 0;if(1===x.opacity&&x.placed)return 4294967295;const l=x.placed?1:0,f=Math.floor(127*x.opacity);return f*pc+l*Ts+f*yr+l*or+f*Ou+l*yl+f*ag+l}const gi=0;class mi{constructor(l){this._sortAcrossTiles="viewport-y"!==l.layout.get("symbol-z-order")&&void 0!==l.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,f,w,A,M){const O=this._bucketParts;for(;this._currentTileIndex<l.length;)if(f.getBucketParts(O,A,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,M())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort((U,X)=>U.sortKey-X.sortKey));this._currentPartIndex<O.length;){const U=O[this._currentPartIndex];if(f.placeLayerBucketPart(U,this._seenCrossTileIDs,w,0===U.symbolInstanceStart),this._currentPartIndex++,M())return!0}return!1}}class _l{constructor(l,f,w,A,M,O,U,X){this.placement=new $a(l,M,O,U,X),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=w,this._showCollisionBoxes=A,this._done=!1}isDone(){return this._done}continuePlacement(l,f,w){const A=v.exported.now(),M=()=>{const O=v.exported.now()-A;return!this._forceFullPlacement&&O>2};for(;this._currentPlacementIndex>=0;){const O=f[l[this._currentPlacementIndex]],U=this.placement.collisionIndex.transform.zoom;if("symbol"===O.type&&(!O.minzoom||O.minzoom<=U)&&(!O.maxzoom||O.maxzoom>U)){if(this._inProgressLayer||(this._inProgressLayer=new mi(O)),this._inProgressLayer.continuePlacement(w[O.source],this.placement,this._showCollisionBoxes,O,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const up=512/v.EXTENT/2;class Vh{constructor(l,f,w){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=w;for(let A=0;A<f.length;A++){const M=f.get(A),O=M.key;this.indexedSymbolInstances[O]||(this.indexedSymbolInstances[O]=[]),this.indexedSymbolInstances[O].push({crossTileID:M.crossTileID,coord:this.getScaledCoordinates(M,l)})}}getScaledCoordinates(l,f){const w=up/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*v.EXTENT+l.tileAnchorX)*w),y:Math.floor((f.canonical.y*v.EXTENT+l.tileAnchorY)*w)}}findMatches(l,f,w){const A=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z);for(let M=0;M<l.length;M++){const O=l.get(M);if(O.crossTileID)continue;const U=this.indexedSymbolInstances[O.key];if(!U)continue;const X=this.getScaledCoordinates(O,f);for(const Z of U)if(Math.abs(Z.coord.x-X.x)<=A&&Math.abs(Z.coord.y-X.y)<=A&&!w[Z.crossTileID]){w[Z.crossTileID]=!0,O.crossTileID=Z.crossTileID;break}}}}class Ft{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class My{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const f=Math.round((l-this.lng)/360);if(0!==f)for(const w in this.indexes){const A=this.indexes[w],M={};for(const O in A){const U=A[O];U.tileID=U.tileID.unwrapTo(U.tileID.wrap+f),M[U.tileID.key]=U}this.indexes[w]=M}this.lng=l}addBucket(l,f,w){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let M=0;M<f.symbolInstances.length;M++)f.symbolInstances.get(M).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const A=this.usedCrossTileIDs[l.overscaledZ];for(const M in this.indexes){const O=this.indexes[M];if(Number(M)>l.overscaledZ)for(const U in O){const X=O[U];X.tileID.isChildOf(l)&&X.findMatches(f.symbolInstances,l,A)}else{const U=O[l.scaledTo(Number(M)).key];U&&U.findMatches(f.symbolInstances,l,A)}}for(let M=0;M<f.symbolInstances.length;M++){const O=f.symbolInstances.get(M);O.crossTileID||(O.crossTileID=w.generate(),A[O.crossTileID]=!0)}return void 0===this.indexes[l.overscaledZ]&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Vh(l,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(l,f){for(const w in f.indexedSymbolInstances)for(const A of f.indexedSymbolInstances[w])delete this.usedCrossTileIDs[l][A.crossTileID]}removeStaleBuckets(l){let f=!1;for(const w in this.indexes){const A=this.indexes[w];for(const M in A)l[A[M].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,A[M]),delete A[M],f=!0)}return f}}class kn{constructor(){this.layerIndexes={},this.crossTileIDs=new Ft,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,f,w){let A=this.layerIndexes[l.id];void 0===A&&(A=this.layerIndexes[l.id]=new My);let M=!1;const O={};A.handleWrapJump(w);for(const U of f){const X=U.getBucket(l);X&&l.id===X.layerIds[0]&&(X.bucketInstanceId||(X.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(U.tileID,X,this.crossTileIDs)&&(M=!0),O[X.bucketInstanceId]=!0)}return A.removeStaleBuckets(O)&&(M=!0),M}pruneUnusedLayers(l){const f={};l.forEach(w=>{f[w]=!0});for(const w in this.layerIndexes)f[w]||delete this.layerIndexes[w]}}const go=(x,l)=>v.emitValidationErrors(x,l&&l.filter(f=>"source.canvas"!==f.identifier)),Uh=v.pick(a,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),lg=v.pick(a,["setCenter","setZoom","setBearing","setPitch"]),hp=function(){const x={},l=v.spec.$version;for(const f in v.spec.$root){const w=v.spec.$root[f];if(w.required){let A=null;A="version"===f?l:"array"===w.type?[]:{},null!=A&&(x[f]=A)}}return x}(),dp={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class hs extends v.Evented{constructor(l,f={}){super(),this.map=l,this.dispatcher=new Bi(Tt(),this),this.imageManager=new Ro,this.imageManager.setEventedParent(this),this.glyphManager=new v.GlyphManager(l._requestManager,f.localFontFamily?v.LocalGlyphMode.all:f.localIdeographFontFamily?v.LocalGlyphMode.ideographs:v.LocalGlyphMode.none,f.localFontFamily||f.localIdeographFontFamily),this.lineAtlas=new v.LineAtlas(256,512),this.crossTileSymbolIndex=new kn,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new v.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",v.getReferrer());const w=this;this._rtlTextPluginCallback=hs.registerForPluginStateChange(A=>{w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:A.pluginStatus,pluginURL:A.pluginURL},(M,O)=>{if(v.triggerPluginCompletionEvent(M),O&&O.every(U=>U))for(const U in w._sourceCaches){const X=w._sourceCaches[U],Z=X.getSource().type;"vector"!==Z&&"geojson"!==Z||X.reload()}})}),this.on("data",A=>{if("source"!==A.dataType||"metadata"!==A.sourceDataType)return;const M=this.getSource(A.sourceId);if(M&&M.vectorLayerIds)for(const O in this._layers){const U=this._layers[O];U.source===M.id&&this._validateLayer(U)}})}loadURL(l,f={}){this.fire(new v.Event("dataloading",{dataType:"style"}));const w="boolean"==typeof f.validate?f.validate:!v.isMapboxURL(l);l=this.map._requestManager.normalizeStyleURL(l,f.accessToken);const A=this.map._requestManager.transformRequest(l,v.ResourceType.Style);this._request=v.getJSON(A,(M,O)=>{this._request=null,M?this.fire(new v.ErrorEvent(M)):O&&this._load(O,w)})}loadJSON(l,f={}){this.fire(new v.Event("dataloading",{dataType:"style"})),this._request=v.exported.frame(()=>{this._request=null,this._load(l,!1!==f.validate)})}loadEmpty(){this.fire(new v.Event("dataloading",{dataType:"style"})),this._load(hp,!1)}_updateLayerCount(l,f){const w=f?1:-1;l.is3D()&&(this._num3DLayers+=w),"circle"===l.type&&(this._numCircleLayers+=w),"symbol"===l.type&&(this._numSymbolLayers+=w)}_load(l,f){if(f&&go(this,v.validateStyle(l)))return;this._loaded=!0,this.stylesheet=l,this.updateProjection();for(const A in l.sources)this.addSource(A,l.sources[A],{validate:!1});this._changed=!1,l.sprite?this._loadSprite(l.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(l.glyphs);const w=o(this.stylesheet.layers);this._order=w.map(A=>A.id),this._layers={},this._serializedLayers={};for(let A of w)A=v.createStyleLayer(A),A.setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=A,this._serializedLayers[A.id]=A.serialize(),this._updateLayerCount(A,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Mi(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new v.Event("data",{dataType:"style"})),this.fire(new v.Event("style.load"))}setProjection(l){l?this.stylesheet.projection=l:delete this.stylesheet.projection,this.updateProjection()}updateProjection(){const l=this.map.transform.setProjection(this.map._runtimeProjection||(this.stylesheet?this.stylesheet.projection:void 0));if(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),l){this.map.painter.clearBackgroundTiles();for(const f in this._sourceCaches)this._sourceCaches[f].clearTiles();this.map._update(!0)}}_loadSprite(l){this._spriteRequest=function(f,w,A){let M,O,U;const X=v.exported.devicePixelRatio>1?"@2x":"";let Z=v.getJSON(w.transformRequest(w.normalizeSpriteURL(f,X,".json"),v.ResourceType.SpriteJSON),(de,ye)=>{Z=null,U||(U=de,M=ye,ne())}),ee=v.getImage(w.transformRequest(w.normalizeSpriteURL(f,X,".png"),v.ResourceType.SpriteImage),(de,ye)=>{ee=null,U||(U=de,O=ye,ne())});function ne(){if(U)A(U);else if(M&&O){const de=v.exported.getImageData(O),ye={};for(const me in M){const{width:_e,height:De,x:ve,y:Ee,sdf:Me,pixelRatio:be,stretchX:ke,stretchY:Fe,content:Qe}=M[me],Ke=new v.RGBAImage({width:_e,height:De});v.RGBAImage.copy(de,Ke,{x:ve,y:Ee},{x:0,y:0},{width:_e,height:De}),ye[me]={data:Ke,pixelRatio:be,sdf:Me,stretchX:ke,stretchY:Fe,content:Qe}}A(null,ye)}}return{cancel(){Z&&(Z.cancel(),Z=null),ee&&(ee.cancel(),ee=null)}}}(l,this.map._requestManager,(f,w)=>{if(this._spriteRequest=null,f)this.fire(new v.ErrorEvent(f));else if(w)for(const A in w)this.imageManager.addImage(A,w[A]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new v.Event("data",{dataType:"style"}))})}_validateLayer(l){const f=this.getSource(l.source);if(!f)return;const w=l.sourceLayer;w&&("geojson"===f.type||f.vectorLayerIds&&-1===f.vectorLayerIds.indexOf(w))&&this.fire(new v.ErrorEvent(new Error(`Source layer "${w}" does not exist on source "${f.id}" as specified by style layer "${l.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this._sourceCaches)if(!this._sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(l){const f=[];for(const w of l){const A=this._layers[w];"custom"!==A.type&&f.push(A.serialize())}return f}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const l in this._sourceCaches)if(this._sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(l){return!!this.terrain&&dp[l.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(l){if(!this._loaded)return;const f=this._changed;if(this._changed){const A=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);(A.length||M.length)&&this._updateWorkerLayers(A,M);for(const O in this._updatedSources){const U=this._updatedSources[O];"reload"===U?this._reloadSource(O):"clear"===U&&this._clearSource(O)}this._updateTilesForChangedImages();for(const O in this._updatedPaintProps)this._layers[O].updateTransitions(l);this.light.updateTransitions(l),this.fog&&this.fog.updateTransitions(l),this._resetUpdates()}const w={};for(const A in this._sourceCaches){const M=this._sourceCaches[A];w[A]=M.used,M.used=!1}for(const A of this._order){const M=this._layers[A];if(M.recalculate(l,this._availableImages),!M.isHidden(l.zoom)){const U=this._getLayerSourceCache(M);U&&(U.used=!0)}const O=this.map.painter;if(O){const U=M.getProgramIds();if(!U)continue;const X=M.getProgramConfiguration(l.zoom);for(const Z of U)O.useProgram(Z,X)}}for(const A in w){const M=this._sourceCaches[A];w[A]!==M.used&&M.getSource().fire(new v.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:M.getSource().id}))}this.light.recalculate(l),this.terrain&&this.terrain.recalculate(l),this.fog&&this.fog.recalculate(l),this.z=l.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),f&&this.fire(new v.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const f in this._sourceCaches)this._sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateWorkerLayers(l,f){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(l){if(this._checkLoaded(),go(this,v.validateStyle(l)))return!1;(l=v.clone$2(l)).layers=o(l.layers);const f=function(A,M){if(!A)return[{command:a.setStyle,args:[M]}];let O=[];try{if(!Je(A.version,M.version))return[{command:a.setStyle,args:[M]}];Je(A.center,M.center)||O.push({command:a.setCenter,args:[M.center]}),Je(A.zoom,M.zoom)||O.push({command:a.setZoom,args:[M.zoom]}),Je(A.bearing,M.bearing)||O.push({command:a.setBearing,args:[M.bearing]}),Je(A.pitch,M.pitch)||O.push({command:a.setPitch,args:[M.pitch]}),Je(A.sprite,M.sprite)||O.push({command:a.setSprite,args:[M.sprite]}),Je(A.glyphs,M.glyphs)||O.push({command:a.setGlyphs,args:[M.glyphs]}),Je(A.transition,M.transition)||O.push({command:a.setTransition,args:[M.transition]}),Je(A.light,M.light)||O.push({command:a.setLight,args:[M.light]}),Je(A.fog,M.fog)||O.push({command:a.setFog,args:[M.fog]}),Je(A.projection,M.projection)||O.push({command:a.setProjection,args:[M.projection]});const U={},X=[];!function(ne,de,ye,me){let _e;for(_e in de=de||{},ne=ne||{})ne.hasOwnProperty(_e)&&(de.hasOwnProperty(_e)||g(_e,ye,me));for(_e in de)de.hasOwnProperty(_e)&&(ne.hasOwnProperty(_e)?Je(ne[_e],de[_e])||("geojson"===ne[_e].type&&"geojson"===de[_e].type&&D(ne,de,_e)?ye.push({command:a.setGeoJSONSourceData,args:[_e,de[_e].data]}):_(_e,de,ye,me)):d(_e,de,ye))}(A.sources,M.sources,X,U);const Z=[];A.layers&&A.layers.forEach(ne=>{U[ne.source]?O.push({command:a.removeLayer,args:[ne.id]}):Z.push(ne)});let ee=A.terrain;ee&&U[ee.source]&&(O.push({command:a.setTerrain,args:[void 0]}),ee=void 0),O=O.concat(X),Je(ee,M.terrain)||O.push({command:a.setTerrain,args:[M.terrain]}),function(ne,de,ye){de=de||[];const me=(ne=ne||[]).map(T),_e=de.map(T),De=ne.reduce(P,{}),ve=de.reduce(P,{}),Ee=me.slice(),Me=Object.create(null);let be,ke,Fe,Qe,Ke,rt,st;for(be=0,ke=0;be<me.length;be++)Fe=me[be],ve.hasOwnProperty(Fe)?ke++:(ye.push({command:a.removeLayer,args:[Fe]}),Ee.splice(Ee.indexOf(Fe,ke),1));for(be=0,ke=0;be<_e.length;be++)Fe=_e[_e.length-1-be],Ee[Ee.length-1-be]!==Fe&&(De.hasOwnProperty(Fe)?(ye.push({command:a.removeLayer,args:[Fe]}),Ee.splice(Ee.lastIndexOf(Fe,Ee.length-ke),1)):ke++,rt=Ee[Ee.length-be],ye.push({command:a.addLayer,args:[ve[Fe],rt]}),Ee.splice(Ee.length-be,0,Fe),Me[Fe]=!0);for(be=0;be<_e.length;be++)if(Fe=_e[be],Qe=De[Fe],Ke=ve[Fe],!Me[Fe]&&!Je(Qe,Ke))if(Je(Qe.source,Ke.source)&&Je(Qe["source-layer"],Ke["source-layer"])&&Je(Qe.type,Ke.type)){for(st in C(Qe.layout,Ke.layout,ye,Fe,null,a.setLayoutProperty),C(Qe.paint,Ke.paint,ye,Fe,null,a.setPaintProperty),Je(Qe.filter,Ke.filter)||ye.push({command:a.setFilter,args:[Fe,Ke.filter]}),Je(Qe.minzoom,Ke.minzoom)&&Je(Qe.maxzoom,Ke.maxzoom)||ye.push({command:a.setLayerZoomRange,args:[Fe,Ke.minzoom,Ke.maxzoom]}),Qe)Qe.hasOwnProperty(st)&&"layout"!==st&&"paint"!==st&&"filter"!==st&&"metadata"!==st&&"minzoom"!==st&&"maxzoom"!==st&&(0===st.indexOf("paint.")?C(Qe[st],Ke[st],ye,Fe,st.slice(6),a.setPaintProperty):Je(Qe[st],Ke[st])||ye.push({command:a.setLayerProperty,args:[Fe,st,Ke[st]]}));for(st in Ke)Ke.hasOwnProperty(st)&&!Qe.hasOwnProperty(st)&&"layout"!==st&&"paint"!==st&&"filter"!==st&&"metadata"!==st&&"minzoom"!==st&&"maxzoom"!==st&&(0===st.indexOf("paint.")?C(Qe[st],Ke[st],ye,Fe,st.slice(6),a.setPaintProperty):Je(Qe[st],Ke[st])||ye.push({command:a.setLayerProperty,args:[Fe,st,Ke[st]]}))}else ye.push({command:a.removeLayer,args:[Fe]}),rt=Ee[Ee.lastIndexOf(Fe)+1],ye.push({command:a.addLayer,args:[Ke,rt]})}(Z,M.layers,O)}catch(U){console.warn("Unable to compute style diff:",U),O=[{command:a.setStyle,args:[M]}]}return O}(this.serialize(),l).filter(A=>!(A.command in lg));if(0===f.length)return!1;const w=f.filter(A=>!(A.command in Uh));if(w.length>0)throw new Error(`Unimplemented: ${w.map(A=>A.command).join(", ")}.`);return f.forEach(A=>{"setTransition"!==A.command&&this[A.command].apply(this,A.args)}),this.stylesheet=l,!0}addImage(l,f){if(this.getImage(l))return this.fire(new v.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(l,f),this._afterImageUpdated(l)}updateImage(l,f){this.imageManager.updateImage(l,f)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new v.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new v.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(l,f,w={}){if(this._checkLoaded(),void 0!==this.getSource(l))throw new Error("There is already a source with this ID");if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(v.validateStyle.source,`sources.${l}`,f,null,w))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const A=ue(l,f,this.dispatcher,this);A.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:A.serialize(),sourceId:l}));const M=O=>{const U=(O?"symbol:":"other:")+l,X=this._sourceCaches[U]=new v.SourceCache(U,A,O);(O?this._symbolSourceCaches:this._otherSourceCaches)[l]=X,X.style=this,X.onAdd(this.map)};M(!1),"vector"!==f.type&&"geojson"!==f.type||M(!0),A.onAdd&&A.onAdd(this.map),this._changed=!0}removeSource(l){this._checkLoaded();const f=this.getSource(l);if(void 0===f)throw new Error("There is no source with this ID");for(const A in this._layers)if(this._layers[A].source===l)return this.fire(new v.ErrorEvent(new Error(`Source "${l}" cannot be removed while layer "${A}" is using it.`)));if(this.terrain&&this.terrain.get().source===l)return this.fire(new v.ErrorEvent(new Error(`Source "${l}" cannot be removed while terrain is using it.`)));const w=this._getSourceCaches(l);for(const A of w)delete this._sourceCaches[A.id],delete this._updatedSources[A.id],A.fire(new v.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:A.getSource().id})),A.setEventedParent(null),A.clearTiles();delete this._otherSourceCaches[l],delete this._symbolSourceCaches[l],f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,f){this._checkLoaded(),this.getSource(l).setData(f),this._changed=!0}getSource(l){const f=this._getSourceCache(l);return f&&f.getSource()}addLayer(l,f,w={}){this._checkLoaded();const A=l.id;if(this.getLayer(A))return void this.fire(new v.ErrorEvent(new Error(`Layer with id "${A}" already exists on this map`)));let M;if("custom"===l.type){if(go(this,v.validateCustomStyleLayer(l)))return;M=v.createStyleLayer(l)}else{if("object"==typeof l.source&&(this.addSource(A,l.source),l=v.clone$2(l),l=v.extend(l,{source:A})),this._validate(v.validateStyle.layer,`layers.${A}`,l,{arrayIndex:-1},w))return;M=v.createStyleLayer(l),this._validateLayer(M),M.setEventedParent(this,{layer:{id:A}}),this._serializedLayers[M.id]=M.serialize(),this._updateLayerCount(M,!0)}const O=f?this._order.indexOf(f):this._order.length;if(f&&-1===O)return void this.fire(new v.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`)));this._order.splice(O,0,A),this._layerOrderChanged=!0,this._layers[A]=M;const U=this._getLayerSourceCache(M);if(this._removedLayers[A]&&M.source&&U&&"custom"!==M.type){const X=this._removedLayers[A];delete this._removedLayers[A],X.type!==M.type?this._updatedSources[M.source]="clear":(this._updatedSources[M.source]="reload",U.pause())}this._updateLayer(M),M.onAdd&&M.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(l,f){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new v.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===f)return;const w=this._order.indexOf(l);this._order.splice(w,1);const A=f?this._order.indexOf(f):this._order.length;f&&-1===A?this.fire(new v.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`))):(this._order.splice(A,0,l),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(l){this._checkLoaded();const f=this._layers[l];if(!f)return void this.fire(new v.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be removed.`)));f.setEventedParent(null),this._updateLayerCount(f,!1);const w=this._order.indexOf(l);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=f,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],f.onRemove&&f.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(l){return this._layers[l]}hasLayer(l){return l in this._layers}hasLayerType(l){for(const f in this._layers)if(this._layers[f].type===l)return!0;return!1}setLayerZoomRange(l,f,w){this._checkLoaded();const A=this.getLayer(l);A?A.minzoom===f&&A.maxzoom===w||(null!=f&&(A.minzoom=f),null!=w&&(A.maxzoom=w),this._updateLayer(A)):this.fire(new v.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(l,f,w={}){this._checkLoaded();const A=this.getLayer(l);if(A){if(!Je(A.filter,f))return null==f?(A.filter=void 0,void this._updateLayer(A)):void(this._validate(v.validateStyle.filter,`layers.${A.id}.filter`,f,{layerType:A.type},w)||(A.filter=v.clone$2(f),this._updateLayer(A)))}else this.fire(new v.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be filtered.`)))}getFilter(l){return v.clone$2(this.getLayer(l).filter)}setLayoutProperty(l,f,w,A={}){this._checkLoaded();const M=this.getLayer(l);M?Je(M.getLayoutProperty(f),w)||(M.setLayoutProperty(f,w,A),this._updateLayer(M)):this.fire(new v.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(l,f){const w=this.getLayer(l);if(w)return w.getLayoutProperty(f);this.fire(new v.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style.`)))}setPaintProperty(l,f,w,A={}){this._checkLoaded();const M=this.getLayer(l);M?Je(M.getPaintProperty(f),w)||(M.setPaintProperty(f,w,A)&&this._updateLayer(M),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new v.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(l,f){return this.getLayer(l).getPaintProperty(f)}setFeatureState(l,f){this._checkLoaded();const w=l.source,A=l.sourceLayer,M=this.getSource(w);if(void 0===M)return void this.fire(new v.ErrorEvent(new Error(`The source '${w}' does not exist in the map's style.`)));const O=M.type;if("geojson"===O&&A)return void this.fire(new v.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===O&&!A)return void this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===l.id&&this.fire(new v.ErrorEvent(new Error("The feature id parameter must be provided.")));const U=this._getSourceCaches(w);for(const X of U)X.setFeatureState(A,l.id,f)}removeFeatureState(l,f){this._checkLoaded();const w=l.source,A=this.getSource(w);if(void 0===A)return void this.fire(new v.ErrorEvent(new Error(`The source '${w}' does not exist in the map's style.`)));const M=A.type,O="vector"===M?l.sourceLayer:void 0;if("vector"===M&&!O)return void this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&"string"!=typeof l.id&&"number"!=typeof l.id)return void this.fire(new v.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const U=this._getSourceCaches(w);for(const X of U)X.removeFeatureState(O,l.id,f)}getFeatureState(l){this._checkLoaded();const f=l.source,w=l.sourceLayer,A=this.getSource(f);if(void 0!==A){if("vector"!==A.type||w)return void 0===l.id&&this.fire(new v.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(f)[0].getFeatureState(w,l.id);this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return v.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const l={};for(const f in this._sourceCaches){const w=this._sourceCaches[f].getSource();l[w.id]||(l[w.id]=w.serialize())}return v.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:l,layers:this._serializeLayers(this._order)},f=>void 0!==f)}_updateLayer(l){this._updatedLayers[l.id]=!0;const f=this._getLayerSourceCache(l);l.source&&!this._updatedSources[l.source]&&f&&"raster"!==f.getSource().type&&(this._updatedSources[l.source]="reload",f.pause()),this._changed=!0,l.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(l){const f=O=>"fill-extrusion"===this._layers[O].type,w={},A=[];for(let O=this._order.length-1;O>=0;O--){const U=this._order[O];if(f(U)){w[U]=O;for(const X of l){const Z=X[U];if(Z)for(const ee of Z)A.push(ee)}}}A.sort((O,U)=>U.intersectionZ-O.intersectionZ);const M=[];for(let O=this._order.length-1;O>=0;O--){const U=this._order[O];if(f(U))for(let X=A.length-1;X>=0;X--){const Z=A[X].feature;if(w[Z.layer.id]<O)break;M.push(Z),A.pop()}else for(const X of l){const Z=X[U];if(Z)for(const ee of Z)M.push(ee.feature)}}return M}queryRenderedFeatures(l,f,w){f&&f.filter&&this._validate(v.validateStyle.filter,"queryRenderedFeatures.filter",f.filter,null,f);const A={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new v.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const X of f.layers){const Z=this._layers[X];if(!Z)return this.fire(new v.ErrorEvent(new Error(`The layer '${X}' does not exist in the map's style and cannot be queried for features.`))),[];A[Z.source]=!0}}const M=[];f.availableImages=this._availableImages;const O=f&&f.layers?f.layers.some(X=>{const Z=this.getLayer(X);return Z&&Z.is3D()}):this.has3DLayers(),U=Dn.createFromScreenPoints(l,w);for(const X in this._sourceCaches){const Z=this._sourceCaches[X].getSource().id;f.layers&&!A[Z]||M.push(Ae(this._sourceCaches[X],this._layers,this._serializedLayers,U,f,w,O,!!this.map._showQueryGeometry))}return this.placement&&M.push(function(X,Z,ee,ne,de,ye,me){const _e={},De=ye.queryRenderedSymbols(ne),ve=[];for(const Ee of Object.keys(De).map(Number))ve.push(me[Ee]);ve.sort($e);for(const Ee of ve){const Me=Ee.featureIndex.lookupSymbolFeatures(De[Ee.bucketInstanceId],Z,Ee.bucketIndex,Ee.sourceLayerIndex,de.filter,de.layers,de.availableImages,X);for(const be in Me){const ke=_e[be]=_e[be]||[],Fe=Me[be];Fe.sort((Qe,Ke)=>{const rt=Ee.featureSortOrder;if(rt){const st=rt.indexOf(Qe.featureIndex);return rt.indexOf(Ke.featureIndex)-st}return Ke.featureIndex-Qe.featureIndex});for(const Qe of Fe)ke.push(Qe)}}for(const Ee in _e)_e[Ee].forEach(Me=>{const be=Me.feature,ke=ee(X[Ee]).getFeatureState(be.layer["source-layer"],be.id);be.source=be.layer.source,be.layer["source-layer"]&&(be.sourceLayer=be.layer["source-layer"]),be.state=ke});return _e}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),U.screenGeometry,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(M)}querySourceFeatures(l,f){f&&f.filter&&this._validate(v.validateStyle.filter,"querySourceFeatures.filter",f.filter,null,f);const w=this._getSourceCaches(l);let A=[];for(const M of w)A=A.concat(Ie(M,f));return A}addSourceType(l,f,w){return hs.getSourceType(l)?w(new Error(`A source type called "${l}" already exists.`)):(hs.setSourceType(l,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:f.workerSourceURL},w):w(null,null))}getLight(){return this.light.getLight()}setLight(l,f={}){this._checkLoaded();const w=this.light.getLight();let A=!1;for(const O in l)if(!Je(l[O],w[O])){A=!0;break}if(!A)return;const M={now:v.exported.now(),transition:v.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,f),this.light.updateTransitions(M)}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(l){if(this._checkLoaded(),!l)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if("object"==typeof l.source){const f="terrain-dem-src";this.addSource(f,l.source),l=v.clone$2(l),l=v.extend(l,{source:f})}if(!this._validate(v.validateStyle.terrain,"terrain",l)){if(this.terrain){const f=this.terrain,w=f.get();for(const A in l)if(!Je(l[A],w[A])){f.set(l),this.stylesheet.terrain=l;const M={now:v.exported.now(),transition:v.extend({duration:0},this.stylesheet.transition)};f.updateTransitions(M);break}}else this._createTerrain(l);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}}_createFog(l){const f=this.fog=new No(l,this.map.transform);this.stylesheet.fog=l;const w={now:v.exported.now(),transition:v.extend({duration:0},this.stylesheet.transition)};f.updateTransitions(w)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const l of this.map._markers)l._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(l){if(this._checkLoaded(),!l)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog,w=f.get();for(const A in l)if(!Je(l[A],w[A])){f.set(l),this.stylesheet.fog=l;const M={now:v.exported.now(),transition:v.extend({duration:0},this.stylesheet.transition)};f.updateTransitions(M);break}}else this._createFog(l);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const l=this._order.filter(w=>this.isLayerDraped(this._layers[w])),f=this._order.filter(w=>!this.isLayerDraped(this._layers[w]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...l),this._drapedFirstOrder.push(...f)}_createTerrain(l){const f=this.terrain=new as(l);this.stylesheet.terrain=l,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const w={now:v.exported.now(),transition:v.extend({duration:0},this.stylesheet.transition)};f.updateTransitions(w)}_force3DLayerUpdate(){for(const l in this._layers){const f=this._layers[l];"fill-extrusion"===f.type&&this._updateLayer(f)}}_validate(l,f,w,A,M={}){return(!M||!1!==M.validate)&&go(this,l.call(v.validateStyle,v.extend({key:f,style:this.serialize(),value:w,styleSpec:v.spec},A)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),v.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this._sourceCaches)this._sourceCaches[l].clearTiles(),this._sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(l){const f=this._getSourceCaches(l);for(const w of f)w.clearTiles()}_reloadSource(l){const f=this._getSourceCaches(l);for(const w of f)w.resume(),w.reload()}_updateSources(l){for(const f in this._sourceCaches)this._sourceCaches[f].update(l)}_generateCollisionBoxes(){for(const l in this._sourceCaches){const f=this._sourceCaches[l];f.resume(),f.reload()}}_updatePlacement(l,f,w,A,M=!1){let O=!1,U=!1;const X={};for(const Z of this._order){const ee=this._layers[Z];if("symbol"!==ee.type)continue;if(!X[ee.source]){const de=this._getLayerSourceCache(ee);if(!de)continue;X[ee.source]=de.getRenderableIds(!0).map(ye=>de.getTileByID(ye)).sort((ye,me)=>me.tileID.overscaledZ-ye.tileID.overscaledZ||(ye.tileID.isLessThan(me.tileID)?-1:1))}const ne=this.crossTileSymbolIndex.addLayer(ee,X[ee.source],l.center.lng);O=O||ne}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),M=M||this._layerOrderChanged||0===w,this._layerOrderChanged&&this.fire(new v.Event("neworder")),(M||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(v.exported.now(),l.zoom))&&(this.pauseablePlacement=new _l(l,this._order,M,f,w,A,this.placement,this.fog&&!this.fog.isSoftDisabled()?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,X),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(v.exported.now()),U=!0),O&&this.pauseablePlacement.placement.setStale()),U||O)for(const Z of this._order){const ee=this._layers[Z];"symbol"===ee.type&&this.placement.updateLayerOpacities(ee,X[ee.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(v.exported.now())}_releaseSymbolFadeTiles(){for(const l in this._sourceCaches)this._sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,f,w){this.imageManager.getImages(f.icons,w),this._updateTilesForChangedImages();const A=M=>{M&&M.setDependencies(f.tileID.key,f.type,f.icons)};A(this._otherSourceCaches[f.source]),A(this._symbolSourceCaches[f.source])}getGlyphs(l,f,w){this.glyphManager.getGlyphs(f.stacks,w)}getResource(l,f,w){return v.makeRequest(f,w)}_getSourceCache(l){return this._otherSourceCaches[l]}_getLayerSourceCache(l){return"symbol"===l.type?this._symbolSourceCaches[l.source]:this._otherSourceCaches[l.source]}_getSourceCaches(l){const f=[];return this._otherSourceCaches[l]&&f.push(this._otherSourceCaches[l]),this._symbolSourceCaches[l]&&f.push(this._symbolSourceCaches[l]),f}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}}hs.getSourceType=function(x){return se[x]},hs.setSourceType=function(x,l){se[x]=l},hs.registerForPluginStateChange=v.registerForPluginStateChange;var nu="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}\n#endif",Lu="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let iu={},Xt={};iu=Mn("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else \nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",!0),Xt=Mn("#ifdef FOG\nuniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);const ha=Mn("\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef TERRAIN\nhighp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#endif","\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {\n#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)\nreturn mix(globe,mercator,t);\n#else\nreturn globe;\n#endif\n}vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),fc=nu;var Vo={background:Mn("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Mn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Mn("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Mn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Mn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\ngl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nextrude*=a_scale;vec3 normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));vec3 globePos=a_pos_3+xAxis*extrude.x+yAxis*extrude.y+elevationVector(tilePos)*elevation(tilePos);vec3 mercPos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+xAxis*extrude.x+yAxis*extrude.y;vec3 pos=mix_globe_mercator(globePos,mercPos,u_zoom_transition);\n#else\nvec3 pos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Mn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Mn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Mn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Mn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:Mn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Mn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Mn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Mn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Mn("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Mn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);\n#else\nvec3 p=vec3(pos_nx.xy,z);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Mn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Mn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Mn("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nvec4 out_color=texture2D(u_gradient_image,v_uv);\n#else\nvec4 out_color=color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#ifdef RENDER_LINE_GRADIENT\nattribute vec3 a_packed;\n#else\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Mn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Mn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Mn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Mn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Mn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Mn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:Mn("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Mn("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Lu),skyboxGradient:Mn("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Lu),skyboxCapture:Mn("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Mn("uniform sampler2D u_image0;varying vec2 v_pos0;void main() {vec4 color=texture2D(u_image0,v_pos0);gl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat4 u_up_vector_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying vec2 v_pos0;void main() {v_pos0=a_uv;vec2 uv=a_uv*EXTENT;vec4 up_vector=u_up_vector_matrix*vec4(elevationVector(uv),1.0);float height=elevation(uv);vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}"),globeAtmosphere:Mn("uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {highp vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)\ndiscard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}","attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}"),globeDepth:Mn("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat4 u_up_vector_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying float v_depth;void main() {vec2 uv=a_uv*EXTENT;vec4 up_vector=u_up_vector_matrix*vec4(elevationVector(uv),1.0);float height=elevation(uv);vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);v_depth=gl_Position.z/gl_Position.w;}")};function Mn(x,l,f){const w=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,A=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,M=l.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),O=x.match(A),U=l.match(A),X=nu.match(A);let Z=U?U.concat(O):O;f||(iu.staticUniforms&&(Z=iu.staticUniforms.concat(Z)),Xt.staticUniforms&&(Z=Xt.staticUniforms.concat(Z))),Z&&(Z=Z.concat(X));const ee={};return{fragmentSource:x=x.replace(w,(ne,de,ye,me,_e)=>(ee[_e]=!0,"define"===de?`\n#ifndef HAS_UNIFORM_u_${_e}\nvarying ${ye} ${me} ${_e};\n#else\nuniform ${ye} ${me} u_${_e};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${_e}\n    ${ye} ${me} ${_e} = u_${_e};\n#endif\n`)),vertexSource:l=l.replace(w,(ne,de,ye,me,_e)=>{const De="float"===me?"vec2":"vec4",ve=_e.match(/color/)?"color":De;return ee[_e]?"define"===de?`\n#ifndef HAS_UNIFORM_u_${_e}\nuniform lowp float u_${_e}_t;\nattribute ${ye} ${De} a_${_e};\nvarying ${ye} ${me} ${_e};\n#else\nuniform ${ye} ${me} u_${_e};\n#endif\n`:"vec4"===ve?`\n#ifndef HAS_UNIFORM_u_${_e}\n    ${_e} = a_${_e};\n#else\n    ${ye} ${me} ${_e} = u_${_e};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${_e}\n    ${_e} = unpack_mix_${ve}(a_${_e}, u_${_e}_t);\n#else\n    ${ye} ${me} ${_e} = u_${_e};\n#endif\n`:"define"===de?`\n#ifndef HAS_UNIFORM_u_${_e}\nuniform lowp float u_${_e}_t;\nattribute ${ye} ${De} a_${_e};\n#else\nuniform ${ye} ${me} u_${_e};\n#endif\n`:"vec4"===ve?`\n#ifndef HAS_UNIFORM_u_${_e}\n    ${ye} ${me} ${_e} = a_${_e};\n#else\n    ${ye} ${me} ${_e} = u_${_e};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${_e}\n    ${ye} ${me} ${_e} = unpack_mix_${ve}(a_${_e}, u_${_e}_t);\n#else\n    ${ye} ${me} ${_e} = u_${_e};\n#endif\n`}),staticAttributes:M,staticUniforms:Z}}class Hh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,f,w,A,M,O,U,X){this.context=l;let Z=this.boundPaintVertexBuffers.length!==A.length;for(let ee=0;!Z&&ee<A.length;ee++)this.boundPaintVertexBuffers[ee]!==A[ee]&&(Z=!0);l.extVertexArrayObject&&this.vao&&this.boundProgram===f&&this.boundLayoutVertexBuffer===w&&!Z&&this.boundIndexBuffer===M&&this.boundVertexOffset===O&&this.boundDynamicVertexBuffer===U&&this.boundDynamicVertexBuffer2===X?(l.bindVertexArrayOES.set(this.vao),U&&U.bind(),M&&M.dynamicDraw&&M.bind(),X&&X.bind()):this.freshBind(f,w,A,M,O,U,X)}freshBind(l,f,w,A,M,O,U){let X;const Z=l.numAttributes,ee=this.context,ne=ee.gl;if(ee.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ee.extVertexArrayObject.createVertexArrayOES(),ee.bindVertexArrayOES.set(this.vao),X=0,this.boundProgram=l,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=A,this.boundVertexOffset=M,this.boundDynamicVertexBuffer=O,this.boundDynamicVertexBuffer2=U;else{X=ee.currentNumAttributes||0;for(let de=Z;de<X;de++)ne.disableVertexAttribArray(de)}f.enableAttributes(ne,l);for(const de of w)de.enableAttributes(ne,l);O&&O.enableAttributes(ne,l),U&&U.enableAttributes(ne,l),f.bind(),f.setVertexAttribPointers(ne,l,M);for(const de of w)de.bind(),de.setVertexAttribPointers(ne,l,M);O&&(O.bind(),O.setVertexAttribPointers(ne,l,M)),A&&A.bind(),U&&(U.bind(),U.setVertexAttribPointers(ne,l,M)),ee.currentNumAttributes=Z}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Uo(x,l){const f=Math.pow(2,l.canonical.z),w=l.canonical.y;return[new v.MercatorCoordinate(0,w/f).toLngLat().lat,new v.MercatorCoordinate(0,(w+1)/f).toLngLat().lat]}function Ms(x,l,f,w,A,M,O){const U=x.context,X=U.gl,Z=f.fbo;if(!Z)return;x.prepareDrawTile(l);const ee=x.useProgram("hillshade");U.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,Z.colorAttachment.get());const ne=((_e,De,ve,Ee)=>{const Me=ve.paint.get("hillshade-shadow-color"),be=ve.paint.get("hillshade-highlight-color"),ke=ve.paint.get("hillshade-accent-color");let Fe=ve.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ve.paint.get("hillshade-illumination-anchor")&&(Fe-=_e.transform.angle);const Qe=!_e.options.moving;return{u_matrix:Ee||_e.transform.calculateProjMatrix(De.tileID.toUnwrapped(),Qe),u_image:0,u_latrange:Uo(0,De.tileID),u_light:[ve.paint.get("hillshade-exaggeration"),Fe],u_shadow:Me,u_highlight:be,u_accent:ke}})(x,f,w,x.terrain?l.projMatrix:null);x.prepareDrawProgram(U,ee,l.toUnwrapped());const{tileBoundsBuffer:de,tileBoundsIndexBuffer:ye,tileBoundsSegments:me}=x.getTileBoundsBuffers(f);ee.draw(U,X.TRIANGLES,A,M,O,v.CullFaceMode.disabled,ne,w.id,de,ye,me)}function zu(x,l,f){if(!l.needsDEMTextureUpload)return;const w=x.context,A=w.gl;w.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||x.getTileTexture(f.stride);const M=f.getPixels();l.demTexture?l.demTexture.update(M,{premultiply:!1}):l.demTexture=new v.Texture(w,M,A.RGBA,{premultiply:!1}),l.needsDEMTextureUpload=!1}function Bu(x,l,f,w,A,M){const O=x.context,U=O.gl;if(!l.dem)return;const X=l.dem;if(O.activeTexture.set(U.TEXTURE1),zu(x,l,X),!l.demTexture)return;l.demTexture.bind(U.NEAREST,U.CLAMP_TO_EDGE);const Z=X.dim;O.activeTexture.set(U.TEXTURE0);let ee=l.fbo;if(!ee){const me=new v.Texture(O,{width:Z,height:Z,data:null},U.RGBA);me.bind(U.LINEAR,U.CLAMP_TO_EDGE),ee=l.fbo=O.createFramebuffer(Z,Z,!0),ee.colorAttachment.set(me.texture)}O.bindFramebuffer.set(ee.framebuffer),O.viewport.set([0,0,Z,Z]);const{tileBoundsBuffer:ne,tileBoundsIndexBuffer:de,tileBoundsSegments:ye}=x.getMercatorTileBoundsBuffers();x.useProgram("hillshadePrepare").draw(O,U.TRIANGLES,w,A,M,v.CullFaceMode.disabled,((me,_e)=>{const De=_e.stride,ve=v.create$1();return v.ortho(ve,0,v.EXTENT,-v.EXTENT,0,0,1),v.translate(ve,ve,[0,-v.EXTENT,0]),{u_matrix:ve,u_image:1,u_dimension:[De,De],u_zoom:me.overscaledZ,u_unpack:_e.unpackVector}})(l.tileID,X),f.id,ne,de,ye),l.needsHillshadePrepare=!1}const ln=(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_image0:new v.Uniform1i(x,l.u_image0),u_skirt_height:new v.Uniform1f(x,l.u_skirt_height)}),ru=(x,l)=>({u_matrix:x,u_image0:0,u_skirt_height:l}),Vu=new class{constructor(){this.operations={}}newMorphing(x,l,f,w,A){if(x in this.operations){const M=this.operations[x];M.to.tileID.key!==f.tileID.key&&(M.queued=f)}else this.operations[x]={startTime:w,phase:0,duration:A,from:l,to:f,queued:null}}getMorphValuesForProxy(x){if(!(x in this.operations))return null;const l=this.operations[x];return{from:l.from,to:l.to,phase:l.phase}}update(x){for(const l in this.operations){const f=this.operations[l];for(f.phase=(x-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,x)){delete this.operations[l];break}}}_nextOp(x,l){return!!x.queued&&(x.from=x.to,x.to=x.queued,x.queued=null,x.phase=0,x.startTime=l,!0)}_validOp(x){return x.from.hasData()&&x.to.hasData()}},jh={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function cg(x,l){const f=1<<x.z;return!l&&(0===x.x||x.x===f-1)||0===x.y||x.y===f-1}const Gn=x=>({u_matrix:x});function pp(x,l,f,w,A){if(A>0){const M=v.exported.now(),O=(M-x.timeAdded)/A,U=l?(M-l.timeAdded)/A:-1,X=f.getSource(),Z=w.coveringZoomLevel({tileSize:X.tileSize,roundZoom:X.roundZoom}),ee=!l||Math.abs(l.tileID.overscaledZ-Z)>Math.abs(x.tileID.overscaledZ-Z),ne=ee&&x.refreshedUponExpiration?1:v.clamp(ee?O:1-U,0,1);return x.refreshedUponExpiration&&O>=1&&(x.refreshedUponExpiration=!1),l?{opacity:1,mix:1-ne}:{opacity:ne,mix:0}}return{opacity:1,mix:0}}class ky extends v.SourceCache{constructor(l){const f=ue("proxy",{type:"geojson",maxzoom:l.transform.maxZoom},new Bi(Tt(),null),l.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=l,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(l,f,w){if(l.freezeTileCoverage)return;this.transform=l;const A=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((M,O)=>{if(M[O.key]="",!this._tiles[O.key]){const U=new v.Tile(O,this._source.tileSize*O.overscaleFactor(),l.tileZoom);U.state="loaded",this._tiles[O.key]=U}return M},{});for(const M in this._tiles)M in A||(this.freeFBO(M),this._tiles[M].unloadVectorData(),delete this._tiles[M])}freeFBO(l){const f=this.proxyCachedFBO[l];if(void 0!==f){const w=Object.values(f);this.renderCachePool.push(...w),delete this.proxyCachedFBO[l]}}deallocRenderCache(){this.renderCache.forEach(l=>l.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class vl extends v.OverscaledTileID{constructor(l,f,w){super(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y),this.proxyTileKey=f,this.projMatrix=w}}class ii extends v.Elevation{constructor(l,f){super(),this.painter=l,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[w,A,M]=function(X){const Z=new v.StructArrayLayout4i8,ee=new v.StructArrayLayout3ui6;Z.reserve(17161),ee.reserve(33800);const de=v.EXTENT/128,ye=v.EXTENT+de/2,me=ye+de;for(let De=-de;De<me;De+=de)for(let ve=-de;ve<me;ve+=de){const Ee=ve<0||ve>ye||De<0||De>ye?24575:0,Me=v.clamp(Math.round(ve),0,v.EXTENT),be=v.clamp(Math.round(De),0,v.EXTENT);Z.emplaceBack(Me+Ee,be,Me,be)}const _e=(De,ve)=>{const Ee=131*ve+De;ee.emplaceBack(Ee+1,Ee,Ee+131),ee.emplaceBack(Ee+131,Ee+131+1,Ee+1)};for(let De=1;De<129;De++)for(let ve=1;ve<129;ve++)_e(ve,De);return[0,129].forEach(De=>{for(let ve=0;ve<130;ve++)_e(ve,De),_e(De,ve)}),[Z,ee,32768]}(),O=l.context;this.gridBuffer=O.createVertexBuffer(w,v.boundsAttributes.members),this.gridIndexBuffer=O.createIndexBuffer(A),this.gridSegments=v.SegmentVector.simpleSegment(0,0,w.length,A.length),this.gridNoSkirtSegments=v.SegmentVector.simpleSegment(0,0,w.length,M),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ky(f.map),this.orthoMatrix=v.create$1(),v.ortho(this.orthoMatrix,0,v.EXTENT,0,v.EXTENT,0,1);const U=O.gl;this._overlapStencilMode=new v.StencilMode({func:U.GEQUAL,mask:255},0,255,U.KEEP,U.KEEP,U.REPLACE),this._previousZoom=l.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1}set style(l){l.on("data",this._onStyleDataEvent.bind(this)),l.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=l,this._checkRenderCacheEfficiency()}update(l,f,w){if(l&&l.terrain){this._style!==l&&(this.style=l),this.enabled=!0;const A=l.terrain.properties;this.sourceCache=l._getSourceCache(A.get("source")),this._exaggeration=A.get("exaggeration");const M=()=>{this.sourceCache.used&&v.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const O=this.sourceCache.getSource().tileSize/128,U=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(f,O*U,!0),this._findCoveringTileCache[this.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,M(),this._initializing=!0),M(),f.updateElevation(!w),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0}else this._disable()}_checkRenderCacheEfficiency(){const l=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==l.efficiency&&v.warnOnce(`Terrain render cache efficiency is not optimal (${l.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${l.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(l){l.coord&&"source"===l.dataType?this._clearRenderCacheForTile(l.sourceCacheId,l.coord):"style"===l.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const l in this._style._sourceCaches)this._style._sourceCaches[l].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(l=>l.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const l=2*this.proxySourceCache.getSource().tileSize;return[l,l]}set useVertexMorphing(l){this._useVertexMorphing=l}updateTileBinding(l){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,w=this.painter.transform;this._initializing&&(this._initializing=0===w._centerAltitude&&-1===this.getAtPointOrZero(v.MercatorCoordinate.fromLngLat(w.center),-1),this._emptyDEMTextureDirty=!this._initializing);const A=this.proxyCoords=f.getIds().map(X=>{const Z=f.getTileByID(X).tileID;return Z.projMatrix=w.calculateProjMatrix(Z.toUnwrapped()),Z});(function(X,Z){const ee=Z.transform.pointCoordinate(Z.transform.getCameraPoint()),ne=new v.pointGeometry(ee.x,ee.y);X.sort((de,ye)=>{if(ye.overscaledZ-de.overscaledZ)return ye.overscaledZ-de.overscaledZ;const me=new v.pointGeometry(de.canonical.x+(1<<de.canonical.z)*de.wrap,de.canonical.y),_e=new v.pointGeometry(ye.canonical.x+(1<<ye.canonical.z)*ye.wrap,ye.canonical.y),De=ne.mult(1<<de.canonical.z);return De.x-=.5,De.y-=.5,De.distSqr(me)-De.distSqr(_e)})})(A,this.painter),this._previousZoom=w.zoom;const M=this.proxyToSource||{};this.proxyToSource={},A.forEach(X=>{this.proxyToSource[X.key]={}}),this.terrainTileForTile={};const O=this._style._sourceCaches;for(const X in O){const Z=O[X];if(!Z.used||(Z!==this.sourceCache&&(this._findCoveringTileCache[Z.id]={}),this._setupProxiedCoordsForOrtho(Z,l[X],M),Z.usedForTerrain))continue;const ee=l[X];Z.getSource().reparseOverscaled&&this._assignTerrainTiles(ee)}this.proxiedCoords[f.id]=A.map(X=>new vl(X,X.key,this.orthoMatrix)),this._assignTerrainTiles(A),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(M),this.renderingToTexture=!1,this._updateTimestamp=v.exported.now();const U={};this._visibleDemTiles=[];for(const X of this.proxyCoords){const Z=this.terrainTileForTile[X.key];if(!Z)continue;const ee=Z.tileID.key;ee in U||(this._visibleDemTiles.push(Z),U[ee]=ee)}}_assignTerrainTiles(l){this._initializing||l.forEach(f=>{if(this.terrainTileForTile[f.key])return;const w=this._findTileCoveringTileID(f,this.sourceCache);w&&(this.terrainTileForTile[f.key]=w)})}_prepareDEMTextures(){const l=this.painter.context,f=l.gl;for(const w in this.terrainTileForTile){const A=this.terrainTileForTile[w],M=A.dem;!M||A.demTexture&&!A.needsDEMTextureUpload||(l.activeTexture.set(f.TEXTURE1),zu(this.painter,A,M))}}_prepareDemTileUniforms(l,f,w,A){if(!f||null==f.demTexture)return!1;const M=l.tileID.canonical,O=Math.pow(2,f.tileID.canonical.z-M.z),U=A||"";return w[`u_dem_tl${U}`]=[M.x*O%1,M.y*O%1],w[`u_dem_scale${U}`]=O,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let l=0;const f=this._visibleDemTiles.reduce((w,A)=>{if(!A.dem)return w;const M=A.dem.tree.minimums[0];return M>0&&l++,w+M},0);return l?f/l:0}_updateEmptyDEMTexture(){const l=this.painter.context,f=l.gl;l.activeTexture.set(f.TEXTURE2);const w=this._getLoadedAreaMinimum(),A={width:1,height:1,data:new Uint8Array(v.DEMData.pack(w,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let M=this._emptyDEMTexture;return M?M.update(A,{premultiply:!1}):M=this._emptyDEMTexture=new v.Texture(l,A,f.RGBA,{premultiply:!1}),M}setupElevationDraw(l,f,w){const A=this.painter.context,M=A.gl,O=(U=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:v.DEMData.getUnpackVector(U),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var U;O.u_dem_size=this.sourceCache.getSource().tileSize,O.u_exaggeration=this.exaggeration();let X=null,Z=null,ee=1;if(w&&w.morphing&&this._useVertexMorphing){const ne=w.morphing.srcDemTile,de=w.morphing.dstDemTile;ee=w.morphing.phase,ne&&de&&(this._prepareDemTileUniforms(l,ne,O,"_prev")&&(Z=ne),this._prepareDemTileUniforms(l,de,O)&&(X=de))}if(Z&&X?(A.activeTexture.set(M.TEXTURE2),X.demTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE,M.NEAREST),A.activeTexture.set(M.TEXTURE4),Z.demTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE,M.NEAREST),O.u_dem_lerp=ee):(X=this.terrainTileForTile[l.tileID.key],A.activeTexture.set(M.TEXTURE2),(this._prepareDemTileUniforms(l,X,O)?X.demTexture:this.emptyDEMTexture).bind(M.NEAREST,M.CLAMP_TO_EDGE)),w&&w.useDepthForOcclusion&&(A.activeTexture.set(M.TEXTURE3),this._depthTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE),O.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),w&&w.useMeterToDem&&X){const ne=(1<<X.tileID.canonical.z)*v.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;O.u_meter_to_dem=ne}w&&w.labelPlaneMatrixInv&&(O.u_label_plane_matrix_inv=w.labelPlaneMatrixInv),f.setTerrainUniformValues(A,O)}renderToBackBuffer(l){const f=this.painter,w=this.painter.context;0!==l.length&&(w.bindFramebuffer.set(null),w.viewport.set([0,0,f.width,f.height]),this.renderingToTexture=!1,function(A,M,O,U,X){const Z=A.context,ee=Z.gl;let ne,de;const ye=A.options.showTerrainWireframe?2:0,me=(Me,be)=>{if(de===Me)return;const ke=[jh[Me]];be&&ke.push(jh[ye]),ne=A.useProgram("terrainRaster",null,ke),de=Me},_e=A.colorModeForRenderPass(),De=new v.DepthMode(ee.LEQUAL,v.DepthMode.ReadWrite,A.depthRangeFor3D);Vu.update(X);const ve=A.transform,Ee=6*Math.pow(1.5,22-ve.zoom)*M.exaggeration();(ye?[!1,!0]:[!1]).forEach(Me=>{de=-1;const be=Me?ee.LINES:ee.TRIANGLES,[ke,Fe]=Me?M.getWirefameBuffer():[M.gridIndexBuffer,M.gridSegments];for(const rt of U){const st=O.getTile(rt),_t=v.StencilMode.disabled,it=M.prevTerrainTileForTile[rt.key],At=M.terrainTileForTile[rt.key];Ke=At,null!=(Qe=it)&&null!=Ke&&Qe.hasData()&&Ke.hasData()&&null!=Qe.demTexture&&null!=Ke.demTexture&&Qe.tileID.key!==Ke.tileID.key&&Vu.newMorphing(rt.key,it,At,X,250),Z.activeTexture.set(ee.TEXTURE0),st.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const Ye=Vu.getMorphValuesForProxy(rt.key),Et=Ye?1:0;let Lt;Ye&&(Lt={morphing:{srcDemTile:Ye.from,dstDemTile:Ye.to,phase:v.easeCubicInOut(Ye.phase)}});const Yt=ru(rt.projMatrix,cg(rt.canonical,ve.renderWorldCopies)?Ee/10:Ee);me(Et,Me),M.setupElevationDraw(st,ne,Lt),A.prepareDrawProgram(Z,ne,rt.toUnwrapped()),ne.draw(Z,be,De,_t,_e,v.CullFaceMode.backCCW,Yt,"terrain_raster",M.gridBuffer,ke,Fe)}var Qe,Ke})}(f,this,this.proxySourceCache,l,this._updateTimestamp),this.renderingToTexture=!0,l.splice(0,l.length))}renderBatch(l){if(0===this._drapedRenderBatches.length)return l+1;this.renderingToTexture=!0;const f=this.painter,w=this.painter.context,A=this.proxySourceCache,M=this.proxiedCoords[A.id],O=this._drapedRenderBatches.shift(),U=[],X=f.style.order;let Z=0;for(const ee of M){const ne=A.getTileByID(ee.proxyTileKey),de=A.proxyCachedFBO[ee.key]?A.proxyCachedFBO[ee.key][l]:void 0,ye=void 0!==de?A.renderCache[de]:this.pool[Z++],me=void 0!==de;if(ne.texture=ye.tex,me&&!ye.dirty){U.push(ne.tileID);continue}let _e;w.bindFramebuffer.set(ye.fb.framebuffer),this.renderedToTile=!1,ye.dirty&&(w.clear({color:v.Color.transparent}),ye.dirty=!1);for(let De=O.start;De<=O.end;++De){const ve=f.style._layers[X[De]];if(ve.isHidden(f.transform.zoom))continue;const Ee=f.style._getLayerSourceCache(ve),Me=Ee?this.proxyToSource[ee.key][Ee.id]:[ee];if(!Me)continue;const be=Me;w.viewport.set([0,0,ye.fb.width,ye.fb.height]),_e!==(Ee?Ee.id:null)&&(this._setupStencil(ye,Me,ve,Ee),_e=Ee?Ee.id:null),f.renderLayer(f,Ee,ve,be)}this.renderedToTile?(ye.dirty=!0,U.push(ne.tileID)):me||--Z,5===Z&&(Z=0,this.renderToBackBuffer(U))}return this.renderToBackBuffer(U),this.renderingToTexture=!1,w.bindFramebuffer.set(null),w.viewport.set([0,0,f.width,f.height]),O.end+1}postRender(){}renderCacheEfficiency(l){const f=l.order.length;if(0===f)return{efficiency:100};let w,A=0,M=0,O=!1;for(let U=0;U<f;++U){const X=l._layers[l.order[U]];this._style.isLayerDraped(X)?(O&&++A,++M):O||(O=!0,w=X.id)}return 0===M?{efficiency:100}:{efficiency:100*(1-A/M),firstUndrapedLayer:w}}getMinElevationBelowMSL(){let l=0;return this._visibleDemTiles.filter(f=>f.dem).forEach(f=>{l=Math.min(l,f.dem.tree.minimums[0])}),0===l?l:(l-30)*this._exaggeration}raycast(l,f,w){if(!this._visibleDemTiles)return null;const A=this._visibleDemTiles.filter(M=>M.dem).map(M=>{const O=M.tileID,U=Math.pow(2,O.overscaledZ),{x:X,y:Z}=O.canonical,ee=X/U,ne=(X+1)/U,de=Z/U,ye=(Z+1)/U;return{minx:ee,miny:de,maxx:ne,maxy:ye,t:M.dem.tree.raycastRoot(ee,de,ne,ye,l,f,w),tile:M}});A.sort((M,O)=>(null!==M.t?M.t:Number.MAX_VALUE)-(null!==O.t?O.t:Number.MAX_VALUE));for(const M of A){if(null==M.t)return null;const O=M.tile.dem.tree.raycast(M.minx,M.miny,M.maxx,M.maxy,l,f,w);if(null!=O)return O}return null}_createFBO(){const l=this.painter.context,f=l.gl,w=this.drapeBufferSize;l.activeTexture.set(f.TEXTURE0);const A=new v.Texture(l,{width:w[0],height:w[1],data:null},f.RGBA);A.bind(f.LINEAR,f.CLAMP_TO_EDGE);const M=l.createFramebuffer(w[0],w[1],!1);return M.colorAttachment.set(A.texture),M.depthAttachment=new Ei(l,M.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=l.createRenderbuffer(l.gl.DEPTH_STENCIL,w[0],w[1]),this._stencilRef=0,M.depthAttachment.set(this._sharedDepthStencil),l.clear({stencil:0})):M.depthAttachment.set(this._sharedDepthStencil),l.extTextureFilterAnisotropic&&!l.extTextureFilterAnisotropicForceOff&&f.texParameterf(f.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax),{fb:M,tex:A,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const l in this._style._sourceCaches)if(this._style._sourceCaches[l].hasTransition())return!0;return this._style.order.some(l=>{const f=this._style._layers[l],w=f.isHidden(this.painter.transform.zoom),A=f.getCrossfadeParameters(),M=!!A&&1!==A.t,O=f.hasTransition();return"custom"!==f.type&&!w&&(M||O)})}_clearRasterFadeFromRenderCache(){let l=!1;for(const f in this._style._sourceCaches)if(this._style._sourceCaches[f]._source instanceof Sa){l=!0;break}if(l)for(let f=0;f<this._style.order.length;++f){const w=this._style._layers[this._style.order[f]],A=w.isHidden(this.painter.transform.zoom),M=this._style._getLayerSourceCache(w);if("raster"!==w.type||A||!M)continue;const O=w.paint.get("raster-fade-duration");for(const U of this.proxyCoords){const X=this.proxyToSource[U.key][M.id];if(X)for(const Z of X){const ee=pp(M.getTile(Z),M.findLoadedParent(Z,0),M,this.painter.transform,O);(1!==ee.opacity||0!==ee.mix)&&this._clearRenderCacheForTile(M.id,Z)}}}}_setupDrapedRenderBatches(){const l=this._style.order,f=l.length;if(0===f)return;const w=[];let A,M=0,O=this._style._layers[l[M]];for(;!this._style.isLayerDraped(O)&&O.isHidden(this.painter.transform.zoom)&&++M<f;)O=this._style._layers[l[M]];for(;M<f;++M){const U=this._style._layers[l[M]];U.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(U)?void 0===A&&(A=M):void 0!==A&&(w.push({start:A,end:M-1}),A=void 0))}void 0!==A&&w.push({start:A,end:M-1}),this._drapedRenderBatches=w}_setupRenderCache(l){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const O=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let U=0;U<O.length;++U){const X=Object.values(O[U]);f.renderCachePool.push(...X)}}return}this._clearRasterFadeFromRenderCache();const w=this.proxyCoords,A=this._tilesDirty;for(let O=w.length-1;O>=0;O--){const U=w[O];if(f.getTileByID(U.key),void 0!==f.proxyCachedFBO[U.key]){const X=l[U.key],Z=this.proxyToSource[U.key];let ee=0;for(const ne in Z){const de=Z[ne],ye=X[ne];if(!ye||ye.length!==de.length||de.some((me,_e)=>me!==ye[_e]||A[ne]&&A[ne].hasOwnProperty(me.key))){ee=-1;break}++ee}for(const ne in f.proxyCachedFBO[U.key])f.renderCache[f.proxyCachedFBO[U.key][ne]].dirty=ee<0||ee!==Object.values(X).length}}const M=[...this._drapedRenderBatches];M.sort((O,U)=>U.end-U.start-(O.end-O.start));for(const O of M)for(const U of w){if(f.proxyCachedFBO[U.key])continue;let X=f.renderCachePool.pop();void 0===X&&f.renderCache.length<50&&(X=f.renderCache.length,f.renderCache.push(this._createFBO())),void 0!==X&&(f.proxyCachedFBO[U.key]={},f.proxyCachedFBO[U.key][O.start]=X,f.renderCache[X].dirty=!0)}this._tilesDirty={}}_setupStencil(l,f,w,A){if(!A||!this._sourceTilesOverlap[A.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const M=this.painter.context,O=M.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let U;if(w.isTileClipped())U=f.length,this._overlapStencilMode.test={func:O.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);U=1,this._overlapStencilMode.test={func:O.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+U>255&&(M.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=U,this._overlapStencilMode.ref=this._stencilRef,w.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}stencilModeForRTTOverlap(l){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[l.key]),this._overlapStencilMode):v.StencilMode.disabled}_renderTileClippingMasks(l,f){const w=this.painter,A=this.painter.context,M=A.gl;w._tileClippingMaskIDs={},A.setColorMode(v.ColorMode.disabled),A.setDepthMode(v.DepthMode.disabled);const O=w.useProgram("clippingMask");for(const U of l){const X=w._tileClippingMaskIDs[U.key]=--f;O.draw(A,M.TRIANGLES,v.DepthMode.disabled,new v.StencilMode({func:M.ALWAYS,mask:0},X,255,M.KEEP,M.KEEP,M.REPLACE),v.ColorMode.disabled,v.CullFaceMode.disabled,Gn(U.projMatrix),"$clipping",w.tileExtentBuffer,w.quadTriangleIndexBuffer,w.tileExtentSegments)}}pointCoordinate(l){const f=this.painter.transform;if(l.x<0||l.x>f.width||l.y<0||l.y>f.height)return null;const w=[l.x,l.y,1,1];v.transformMat4(w,w,f.pixelMatrixInverse),v.scale$2(w,w,1/w[3]),w[0]/=f.worldSize,w[1]/=f.worldSize;const A=f._camera.position,M=v.mercatorZfromAltitude(1,f.center.lat),O=[A[0],A[1],A[2]/M,0],U=v.subtract([],w.slice(0,3),O);v.normalize(U,U);const X=this.raycast(O,U,this._exaggeration);return null!==X&&X?(v.scaleAndAdd(O,O,U,X),O[3]=O[2],O[2]*=M,O):null}drawDepth(){const l=this.painter,f=l.context,w=this.proxySourceCache,A=Math.ceil(l.width),M=Math.ceil(l.height);if(!this._depthFBO||this._depthFBO.width===A&&this._depthFBO.height===M||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const O=f.gl,U=f.createFramebuffer(A,M,!0);f.activeTexture.set(O.TEXTURE0);const X=new v.Texture(f,{width:A,height:M,data:null},O.RGBA);X.bind(O.NEAREST,O.CLAMP_TO_EDGE),U.colorAttachment.set(X.texture);const Z=f.createRenderbuffer(f.gl.DEPTH_COMPONENT16,A,M);U.depthAttachment.set(Z),this._depthFBO=U,this._depthTexture=X}f.bindFramebuffer.set(this._depthFBO.framebuffer),f.viewport.set([0,0,A,M]),function(O,U,X,Z){const ee=O.context,ne=ee.gl;ee.clear({depth:1});const de=O.useProgram("terrainDepth"),ye=new v.DepthMode(ne.LESS,v.DepthMode.ReadWrite,O.depthRangeFor3D);for(const me of Z){const _e=X.getTile(me),De=ru(me.projMatrix,0);U.setupElevationDraw(_e,de),de.draw(ee,ne.TRIANGLES,ye,v.StencilMode.disabled,v.ColorMode.unblended,v.CullFaceMode.backCCW,De,"terrain_depth",U.gridBuffer,U.gridIndexBuffer,U.gridNoSkirtSegments)}}(l,this,w,this.proxyCoords)}_setupProxiedCoordsForOrtho(l,f,w){if(l.getSource()instanceof we)return this._setupProxiedCoordsForImageSource(l,f,w);this._findCoveringTileCache[l.id]=this._findCoveringTileCache[l.id]||{};const A=this.proxiedCoords[l.id]=[],M=this.proxyCoords;for(let U=0;U<M.length;U++){const X=M[U],Z=this._findTileCoveringTileID(X,l);if(Z){const ee=this._createProxiedId(X,Z,w[X.key]&&w[X.key][l.id]);A.push(ee),this.proxyToSource[X.key][l.id]=[ee]}}let O=!1;for(let U=0;U<f.length;U++){const X=l.getTile(f[U]);if(!X||!X.hasData())continue;const Z=this._findTileCoveringTileID(X.tileID,this.proxySourceCache);if(Z&&Z.tileID.canonical.z!==X.tileID.canonical.z){const ee=this.proxyToSource[Z.tileID.key][l.id],ne=this._createProxiedId(Z.tileID,X,w[Z.tileID.key]&&w[Z.tileID.key][l.id]);ee?ee.splice(ee.length-1,0,ne):this.proxyToSource[Z.tileID.key][l.id]=[ne],A.push(ne),O=!0}}this._sourceTilesOverlap[l.id]=O}_setupProxiedCoordsForImageSource(l,f,w){if(!l.getSource().loaded())return;const A=this.proxiedCoords[l.id]=[],M=this.proxyCoords,O=l.getSource(),U=new v.pointGeometry(O.tileID.x,O.tileID.y)._div(1<<O.tileID.z),X=O.coordinates.map(v.MercatorCoordinate.fromLngLat).reduce((ee,ne)=>(ee.min.x=Math.min(ee.min.x,ne.x-U.x),ee.min.y=Math.min(ee.min.y,ne.y-U.y),ee.max.x=Math.max(ee.max.x,ne.x-U.x),ee.max.y=Math.max(ee.max.y,ne.y-U.y),ee),{min:new v.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new v.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Z=(ee,ne)=>{const de=ee.wrap+ee.canonical.x/(1<<ee.canonical.z),ye=ee.canonical.y/(1<<ee.canonical.z),me=v.EXTENT/(1<<ee.canonical.z),_e=ne.wrap+ne.canonical.x/(1<<ne.canonical.z),De=ne.canonical.y/(1<<ne.canonical.z);return de+me<_e+X.min.x||de>_e+X.max.x||ye+me<De+X.min.y||ye>De+X.max.y};for(let ee=0;ee<M.length;ee++){const ne=M[ee];for(let de=0;de<f.length;de++){const ye=l.getTile(f[de]);if(!ye||!ye.hasData()||Z(ne,ye.tileID))continue;const me=this._createProxiedId(ne,ye,w[ne.key]&&w[ne.key][l.id]),_e=this.proxyToSource[ne.key][l.id];_e?_e.push(me):this.proxyToSource[ne.key][l.id]=[me],A.push(me)}}}_createProxiedId(l,f,w){let A=this.orthoMatrix;if(w){const M=w.find(O=>O.key===f.tileID.key);if(M)return M}if(f.tileID.key!==l.key){const M=l.canonical.z-f.tileID.canonical.z;let O,U,X;A=v.create$1();const Z=f.tileID.wrap-l.wrap<<l.overscaledZ;M>0?(O=v.EXTENT>>M,U=O*((f.tileID.canonical.x<<M)-l.canonical.x+Z),X=O*((f.tileID.canonical.y<<M)-l.canonical.y)):(O=v.EXTENT<<-M,U=v.EXTENT*(f.tileID.canonical.x-(l.canonical.x+Z<<-M)),X=v.EXTENT*(f.tileID.canonical.y-(l.canonical.y<<-M))),v.ortho(A,0,O,0,O,0,1),v.translate(A,A,[U,X,0])}return new vl(f.tileID,l.key,A)}_findTileCoveringTileID(l,f){let w=f.getTile(l);if(w&&w.hasData())return w;const A=this._findCoveringTileCache[f.id],M=A[l.key];if(w=M?f.getTileByID(M):null,w&&w.hasData()||null===M)return w;let O=w?w.tileID:l,U=O.overscaledZ;const X=f.getSource().minzoom,Z=[];if(!M){const ne=f.getSource().maxzoom;if(l.canonical.z>=ne){const de=l.canonical.z-ne;f.getSource().reparseOverscaled?(U=Math.max(l.canonical.z+2,f.transform.tileZoom),O=new v.OverscaledTileID(U,l.wrap,ne,l.canonical.x>>de,l.canonical.y>>de)):0!==de&&(U=ne,O=new v.OverscaledTileID(U,l.wrap,ne,l.canonical.x>>de,l.canonical.y>>de))}O.key!==l.key&&(Z.push(O.key),w=f.getTile(O))}const ee=ne=>{Z.forEach(de=>{A[de]=ne}),Z.length=0};for(U-=1;U>=X&&(!w||!w.hasData());U--){w&&ee(w.tileID.key);const ne=O.calculateScaledKey(U);if(w=f.getTileByID(ne),w&&w.hasData())break;const de=A[ne];if(null===de)break;void 0===de?Z.push(ne):w=f.getTileByID(de)}return ee(w?w.tileID.key:null),w&&w.hasData()?w:null}findDEMTileFor(l){return this.enabled?this._findTileCoveringTileID(l,this.sourceCache):null}prepareDrawTile(l){this.renderedToTile=!0}_clearRenderCacheForTile(l,f){let w=this._tilesDirty[l];w||(w=this._tilesDirty[l]={}),w[f.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const l=function(f){let w,A,M;const O=new v.StructArrayLayout2ui4,U=131;for(A=1;A<129;A++){for(w=1;w<129;w++)M=A*U+w,O.emplaceBack(M,M+1),O.emplaceBack(M,M+U),O.emplaceBack(M+1,M+U),128===A&&O.emplaceBack(M+U,M+U+1);O.emplaceBack(M+1,M+1+U)}return O}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(l),this.wireframeSegments=v.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,l.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function xl(x){const l=[];for(let f=0;f<x.length;f++){if(null===x[f])continue;const w=x[f].split(" ");l.push(w.pop())}return l}class gc{static cacheKey(l,f,w){let A=`${l}${w?w.cacheKey:""}`;for(const M of f)A+=`/${M}`;return A}constructor(l,f,w,A,M,O){const U=l.gl;this.program=U.createProgram();const X=xl(w.staticAttributes),Z=A?A.getBinderAttributes():[],ee=X.concat(Z),ne=w.staticUniforms?xl(w.staticUniforms):[],de=A?A.getBinderUniforms():[],ye=ne.concat(de),me=[];for(const ke of ye)me.indexOf(ke)<0&&me.push(ke);let _e=A?A.defines():[];_e=_e.concat(O.map(ke=>`#define ${ke}`));const De=_e.concat("\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",fc,ha.fragmentSource,Xt.fragmentSource,w.fragmentSource).join("\n"),ve=_e.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",fc,ha.vertexSource,Xt.vertexSource,iu.vertexSource,w.vertexSource).join("\n"),Ee=U.createShader(U.FRAGMENT_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);U.shaderSource(Ee,De),U.compileShader(Ee),U.attachShader(this.program,Ee);const Me=U.createShader(U.VERTEX_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);U.shaderSource(Me,ve),U.compileShader(Me),U.attachShader(this.program,Me),this.attributes={};const be={};this.numAttributes=ee.length;for(let ke=0;ke<this.numAttributes;ke++)ee[ke]&&(U.bindAttribLocation(this.program,ke,ee[ke]),this.attributes[ee[ke]]=ke);U.linkProgram(this.program),U.deleteShader(Me),U.deleteShader(Ee);for(let ke=0;ke<me.length;ke++){const Fe=me[ke];if(Fe&&!be[Fe]){const Qe=U.getUniformLocation(this.program,Fe);Qe&&(be[Fe]=Qe)}}var ke,Fe;this.fixedUniforms=M(l,be),this.binderUniforms=A?A.getUniforms(l,be):[],-1!==O.indexOf("TERRAIN")&&(this.terrainUniforms={u_dem:new v.Uniform1i(ke=l,(Fe=be).u_dem),u_dem_prev:new v.Uniform1i(ke,Fe.u_dem_prev),u_dem_unpack:new v.Uniform4f(ke,Fe.u_dem_unpack),u_dem_tl:new v.Uniform2f(ke,Fe.u_dem_tl),u_dem_scale:new v.Uniform1f(ke,Fe.u_dem_scale),u_dem_tl_prev:new v.Uniform2f(ke,Fe.u_dem_tl_prev),u_dem_scale_prev:new v.Uniform1f(ke,Fe.u_dem_scale_prev),u_dem_size:new v.Uniform1f(ke,Fe.u_dem_size),u_dem_lerp:new v.Uniform1f(ke,Fe.u_dem_lerp),u_exaggeration:new v.Uniform1f(ke,Fe.u_exaggeration),u_depth:new v.Uniform1i(ke,Fe.u_depth),u_depth_size_inv:new v.Uniform2f(ke,Fe.u_depth_size_inv),u_meter_to_dem:new v.Uniform1f(ke,Fe.u_meter_to_dem),u_label_plane_matrix_inv:new v.UniformMatrix4f(ke,Fe.u_label_plane_matrix_inv),u_tile_tl_up:new v.Uniform3f(ke,Fe.u_tile_tl_up),u_tile_tr_up:new v.Uniform3f(ke,Fe.u_tile_tr_up),u_tile_br_up:new v.Uniform3f(ke,Fe.u_tile_br_up),u_tile_bl_up:new v.Uniform3f(ke,Fe.u_tile_bl_up),u_tile_up_scale:new v.Uniform1f(ke,Fe.u_tile_up_scale)}),-1!==O.indexOf("FOG")&&(this.fogUniforms=((ke,Fe)=>({u_fog_matrix:new v.UniformMatrix4f(ke,Fe.u_fog_matrix),u_fog_range:new v.Uniform2f(ke,Fe.u_fog_range),u_fog_color:new v.Uniform4f(ke,Fe.u_fog_color),u_fog_horizon_blend:new v.Uniform1f(ke,Fe.u_fog_horizon_blend),u_fog_temporal_offset:new v.Uniform1f(ke,Fe.u_fog_temporal_offset)}))(l,be))}setTerrainUniformValues(l,f){if(!this.terrainUniforms)return;const w=this.terrainUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const A in f)w[A].set(f[A])}}setFogUniformValues(l,f){if(!this.fogUniforms)return;const w=this.fogUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const A in f)w[A].location&&w[A].set(f[A])}}draw(l,f,w,A,M,O,U,X,Z,ee,ne,de,ye,me,_e,De){const ve=l.gl;if(this.failedToCreate)return;l.program.set(this.program),l.setDepthMode(w),l.setStencilMode(A),l.setColorMode(M),l.setCullFace(O);for(const Me in this.fixedUniforms)this.fixedUniforms[Me].set(U[Me]);me&&me.setUniforms(l,this.binderUniforms,de,{zoom:ye});const Ee={[ve.LINES]:2,[ve.TRIANGLES]:3,[ve.LINE_STRIP]:1}[f];for(const Me of ne.get()){const be=Me.vaos||(Me.vaos={});(be[X]||(be[X]=new Hh)).bind(l,this,Z,me?me.getPaintVertexBuffers():[],ee,Me.vertexOffset,_e,De),ve.drawElements(f,Me.primitiveLength*Ee,ve.UNSIGNED_SHORT,Me.primitiveOffset*Ee*2)}}}function mc(x,l,f){const w=1/ir(f,1,l.transform.tileZoom),A=Math.pow(2,f.tileID.overscaledZ),M=f.tileSize*Math.pow(2,l.transform.tileZoom)/A,O=M*(f.tileID.canonical.x+f.tileID.wrap*A),U=M*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_scale:[w,x.fromScale,x.toScale],u_fade:x.t,u_pixel_coord_upper:[O>>16,U>>16],u_pixel_coord_lower:[65535&O,65535&U]}}const Uu=(x,l,f,w)=>{const A=l.style.light,M=A.properties.get("position"),O=[M.x,M.y,M.z],U=v.create$2();"viewport"===A.properties.get("anchor")&&(v.fromRotation(U,-l.transform.angle),v.transformMat3(O,O,U));const X=A.properties.get("color");return{u_matrix:x,u_lightpos:O,u_lightintensity:A.properties.get("intensity"),u_lightcolor:[X.r,X.g,X.b],u_vertical_gradient:+f,u_opacity:w}},da=(x,l,f,w,A,M,O)=>v.extend(Uu(x,l,f,w),mc(M,l,O),{u_height_factor:-Math.pow(2,A.overscaledZ)/O.tileSize/8}),yc=x=>({u_matrix:x}),_c=(x,l,f,w)=>v.extend(yc(x),mc(f,l,w)),Jn=(x,l)=>({u_matrix:x,u_world:l}),fp=(x,l,f,w,A)=>v.extend(_c(x,l,f,w),{u_world:A}),ks=(x,l,f,w)=>{const A=x.transform;let M;return M="map"===w.paint.get("circle-pitch-alignment")?A.calculatePixelsToTileUnitsMatrix(f):new Float32Array([A.pixelsToGLUnits[0],0,0,A.pixelsToGLUnits[1]]),{u_camera_to_center_distance:A.cameraToCenterDistance,u_matrix:x.translatePosMatrix(l.projMatrix,f,w.paint.get("circle-translate"),w.paint.get("circle-translate-anchor")),u_device_pixel_ratio:v.exported.devicePixelRatio,u_extrude_scale:M}},Hu=x=>{const l=[];return"map"===x.paint.get("circle-pitch-alignment")&&l.push("PITCH_WITH_MAP"),"map"===x.paint.get("circle-pitch-scale")&&l.push("SCALE_WITH_MAP"),l},su=(x,l,f)=>{const w=v.EXTENT/f.tileSize;return{u_matrix:x,u_camera_to_center_distance:l.cameraToCenterDistance,u_extrude_scale:[l.pixelsToGLUnits[0]/w,l.pixelsToGLUnits[1]/w]}},Ln=(x,l,f=1)=>({u_matrix:x,u_color:l,u_overlay:0,u_overlay_scale:f}),$h=(x,l,f,w)=>({u_matrix:x,u_extrude_scale:ir(l,1,f),u_intensity:w}),ju=(x,l,f,w,A,M)=>{const O=x.transform,U=O.calculatePixelsToTileUnitsMatrix(l),X={u_matrix:_r(x,l,f,A),u_pixels_to_tile_units:U,u_device_pixel_ratio:v.exported.devicePixelRatio,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:M,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0};if(Ea(f)){const Z=Lr(l,x.transform);X.u_texsize=l.lineAtlasTexture.size,X.u_scale=[Z,w.fromScale,w.toScale],X.u_mix=w.t}return X},Rt=(x,l,f,w,A)=>{const M=x.transform,O=Lr(l,M);return{u_matrix:_r(x,l,f,A),u_texsize:l.imageAtlasTexture.size,u_pixels_to_tile_units:M.calculatePixelsToTileUnitsMatrix(l),u_device_pixel_ratio:v.exported.devicePixelRatio,u_image:0,u_scale:[O,w.fromScale,w.toScale],u_fade:w.t,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]]}};function Lr(x,l){return 1/ir(x,1,l.tileZoom)}function _r(x,l,f,w){return x.translatePosMatrix(w||l.tileID.projMatrix,l,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}const Ho=x=>{const l=[];return Ea(x)&&l.push("RENDER_LINE_DASH"),x.paint.get("line-gradient")&&l.push("RENDER_LINE_GRADIENT"),l};function Ea(x){const l=x.paint.get("line-dasharray").value;return l.value||"constant"!==l.kind}const Ws=(x,l,f,w,A)=>{return{u_matrix:x,u_tl_parent:l,u_scale_parent:f,u_buffer_scale:1,u_fade_t:w.mix,u_opacity:w.opacity*A.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:A.paint.get("raster-brightness-min"),u_brightness_high:A.paint.get("raster-brightness-max"),u_saturation_factor:(O=A.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(M=A.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:zr(A.paint.get("raster-hue-rotate"))};var M,O};function zr(x){x*=Math.PI/180;const l=Math.sin(x),f=Math.cos(x);return[(2*f+1)/3,(-Math.sqrt(3)*l-f+1)/3,(Math.sqrt(3)*l-f+1)/3]}const Ut=(x,l,f,w,A,M,O,U,X,Z,ee,ne,de,ye)=>{const me=A.transform;return{u_is_size_zoom_constant:+("constant"===x||"source"===x),u_is_size_feature_constant:+("constant"===x||"camera"===x),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:me.cameraToCenterDistance,u_pitch:me.pitch/360*2*Math.PI,u_rotate_symbol:+f,u_aspect_ratio:me.width/me.height,u_fade_change:A.options.fadeDuration?A.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:O,u_coord_matrix:U,u_is_text:+X,u_pitch_with_map:+w,u_texsize:Z,u_tile_id:ee,u_zoom_transition:ne,u_inv_rot_matrix:de,u_merc_center:ye,u_texture:0}},En=(x,l,f,w,A,M,O,U,X,Z,ee,ne,de,ye,me)=>{const{cameraToCenterDistance:_e,_pitch:De}=A.transform;return v.extend(Ut(x,l,f,w,A,M,O,U,X,Z,ne,de,ye,me),{u_gamma_scale:w?_e*Math.cos(A.terrain?0:De):1,u_device_pixel_ratio:v.exported.devicePixelRatio,u_is_halo:+ee})},Oi=(x,l,f,w,A,M,O,U,X,Z,ee,ne,de,ye)=>v.extend(En(x,l,f,w,A,M,O,U,!0,X,!0,ee,ne,de,ye),{u_texsize_icon:Z,u_texture_icon:1}),Xs=(x,l,f)=>({u_matrix:x,u_opacity:l,u_color:f}),bl=(x,l,f,w,A,M)=>v.extend(function(O,U,X,Z){const ee=X.imageManager.getPattern(O.from.toString()),ne=X.imageManager.getPattern(O.to.toString()),{width:de,height:ye}=X.imageManager.getPixelSize(),me=Math.pow(2,Z.tileID.overscaledZ),_e=Z.tileSize*Math.pow(2,X.transform.tileZoom)/me,De=_e*(Z.tileID.canonical.x+Z.tileID.wrap*me),ve=_e*Z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:ee.tl,u_pattern_br_a:ee.br,u_pattern_tl_b:ne.tl,u_pattern_br_b:ne.br,u_texsize:[de,ye],u_mix:U.t,u_pattern_size_a:ee.displaySize,u_pattern_size_b:ne.displaySize,u_scale_a:U.fromScale,u_scale_b:U.toScale,u_tile_units_to_pixels:1/ir(Z,1,X.transform.tileZoom),u_pixel_coord_upper:[De>>16,ve>>16],u_pixel_coord_lower:[65535&De,65535&ve]}}(w,M,f,A),{u_matrix:x,u_opacity:l}),Sr={fillExtrusion:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_lightpos:new v.Uniform3f(x,l.u_lightpos),u_lightintensity:new v.Uniform1f(x,l.u_lightintensity),u_lightcolor:new v.Uniform3f(x,l.u_lightcolor),u_vertical_gradient:new v.Uniform1f(x,l.u_vertical_gradient),u_opacity:new v.Uniform1f(x,l.u_opacity)}),fillExtrusionPattern:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_lightpos:new v.Uniform3f(x,l.u_lightpos),u_lightintensity:new v.Uniform1f(x,l.u_lightintensity),u_lightcolor:new v.Uniform3f(x,l.u_lightcolor),u_vertical_gradient:new v.Uniform1f(x,l.u_vertical_gradient),u_height_factor:new v.Uniform1f(x,l.u_height_factor),u_image:new v.Uniform1i(x,l.u_image),u_texsize:new v.Uniform2f(x,l.u_texsize),u_pixel_coord_upper:new v.Uniform2f(x,l.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(x,l.u_pixel_coord_lower),u_scale:new v.Uniform3f(x,l.u_scale),u_fade:new v.Uniform1f(x,l.u_fade),u_opacity:new v.Uniform1f(x,l.u_opacity)}),fill:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix)}),fillPattern:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_image:new v.Uniform1i(x,l.u_image),u_texsize:new v.Uniform2f(x,l.u_texsize),u_pixel_coord_upper:new v.Uniform2f(x,l.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(x,l.u_pixel_coord_lower),u_scale:new v.Uniform3f(x,l.u_scale),u_fade:new v.Uniform1f(x,l.u_fade)}),fillOutline:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_world:new v.Uniform2f(x,l.u_world)}),fillOutlinePattern:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_world:new v.Uniform2f(x,l.u_world),u_image:new v.Uniform1i(x,l.u_image),u_texsize:new v.Uniform2f(x,l.u_texsize),u_pixel_coord_upper:new v.Uniform2f(x,l.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(x,l.u_pixel_coord_lower),u_scale:new v.Uniform3f(x,l.u_scale),u_fade:new v.Uniform1f(x,l.u_fade)}),circle:(x,l)=>({u_camera_to_center_distance:new v.Uniform1f(x,l.u_camera_to_center_distance),u_extrude_scale:new v.UniformMatrix2f(x,l.u_extrude_scale),u_device_pixel_ratio:new v.Uniform1f(x,l.u_device_pixel_ratio),u_matrix:new v.UniformMatrix4f(x,l.u_matrix)}),collisionBox:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_camera_to_center_distance:new v.Uniform1f(x,l.u_camera_to_center_distance),u_extrude_scale:new v.Uniform2f(x,l.u_extrude_scale)}),collisionCircle:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_inv_matrix:new v.UniformMatrix4f(x,l.u_inv_matrix),u_camera_to_center_distance:new v.Uniform1f(x,l.u_camera_to_center_distance),u_viewport_size:new v.Uniform2f(x,l.u_viewport_size)}),debug:(x,l)=>({u_color:new v.UniformColor(x,l.u_color),u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_overlay:new v.Uniform1i(x,l.u_overlay),u_overlay_scale:new v.Uniform1f(x,l.u_overlay_scale)}),clippingMask:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix)}),heatmap:(x,l)=>({u_extrude_scale:new v.Uniform1f(x,l.u_extrude_scale),u_intensity:new v.Uniform1f(x,l.u_intensity),u_matrix:new v.UniformMatrix4f(x,l.u_matrix)}),heatmapTexture:(x,l)=>({u_image:new v.Uniform1i(x,l.u_image),u_color_ramp:new v.Uniform1i(x,l.u_color_ramp),u_opacity:new v.Uniform1f(x,l.u_opacity)}),hillshade:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_image:new v.Uniform1i(x,l.u_image),u_latrange:new v.Uniform2f(x,l.u_latrange),u_light:new v.Uniform2f(x,l.u_light),u_shadow:new v.UniformColor(x,l.u_shadow),u_highlight:new v.UniformColor(x,l.u_highlight),u_accent:new v.UniformColor(x,l.u_accent)}),hillshadePrepare:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_image:new v.Uniform1i(x,l.u_image),u_dimension:new v.Uniform2f(x,l.u_dimension),u_zoom:new v.Uniform1f(x,l.u_zoom),u_unpack:new v.Uniform4f(x,l.u_unpack)}),line:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_pixels_to_tile_units:new v.UniformMatrix2f(x,l.u_pixels_to_tile_units),u_device_pixel_ratio:new v.Uniform1f(x,l.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(x,l.u_units_to_pixels),u_dash_image:new v.Uniform1i(x,l.u_dash_image),u_gradient_image:new v.Uniform1i(x,l.u_gradient_image),u_image_height:new v.Uniform1f(x,l.u_image_height),u_texsize:new v.Uniform2f(x,l.u_texsize),u_scale:new v.Uniform3f(x,l.u_scale),u_mix:new v.Uniform1f(x,l.u_mix)}),linePattern:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_texsize:new v.Uniform2f(x,l.u_texsize),u_pixels_to_tile_units:new v.UniformMatrix2f(x,l.u_pixels_to_tile_units),u_device_pixel_ratio:new v.Uniform1f(x,l.u_device_pixel_ratio),u_image:new v.Uniform1i(x,l.u_image),u_units_to_pixels:new v.Uniform2f(x,l.u_units_to_pixels),u_scale:new v.Uniform3f(x,l.u_scale),u_fade:new v.Uniform1f(x,l.u_fade)}),raster:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_tl_parent:new v.Uniform2f(x,l.u_tl_parent),u_scale_parent:new v.Uniform1f(x,l.u_scale_parent),u_buffer_scale:new v.Uniform1f(x,l.u_buffer_scale),u_fade_t:new v.Uniform1f(x,l.u_fade_t),u_opacity:new v.Uniform1f(x,l.u_opacity),u_image0:new v.Uniform1i(x,l.u_image0),u_image1:new v.Uniform1i(x,l.u_image1),u_brightness_low:new v.Uniform1f(x,l.u_brightness_low),u_brightness_high:new v.Uniform1f(x,l.u_brightness_high),u_saturation_factor:new v.Uniform1f(x,l.u_saturation_factor),u_contrast_factor:new v.Uniform1f(x,l.u_contrast_factor),u_spin_weights:new v.Uniform3f(x,l.u_spin_weights)}),symbolIcon:(x,l)=>({u_is_size_zoom_constant:new v.Uniform1i(x,l.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(x,l.u_is_size_feature_constant),u_size_t:new v.Uniform1f(x,l.u_size_t),u_size:new v.Uniform1f(x,l.u_size),u_camera_to_center_distance:new v.Uniform1f(x,l.u_camera_to_center_distance),u_pitch:new v.Uniform1f(x,l.u_pitch),u_rotate_symbol:new v.Uniform1i(x,l.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(x,l.u_aspect_ratio),u_fade_change:new v.Uniform1f(x,l.u_fade_change),u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(x,l.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(x,l.u_coord_matrix),u_is_text:new v.Uniform1i(x,l.u_is_text),u_pitch_with_map:new v.Uniform1i(x,l.u_pitch_with_map),u_texsize:new v.Uniform2f(x,l.u_texsize),u_tile_id:new v.Uniform3f(x,l.u_tile_id),u_zoom_transition:new v.Uniform1f(x,l.u_zoom_transition),u_inv_rot_matrix:new v.UniformMatrix4f(x,l.u_inv_rot_matrix),u_merc_center:new v.Uniform2f(x,l.u_merc_center),u_texture:new v.Uniform1i(x,l.u_texture)}),symbolSDF:(x,l)=>({u_is_size_zoom_constant:new v.Uniform1i(x,l.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(x,l.u_is_size_feature_constant),u_size_t:new v.Uniform1f(x,l.u_size_t),u_size:new v.Uniform1f(x,l.u_size),u_camera_to_center_distance:new v.Uniform1f(x,l.u_camera_to_center_distance),u_pitch:new v.Uniform1f(x,l.u_pitch),u_rotate_symbol:new v.Uniform1i(x,l.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(x,l.u_aspect_ratio),u_fade_change:new v.Uniform1f(x,l.u_fade_change),u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(x,l.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(x,l.u_coord_matrix),u_is_text:new v.Uniform1i(x,l.u_is_text),u_pitch_with_map:new v.Uniform1i(x,l.u_pitch_with_map),u_texsize:new v.Uniform2f(x,l.u_texsize),u_texture:new v.Uniform1i(x,l.u_texture),u_gamma_scale:new v.Uniform1f(x,l.u_gamma_scale),u_device_pixel_ratio:new v.Uniform1f(x,l.u_device_pixel_ratio),u_tile_id:new v.Uniform3f(x,l.u_tile_id),u_zoom_transition:new v.Uniform1f(x,l.u_zoom_transition),u_inv_rot_matrix:new v.UniformMatrix4f(x,l.u_inv_rot_matrix),u_merc_center:new v.Uniform2f(x,l.u_merc_center),u_is_halo:new v.Uniform1i(x,l.u_is_halo)}),symbolTextAndIcon:(x,l)=>({u_is_size_zoom_constant:new v.Uniform1i(x,l.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(x,l.u_is_size_feature_constant),u_size_t:new v.Uniform1f(x,l.u_size_t),u_size:new v.Uniform1f(x,l.u_size),u_camera_to_center_distance:new v.Uniform1f(x,l.u_camera_to_center_distance),u_pitch:new v.Uniform1f(x,l.u_pitch),u_rotate_symbol:new v.Uniform1i(x,l.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(x,l.u_aspect_ratio),u_fade_change:new v.Uniform1f(x,l.u_fade_change),u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(x,l.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(x,l.u_coord_matrix),u_is_text:new v.Uniform1i(x,l.u_is_text),u_pitch_with_map:new v.Uniform1i(x,l.u_pitch_with_map),u_texsize:new v.Uniform2f(x,l.u_texsize),u_texsize_icon:new v.Uniform2f(x,l.u_texsize_icon),u_texture:new v.Uniform1i(x,l.u_texture),u_texture_icon:new v.Uniform1i(x,l.u_texture_icon),u_gamma_scale:new v.Uniform1f(x,l.u_gamma_scale),u_device_pixel_ratio:new v.Uniform1f(x,l.u_device_pixel_ratio),u_is_halo:new v.Uniform1i(x,l.u_is_halo)}),background:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_opacity:new v.Uniform1f(x,l.u_opacity),u_color:new v.UniformColor(x,l.u_color)}),backgroundPattern:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_opacity:new v.Uniform1f(x,l.u_opacity),u_image:new v.Uniform1i(x,l.u_image),u_pattern_tl_a:new v.Uniform2f(x,l.u_pattern_tl_a),u_pattern_br_a:new v.Uniform2f(x,l.u_pattern_br_a),u_pattern_tl_b:new v.Uniform2f(x,l.u_pattern_tl_b),u_pattern_br_b:new v.Uniform2f(x,l.u_pattern_br_b),u_texsize:new v.Uniform2f(x,l.u_texsize),u_mix:new v.Uniform1f(x,l.u_mix),u_pattern_size_a:new v.Uniform2f(x,l.u_pattern_size_a),u_pattern_size_b:new v.Uniform2f(x,l.u_pattern_size_b),u_scale_a:new v.Uniform1f(x,l.u_scale_a),u_scale_b:new v.Uniform1f(x,l.u_scale_b),u_pixel_coord_upper:new v.Uniform2f(x,l.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(x,l.u_pixel_coord_lower),u_tile_units_to_pixels:new v.Uniform1f(x,l.u_tile_units_to_pixels)}),terrainRaster:ln,terrainDepth:ln,skybox:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_sun_direction:new v.Uniform3f(x,l.u_sun_direction),u_cubemap:new v.Uniform1i(x,l.u_cubemap),u_opacity:new v.Uniform1f(x,l.u_opacity),u_temporal_offset:new v.Uniform1f(x,l.u_temporal_offset)}),skyboxGradient:(x,l)=>({u_matrix:new v.UniformMatrix4f(x,l.u_matrix),u_color_ramp:new v.Uniform1i(x,l.u_color_ramp),u_center_direction:new v.Uniform3f(x,l.u_center_direction),u_radius:new v.Uniform1f(x,l.u_radius),u_opacity:new v.Uniform1f(x,l.u_opacity),u_temporal_offset:new v.Uniform1f(x,l.u_temporal_offset)}),skyboxCapture:(x,l)=>({u_matrix_3f:new v.UniformMatrix3f(x,l.u_matrix_3f),u_sun_direction:new v.Uniform3f(x,l.u_sun_direction),u_sun_intensity:new v.Uniform1f(x,l.u_sun_intensity),u_color_tint_r:new v.Uniform4f(x,l.u_color_tint_r),u_color_tint_m:new v.Uniform4f(x,l.u_color_tint_m),u_luminance:new v.Uniform1f(x,l.u_luminance)})};let mo;function Li(x,l,f,w,A,M,O){const U=x.context,X=U.gl,Z=x.useProgram("collisionBox"),ee=[];let ne=0,de=0;for(let Me=0;Me<w.length;Me++){const be=w[Me],ke=l.getTile(be),Fe=ke.getBucket(f);if(!Fe)continue;let Qe=be.projMatrix;0===A[0]&&0===A[1]||(Qe=x.translatePosMatrix(be.projMatrix,ke,A,M));const Ke=O?Fe.textCollisionBox:Fe.iconCollisionBox,rt=Fe.collisionCircleArray;if(rt.length>0){const st=v.create$1(),_t=Qe;v.mul$1(st,Fe.placementInvProjMatrix,x.transform.glCoordMatrix),v.mul$1(st,st,Fe.placementViewportMatrix),ee.push({circleArray:rt,circleOffset:de,transform:_t,invTransform:st}),ne+=rt.length/4,de=ne}Ke&&(x.terrain&&x.terrain.setupElevationDraw(ke,Z),Z.draw(U,X.LINES,v.DepthMode.disabled,v.StencilMode.disabled,x.colorModeForRenderPass(),v.CullFaceMode.disabled,su(Qe,x.transform,ke),f.id,Ke.layoutVertexBuffer,Ke.indexBuffer,Ke.segments,null,x.transform.zoom,null,Ke.collisionVertexBuffer,Ke.collisionVertexBufferExt))}if(!O||!ee.length)return;const ye=x.useProgram("collisionCircle"),me=new v.StructArrayLayout2f1f2i16;me.resize(4*ne),me._trim();let _e=0;for(const Me of ee)for(let be=0;be<Me.circleArray.length/4;be++){const ke=4*be,Fe=Me.circleArray[ke+0],Qe=Me.circleArray[ke+1],Ke=Me.circleArray[ke+2],rt=Me.circleArray[ke+3];me.emplace(_e++,Fe,Qe,Ke,rt,0),me.emplace(_e++,Fe,Qe,Ke,rt,1),me.emplace(_e++,Fe,Qe,Ke,rt,2),me.emplace(_e++,Fe,Qe,Ke,rt,3)}(!mo||mo.length<2*ne)&&(mo=function(Me){const be=2*Me,ke=new v.StructArrayLayout3ui6;ke.resize(be),ke._trim();for(let Fe=0;Fe<be;Fe++){const Qe=6*Fe;ke.uint16[Qe+0]=4*Fe+0,ke.uint16[Qe+1]=4*Fe+1,ke.uint16[Qe+2]=4*Fe+2,ke.uint16[Qe+3]=4*Fe+2,ke.uint16[Qe+4]=4*Fe+3,ke.uint16[Qe+5]=4*Fe+0}return ke}(ne));const De=U.createIndexBuffer(mo,!0),ve=U.createVertexBuffer(me,v.collisionCircleLayout.members,!0);for(const Me of ee){const be={u_matrix:Me.transform,u_inv_matrix:Me.invTransform,u_camera_to_center_distance:(Ee=x.transform).cameraToCenterDistance,u_viewport_size:[Ee.width,Ee.height]};ye.draw(U,X.TRIANGLES,v.DepthMode.disabled,v.StencilMode.disabled,x.colorModeForRenderPass(),v.CullFaceMode.disabled,be,f.id,ve,De,v.SegmentVector.simpleSegment(0,2*Me.circleOffset,Me.circleArray.length,Me.circleArray.length/2),null,x.transform.zoom,null,null,null)}var Ee;ve.destroy(),De.destroy()}const jo=v.identity(new Float32Array(16));function wl(x,l,f,w,A,M){const{horizontalAlign:O,verticalAlign:U}=v.getAnchorAlignment(x),X=-(O-.5)*l,Z=-(U-.5)*f,ee=v.evaluateVariableOffset(x,w);return new v.pointGeometry((X/A+ee[0])*M,(Z/A+ee[1])*M)}function yn(x,l,f,w,A,M,O,U,X,Z,ee,ne){const de=x.text.placedSymbolArray,ye=x.text.dynamicLayoutVertexArray,me=x.icon.dynamicLayoutVertexArray,_e={};ye.clear();for(let De=0;De<de.length;De++){const ve=de.get(De),Ee=x.allowVerticalPlacement&&!ve.placedOrientation,Me=ve.hidden||!ve.crossTileID||Ee?null:w[ve.crossTileID];if(Me){const be=new v.pointGeometry(ve.tileAnchorX,ve.tileAnchorY),ke=ne(be),Fe=K(be,f?U:O,ke),Qe=oe(M.cameraToCenterDistance,Fe.signedDistanceFromCamera);let Ke=A.evaluateSizeForFeature(x.textSizeData,Z,ve)*Qe/v.ONE_EM;f&&(Ke*=x.tilePixelRatio/X);const{width:rt,height:st,anchor:_t,textOffset:it,textScale:At}=Me,Ye=wl(_t,rt,st,it,At,Ke),Et=f?K(be.add(Ye),O,ke).point:Fe.point.add(l?Ye.rotate(-M.angle):Ye),Lt=x.allowVerticalPlacement&&ve.placedOrientation===v.WritingMode.vertical?Math.PI/2:0;for(let Yt=0;Yt<ve.numGlyphs;Yt++)v.addDynamicAttributes(ye,Et,Lt);ee&&ve.associatedIconIndex>=0&&(_e[ve.associatedIconIndex]={shiftedAnchor:Et,angle:Lt})}else Ve(ve.numGlyphs,ye)}if(ee){me.clear();const De=x.icon.placedSymbolArray;for(let ve=0;ve<De.length;ve++){const Ee=De.get(ve);if(Ee.hidden)Ve(Ee.numGlyphs,me);else{const Me=_e[ve];if(Me)for(let be=0;be<Ee.numGlyphs;be++)v.addDynamicAttributes(me,Me.shiftedAnchor,Me.angle);else Ve(Ee.numGlyphs,me)}}x.icon.dynamicLayoutVertexBuffer.updateData(me)}x.text.dynamicLayoutVertexBuffer.updateData(ye)}function vc(x,l,f){return f.iconsInText&&l?"symbolTextAndIcon":x?"symbolSDF":"symbolIcon"}function Ys(x,l,f,w,A,M,O,U,X,Z,ee,ne){const de=x.context,ye=de.gl,me=x.transform,_e="map"===U,De="map"===X,ve=_e&&"point"!==f.layout.get("symbol-placement"),Ee=_e&&!De&&!ve,Me=void 0!==f.layout.get("symbol-sort-key").constantOr(1);let be=!1;const ke=x.depthModeForSublayer(0,v.DepthMode.ReadOnly),Fe=[0,0],Qe=f.layout.get("text-variable-anchor"),Ke=[],rt=[];x.terrain&&De&&rt.push("PITCH_WITH_MAP_TERRAIN"),ve&&rt.push("PROJECTED_POS_ON_VIEWPORT");for(const st of w){const _t=l.getTile(st),it=_t.getBucket(f);if(!it)continue;const At=A?it.text:it.icon;if(!At||!At.segments.get().length)continue;const Ye=At.programConfigurations.get(f.id),Et=A||it.sdfIcons,Lt=A?it.textSizeData:it.iconSizeData,Yt=De||0!==me.pitch,Zt=x.useProgram(vc(Et,A,it),Ye,rt),tn=v.evaluateSizeForZoom(Lt,me.zoom),nn=[st.canonical.x,st.canonical.y,1<<st.canonical.z];let Gt,sn,Un,Vi,Tr=[0,0],Ur=null;if(A){if(sn=_t.glyphAtlasTexture,Un=ye.LINEAR,Gt=_t.glyphAtlasTexture.size,it.iconsInText){Tr=_t.imageAtlasTexture.size,Ur=_t.imageAtlasTexture;const Zr="composite"===Lt.kind||"camera"===Lt.kind;Vi=Yt||x.options.rotating||x.options.zooming||Zr?ye.LINEAR:ye.NEAREST}}else{const Zr=1!==f.layout.get("icon-size").constantOr(0)||it.iconsNeedLinear;sn=_t.imageAtlasTexture,Un=Et||x.options.rotating||x.options.zooming||Zr||Yt?ye.LINEAR:ye.NEAREST,Gt=_t.imageAtlasTexture.size}const ar=x.transform.calculatePixelsToTileUnitsMatrix(_t),lr=$(st.projMatrix,De,_e,x.transform,ar),Is=x.terrain&&De&&ve?v.invert(new Float32Array(16),lr):jo,bo=q(st.projMatrix,De,_e,x.transform,ar),ri=Qe&&it.hasTextData(),Ji="none"!==f.layout.get("icon-text-fit")&&ri&&it.hasIconData();if(ve){const Zr=me.elevation;fe(it,st.projMatrix,x,A,lr,bo,De,Z,Zr?qo=>Zr.getAtTileOffset(st,qo.x,qo.y):null)}const Pn=x.translatePosMatrix(st.projMatrix,_t,M,O),wi=ve||A&&Qe||Ji?jo:lr,Hr=x.translatePosMatrix(bo,_t,M,O,!0),Ci=Et&&0!==f.paint.get(A?"text-halo-width":"icon-halo-width").constantOr(1);let jr;jr=Et?it.iconsInText?Oi(Lt.kind,tn,Ee,De,x,Pn,wi,Hr,Gt,Tr,nn,0,x.identityMat,Fe):En(Lt.kind,tn,Ee,De,x,Pn,wi,Hr,A,Gt,!0,nn,0,x.identityMat,Fe):Ut(Lt.kind,tn,Ee,De,x,Pn,wi,Hr,A,Gt,nn,0,x.identityMat,Fe);const Ml={program:Zt,buffers:At,uniformValues:jr,atlasTexture:sn,atlasTextureIcon:Ur,atlasInterpolation:Un,atlasInterpolationIcon:Vi,isSDF:Et,hasHalo:Ci,tile:_t,labelPlaneMatrixInv:Is};if(Me&&it.canOverlap){be=!0;const Zr=At.segments.get();for(const qo of Zr)Ke.push({segments:new v.SegmentVector([qo]),sortKey:qo.sortKey,state:Ml})}else Ke.push({segments:At.segments,sortKey:0,state:Ml})}be&&Ke.sort((st,_t)=>st.sortKey-_t.sortKey);for(const st of Ke){const _t=st.state;if(x.terrain&&x.terrain.setupElevationDraw(_t.tile,_t.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:_t.labelPlaneMatrixInv}),de.activeTexture.set(ye.TEXTURE0),_t.atlasTexture.bind(_t.atlasInterpolation,ye.CLAMP_TO_EDGE),_t.atlasTextureIcon&&(de.activeTexture.set(ye.TEXTURE1),_t.atlasTextureIcon&&_t.atlasTextureIcon.bind(_t.atlasInterpolationIcon,ye.CLAMP_TO_EDGE)),_t.isSDF){const it=_t.uniformValues;_t.hasHalo&&(it.u_is_halo=1,ou(_t.buffers,st.segments,f,x,_t.program,ke,ee,ne,it)),it.u_is_halo=0}ou(_t.buffers,st.segments,f,x,_t.program,ke,ee,ne,_t.uniformValues)}}function ou(x,l,f,w,A,M,O,U,X){const Z=w.context;A.draw(Z,Z.gl.TRIANGLES,M,O,U,v.CullFaceMode.disabled,X,f.id,x.layoutVertexBuffer,x.indexBuffer,l,f.paint,w.transform.zoom,x.programConfigurations.get(f.id),x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer)}function yo(x,l,f,w,A,M,O){const U=x.context.gl,X=f.paint.get("fill-pattern"),Z=X&&X.constantOr(1),ee=f.getCrossfadeParameters();let ne,de,ye,me,_e;O?(de=Z&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ne=U.LINES):(de=Z?"fillPattern":"fill",ne=U.TRIANGLES);for(const De of w){const ve=l.getTile(De);if(Z&&!ve.patternsLoaded())continue;const Ee=ve.getBucket(f);if(!Ee)continue;x.prepareDrawTile(De);const Me=Ee.programConfigurations.get(f.id),be=x.useProgram(de,Me);Z&&(x.context.activeTexture.set(U.TEXTURE0),ve.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Me.updatePaintBuffers(ee));const ke=X.constantOr(null);if(ke&&ve.imageAtlas){const Qe=ve.imageAtlas,Ke=Qe.patternPositions[ke.to.toString()],rt=Qe.patternPositions[ke.from.toString()];Ke&&rt&&Me.setConstantPatternPositions(Ke,rt)}const Fe=x.translatePosMatrix(De.projMatrix,ve,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(O){me=Ee.indexBuffer2,_e=Ee.segments2;const Qe=x.terrain&&x.terrain.renderingToTexture?x.terrain.drapeBufferSize:[U.drawingBufferWidth,U.drawingBufferHeight];ye="fillOutlinePattern"===de&&Z?fp(Fe,x,ee,ve,Qe):Jn(Fe,Qe)}else me=Ee.indexBuffer,_e=Ee.segments,ye=Z?_c(Fe,x,ee,ve):yc(Fe);x.prepareDrawProgram(x.context,be,De.toUnwrapped()),be.draw(x.context,ne,A,x.stencilModeForClipping(De),M,v.CullFaceMode.disabled,ye,f.id,Ee.layoutVertexBuffer,me,_e,f.paint,x.transform.zoom,Me)}}function Zi(x,l,f,w,A,M,O){const U=x.context,X=U.gl,Z=f.paint.get("fill-extrusion-pattern"),ee=Z.constantOr(1),ne=f.getCrossfadeParameters(),de=f.paint.get("fill-extrusion-opacity");for(const ye of w){const me=l.getTile(ye),_e=me.getBucket(f);if(!_e)continue;const De=_e.programConfigurations.get(f.id),ve=x.useProgram(ee?"fillExtrusionPattern":"fillExtrusion",De);if(x.terrain){const Fe=x.terrain;if(!_e.enableTerrain)continue;if(Fe.setupElevationDraw(me,ve,{useMeterToDem:!0}),xc(U,l,ye,_e,f,Fe),!_e.centroidVertexBuffer){const Qe=ve.attributes.a_centroid_pos;void 0!==Qe&&X.vertexAttrib2f(Qe,0,0)}}ee&&(x.context.activeTexture.set(X.TEXTURE0),me.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),De.updatePaintBuffers(ne));const Ee=Z.constantOr(null);if(Ee&&me.imageAtlas){const Fe=me.imageAtlas,Qe=Fe.patternPositions[Ee.to.toString()],Ke=Fe.patternPositions[Ee.from.toString()];Qe&&Ke&&De.setConstantPatternPositions(Qe,Ke)}const Me=x.translatePosMatrix(ye.projMatrix,me,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),be=f.paint.get("fill-extrusion-vertical-gradient"),ke=ee?da(Me,x,be,de,ye,ne,me):Uu(Me,x,be,de);x.prepareDrawProgram(U,ve,ye.toUnwrapped()),ve.draw(U,U.gl.TRIANGLES,A,M,O,v.CullFaceMode.backCCW,ke,f.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,f.paint,x.transform.zoom,De,x.terrain?_e.centroidVertexBuffer:null)}}function xc(x,l,f,w,A,M){const O=[ve=>{let Ee=ve.canonical.x-1,Me=ve.wrap;return Ee<0&&(Ee=(1<<ve.canonical.z)-1,Me--),new v.OverscaledTileID(ve.overscaledZ,Me,ve.canonical.z,Ee,ve.canonical.y)},ve=>{let Ee=ve.canonical.x+1,Me=ve.wrap;return Ee===1<<ve.canonical.z&&(Ee=0,Me++),new v.OverscaledTileID(ve.overscaledZ,Me,ve.canonical.z,Ee,ve.canonical.y)},ve=>new v.OverscaledTileID(ve.overscaledZ,ve.wrap,ve.canonical.z,ve.canonical.x,(0===ve.canonical.y?1<<ve.canonical.z:ve.canonical.y)-1),ve=>new v.OverscaledTileID(ve.overscaledZ,ve.wrap,ve.canonical.z,ve.canonical.x,ve.canonical.y===(1<<ve.canonical.z)-1?0:ve.canonical.y+1)],U=ve=>{const Ee=l.getSource().maxzoom,Me=Qe=>{const Ke=l.getTileByID(Qe);if(Ke&&Ke.hasData())return Ke.getBucket(A)};let be,ke,Fe;return(ve.overscaledZ===ve.canonical.z||ve.overscaledZ>=Ee)&&(be=Me(ve.key)),ve.overscaledZ>=Ee&&(ke=Me(ve.calculateScaledKey(ve.overscaledZ+1))),ve.overscaledZ>Ee&&(Fe=Me(ve.calculateScaledKey(ve.overscaledZ-1))),be||ke||Fe},X=[0,0,0],Z=(ve,Ee)=>(X[0]=Math.min(ve.min.y,Ee.min.y),X[1]=Math.max(ve.max.y,Ee.max.y),X[2]=v.EXTENT-Ee.min.x>ve.max.x?Ee.min.x-v.EXTENT:ve.max.x,X),ee=(ve,Ee)=>(X[0]=Math.min(ve.min.x,Ee.min.x),X[1]=Math.max(ve.max.x,Ee.max.x),X[2]=v.EXTENT-Ee.min.y>ve.max.y?Ee.min.y-v.EXTENT:ve.max.y,X),ne=[(ve,Ee)=>Z(ve,Ee),(ve,Ee)=>Z(Ee,ve),(ve,Ee)=>ee(ve,Ee),(ve,Ee)=>ee(Ee,ve)],de=new v.pointGeometry(0,0);let ye,me,_e;const De=(ve,Ee,Me,be,ke)=>{const Fe=[[be?Me:ve,be?ve:Me,0],[be?Me:Ee,be?Ee:Me,0]],Qe=ke<0?v.EXTENT+ke:ke,Ke=[be?Qe:(ve+Ee)/2,be?(ve+Ee)/2:Qe,0];return 0===Me&&ke<0||0!==Me&&ke>0?M.getForTilePoints(_e,[Ke],!0,me):Fe.push(Ke),M.getForTilePoints(f,Fe,!0,ye),Math.max(Fe[0][2],Fe[1][2],Ke[2])/M.exaggeration()};for(let ve=0;ve<4;ve++){const Ee=w.borders[ve];if(0===Ee.length&&(w.borderDone[ve]=!0),w.borderDone[ve])continue;const Me=_e=O[ve](f),be=U(Me);if(!(be&&be.enableTerrain&&(me=M.findDEMTileFor(Me),me&&me.dem)))continue;if(!ye){const Ke=M.findDEMTileFor(f);if(!Ke||!Ke.dem)return;ye=Ke}const ke=(ve<2?1:5)-ve,Fe=be.borders[ke];let Qe=0;for(let Ke=0;Ke<Ee.length;Ke++){const rt=w.featuresOnBorder[Ee[Ke]],st=rt.borders[ve];let _t;for(;Qe<Fe.length&&(_t=be.featuresOnBorder[Fe[Qe]],!(_t.borders[ke][1]>st[0]+3));)be.borderDone[ke]||be.encodeCentroid(void 0,_t,!1),Qe++;if(_t&&Qe<Fe.length){const it=Qe;let At=0;for(;!(_t.borders[ke][0]>st[1]-3)&&(At++,++Qe!==Fe.length);)_t=be.featuresOnBorder[Fe[Qe]];if(_t=be.featuresOnBorder[Fe[it]],rt.intersectsCount()>1||_t.intersectsCount()>1||1!==At){1!==At&&(Qe=it),w.encodeCentroid(void 0,rt,!1),be.borderDone[ke]||be.encodeCentroid(void 0,_t,!1);continue}const Ye=ne[ve](rt,_t),Et=ve%2?v.EXTENT-1:0;de.x=De(Ye[0],Math.min(v.EXTENT-1,Ye[1]),Et,ve<2,Ye[2]),de.y=0,w.encodeCentroid(de,rt,!1),be.borderDone[ke]||be.encodeCentroid(de,_t,!1)}else w.encodeCentroid(void 0,rt,!1)}w.borderDone[ve]=w.needsCentroidUpdate=!0,be.borderDone[ke]||(be.borderDone[ke]=be.needsCentroidUpdate=!0)}(w.needsCentroidUpdate||!w.centroidVertexBuffer&&0!==w.centroidVertexArray.length)&&w.uploadCentroid(x)}const Ga=new v.Color(1,0,0,1),hn=new v.Color(0,1,0,1),li=new v.Color(0,0,1,1),ug=new v.Color(1,0,1,1),gp=new v.Color(0,1,1,1);function Aa(x,l,f,w){Wa(x,0,l+f/2,x.transform.width,f,w)}function $u(x,l,f,w){Wa(x,l-f/2,0,f,x.transform.height,w)}function Wa(x,l,f,w,A,M){const O=x.context,U=O.gl;U.enable(U.SCISSOR_TEST),U.scissor(l*v.exported.devicePixelRatio,f*v.exported.devicePixelRatio,w*v.exported.devicePixelRatio,A*v.exported.devicePixelRatio),O.clear({color:M}),U.disable(U.SCISSOR_TEST)}function au(x,l,f){const w=x.context,A=w.gl,M=f.projMatrix,O=x.useProgram("debug"),U=l.getTileByID(f.key);x.terrain&&x.terrain.setupElevationDraw(U,O);const X=v.DepthMode.disabled,Z=v.StencilMode.disabled,ee=x.colorModeForRenderPass();w.activeTexture.set(A.TEXTURE0),x.emptyTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),U._makeDebugTileBoundsBuffers(x.context,x.transform.projection);const de=U._tileDebugBuffer||x.debugBuffer,ye=U._tileDebugIndexBuffer||x.debugIndexBuffer,me=U._tileDebugSegments||x.debugSegments;O.draw(w,A.LINE_STRIP,X,Z,ee,v.CullFaceMode.disabled,Ln(M,v.Color.red),"$debug",de,ye,me);const _e=U.latestRawTileData,De=Math.floor((_e&&_e.byteLength||0)/1024),ve=l.getTile(f).tileSize,Ee=512/Math.min(ve,512)*(f.overscaledZ/x.transform.zoom)*.5;let Me=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(Me+=` => ${f.overscaledZ}`),function(be,ke){be.initDebugOverlayCanvas();const Fe=be.debugOverlayCanvas,Qe=be.context.gl,Ke=be.debugOverlayCanvas.getContext("2d");Ke.clearRect(0,0,Fe.width,Fe.height),Ke.shadowColor="white",Ke.shadowBlur=2,Ke.lineWidth=1.5,Ke.strokeStyle="white",Ke.textBaseline="top",Ke.font="bold 36px Open Sans, sans-serif",Ke.fillText(ke,5,5),Ke.strokeText(ke,5,5),be.debugOverlayTexture.update(Fe),be.debugOverlayTexture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE)}(x,`${Me} ${De}kb`),O.draw(w,A.TRIANGLES,X,Z,v.ColorMode.alphaBlended,v.CullFaceMode.disabled,Ln(M,v.Color.transparent,Ee),"$debug",x.debugBuffer,x.quadTriangleIndexBuffer,x.debugSegments)}const Cl=v.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Dr}=Cl;function $o(x,l,f,w){x.emplaceBack(l,f,w)}class ds{constructor(l){this.vertexArray=new v.StructArrayLayout3f12,this.indices=new v.StructArrayLayout3ui6,$o(this.vertexArray,-1,-1,1),$o(this.vertexArray,1,-1,1),$o(this.vertexArray,-1,1,1),$o(this.vertexArray,1,1,1),$o(this.vertexArray,-1,-1,-1),$o(this.vertexArray,1,-1,-1),$o(this.vertexArray,-1,1,-1),$o(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=l.createVertexBuffer(this.vertexArray,Dr),this.indexBuffer=l.createIndexBuffer(this.indices),this.segment=v.SegmentVector.simpleSegment(0,0,36,12)}}function Er(x,l,f,w,A,M){const O=x.gl,U=l.paint.get("sky-atmosphere-color"),X=l.paint.get("sky-atmosphere-halo-color"),Z=l.paint.get("sky-atmosphere-sun-intensity"),ee={u_matrix_3f:v.fromMat4([],w),u_sun_direction:A,u_sun_intensity:Z,u_color_tint_r:[(me=U).r,me.g,me.b,me.a],u_color_tint_m:[(_e=X).r,_e.g,_e.b,_e.a],u_luminance:5e-5};var me,_e;O.framebufferTexture2D(O.FRAMEBUFFER,O.COLOR_ATTACHMENT0,O.TEXTURE_CUBE_MAP_POSITIVE_X+M,l.skyboxTexture,0),f.draw(x,O.TRIANGLES,v.DepthMode.disabled,v.StencilMode.disabled,v.ColorMode.unblended,v.CullFaceMode.frontCW,ee,"skyboxCapture",l.skyboxGeometry.vertexBuffer,l.skyboxGeometry.indexBuffer,l.skyboxGeometry.segment)}const bc={symbol:function(x,l,f,w,A){if("translucent"!==x.renderPass)return;const M=v.StencilMode.disabled,O=x.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(U,X,Z,ee,ne,de,ye){const me=X.transform,_e="map"===ne,De="map"===de;for(const ve of U){const Ee=ee.getTile(ve),Me=Ee.getBucket(Z);if(!Me||!Me.text||!Me.text.segments.get().length)continue;const be=v.evaluateSizeForZoom(Me.textSizeData,me.zoom),ke=X.transform.calculatePixelsToTileUnitsMatrix(Ee),Fe=$(ve.projMatrix,De,_e,X.transform,ke),Qe="none"!==Z.layout.get("icon-text-fit")&&Me.hasIconData();if(be){const Ke=Math.pow(2,me.zoom-Ee.tileID.overscaledZ),rt=me.elevation;yn(Me,_e,De,ye,v.symbolSize,me,Fe,ve.projMatrix,Ke,be,Qe,rt?st=>rt.getAtTileOffset(ve,st.x,st.y):st=>0)}}}(w,x,f,l,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),A),0!==f.paint.get("icon-opacity").constantOr(1)&&Ys(x,l,f,w,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),M,O),0!==f.paint.get("text-opacity").constantOr(1)&&Ys(x,l,f,w,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),M,O),l.map.showCollisionBoxes&&(Li(x,l,f,w,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),Li(x,l,f,w,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(x,l,f,w){if("translucent"!==x.renderPass)return;const A=f.paint.get("circle-opacity"),M=f.paint.get("circle-stroke-width"),O=f.paint.get("circle-stroke-opacity"),U=void 0!==f.layout.get("circle-sort-key").constantOr(1);if(0===A.constantOr(1)&&(0===M.constantOr(1)||0===O.constantOr(1)))return;const X=x.context,Z=X.gl,ee=x.depthModeForSublayer(0,v.DepthMode.ReadOnly),ne=v.StencilMode.disabled,de=x.colorModeForRenderPass(),ye=[];for(let me=0;me<w.length;me++){const _e=w[me],De=l.getTile(_e),ve=De.getBucket(f);if(!ve)continue;const Ee=ve.programConfigurations.get(f.id),Me=Hu(f),be={programConfiguration:Ee,program:x.useProgram("circle",Ee,Me),layoutVertexBuffer:ve.layoutVertexBuffer,indexBuffer:ve.indexBuffer,uniformValues:ks(x,_e,De,f),tile:De};if(U){const ke=ve.segments.get();for(const Fe of ke)ye.push({segments:new v.SegmentVector([Fe]),sortKey:Fe.sortKey,state:be})}else ye.push({segments:ve.segments,sortKey:0,state:be})}U&&ye.sort((me,_e)=>me.sortKey-_e.sortKey);for(const me of ye){const{programConfiguration:_e,program:De,layoutVertexBuffer:ve,indexBuffer:Ee,uniformValues:Me,tile:be}=me.state,ke=me.segments;x.terrain&&x.terrain.setupElevationDraw(be,De,{useDepthForOcclusion:!0}),x.prepareDrawProgram(X,De,be.tileID.toUnwrapped()),De.draw(X,Z.TRIANGLES,ee,ne,de,v.CullFaceMode.disabled,Me,f.id,ve,Ee,ke,f.paint,x.transform.zoom,_e)}},heatmap:function(x,l,f,w){if(0!==f.paint.get("heatmap-opacity"))if("offscreen"===x.renderPass){const A=x.context,M=A.gl,O=v.StencilMode.disabled,U=new v.ColorMode([M.ONE,M.ONE],v.Color.transparent,[!0,!0,!0,!0]);(function(X,Z,ee){const ne=X.gl;X.activeTexture.set(ne.TEXTURE1),X.viewport.set([0,0,Z.width/4,Z.height/4]);let de=ee.heatmapFbo;if(de)ne.bindTexture(ne.TEXTURE_2D,de.colorAttachment.get()),X.bindFramebuffer.set(de.framebuffer);else{const ye=ne.createTexture();ne.bindTexture(ne.TEXTURE_2D,ye),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_S,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_T,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MIN_FILTER,ne.LINEAR),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MAG_FILTER,ne.LINEAR),de=ee.heatmapFbo=X.createFramebuffer(Z.width/4,Z.height/4,!1),function(me,_e,De,ve){const Ee=me.gl;Ee.texImage2D(Ee.TEXTURE_2D,0,Ee.RGBA,_e.width/4,_e.height/4,0,Ee.RGBA,me.extRenderToTextureHalfFloat?me.extTextureHalfFloat.HALF_FLOAT_OES:Ee.UNSIGNED_BYTE,null),ve.colorAttachment.set(De)}(X,Z,ye,de)}})(A,x,f),A.clear({color:v.Color.transparent});for(let X=0;X<w.length;X++){const Z=w[X];if(l.hasRenderableParent(Z))continue;const ee=l.getTile(Z),ne=ee.getBucket(f);if(!ne)continue;const de=ne.programConfigurations.get(f.id),ye=x.useProgram("heatmap",de),{zoom:me}=x.transform;x.terrain&&x.terrain.setupElevationDraw(ee,ye),x.prepareDrawProgram(A,ye,Z.toUnwrapped()),ye.draw(A,M.TRIANGLES,v.DepthMode.disabled,O,U,v.CullFaceMode.disabled,$h(Z.projMatrix,ee,me,f.paint.get("heatmap-intensity")),f.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,f.paint,x.transform.zoom,de)}A.viewport.set([0,0,x.width,x.height])}else"translucent"===x.renderPass&&(x.context.setColorMode(x.colorModeForRenderPass()),function(A,M){const O=A.context,U=O.gl,X=M.heatmapFbo;if(!X)return;O.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,X.colorAttachment.get()),O.activeTexture.set(U.TEXTURE1);let Z=M.colorRampTexture;Z||(Z=M.colorRampTexture=new v.Texture(O,M.colorRamp,U.RGBA)),Z.bind(U.LINEAR,U.CLAMP_TO_EDGE),A.useProgram("heatmapTexture").draw(O,U.TRIANGLES,v.DepthMode.disabled,v.StencilMode.disabled,A.colorModeForRenderPass(),v.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:M.paint.get("heatmap-opacity")},M.id,A.viewportBuffer,A.quadTriangleIndexBuffer,A.viewportSegments,M.paint,A.transform.zoom)}(x,f))},line:function(x,l,f,w){if("translucent"!==x.renderPass)return;const A=f.paint.get("line-opacity"),M=f.paint.get("line-width");if(0===A.constantOr(1)||0===M.constantOr(1))return;const O=x.depthModeForSublayer(0,v.DepthMode.ReadOnly),U=x.colorModeForRenderPass(),X=f.paint.get("line-dasharray"),Z=X.constantOr(1),ee=f.layout.get("line-cap"),ne=f.paint.get("line-pattern"),de=ne.constantOr(1),ye=f.paint.get("line-gradient"),me=f.getCrossfadeParameters(),_e=de?"linePattern":"line",De=x.context,ve=De.gl;for(const Ee of w){const Me=l.getTile(Ee);if(de&&!Me.patternsLoaded())continue;const be=Me.getBucket(f);if(!be)continue;x.prepareDrawTile(Ee);const ke=be.programConfigurations.get(f.id),Fe=Ho(f),Qe=x.useProgram(_e,ke,Fe),Ke=ne.constantOr(null);if(Ke&&Me.imageAtlas){const At=Me.imageAtlas,Ye=At.patternPositions[Ke.to.toString()],Et=At.patternPositions[Ke.from.toString()];Ye&&Et&&ke.setConstantPatternPositions(Ye,Et)}const rt=X.constantOr(null),st=ee.constantOr(null);if(!de&&rt&&st&&Me.lineAtlas){const At=Me.lineAtlas,Ye=At.getDash(rt.to,st),Et=At.getDash(rt.from,st);Ye&&Et&&ke.setConstantPatternPositions(Ye,Et)}const _t=x.terrain?Ee.projMatrix:null,it=de?Rt(x,Me,f,me,_t):ju(x,Me,f,me,_t,be.lineClipsArray.length);if(ye){const At=be.gradients[f.id];let Ye=At.texture;if(f.gradientVersion!==At.version){let Et=256;if(f.stepInterpolant){const Lt=l.getSource().maxzoom,Yt=Ee.canonical.z===Lt?Math.ceil(1<<x.transform.maxZoom-Ee.canonical.z):1;Et=v.clamp(v.nextPowerOfTwo(be.maxLineLength/v.EXTENT*1024*Yt),256,De.maxTextureSize)}At.gradient=v.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:Et,image:At.gradient||void 0,clips:be.lineClipsArray}),At.texture?At.texture.update(At.gradient):At.texture=new v.Texture(De,At.gradient,ve.RGBA),At.version=f.gradientVersion,Ye=At.texture}De.activeTexture.set(ve.TEXTURE1),Ye.bind(f.stepInterpolant?ve.NEAREST:ve.LINEAR,ve.CLAMP_TO_EDGE)}Z&&(De.activeTexture.set(ve.TEXTURE0),Me.lineAtlasTexture.bind(ve.LINEAR,ve.REPEAT),ke.updatePaintBuffers(me)),de&&(De.activeTexture.set(ve.TEXTURE0),Me.imageAtlasTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE),ke.updatePaintBuffers(me)),x.prepareDrawProgram(De,Qe,Ee.toUnwrapped()),Qe.draw(De,ve.TRIANGLES,O,x.stencilModeForClipping(Ee),U,v.CullFaceMode.disabled,it,f.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,f.paint,x.transform.zoom,ke,be.layoutVertexBuffer2)}},fill:function(x,l,f,w){const A=f.paint.get("fill-color"),M=f.paint.get("fill-opacity");if(0===M.constantOr(1))return;const O=x.colorModeForRenderPass(),U=f.paint.get("fill-pattern"),X=x.opaquePassEnabledForLayer()&&!U.constantOr(1)&&1===A.constantOr(v.Color.transparent).a&&1===M.constantOr(0)?"opaque":"translucent";if(x.renderPass===X){const Z=x.depthModeForSublayer(1,"opaque"===x.renderPass?v.DepthMode.ReadWrite:v.DepthMode.ReadOnly);yo(x,l,f,w,Z,O,!1)}if("translucent"===x.renderPass&&f.paint.get("fill-antialias")){const Z=x.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,v.DepthMode.ReadOnly);yo(x,l,f,w,Z,O,!0)}},"fill-extrusion":function(x,l,f,w){const A=f.paint.get("fill-extrusion-opacity");if(0!==A&&"translucent"===x.renderPass){const M=new v.DepthMode(x.context.gl.LEQUAL,v.DepthMode.ReadWrite,x.depthRangeFor3D);if(1!==A||f.paint.get("fill-extrusion-pattern").constantOr(1))Zi(x,l,f,w,M,v.StencilMode.disabled,v.ColorMode.disabled),Zi(x,l,f,w,M,x.stencilModeFor3D(),x.colorModeForRenderPass());else{const O=x.colorModeForRenderPass();Zi(x,l,f,w,M,v.StencilMode.disabled,O)}}},hillshade:function(x,l,f,w){if("offscreen"!==x.renderPass&&"translucent"!==x.renderPass)return;const A=x.context,M=x.depthModeForSublayer(0,v.DepthMode.ReadOnly),O=x.colorModeForRenderPass(),U=x.terrain&&x.terrain.renderingToTexture,[X,Z]="translucent"!==x.renderPass||U?[{},w]:x.stencilConfigForOverlap(w);for(const ee of Z){const ne=l.getTile(ee);if(ne.needsHillshadePrepare&&"offscreen"===x.renderPass)Bu(x,ne,f,M,v.StencilMode.disabled,O);else if("translucent"===x.renderPass){const de=U&&x.terrain?x.terrain.stencilModeForRTTOverlap(ee):X[ee.overscaledZ];Ms(x,ee,ne,f,M,de,O)}}A.viewport.set([0,0,x.width,x.height])},raster:function(x,l,f,w,A,M){if("translucent"!==x.renderPass||0===f.paint.get("raster-opacity")||!w.length)return;const O=x.context,U=O.gl,X=l.getSource(),Z=x.useProgram("raster"),ee=x.colorModeForRenderPass(),ne=x.terrain&&x.terrain.renderingToTexture,[de,ye]=X instanceof we||ne?[{},w]:x.stencilConfigForOverlap(w),me=ye[ye.length-1].overscaledZ,_e=!x.options.moving;for(const De of ye){const ve=ne?v.DepthMode.disabled:x.depthModeForSublayer(De.overscaledZ-me,1===f.paint.get("raster-opacity")?v.DepthMode.ReadWrite:v.DepthMode.ReadOnly,U.LESS),Ee=De.toUnwrapped(),Me=l.getTile(De);if(ne&&(!Me||!Me.hasData()))continue;const be=ne?De.projMatrix:x.transform.calculateProjMatrix(Ee,_e),ke=x.terrain&&ne?x.terrain.stencilModeForRTTOverlap(De):de[De.overscaledZ],Fe=M?0:f.paint.get("raster-fade-duration");Me.registerFadeDuration(Fe);const Qe=l.findLoadedParent(De,0),Ke=pp(Me,Qe,l,x.transform,Fe);let rt,st;x.terrain&&x.terrain.prepareDrawTile(De);const _t="nearest"===f.paint.get("raster-resampling")?U.NEAREST:U.LINEAR;O.activeTexture.set(U.TEXTURE0),Me.texture.bind(_t,U.CLAMP_TO_EDGE),O.activeTexture.set(U.TEXTURE1),Qe?(Qe.texture.bind(_t,U.CLAMP_TO_EDGE),rt=Math.pow(2,Qe.tileID.overscaledZ-Me.tileID.overscaledZ),st=[Me.tileID.canonical.x*rt%1,Me.tileID.canonical.y*rt%1]):Me.texture.bind(_t,U.CLAMP_TO_EDGE);const it=Ws(be,st||[0,0],rt||1,Ke,f);if(x.prepareDrawProgram(O,Z,Ee),X instanceof we)Z.draw(O,U.TRIANGLES,ve,v.StencilMode.disabled,ee,v.CullFaceMode.disabled,it,f.id,X.boundsBuffer,x.quadTriangleIndexBuffer,X.boundsSegments);else{const{tileBoundsBuffer:At,tileBoundsIndexBuffer:Ye,tileBoundsSegments:Et}=x.getTileBoundsBuffers(Me);Z.draw(O,U.TRIANGLES,ve,ke,ee,v.CullFaceMode.disabled,it,f.id,At,Ye,Et)}}},background:function(x,l,f,w){const A=f.paint.get("background-color"),M=f.paint.get("background-opacity");if(0===M)return;const O=x.context,U=O.gl,X=x.transform,Z=X.tileSize,ee=f.paint.get("background-pattern");if(x.isPatternMissing(ee))return;const ne=!ee&&1===A.a&&1===M&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==ne)return;const de=v.StencilMode.disabled,ye=x.depthModeForSublayer(0,"opaque"===ne?v.DepthMode.ReadWrite:v.DepthMode.ReadOnly),me=x.colorModeForRenderPass(),_e=x.useProgram(ee?"backgroundPattern":"background");let De,ve=w;ve||(De=x.getBackgroundTiles(),ve=Object.values(De).map(Me=>Me.tileID)),ee&&(O.activeTexture.set(U.TEXTURE0),x.imageManager.bind(x.context));const Ee=f.getCrossfadeParameters();for(const Me of ve){const be=Me.toUnwrapped(),ke=w?Me.projMatrix:x.transform.calculateProjMatrix(be);x.prepareDrawTile(Me);const Fe=l?l.getTile(Me):De?De[Me.key]:new v.Tile(Me,Z,X.zoom,x),Qe=ee?bl(ke,M,x,ee,{tileID:Me,tileSize:Z},Ee):Xs(ke,M,A);x.prepareDrawProgram(O,_e,be);const{tileBoundsBuffer:Ke,tileBoundsIndexBuffer:rt,tileBoundsSegments:st}=x.getTileBoundsBuffers(Fe);_e.draw(O,U.TRIANGLES,ye,de,me,v.CullFaceMode.disabled,Qe,f.id,Ke,rt,st)}},sky:function(x,l,f){const w=x.transform,A="mercator"===w.projection.name?1:v.smoothstep(7,8,w.zoom),M=f.paint.get("sky-opacity")*A;if(0===M)return;const O=x.context,U=f.paint.get("sky-type"),X=new v.DepthMode(O.gl.LEQUAL,v.DepthMode.ReadOnly,[0,1]),Z=x.frameCounter/1e3%1;"atmosphere"===U?"offscreen"===x.renderPass?f.needsSkyboxCapture(x)&&(function(ee,ne,de,ye){const me=ee.context,_e=me.gl;let De=ne.skyboxFbo;if(!De){De=ne.skyboxFbo=me.createFramebuffer(32,32,!1),ne.skyboxGeometry=new ds(me),ne.skyboxTexture=me.gl.createTexture(),_e.bindTexture(_e.TEXTURE_CUBE_MAP,ne.skyboxTexture),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_WRAP_S,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_WRAP_T,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_MIN_FILTER,_e.LINEAR),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_MAG_FILTER,_e.LINEAR);for(let be=0;be<6;++be)_e.texImage2D(_e.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,_e.RGBA,32,32,0,_e.RGBA,_e.UNSIGNED_BYTE,null)}me.bindFramebuffer.set(De.framebuffer),me.viewport.set([0,0,32,32]);const ve=ne.getCenter(ee,!0),Ee=ee.useProgram("skyboxCapture"),Me=new Float64Array(16);v.identity(Me),v.rotateY(Me,Me,.5*-Math.PI),Er(me,ne,Ee,Me,ve,0),v.identity(Me),v.rotateY(Me,Me,.5*Math.PI),Er(me,ne,Ee,Me,ve,1),v.identity(Me),v.rotateX(Me,Me,.5*-Math.PI),Er(me,ne,Ee,Me,ve,2),v.identity(Me),v.rotateX(Me,Me,.5*Math.PI),Er(me,ne,Ee,Me,ve,3),v.identity(Me),Er(me,ne,Ee,Me,ve,4),v.identity(Me),v.rotateY(Me,Me,Math.PI),Er(me,ne,Ee,Me,ve,5),me.viewport.set([0,0,ee.width,ee.height])}(x,f),f.markSkyboxValid(x)):"sky"===x.renderPass&&function(ee,ne,de,ye,me){const _e=ee.context,De=_e.gl,ve=ee.transform,Ee=ee.useProgram("skybox");_e.activeTexture.set(De.TEXTURE0),De.bindTexture(De.TEXTURE_CUBE_MAP,ne.skyboxTexture);const Me={u_matrix:ve.skyboxMatrix,u_sun_direction:ne.getCenter(ee,!1),u_cubemap:0,u_opacity:ye,u_temporal_offset:me};ee.prepareDrawProgram(_e,Ee),Ee.draw(_e,De.TRIANGLES,de,v.StencilMode.disabled,ee.colorModeForRenderPass(),v.CullFaceMode.backCW,Me,"skybox",ne.skyboxGeometry.vertexBuffer,ne.skyboxGeometry.indexBuffer,ne.skyboxGeometry.segment)}(x,f,X,M,Z):"gradient"===U&&"sky"===x.renderPass&&function(ee,ne,de,ye,me){const _e=ee.context,De=_e.gl,ve=ee.transform,Ee=ee.useProgram("skyboxGradient");ne.skyboxGeometry||(ne.skyboxGeometry=new ds(_e)),_e.activeTexture.set(De.TEXTURE0);let Me=ne.colorRampTexture;Me||(Me=ne.colorRampTexture=new v.Texture(_e,ne.colorRamp,De.RGBA)),Me.bind(De.LINEAR,De.CLAMP_TO_EDGE);const be=(ke=ve.skyboxMatrix,Fe=ne.getCenter(ee,!1),Qe=ne.paint.get("sky-gradient-radius"),Ke=ye,rt=me,{u_matrix:ke,u_color_ramp:0,u_center_direction:Fe,u_radius:v.degToRad(Qe),u_opacity:Ke,u_temporal_offset:rt});var ke,Fe,Qe,Ke,rt;ee.prepareDrawProgram(_e,Ee),Ee.draw(_e,De.TRIANGLES,de,v.StencilMode.disabled,ee.colorModeForRenderPass(),v.CullFaceMode.backCW,be,"skyboxGradient",ne.skyboxGeometry.vertexBuffer,ne.skyboxGeometry.indexBuffer,ne.skyboxGeometry.segment)}(x,f,X,M,Z)},debug:function(x,l,f){for(let w=0;w<f.length;w++)au(x,l,f[w])},custom:function(x,l,f){const w=x.context,A=f.implementation;if("mercator"===x.transform.projection.name){if("offscreen"===x.renderPass){const M=A.prerender;M&&(x.setCustomLayerDefaults(),w.setColorMode(x.colorModeForRenderPass()),M.call(A,w.gl,x.transform.customLayerMatrix()),w.setDirty(),x.setBaseState())}else if("translucent"===x.renderPass){x.setCustomLayerDefaults(),w.setColorMode(x.colorModeForRenderPass()),w.setStencilMode(v.StencilMode.disabled);const M="3d"===A.renderingMode?new v.DepthMode(x.context.gl.LEQUAL,v.DepthMode.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,v.DepthMode.ReadOnly);w.setDepthMode(M),A.render(w.gl,x.transform.customLayerMatrix()),w.setDirty(),x.setBaseState(),w.bindFramebuffer.set(null)}}else v.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.")}};class lu{constructor(l,f){this.context=new ja(l),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=v.SourceCache.maxUnderzooming+v.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new kn,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(l,f){const w=!!l&&!!l.terrain&&"mercator"===this.transform.projection.name;if(!(w||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ii(this,l));const A=this._terrain;this.transform.elevation=w?A:null,A.update(l,this.transform,f)}_updateFog(l){const f=l.fog;if(!f||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[w,A]=f.getFovAdjustedRange(this.transform._fov);if(w>A)return void(this.transform.fogCullDistSq=null);const M=w+.78*(A-w);this.transform.fogCullDistSq=M*M}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(l,f){if(this.width=l*v.exported.devicePixelRatio,this.height=f*v.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const w of this.style.order)this.style._layers[w].resize()}setup(){const l=this.context,f=new v.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(v.EXTENT,0),f.emplaceBack(0,v.EXTENT),f.emplaceBack(v.EXTENT,v.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(f,v.posAttributes.members),this.tileExtentSegments=v.SegmentVector.simpleSegment(0,0,4,2);const w=new v.StructArrayLayout2i4;w.emplaceBack(0,0),w.emplaceBack(v.EXTENT,0),w.emplaceBack(0,v.EXTENT),w.emplaceBack(v.EXTENT,v.EXTENT),this.debugBuffer=l.createVertexBuffer(w,v.posAttributes.members),this.debugSegments=v.SegmentVector.simpleSegment(0,0,4,5);const A=new v.StructArrayLayout2i4;A.emplaceBack(-1,-1),A.emplaceBack(1,-1),A.emplaceBack(-1,1),A.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(A,v.posAttributes.members),this.viewportSegments=v.SegmentVector.simpleSegment(0,0,4,2);const M=new v.StructArrayLayout4i8;M.emplaceBack(0,0,0,0),M.emplaceBack(v.EXTENT,0,v.EXTENT,0),M.emplaceBack(0,v.EXTENT,0,v.EXTENT),M.emplaceBack(v.EXTENT,v.EXTENT,v.EXTENT,v.EXTENT),this.mercatorBoundsBuffer=l.createVertexBuffer(M,v.boundsAttributes.members),this.mercatorBoundsSegments=v.SegmentVector.simpleSegment(0,0,4,2);const O=new v.StructArrayLayout3ui6;O.emplaceBack(0,1,2),O.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(O);const U=new v.StructArrayLayout1ui2;for(const Z of[0,1,3,2,0])U.emplaceBack(Z);this.debugIndexBuffer=l.createIndexBuffer(U),this.emptyTexture=new v.Texture(l,{width:1,height:1,data:new Uint8Array([0,0,0,0])},l.gl.RGBA),this.identityMat=v.create$1();const X=this.context.gl;this.stencilClearMode=new v.StencilMode({func:X.ALWAYS,mask:0},0,255,X.ZERO,X.ZERO,X.ZERO),this.loadTimeStamps.push(v.window.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(l){return l._makeTileBoundsBuffers(this.context,this.transform.projection),l._tileBoundsBuffer?{tileBoundsBuffer:l._tileBoundsBuffer,tileBoundsIndexBuffer:l._tileBoundsIndexBuffer,tileBoundsSegments:l._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const l=this.context,f=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this.useProgram("clippingMask").draw(l,f.TRIANGLES,v.DepthMode.disabled,this.stencilClearMode,v.ColorMode.disabled,v.CullFaceMode.disabled,Gn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,f,w){if(!(f&&this.currentStencilSource!==f.id&&l.isTileClipped()&&w&&w.length))return;this.currentStencilSource=f.id;const A=this.context,M=A.gl;this.nextStencilID+w.length>256&&this.clearStencil(),A.setColorMode(v.ColorMode.disabled),A.setDepthMode(v.DepthMode.disabled);const O=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const U of w){const X=f.getTile(U),Z=this._tileClippingMaskIDs[U.key]=this.nextStencilID++,{tileBoundsBuffer:ee,tileBoundsIndexBuffer:ne,tileBoundsSegments:de}=this.getTileBoundsBuffers(X);O.draw(A,M.TRIANGLES,v.DepthMode.disabled,new v.StencilMode({func:M.ALWAYS,mask:0},Z,255,M.KEEP,M.KEEP,M.REPLACE),v.ColorMode.disabled,v.CullFaceMode.disabled,Gn(U.projMatrix),"$clipping",ee,ne,de)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,f=this.context.gl;return new v.StencilMode({func:f.NOTEQUAL,mask:255},l,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(l){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(l);const f=this.context.gl;return new v.StencilMode({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(l){const f=this.context.gl,w=l.sort((O,U)=>U.overscaledZ-O.overscaledZ),A=w[w.length-1].overscaledZ,M=w[0].overscaledZ-A+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();const O={};for(let U=0;U<M;U++)O[U+A]=new v.StencilMode({func:f.GEQUAL,mask:255},U+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=M,[O,w]}return[{[A]:v.StencilMode.disabled},w]}colorModeForRenderPass(){const l=this.context.gl;if(this._showOverdrawInspector){const f=1/8;return new v.ColorMode([l.CONSTANT_COLOR,l.ONE],new v.Color(f,f,f,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?v.ColorMode.unblended:v.ColorMode.alphaBlended}depthModeForSublayer(l,f,w){if(!this.opaquePassEnabledForLayer())return v.DepthMode.disabled;const A=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new v.DepthMode(w||this.context.gl.LEQUAL,f,[A,A])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,f){this.style=l,this.options=f,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(v.exported.now()),this.imageManager.beginFrame();const w=this.style.order,A=this.style._sourceCaches;for(const Z in A){const ee=A[Z];ee.used&&ee.prepare(this.context)}const M={},O={},U={};for(const Z in A){const ee=A[Z];M[Z]=ee.getVisibleCoordinates(),O[Z]=M[Z].slice().reverse(),U[Z]=ee.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Z=0;Z<w.length;Z++)if(this.style._layers[w[Z]].is3D()){this.opaquePassCutoff=Z;break}if(this.terrain&&(this.terrain.updateTileBinding(U),this.opaquePassCutoff=0),!v.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const Z of w){const ee=this.style._layers[Z],ne=l._getLayerSourceCache(ee);if(!ee.hasOffscreenPass()||ee.isHidden(this.transform.zoom))continue;const de=ne?O[ne.id]:void 0;("custom"===ee.type||ee.isSky()||de&&de.length)&&this.renderLayer(this,ne,ee,de)}this.depthRangeFor3D=[0,1-(l.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let X=v.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(X=this.style.fog.properties.get("color")),this.context.clear({color:f.showOverdrawInspector?v.Color.black:X,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const Z=this.style._layers[w[this.currentLayer]],ee=l._getLayerSourceCache(Z);if(Z.isSky())continue;const ne=ee?O[ee.id]:void 0;this._renderTileClippingMasks(Z,ee,ne),this.renderLayer(this,ee,Z,ne)}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const Z=this.style._layers[w[this.currentLayer]],ee=l._getLayerSourceCache(Z);Z.isSky()&&this.renderLayer(this,ee,Z,ee?O[ee.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<w.length;){const Z=this.style._layers[w[this.currentLayer]],ee=l._getLayerSourceCache(Z);if(Z.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(Z)){if(Z.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const ne=ee?("symbol"===Z.type?U:O)[ee.id]:void 0;this._renderTileClippingMasks(Z,ee,ee?M[ee.id]:void 0),this.renderLayer(this,ee,Z,ne),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let Z=null;v.values(this.style._layers).forEach(ee=>{const ne=l._getLayerSourceCache(ee);ne&&!ee.isHidden(this.transform.zoom)&&(!Z||Z.getSource().maxzoom<ne.getSource().maxzoom)&&(Z=ne)}),Z&&this.options.showTileBoundaries&&bc.debug(this,Z,Z.getVisibleCoordinates())}this.options.showPadding&&function(Z){const ee=Z.transform.padding;Aa(Z,Z.transform.height-(ee.top||0),3,Ga),Aa(Z,ee.bottom||0,3,hn),$u(Z,ee.left||0,3,li),$u(Z,Z.transform.width-(ee.right||0),3,ug);const ne=Z.transform.centerPoint;var de,ye,me,_e;Wa(de=Z,(ye=ne.x)-1,(me=Z.transform.height-ne.y)-10,2,20,_e=gp),Wa(de,ye-10,me-1,20,2,_e)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%v.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(v.window.performance.now()),this.saveCanvasCopy())}renderLayer(l,f,w,A){w.isHidden(this.transform.zoom)||("background"===w.type||"sky"===w.type||"custom"===w.type||A&&A.length)&&(this.id=w.id,this.gpuTimingStart(w),bc[w.type](l,f,w,A,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;let w=this.gpuTimers[l.id];w||(w=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),w.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,w.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}queryGpuTimers(l){const f={};for(const w in l){const A=l[w],M=this.context.extTimerQuery,O=M.getQueryObjectEXT(A.query,M.QUERY_RESULT_EXT)/1e6;M.deleteQueryEXT(A.query),f[w]=O}return f}translatePosMatrix(l,f,w,A,M){if(!w[0]&&!w[1])return l;const O=M?"map"===A?this.transform.angle:0:"viewport"===A?-this.transform.angle:0;if(O){const Z=Math.sin(O),ee=Math.cos(O);w=[w[0]*ee-w[1]*Z,w[0]*Z+w[1]*ee]}const U=[M?w[0]:ir(f,w[0],this.transform.zoom),M?w[1]:ir(f,w[1],this.transform.zoom),0],X=new Float32Array(16);return v.translate(X,l,U),X}saveTileTexture(l){const f=this._tileTextures[l.size[0]];f?f.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const f=this._tileTextures[l];return f&&f.length>0?f.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const f=this.imageManager.getPattern(l.from.toString()),w=this.imageManager.getPattern(l.to.toString());return!f||!w}currentGlobalDefines(){const l=this.terrain&&this.terrain.renderingToTexture,f=this.style&&this.style.fog,w=[];return this.terrain&&!this.terrain.renderingToTexture&&w.push("TERRAIN"),f&&!l&&0!==f.getOpacity(this.transform.pitch)&&w.push("FOG"),l&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}useProgram(l,f,w){this.cache=this.cache||{};const A=w||[],M=this.currentGlobalDefines().concat(A),O=gc.cacheKey(l,M,f);return this.cache[O]||(this.cache[O]=new gc(this.context,l,Vo[l],f,Sr[l],M)),this.cache[O]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=v.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new v.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(l){this.terrain&&this.terrain.prepareDrawTile(l)}prepareDrawProgram(l,f,w){if(this.terrain&&this.terrain.renderingToTexture)return;const A=this.style.fog;if(A){const M=A.getOpacity(this.transform.pitch);0!==M&&f.setFogUniformValues(l,((O,U,X,Z)=>{const ee=U.properties.get("color"),ne=O.frameCounter/1e3%1,de=[ee.r/ee.a,ee.g/ee.a,ee.b/ee.a,Z];return{u_fog_matrix:X?O.transform.calculateFogTileMatrix(X):O.identityMat,u_fog_range:U.getFovAdjustedRange(O.transform._fov),u_fog_color:de,u_fog_horizon_blend:U.properties.get("horizon-blend"),u_fog_temporal_offset:ne}})(this,A,w,M))}}setTileLoadedFlag(l){this.tileLoaded=l}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const l=this.context.gl,f=l.createTexture();return l.bindTexture(l.TEXTURE_2D,f),l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,0,0,l.drawingBufferWidth,l.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const l=this.style&&this.style.fog;return!!l&&0!==l.getOpacity(this.transform.pitch)}getBackgroundTiles(){const l=this._backgroundTiles,f=this._backgroundTiles={},w=this.transform.coveringTiles({tileSize:512});for(const A of w)f[A.key]=l[A.key]||new v.Tile(A,512,this.transform.tileZoom,this);return f}clearBackgroundTiles(){this._backgroundTiles={}}}class Ta{constructor(l=0,f=0,w=0,A=0){if(isNaN(l)||l<0||isNaN(f)||f<0||isNaN(w)||w<0||isNaN(A)||A<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=f,this.left=w,this.right=A}interpolate(l,f,w){return null!=f.top&&null!=l.top&&(this.top=v.number(l.top,f.top,w)),null!=f.bottom&&null!=l.bottom&&(this.bottom=v.number(l.bottom,f.bottom,w)),null!=f.left&&null!=l.left&&(this.left=v.number(l.left,f.left,w)),null!=f.right&&null!=l.right&&(this.right=v.number(l.right,f.right,w)),this}getCenter(l,f){const w=v.clamp((this.left+l-this.right)/2,0,l),A=v.clamp((this.top+f-this.bottom)/2,0,f);return new v.pointGeometry(w,A)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Ta(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ar(x,l){return[x[4*l],x[4*l+1],x[4*l+2],x[4*l+3]]}function _o(x,l,f){x[4*l+0]=f[0],x[4*l+1]=f[1],x[4*l+2]=f[2],x[4*l+3]=f[3]}function Gh(x,l){const f=Ar(x,3);v.fromQuat(x,l),_o(x,3,f)}function Wh(x,l){_o(x,3,[l[0],l[1],l[2],1])}function Gu(x,l){const f=v.identity$1([]);return v.rotateZ$1(f,f,-l),v.rotateX$1(f,f,-x),f}function Sl(x,l){const f=[x[0],x[1],0],w=[l[0],l[1],0];if(v.length(f)>=1e-15){const O=v.normalize([],f);v.scale(w,O,v.dot(w,O)),l[0]=w[0],l[1]=w[1]}const A=v.cross([],l,x);if(v.len(A)<1e-15)return null;const M=Math.atan2(-A[1],A[0]);return Gu(Math.atan2(Math.sqrt(x[0]*x[0]+x[1]*x[1]),-x[2]),M)}class mp{constructor(l,f){this.position=l,this.orientation=f}get position(){return this._position}set position(l){this._position=this._renderWorldCopies?function(f){if(!f)return;const w=Array.isArray(f)?new v.MercatorCoordinate(f[0],f[1],f[2]):f;return w.x=v.wrap(w.x,0,1),w}(l):l}lookAtPoint(l,f){if(this.orientation=null,!this.position)return;const w=this._elevation?this._elevation.getAtPointOrZero(v.MercatorCoordinate.fromLngLat(l)):0,A=this.position,M=v.MercatorCoordinate.fromLngLat(l,w),O=[M.x-A.x,M.y-A.y,M.z-A.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=Sl(O,f)}setPitchBearing(l,f){this.orientation=Gu(v.degToRad(l),v.degToRad(-f))}}class cu{constructor(l,f){this._transform=v.identity([]),this._orientation=v.identity$1([]),f&&(this._orientation=f,Gh(this._transform,this._orientation)),l&&Wh(this._transform,l)}get mercatorPosition(){const l=this.position;return new v.MercatorCoordinate(l[0],l[1],l[2])}get position(){const l=Ar(this._transform,3);return[l[0],l[1],l[2]]}set position(l){Wh(this._transform,l)}get orientation(){return this._orientation}set orientation(l){this._orientation=l,Gh(this._transform,this._orientation)}getPitchBearing(){const l=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2])}}setPitchBearing(l,f){this._orientation=Gu(l,f),Gh(this._transform,this._orientation)}forward(){const l=Ar(this._transform,2);return[-l[0],-l[1],-l[2]]}up(){const l=Ar(this._transform,1);return[-l[0],-l[1],-l[2]]}right(){const l=Ar(this._transform,0);return[l[0],l[1],l[2]]}getCameraToWorld(l,f){const w=new Float64Array(16);return v.invert(w,this.getWorldToCamera(l,f)),w}getWorldToCameraPosition(l,f,w){const A=this.position;v.scale(A,A,-l);const M=new Float64Array(16);return v.fromScaling(M,[w,w,w]),v.translate(M,M,A),M[10]*=f,M}getWorldToCamera(l,f){const w=new Float64Array(16),A=new Float64Array(4),M=this.position;return v.conjugate(A,this._orientation),v.scale(M,M,-l),v.fromQuat(w,A),v.translate(w,w,M),w[1]*=-1,w[5]*=-1,w[9]*=-1,w[13]*=-1,w[8]*=f,w[9]*=f,w[10]*=f,w[11]*=f,w}getCameraToClipPerspective(l,f,w,A){const M=new Float64Array(16);return v.perspective(M,l,f,w,A),M}getDistanceToElevation(l){const f=0===l?0:v.mercatorZfromAltitude(l,this.position[1]),w=this.forward();return(f-this.position[2])/w[2]}clone(){return new cu([...this.position],[...this.orientation])}}function Xh(x,l){const f=yp(x),w=function(M,O,U,X,Z){const ee=new v.LngLat(U.lng-180*wc,U.lat),ne=new v.LngLat(U.lng+180*wc,U.lat),de=M.project(ee.lng,ee.lat),ye=M.project(ne.lng,ne.lat),me=-Math.atan2(ye.y-de.y,ye.x-de.x),_e=v.MercatorCoordinate.fromLngLat(U);_e.y=v.clamp(_e.y,-.999975,.999975);const De=_e.toLngLat(),ve=M.project(De.lng,De.lat),Ee=v.MercatorCoordinate.fromLngLat(De);Ee.x+=wc;const Me=Ee.toLngLat(),be=M.project(Me.lng,Me.lat),ke=hg(be.x-ve.x,be.y-ve.y,me),Fe=v.MercatorCoordinate.fromLngLat(De);Fe.y+=wc;const Qe=Fe.toLngLat(),Ke=M.project(Qe.lng,Qe.lat),rt=hg(Ke.x-ve.x,Ke.y-ve.y,me),st=Math.abs(ke.x)/Math.abs(rt.y),_t=v.identity([]);v.rotateZ(_t,_t,-me*(1-(Z?0:X)));const it=v.identity([]);return v.scale$1(it,it,[1,1-(1-st)*X,1]),it[4]=-rt.x/rt.y*X,v.rotateZ(it,it,me),v.multiply(it,_t,it),it}(x.projection,0,x.center,f,l),A=Wu(x);return v.scale$1(w,w,[A,A,1]),w}function Wu(x){const l=x.projection,f=yp(x),w=Cc(l,x.center),A=Cc(l,v.LngLat.convert(l.center));return Math.pow(2,w*f+(1-f)*A)}function yp(x){const l=x.projection.range;if(!l)return 0;const f=Math.max(x.width,x.height),w=Math.log(f/1024)/Math.LN2;return v.smoothstep(l[0]+w,l[1]+w,x.zoom)}const wc=1/4e4;function Cc(x,l){const f=v.clamp(l.lat,-v.MAX_MERCATOR_LATITUDE,v.MAX_MERCATOR_LATITUDE),w=new v.LngLat(l.lng-180*wc,f),A=new v.LngLat(l.lng+180*wc,f),M=x.project(w.lng,f),O=x.project(A.lng,f),U=v.MercatorCoordinate.fromLngLat(w),X=v.MercatorCoordinate.fromLngLat(A),Z=O.x-M.x,ee=O.y-M.y,ne=X.x-U.x,de=X.y-U.y,ye=Math.sqrt((ne*ne+de*de)/(Z*Z+ee*ee));return Math.log(ye)/Math.LN2}function hg(x,l,f){const w=Math.cos(f),A=Math.sin(f);return{x:x*w-l*A,y:x*A+l*w}}class _p{constructor(l,f,w,A,M){this.tileSize=512,this._renderWorldCopies=void 0===M||M,this._minZoom=l||0,this._maxZoom=f||22,this._minPitch=null==w?0:w,this._maxPitch=null==A?60:A,this.setProjection(),this.setMaxBounds(),this.width=0,this.height=0,this._center=new v.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ta,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new cu,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1}clone(){const l=new _p(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l._elevation=this._elevation,l._centerAltitude=this._centerAltitude,l.tileSize=this.tileSize,l.setMaxBounds(this.getMaxBounds()),l.width=this.width,l.height=this.height,l.cameraElevationReference=this.cameraElevationReference,l._center=this._center,l._setZoom(this.zoom),l._cameraZoom=this._cameraZoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._averageElevation=this._averageElevation,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._camera=this._camera.clone(),l._calcMatrices(),l.freezeTileCoverage=this.freezeTileCoverage,l.setProjection(this.getProjection()),l}get elevation(){return this._elevation}set elevation(l){this._elevation!==l&&(this._elevation=l,l?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(l){this._terrainEnabled()&&null==this._cameraZoom&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),l&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return v.pick(this.projection,["name","center","parallels"])}setProjection(l){null==l&&(l={name:"mercator"}),this.projectionOptions=l;const f=this.projection?this.getProjection():void 0;return this.projection=v.getProjection(l),!Je(f,this.getProjection())&&(this._calcMatrices(),!0)}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.wrap}set renderWorldCopies(l){void 0===l?l=!0:null===l&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get pixelsPerMeter(){return v.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}get cameraPixelsPerMeter(){return v.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new v.pointGeometry(this.width,this.height)}get bearing(){return v.wrap(this.rotation,-180,180)}set bearing(l){this.rotation=l}get rotation(){return-this.angle/Math.PI*180}set rotation(l){const f=-l*Math.PI/180;var w,A,M,O,U,X,Z,ee,ne,de;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=(w=new v.ARRAY_TYPE(4),v.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w),A=this.rotationMatrix,O=this.angle,U=(M=this.rotationMatrix)[0],X=M[1],Z=M[2],ee=M[3],ne=Math.sin(O),de=Math.cos(O),A[0]=U*de+Z*ne,A[1]=X*de+ee*ne,A[2]=U*-ne+Z*de,A[3]=X*-ne+ee*de)}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const f=v.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(l){this._averageElevation=l,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(l){const f=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(l){this._zoom=l,this.scale=this.zoomScale(l),this.tileZoom=Math.floor(l),this.zoomFraction=l-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center),-1);return-1===l?(this._cameraZoom=null,!1):(this._centerAltitude=l,!0)}_updateCameraOnTerrain(){const l=this.cameraToCenterDistance/this.worldSize,f=v.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(f+l)}sampleAverageElevation(){if(!this._elevation)return 0;const l=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],w=this.horizonLineFromTop();let A=0,M=0;for(let O=0;O<f.length;O++){const U=new v.pointGeometry(f[O][0]*this.width,w+f[O][1]*(this.height-w)),X=l.pointCoordinate(U);if(!X)continue;const Z=1/Math.hypot(X[0]-this._camera.position[0],X[1]-this._camera.position[1]);A+=X[3]*Z,M+=Z}return 0===M?NaN:A/M}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._cameraZoom||!this._elevation)return;const l=this._cameraZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),w=v.mercatorZfromAltitude(f,this.center.lat),A=this._mercatorZfromZoom(l),M=this._mercatorZfromZoom(this._maxZoom),O=Math.max(A-w,M);this._setZoom(this._zoomFromMercatorZ(O))}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}computeZoomRelativeTo(l){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,l.toAltitude()));let w;w=l.z<this._camera.position[2]?[f.x,f.y,f.z]:[l.x,l.y,l.z];const A=v.length(v.sub([],this._camera.position,w));return v.clamp(this._zoomFromMercatorZ(A),this._minZoom,this._maxZoom)}setFreeCameraOptions(l){if(!this.height||!l.position&&!l.orientation)return;this._updateCameraState();let f=!1;if(l.orientation&&!v.exactEquals(l.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(l.orientation)),l.position){const w=[l.position.x,l.position.y,l.position.z];v.exactEquals$1(w,this._camera.position)||(this._setCameraPosition(w),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const l=this._camera.position,f=new mp;return f.position=new v.MercatorCoordinate(l[0],l[1],l[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(l){if(!v.length$1(l))return!1;v.normalize$1(l,l);const f=v.transformQuat([],[0,0,-1],l),w=v.transformQuat([],[0,-1,0],l);if(w[2]<0)return!1;const A=Sl(f,w);return!!A&&(this._camera.orientation=A,!0)}_setCameraPosition(l){const f=this.zoomScale(this.minZoom)*this.tileSize,w=this.zoomScale(this.maxZoom)*this.tileSize,A=this.cameraToCenterDistance;l[2]=v.clamp(l[2],A/w,A/f),this._camera.position=l}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,f,w){this._unmodified=!1,this._edgeInsets.interpolate(l,f,w),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const f=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(l){const f=[new v.UnwrappedTileID(0,l)];if(this.renderWorldCopies){const w=this.pointCoordinate(new v.pointGeometry(0,0)),A=this.pointCoordinate(new v.pointGeometry(this.width,0)),M=this.pointCoordinate(new v.pointGeometry(this.width,this.height)),O=this.pointCoordinate(new v.pointGeometry(0,this.height)),U=Math.floor(Math.min(w.x,A.x,M.x,O.x)),X=Math.floor(Math.max(w.x,A.x,M.x,O.x)),Z=1;for(let ee=U-Z;ee<=X+Z;ee++)0!==ee&&f.push(new v.UnwrappedTileID(ee,l))}return f}coveringTiles(l){let f=this.coveringZoomLevel(l);const w=f,A=this.elevation&&!l.isTerrainDEM,M="mercator"===this.projection.name;if(void 0!==l.minzoom&&f<l.minzoom)return[];void 0!==l.maxzoom&&f>l.maxzoom&&(f=l.maxzoom);const O=this.locationCoordinate(this.center),U=1<<f,X=[U*O.x,U*O.y,0],Z=pi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f),ee=this.pointCoordinate(this.getCameraPoint()),ne=U*v.mercatorZfromAltitude(1,this.center.lat),de=this._camera.position[2]/v.mercatorZfromAltitude(1,this.center.lat),ye=[U*ee.x,U*ee.y,de],me=this.cameraToCenterDistance/l.tileSize*(l.roundZoom?1:.502),_e=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&M?f:0,De=l.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ve=l.isTerrainDEM?-De:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ee=Wu(this),Me=Ye=>{const Et=1/4e4,Lt=new v.MercatorCoordinate(Ye.x+Et,Ye.y,Ye.z),Yt=new v.MercatorCoordinate(Ye.x,Ye.y+Et,Ye.z),Zt=Ye.toLngLat(),tn=Lt.toLngLat(),nn=Yt.toLngLat(),Gt=this.locationCoordinate(Zt),sn=this.locationCoordinate(tn),Un=this.locationCoordinate(nn),Vi=Math.hypot(sn.x-Gt.x,sn.y-Gt.y),Tr=Math.hypot(Un.x-Gt.x,Un.y-Gt.y);return Math.sqrt(Vi*Tr)*Ee/Et},be=(Ye,Et,Lt,Yt,Zt,tn)=>{const nn=v.tileTransform({z:Ye,x:Et,y:Lt},this.projection);return new yt([(Yt+nn.x/nn.scale)*U,U*(nn.y/nn.scale),Zt],[(Yt+nn.x2/nn.scale)*U,U*(nn.y2/nn.scale),tn])},ke=Ye=>({aabb:be(0,0,0,Ye,ve,De),zoom:0,x:0,y:0,wrap:Ye,fullyVisible:!1}),Fe=[];let Qe=[];const Ke=f,rt=l.reparseOverscaled?w:f,st=Ye=>{if(!this._elevation||!Ye.tileID)return;const Et=this._elevation.getMinMaxForTile(Ye.tileID),Lt=Ye.aabb;Et?(Lt.min[2]=Et.min,Lt.max[2]=Et.max,Lt.center[2]=(Lt.min[2]+Lt.max[2])/2):(Ye.shouldSplit=At(Ye),Ye.shouldSplit||(Lt.min[2]=Lt.max[2]=Lt.center[2]=this._centerAltitude))},_t=Ye=>Ye*Ye,it=_t((de-this._centerAltitude)*ne),At=Ye=>{if(Ye.zoom<_e)return!0;if(Ye.zoom===Ke)return!1;if(null!=Ye.shouldSplit)return Ye.shouldSplit;const Et=Ye.aabb.distanceX(ye),Lt=Ye.aabb.distanceY(ye);let Yt=it;A&&(Yt=_t(Ye.aabb.distanceZ(ye)*ne));let Zt=1;if(!M&&w<=5){const nn=Math.pow(2,Ye.zoom),Gt=Me(new v.MercatorCoordinate((Ye.x+.5)/nn,(Ye.y+.5)/nn));Zt=Gt>.85?1:Gt}const tn=Et*Et+Lt*Lt+Yt;return tn<_t((1<<Ke-Ye.zoom)*me*Zt*((nn,Gt)=>{if(Gt*_t(.707)<nn)return 1;const sn=Math.sqrt(Gt/nn);return sn/(1.4144271570014144+(Math.pow(1.1,sn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Yt,it),tn))};if(this.renderWorldCopies)for(let Ye=1;Ye<=3;Ye++)Fe.push(ke(-Ye)),Fe.push(ke(Ye));for(Fe.push(ke(0));Fe.length>0;){const Ye=Fe.pop(),Et=Ye.x,Lt=Ye.y;let Yt=Ye.fullyVisible;if(!Yt){const Zt=Ye.aabb.intersects(Z);if(0===Zt)continue;Yt=2===Zt}if(Ye.zoom!==Ke&&At(Ye))for(let Zt=0;Zt<4;Zt++){const tn=(Et<<1)+Zt%2,nn=(Lt<<1)+(Zt>>1),Gt={aabb:"mercator"===this.projection.name?Ye.aabb.quadrant(Zt):be(Ye.zoom+1,tn,nn,Ye.wrap,0,0),zoom:Ye.zoom+1,x:tn,y:nn,wrap:Ye.wrap,fullyVisible:Yt,tileID:void 0,shouldSplit:void 0};A&&(Gt.tileID=new v.OverscaledTileID(Ye.zoom+1===Ke?rt:Ye.zoom+1,Ye.wrap,Ye.zoom+1,tn,nn),st(Gt)),Fe.push(Gt)}else{const Zt=Ye.zoom===Ke?rt:Ye.zoom;if(l.minzoom&&l.minzoom>Zt)continue;const tn=X[0]-(.5+Et+(Ye.wrap<<Ye.zoom))*(1<<f-Ye.zoom),nn=X[1]-.5-Lt,Gt=Ye.tileID?Ye.tileID:new v.OverscaledTileID(Zt,Ye.wrap,Ye.zoom,Et,Lt);Qe.push({tileID:Gt,distanceSq:tn*tn+nn*nn})}}if(this.fogCullDistSq){const Ye=this.fogCullDistSq,Et=this.horizonLineFromTop();Qe=Qe.filter(Lt=>{const Yt=[0,0,0,1],Zt=[v.EXTENT,v.EXTENT,0,1],tn=this.calculateFogTileMatrix(Lt.tileID.toUnwrapped());v.transformMat4(Yt,Yt,tn),v.transformMat4(Zt,Zt,tn);const nn=v.getAABBPointSquareDist(Yt,Zt);if(0===nn)return!0;let Gt=!1;const sn=this._elevation;if(sn&&nn>Ye&&0!==Et){const Un=this.calculateProjMatrix(Lt.tileID.toUnwrapped());let Vi;l.isTerrainDEM||(Vi=sn.getMinMaxForTile(Lt.tileID)),Vi||(Vi={min:ve,max:De});const Tr=v.furthestTileCorner(this.rotation),Ur=[Tr[0]*v.EXTENT,Tr[1]*v.EXTENT,Vi.max];v.transformMat4$1(Ur,Ur,Un),Gt=(1-Ur[1])*this.height*.5<Et}return nn<Ye||Gt})}return Qe.sort((Ye,Et)=>Ye.distanceSq-Et.distanceSq).map(Ye=>Ye.tileID)}resize(l,f){this.width=l,this.height=f,this.pixelsToGLUnits=[2/l,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const f=v.clamp(l.lat,-v.MAX_MERCATOR_LATITUDE,v.MAX_MERCATOR_LATITUDE),w=this.projection.project(l.lng,f);return new v.pointGeometry(w.x*this.worldSize,w.y*this.worldSize)}unproject(l){return this.projection.unproject(l.x/this.worldSize,l.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(l,f){const w=this.pointCoordinate(f),A=this.pointCoordinate(this.centerPoint),M=this.locationCoordinate(l);this.setLocation(new v.MercatorCoordinate(M.x-(w.x-A.x),M.y-(w.y-A.y)))}setLocation(l){this.center=this.coordinateLocation(l),this.renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(l){return this._coordinatePoint(this.locationCoordinate(l),!1)}locationPoint3D(l){return this._coordinatePoint(this.locationCoordinate(l),!0)}pointLocation(l){return this.coordinateLocation(this.pointCoordinate(l))}pointLocation3D(l){return this.coordinateLocation(this.pointCoordinate3D(l))}locationCoordinate(l,f){const w=f?v.mercatorZfromAltitude(f,l.lat):void 0,A=this.projection.project(l.lng,l.lat);return new v.MercatorCoordinate(A.x,A.y,w)}coordinateLocation(l){return this.projection.unproject(l.x,l.y)}pointRayIntersection(l,f){const w=null!=f?f:this._centerAltitude,A=[l.x,l.y,0,1],M=[l.x,l.y,1,1];v.transformMat4(A,A,this.pixelMatrixInverse),v.transformMat4(M,M,this.pixelMatrixInverse);const O=M[3];v.scale$2(A,A,1/A[3]),v.scale$2(M,M,1/O);const U=A[2],X=M[2];return{p0:A,p1:M,t:U===X?0:(w-U)/(X-U)}}screenPointToMercatorRay(l){const f=[l.x,l.y,0,1],w=[l.x,l.y,1,1];return v.transformMat4(f,f,this.pixelMatrixInverse),v.transformMat4(w,w,this.pixelMatrixInverse),v.scale$2(f,f,1/f[3]),v.scale$2(w,w,1/w[3]),f[2]=v.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,w[2]=v.mercatorZfromAltitude(w[2],this._center.lat)*this.worldSize,v.scale$2(f,f,1/this.worldSize),v.scale$2(w,w,1/this.worldSize),new mr([f[0],f[1],f[2]],v.normalize([],v.sub([],w,f)))}rayIntersectionCoordinate(l){const{p0:f,p1:w,t:A}=l,M=v.mercatorZfromAltitude(f[2],this._center.lat),O=v.mercatorZfromAltitude(w[2],this._center.lat);return new v.MercatorCoordinate(v.number(f[0],w[0],A)/this.worldSize,v.number(f[1],w[1],A)/this.worldSize,v.number(M,O,A))}pointCoordinate(l,f=this._centerAltitude){const w=this.horizonLineFromTop(!1),A=new v.pointGeometry(l.x,Math.max(w,l.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(A,f))}pointCoordinate3D(l){if(!this.elevation)return this.pointCoordinate(l);const f=this.elevation;let w=this.elevation.pointCoordinate(l);if(w)return new v.MercatorCoordinate(w[0],w[1],w[2]);let A=0,M=this.horizonLineFromTop();if(l.y>M)return this.pointCoordinate(l);const O=.02*M,U=l.clone();for(let X=0;X<10&&M-A>O;X++){U.y=v.number(A,M,.66);const Z=f.pointCoordinate(U);Z?(M=U.y,w=Z):A=U.y}return w?new v.MercatorCoordinate(w[0],w[1],w[2]):this.pointCoordinate(l)}isPointAboveHorizon(l){if(this.elevation)return!this.elevation.pointCoordinate(l);{const f=this.horizonLineFromTop();return l.y<f}}_coordinatePoint(l,f){const w=f&&this.elevation?this.elevation.getAtPointOrZero(l,this._centerAltitude):this._centerAltitude,A=[l.x*this.worldSize,l.y*this.worldSize,w+l.toAltitude(),1];return v.transformMat4(A,A,this.pixelMatrix),A[3]>0?new v.pointGeometry(A[0]/A[3],A[1]/A[3]):new v.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(l,f){const w=new v.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),A=new v.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),M=new v.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),O=new v.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let U=this.pointCoordinate(w,l),X=this.pointCoordinate(A,l);const Z=this.pointCoordinate(M,f),ee=this.pointCoordinate(O,f),ne=(de,ye)=>(ye.y-de.y)/(ye.x-de.x);return U.y>1&&X.y>=0?U=new v.MercatorCoordinate((1-ee.y)/ne(ee,U)+ee.x,1):U.y<0&&X.y<=1&&(U=new v.MercatorCoordinate(-ee.y/ne(ee,U)+ee.x,0)),X.y>1&&U.y>=0?X=new v.MercatorCoordinate((1-Z.y)/ne(Z,X)+Z.x,1):X.y<0&&U.y<=1&&(X=new v.MercatorCoordinate(-Z.y/ne(Z,X)+Z.x,0)),(new v.LngLatBounds).extend(this.coordinateLocation(U)).extend(this.coordinateLocation(X)).extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(Z))}_getBounds3D(){const l=this.elevation,f=l.visibleDemTiles.reduce((w,A)=>{if(A.dem){const M=A.dem.tree;w.min=Math.min(w.min,M.minimums[0]),w.max=Math.max(w.max,M.maximums[0])}return w},{min:Number.MAX_VALUE,max:0});return this._getBounds(f.min*l.exaggeration(),f.max*l.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(l=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,w=this.height/2-f*(1-this._horizonShift);return l?Math.max(0,w):w}getMaxBounds(){return this.maxBounds}setMaxBounds(l){this.maxBounds=l,this.minLat=-v.MAX_MERCATOR_LATITUDE,this.maxLat=v.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,l&&(this.minLat=l.getSouth(),this.maxLat=l.getNorth(),this.minLng=l.getWest(),this.maxLng=l.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=v.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=v.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=v.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=v.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(l,f){let w,A,M;const O=l.canonical,U=v.identity(new Float64Array(16));if("mercator"===this.projection.name)w=f/this.zoomScale(O.z),A=(O.x+Math.pow(2,O.z)*l.wrap)*w,M=O.y*w;else{const X=v.tileTransform(O,this.projection);w=1,A=X.x+l.wrap*X.scale,M=X.y,v.scale$1(U,U,[w/X.scale,w/X.scale,this.pixelsPerMeter/this.worldSize])}return v.translate(U,U,[A,M,0]),v.scale$1(U,U,[w/v.EXTENT,w/v.EXTENT,1]),U}calculateDistanceTileData(l){const f=l.key,w=this._distanceTileDataCache;if(w[f])return w[f];const A=l.canonical,M=1/this.height,O=this.cameraWorldSize/this.zoomScale(A.z),U=(A.x+Math.pow(2,A.z)*l.wrap)*O,X=A.y*O,Z=this.point,ee=this.angle,ne=Math.sin(-ee),de=-Math.cos(-ee);return w[f]={bearing:[ne,de],center:[(Z.x-U)*M,(Z.y-X)*M],scale:O/v.EXTENT*M},w[f]}calculateFogTileMatrix(l){const f=l.key,w=this._fogTileMatrixCache;if(w[f])return w[f];const A=this.calculatePosMatrix(l,this.cameraWorldSize);return v.multiply(A,this.worldToFogMatrix,A),w[f]=new Float32Array(A),w[f]}calculateProjMatrix(l,f=!1){const w=l.key,A=f?this._alignedProjMatrixCache:this._projMatrixCache;if(A[w])return A[w];const M=this.calculatePosMatrix(l,this.worldSize);return v.multiply(M,"mercator"===this.projection.name?f?this.alignedProjMatrix:this.projMatrix:this.mercatorMatrix,M),A[w]=new Float32Array(M),A[w]}calculatePixelsToTileUnitsMatrix(l){const f=l.tileID.key,w=this._pixelsToTileUnitsCache;if(w[f])return w[f];const A=function(M,O){const{scale:U}=M.tileTransform,X=U*v.EXTENT/(M.tileSize*Math.pow(2,O.zoom-M.tileID.overscaledZ+M.tileID.canonical.z));return Z=new Float32Array(4),de=(ee=O.inverseAdjustmentMatrix)[1],ye=ee[2],me=ee[3],De=(ne=[X,X])[1],Z[0]=ee[0]*(_e=ne[0]),Z[1]=de*_e,Z[2]=ye*De,Z[3]=me*De,Z;var Z,ee,ne,de,ye,me,_e,De}(l,this);return w[f]=A,w[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const l=this._elevation;this._updateCameraState();const f=this._camera.position,w=this._camera.forward();if(f[2]<=0||w[2]>=0)return;const A=v.mercatorZfromAltitude(1,this._center.lat);f[2]/=A,w[2]/=A,v.normalize(w,w);const M=l.raycast(f,w,l.exaggeration());if(M){const O=v.scaleAndAdd([],f,w,M),U=new v.MercatorCoordinate(O[0],O[1],v.mercatorZfromAltitude(O[2],v.latFromMercatorY(O[1]))),X=this._camera.position,Z=U.z+v.length([U.x-X[0],U.y-X[1],U.z-X[2]]);this._cameraZoom=this._zoomFromMercatorZ(Z),this._centerAltitude=U.toAltitude(),this._center=this.coordinateLocation(U),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const l=this._elevation;this._updateCameraState();const f=l.getAtPointOrZero(this._camera.mercatorPosition),w=this._minimumHeightOverTerrain()*Math.cos(v.degToRad(this._maxPitch)),A=v.mercatorZfromAltitude(f,this._center.lat),M=this._camera.position[2]-A;if(M<w){const O=this.locationCoordinate(this._center,this._centerAltitude),U=this._camera.mercatorPosition,X=[O.x-U.x,O.y-U.y,O.z-U.z],Z=v.length(X);X[2]-=w-M;const ee=v.length(X);if(0===ee)return;v.scale(X,X,Z/ee),this._camera.position=[O.x-X[0],O.y-X[1],O.z-X[2]],this._camera.orientation=Sl(X,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,"mercator"!==this.projection.name){const ne=this.center;return ne.lat=v.clamp(ne.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(ne.lng=v.clamp(ne.lng,this.minLng,this.maxLng)),this.center=ne,void(this._constraining=!1)}const l=this._unmodified,{x:f,y:w}=this.point;let A=0,M=f,O=w;const U=this.width/2,X=this.height/2,Z=this.worldMinY*this.scale,ee=this.worldMaxY*this.scale;if(w-X<Z&&(O=Z+X),w+X>ee&&(O=ee-X),ee-Z<this.height&&(A=Math.max(A,this.height/(ee-Z)),O=(ee+Z)/2),this.maxBounds||!this.renderWorldCopies){const ne=this.worldMinX*this.scale,de=this.worldMaxX*this.scale,ye=this.worldSize/2-(ne+de)/2;M=(f+ye+this.worldSize)%this.worldSize-ye,M-U<ne&&(M=ne+U),M+U>de&&(M=de-U),de-ne<this.width&&(A=Math.max(A,this.width/(de-ne)),M=(de+ne)/2)}M===f&&O===w||(this.center=this.unproject(new v.pointGeometry(M,O))),A&&(this.zoom+=this.scaleZoom(A)),this._constrainCameraAltitude(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let l=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(l=Math.max(l,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),l}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const l=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const f=this.pixelsPerMeter;this._updateCameraState();const w=Math.PI/2+this._pitch,A=this.fovAboveCenter,M=this.elevation?this.elevation.getMinElevationBelowMSL()*f:0,O=(this._camera.position[2]*this.worldSize-M)/Math.cos(this._pitch),U=Math.sin(A)*O/Math.sin(v.clamp(Math.PI-w-A,.01,Math.PI-.01)),X=this.point,Z=X.x,ee=X.y,ne=Math.cos(Math.PI/2-this._pitch)*U+O,de=Math.min(1.01*ne,O*(1/this._horizonShift)),ye=this.height/50,me=this._camera.getWorldToCamera(this.worldSize,f),_e=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,ye,de);_e[8]=2*-l.x/this.width,_e[9]=2*l.y/this.height;let De=v.mul$1([],_e,me);if("mercator"!==this.projection.name){const _t=this.locationCoordinate(this.center),it=v.identity([]);v.translate(it,it,[_t.x*this.worldSize,_t.y*this.worldSize,0]),v.multiply(it,it,Xh(this)),v.translate(it,it,[-_t.x*this.worldSize,-_t.y*this.worldSize,0]),v.multiply(De,De,it),this.inverseAdjustmentMatrix=function(At){const Ye=Xh(At,!0);return Xe([],[Ye[0],Ye[1],Ye[4],Ye[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=v.scale$1([],De,[this.worldSize,this.worldSize,this.worldSize/f]),this.projMatrix=De,this.invProjMatrix=v.invert(new Float64Array(16),this.projMatrix);const ve=new Float32Array(16);v.identity(ve),v.scale$1(ve,ve,[1,-1,1]),v.rotateX(ve,ve,this._pitch),v.rotateZ(ve,ve,this.angle);const Ee=v.perspective(new Float32Array(16),this._fov,this.width/this.height,ye,de),Me=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Ee[8]=2*-l.x/this.width,Ee[9]=2*(l.y+Me)/this.height,this.skyboxMatrix=v.multiply(ve,Ee,ve);const be=this.width%2/2,ke=this.height%2/2,Fe=Math.cos(this.angle),Qe=Math.sin(this.angle),Ke=Z-Math.round(Z)+Fe*be+Qe*ke,rt=ee-Math.round(ee)+Fe*ke+Qe*be,st=new Float64Array(De);if(v.translate(st,st,[Ke>.5?Ke-1:Ke,rt>.5?rt-1:rt,0]),this.alignedProjMatrix=st,De=v.create$1(),v.scale$1(De,De,[this.width/2,-this.height/2,1]),v.translate(De,De,[1,-1,0]),this.labelPlaneMatrix=De,De=v.create$1(),v.scale$1(De,De,[1,-1,1]),v.translate(De,De,[-1,-1,0]),v.scale$1(De,De,[2/this.width,2/this.height,1]),this.glCoordMatrix=De,this.pixelMatrix=v.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},De=v.invert(new Float64Array(16),this.pixelMatrix),!De)throw new Error("failed to invert matrix");this.pixelMatrixInverse=De,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const l=this.cameraWorldSize,f=this.cameraPixelsPerMeter,w=this._camera.position,A=1/this.height,M=[l,l,f];v.scale(M,M,A),v.scale(w,w,-1),v.multiply$1(w,w,M);const O=v.create$1();v.translate(O,O,w),v.scale$1(O,O,M),this.mercatorFogMatrix=O,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(l,f,A)}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const l=this._camera.forward(),f=this.cameraToCenterDistance,w=this.point,A=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-v.mercatorZfromAltitude(this._centerAltitude,this.center.lat),M=this.cameraToCenterDistance/A;this._camera.position=[w.x/this.worldSize-l[0]*f/M,w.y/this.worldSize-l[1]*f/M,v.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-l[2]*f/M]}_translateCameraConstrained(l){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),w=l[2];let A=1;w>0&&(A=Math.min((f-this._camera.position[2])/w,1)),this._camera.position=v.scaleAndAdd([],this._camera.position,l,A),this._updateStateFromCamera()}_updateStateFromCamera(){const l=this._camera.position,f=this._camera.forward(),{pitch:w,bearing:A}=this._camera.getPitchBearing(),M=v.mercatorZfromAltitude(this._centerAltitude,this.center.lat),O=this._mercatorZfromZoom(this._maxZoom)*Math.cos(v.degToRad(this._maxPitch)),U=Math.max((l[2]-M)/Math.cos(w),O),X=this._zoomFromMercatorZ(U);v.scaleAndAdd(l,l,f,U),this._pitch=v.clamp(w,v.degToRad(this.minPitch),v.degToRad(this.maxPitch)),this.angle=v.wrap(A,-Math.PI,Math.PI),this._setZoom(v.clamp(X,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=this.coordinateLocation(new v.MercatorCoordinate(l[0],l[1],l[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(l){return Math.pow(2,l)*this.tileSize}_mercatorZfromZoom(l){return this.cameraToCenterDistance/this._worldSizeFromZoom(l)}_minimumHeightOverTerrain(){const l=Math.min((null!=this._cameraZoom?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(l)}_zoomFromMercatorZ(l){return this.scaleZoom(this.cameraToCenterDistance/(l*this.tileSize))}_terrainEnabled(){return!(!this._elevation||"mercator"!==this.projection.name&&(v.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(l,f){const w=Math.min(l.x,f.x),A=Math.max(l.x,f.x),M=Math.min(l.y,f.y),O=Math.max(l.y,f.y);if(M<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const U=[new v.pointGeometry(w,M),new v.pointGeometry(A,O),new v.pointGeometry(w,O),new v.pointGeometry(A,M)],X=this.renderWorldCopies?-3:0,Z=this.renderWorldCopies?4:1;for(const ee of U){const ne=this.pointRayIntersection(ee);if(ne.t<0)return!0;const de=this.rayIntersectionCoordinate(ne);if(de.x<X||de.y<0||de.x>Z||de.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+v.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new v.pointGeometry(0,0),new v.pointGeometry(this.width,this.height))}zoomDeltaToMovement(l,f){const w=v.length(v.sub([],this._camera.position,l)),A=this._zoomFromMercatorZ(w)+f;return w-this._mercatorZfromZoom(A)}getCameraPoint(){const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new v.pointGeometry(0,l))}}function vp(x,l){let f=!1,w=null;const A=()=>{w=null,f&&(x(),w=setTimeout(A,l),f=!1)};return()=>(f=!0,w||A(),w)}class Yh{constructor(l){this._hashName=l&&encodeURIComponent(l),v.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=vp(this._updateHashUnthrottled.bind(this),300)}addTo(l){return this._map=l,v.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return v.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(l){const f=this._map.getCenter(),w=Math.round(100*this._map.getZoom())/100,A=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),M=Math.pow(10,A),O=Math.round(f.lng*M)/M,U=Math.round(f.lat*M)/M,X=this._map.getBearing(),Z=this._map.getPitch();let ee="";if(ee+=l?`/${O}/${U}/${w}`:`${w}/${U}/${O}`,(X||Z)&&(ee+="/"+Math.round(10*X)/10),Z&&(ee+=`/${Math.round(Z)}`),this._hashName){const ne=this._hashName;let de=!1;const ye=v.window.location.hash.slice(1).split("&").map(me=>{const _e=me.split("=")[0];return _e===ne?(de=!0,`${_e}=${ee}`):me}).filter(me=>me);return de||ye.push(`${ne}=${ee}`),`#${ye.join("&")}`}return`#${ee}`}_getCurrentHash(){const l=v.window.location.hash.replace("#","");if(this._hashName){let f;return l.split("&").map(w=>w.split("=")).forEach(w=>{w[0]===this._hashName&&(f=w)}),(f&&f[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._getCurrentHash();if(l.length>=3&&!l.some(f=>isNaN(f))){const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:f,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){const l=v.window.location.href.replace(/(#.+)?$/,this.getHashString());v.window.history.replaceState(v.window.history.state,null,l)}}const uu={linearity:.3,easing:v.bezier(0,0,.3,1)},dg=v.extend({deceleration:2500,maxSpeed:1400},uu),qh=v.extend({deceleration:20,maxSpeed:1400},uu),Sc=v.extend({deceleration:1e3,maxSpeed:360},uu),xp=v.extend({deceleration:1e3,maxSpeed:90},uu);class pg{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:v.exported.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,f=v.exported.now();for(;l.length>0&&f-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const f={zoom:0,bearing:0,pitch:0,pan:new v.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:M}of this._inertiaBuffer)f.zoom+=M.zoomDelta||0,f.bearing+=M.bearingDelta||0,f.pitch+=M.pitchDelta||0,M.panDelta&&f.pan._add(M.panDelta),M.around&&(f.around=M.around),M.pinchAround&&(f.pinchAround=M.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,A={};if(f.pan.mag()){const M=Go(f.pan.mag(),w,v.extend({},dg,l||{}));A.offset=f.pan.mult(M.amount/f.pan.mag()),A.center=this._map.transform.center,Xu(A,M)}if(f.zoom){const M=Go(f.zoom,w,qh);A.zoom=this._map.transform.zoom+M.amount,Xu(A,M)}if(f.bearing){const M=Go(f.bearing,w,Sc);A.bearing=this._map.transform.bearing+v.clamp(M.amount,-179,179),Xu(A,M)}if(f.pitch){const M=Go(f.pitch,w,xp);A.pitch=this._map.transform.pitch+M.amount,Xu(A,M)}if(A.zoom||A.bearing){const M=void 0===f.pinchAround?f.around:f.pinchAround;A.around=M?this._map.unproject(M):this._map.getCenter()}return this.clear(),v.extend(A,{noMoveStart:!0})}}function Xu(x,l){(!x.duration||x.duration<l.duration)&&(x.duration=l.duration,x.easing=l.easing)}function Go(x,l,f){const{maxSpeed:w,linearity:A,deceleration:M}=f,O=v.clamp(x*A/(l/1e3),-w,w),U=Math.abs(O)/(M*A);return{easing:f.easing,duration:1e3*U,amount:O*(U/2)}}class ps extends v.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,w,A={}){const M=ht.mousePos(f.getCanvasContainer(),w),O=f.unproject(M);super(l,v.extend({point:M,lngLat:O,originalEvent:w},A)),this._defaultPrevented=!1,this.target=f}}class In extends v.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,w){const A="touchend"===l?w.changedTouches:w.touches,M=ht.touchPos(f.getCanvasContainer(),A),O=M.map(X=>f.unproject(X)),U=M.reduce((X,Z,ee,ne)=>X.add(Z.div(ne.length)),new v.pointGeometry(0,0));super(l,{points:M,point:U,lngLats:O,lngLat:f.unproject(U),originalEvent:w}),this._defaultPrevented=!1}}class Dl extends v.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,w){super(l,{originalEvent:w}),this._defaultPrevented=!1}}class bp{constructor(l,f){this._map=l,this._clickTolerance=f.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new Dl(l.type,this._map,l))}mousedown(l,f){return this._mousedownPos=f,this._firePreventable(new ps(l.type,this._map,l))}mouseup(l){this._map.fire(new ps(l.type,this._map,l))}preclick(l){const f=v.extend({},l);f.type="preclick",this._map.fire(new ps(f.type,this._map,f))}click(l,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(l),this._map.fire(new ps(l.type,this._map,l)))}dblclick(l){return this._firePreventable(new ps(l.type,this._map,l))}mouseover(l){this._map.fire(new ps(l.type,this._map,l))}mouseout(l){this._map.fire(new ps(l.type,this._map,l))}touchstart(l){return this._firePreventable(new In(l.type,this._map,l))}touchmove(l){this._map.fire(new In(l.type,this._map,l))}touchend(l){this._map.fire(new In(l.type,this._map,l))}touchcancel(l){this._map.fire(new In(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wp{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(l){this._map.fire(new ps(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ps("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new ps(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zh{constructor(l,f){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,f){this.isEnabled()&&l.shiftKey&&0===l.button&&(ht.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(l,f){if(!this._active)return;const w=f;if(this._lastPos.equals(w)||!this._box&&w.dist(this._startPos)<this._clickTolerance)return;const A=this._startPos;this._lastPos=w,this._box||(this._box=ht.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const M=Math.min(A.x,w.x),O=Math.max(A.x,w.x),U=Math.min(A.y,w.y),X=Math.max(A.y,w.y);this._map._requestDomTask(()=>{this._box&&(ht.setTransform(this._box,`translate(${M}px,${U}px)`),this._box.style.width=O-M+"px",this._box.style.height=X-U+"px")})}mouseupWindow(l,f){if(!this._active||0!==l.button)return;const w=this._startPos,A=f;if(this.reset(),ht.suppressClick(),w.x!==A.x||w.y!==A.y)return this._map.fire(new v.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:M=>M.fitScreenCoordinates(w,A,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&27===l.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",l))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(ht.remove(this._box),this._box=null),ht.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,f){return this._map.fire(new v.Event(l,{originalEvent:f}))}}function hu(x,l){const f={};for(let w=0;w<x.length;w++)f[x[w].identifier]=l[w];return f}class Cp{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,f,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=l.timeStamp),w.length===this.numTouches&&(this.centroid=function(A){const M=new v.pointGeometry(0,0);for(const O of A)M._add(O);return M.div(A.length)}(f),this.touches=hu(w,f)))}touchmove(l,f,w){if(this.aborted||!this.centroid)return;const A=hu(w,f);for(const M in this.touches){const O=this.touches[M],U=A[M];(!U||U.dist(O)>30)&&(this.aborted=!0)}}touchend(l,f,w){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),0===w.length){const A=!this.aborted&&this.centroid;if(this.reset(),A)return A}}}class Dc{constructor(l){this.singleTap=new Cp(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,f,w){this.singleTap.touchstart(l,f,w)}touchmove(l,f,w){this.singleTap.touchmove(l,f,w)}touchend(l,f,w){const A=this.singleTap.touchend(l,f,w);if(A){const M=l.timeStamp-this.lastTime<500,O=!this.lastTap||this.lastTap.dist(A)<30;if(M&&O||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=A,this.count===this.numTaps)return this.reset(),A}}}class Yr{constructor(){this._zoomIn=new Dc({numTouches:1,numTaps:2}),this._zoomOut=new Dc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,f,w){this._zoomIn.touchstart(l,f,w),this._zoomOut.touchstart(l,f,w)}touchmove(l,f,w){this._zoomIn.touchmove(l,f,w),this._zoomOut.touchmove(l,f,w)}touchend(l,f,w){const A=this._zoomIn.touchend(l,f,w),M=this._zoomOut.touchend(l,f,w);return A?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:O.getZoom()+1,around:O.unproject(A)},{originalEvent:l})}):M?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:O.getZoom()-1,around:O.unproject(M)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const vo={0:1,2:2};class xo{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(l,f){return!1}_move(l,f){return{}}mousedown(l,f){if(this._lastPoint)return;const w=ht.mouseButton(l);this._correctButton(l,w)&&(this._lastPoint=f,this._eventButton=w)}mousemoveWindow(l,f){const w=this._lastPoint;if(w)if(l.preventDefault(),function(A,M){const O=vo[M];return void 0===A.buttons||(A.buttons&O)!==O}(l,this._eventButton))this.reset();else if(this._moved||!(f.dist(w)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(w,f)}mouseupWindow(l){this._lastPoint&&ht.mouseButton(l)===this._eventButton&&(this._moved&&ht.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jh extends xo{mousedown(l,f){super.mousedown(l,f),this._lastPoint&&(this._active=!0)}_correctButton(l,f){return 0===f&&!l.ctrlKey}_move(l,f){return{around:f,panDelta:f.sub(l)}}}class Wo extends xo{_correctButton(l,f){return 0===f&&l.ctrlKey||2===f}_move(l,f){const w=.8*(f.x-l.x);if(w)return this._active=!0,{bearingDelta:w}}contextmenu(l){l.preventDefault()}}class El extends xo{_correctButton(l,f){return 0===f&&l.ctrlKey||2===f}_move(l,f){const w=-.5*(f.y-l.y);if(w)return this._active=!0,{pitchDelta:w}}contextmenu(l){l.preventDefault()}}class Kh{constructor(l,f){this._map=l,this._el=l.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),v.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new v.pointGeometry(0,0)}touchstart(l,f,w){return this._calculateTransform(l,f,w)}touchmove(l,f,w){if(this._active&&!(w.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===w.length)return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return l.preventDefault(),this._calculateTransform(l,f,w)}}touchend(l,f,w){this._calculateTransform(l,f,w),this._active&&w.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,f,w){w.length>0&&(this._active=!0);const A=hu(w,f),M=new v.pointGeometry(0,0),O=new v.pointGeometry(0,0);let U=0;for(const Z in A){const ee=A[Z],ne=this._touches[Z];ne&&(M._add(ee),O._add(ee.sub(ne)),U++,A[Z]=ee)}if(this._touches=A,U<this._minTouches||!O.mag())return;const X=O.div(U);return this._sum._add(X),this._sum.mag()<this._clickTolerance?void 0:{around:M.div(U),panDelta:X}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ht.create("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){"hidden"===this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class Sp{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(l){}_move(l,f,w){return{}}touchstart(l,f,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([f[0],f[1]]))}touchmove(l,f,w){if(!this._firstTwoTouches)return;l.preventDefault();const[A,M]=this._firstTwoTouches,O=Ii(w,f,A),U=Ii(w,f,M);if(!O||!U)return;const X=this._aroundCenter?null:O.add(U).div(2);return this._move([O,U],X,l)}touchend(l,f,w){if(!this._firstTwoTouches)return;const[A,M]=this._firstTwoTouches,O=Ii(w,f,A),U=Ii(w,f,M);O&&U||(this._active&&ht.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&"center"===l.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ii(x,l,f){for(let w=0;w<x.length;w++)if(x[w].identifier===f)return l[w]}function Qh(x,l){return Math.log(x/l)/Math.LN2}class Dp extends Sp{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,f){const w=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(Qh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qh(this._distance,w),pinchAround:f}}}function Pi(x,l){return 180*x.angleWith(l)/Math.PI}class pa extends Sp{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,f){const w=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Pi(this._vector,w),pinchAround:f}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const f=25/(Math.PI*this._minDiameter)*360,w=Pi(l,this._startVector);return Math.abs(w)<f}}function ed(x){return Math.abs(x.y)>Math.abs(x.x)}class du extends Sp{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(l){this._lastPoints=l,ed(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,f,w){const A=l[0].sub(this._lastPoints[0]),M=l[1].sub(this._lastPoints[1]);if(!(this._map._cooperativeGestures&&w.touches.length<3)&&(this._valid=this.gestureBeginsVertically(A,M,w.timeStamp),this._valid))return this._lastPoints=l,this._active=!0,{pitchDelta:(A.y+M.y)/2*-.5}}gestureBeginsVertically(l,f,w){if(void 0!==this._valid)return this._valid;const A=l.mag()>=2,M=f.mag()>=2;if(!A&&!M)return;if(!A||!M)return void 0===this._firstMove&&(this._firstMove=w),w-this._firstMove<100&&void 0;const O=l.y>0==f.y>0;return ed(l)&&ed(f)&&O}}const qr={panStep:100,bearingStep:15,pitchStep:10};class Bt{constructor(){const l=qr;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let f=0,w=0,A=0,M=0,O=0;switch(l.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:l.shiftKey?w=-1:(l.preventDefault(),M=-1);break;case 39:l.shiftKey?w=1:(l.preventDefault(),M=1);break;case 38:l.shiftKey?A=1:(l.preventDefault(),O=-1);break;case 40:l.shiftKey?A=-1:(l.preventDefault(),O=1);break;default:return}return this._rotationDisabled&&(w=0,A=0),{cameraAnimation:U=>{const X=U.getZoom();U.easeTo({duration:300,easeId:"keyboardHandler",easing:Yu,zoom:f?Math.round(X)+f*(l.shiftKey?2:1):X,bearing:U.getBearing()+w*this._bearingStep,pitch:U.getPitch()+A*this._pitchStep,offset:[-M*this._panStep,-O*this._panStep],center:U.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Yu(x){return x*(2-x)}const Xa=4.000244140625;class Br{constructor(l,f){this._map=l,this._el=l.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,v.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=l&&"center"===l.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(l.ctrlKey||l.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=l.deltaMode===v.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const w=v.exported.now(),A=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,0!==f&&f%Xa==0?this._type="wheel":0!==f&&Math.abs(f)<4?this._type="trackpad":A>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(A*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),l.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=l,this._delta-=f,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=ht.mousePos(this._el,l);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform,f=()=>l._terrainEnabled()?l.computeZoomRelativeTo(this._aroundCoord):l.zoom;if(0!==this._delta){const X="wheel"===this._type&&Math.abs(this._delta)>Xa?this._wheelZoomRate:this._defaultZoomRate;let Z=2/(1+Math.exp(-Math.abs(this._delta*X)));this._delta<0&&0!==Z&&(Z=1/Z);const ee=f(),ne=Math.pow(2,ee),de="number"==typeof this._targetZoom?l.zoomScale(this._targetZoom):ne;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(de*Z))),"wheel"===this._type&&(this._startZoom=f(),this._easing=this._smoothOutEasing(200)),this._delta=0}const w="number"==typeof this._targetZoom?this._targetZoom:f(),A=this._startZoom,M=this._easing;let O,U=!1;if("wheel"===this._type&&A&&M){const X=Math.min((v.exported.now()-this._lastWheelEventTime)/200,1),Z=M(X);O=v.number(A,w,Z),X<1?this._frameId||(this._frameId=!0):U=!0}else O=w,U=!0;return this._active=!0,U&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!U,zoomDelta:O-f(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let f=v.ease;if(this._prevEase){const w=this._prevEase,A=(v.exported.now()-w.start)/w.duration,M=w.easing(A+.01)-w.easing(A),O=.27/Math.sqrt(M*M+1e-4)*.01,U=Math.sqrt(.0729-O*O);f=v.bezier(O,U,.25,1)}return this._prevEase={start:v.exported.now(),duration:l,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ht.create("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(v.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!v.window.document.fullscreenElement}_showBlockerAlert(){"hidden"===this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class Ec{constructor(l,f){this._clickZoom=l,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class qu{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(l,f){return l.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:w.getZoom()+(l.shiftKey?-1:1),around:w.unproject(f)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ep{constructor(){this._tap=new Dc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(l,f,w){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?w.length>0&&(this._swipePoint=f[0],this._swipeTouch=w[0].identifier):this._tap.touchstart(l,f,w))}touchmove(l,f,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const A=f[0],M=A.y-this._swipePoint.y;return this._swipePoint=A,l.preventDefault(),this._active=!0,{zoomDelta:M/128}}}else this._tap.touchmove(l,f,w)}touchend(l,f,w){this._tapTime?this._swipePoint&&0===w.length&&this.reset():this._tap.touchend(l,f,w)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ma{constructor(l,f,w){this._el=l,this._mousePan=f,this._touchPan=w}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class td{constructor(l,f,w){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=f,this._mousePitch=w}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Zu{constructor(l,f,w,A){this._el=l,this._touchZoom=f,this._touchRotate=w,this._tapDragZoom=A,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const en=x=>x.zoom||x.drag||x.pitch||x.rotate;class fg extends v.Event{}class Ju{constructor(){this.constants=[1,1,.01],this.radius=0}setup(l,f){const w=v.sub([],f,l);this.radius=v.length(w[2]<0?v.div([],w,this.constants):[w[0],w[1],0])}projectRay(l){v.div(l,l,this.constants),v.normalize(l,l),v.mul$2(l,l,this.constants);const f=v.scale([],l,this.radius);if(f[2]>0){const w=v.scale([],[0,0,1],v.dot(f,[0,0,1])),A=v.scale([],v.normalize([],[f[0],f[1],0]),this.radius),M=v.add([],f,v.scale([],v.sub([],v.add([],A,w),f),2));f[0]=M[0],f[1]=M[1]}return f}}function Ac(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta}class Ku{constructor(l,f){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new pg(l),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ju,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),v.bindAll(["handleEvent","handleWindowEvent"],this);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[v.window.document,"mousemove",{capture:!0}],[v.window.document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[v.window,"blur",void 0]];for(const[A,M,O]of this._listeners)ht.addEventListener(A,M,A===v.window.document?this.handleWindowEvent:this.handleEvent,O)}destroy(){for(const[l,f,w]of this._listeners)ht.removeEventListener(l,f,l===v.window.document?this.handleWindowEvent:this.handleEvent,w)}_addDefaultHandlers(l){const f=this._map,w=f.getCanvasContainer();this._add("mapEvent",new bp(f,l));const A=f.boxZoom=new Zh(f,l);this._add("boxZoom",A);const M=new Yr,O=new qu;f.doubleClickZoom=new Ec(O,M),this._add("tapZoom",M),this._add("clickZoom",O);const U=new Ep;this._add("tapDragZoom",U);const X=f.touchPitch=new du(f);this._add("touchPitch",X);const Z=new Wo(l),ee=new El(l);f.dragRotate=new td(l,Z,ee),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",ee,["mouseRotate"]);const ne=new Jh(l),de=new Kh(f,l);f.dragPan=new Ma(w,ne,de),this._add("mousePan",ne),this._add("touchPan",de,["touchZoom","touchRotate"]);const ye=new pa,me=new Dp;f.touchZoomRotate=new Zu(w,me,ye,U),this._add("touchRotate",ye,["touchPan","touchZoom"]),this._add("touchZoom",me,["touchPan","touchRotate"]),this._add("blockableMapEvent",new wp(f));const _e=f.scrollZoom=new Br(f,this);this._add("scrollZoom",_e,["mousePan"]);const De=f.keyboard=new Bt;this._add("keyboard",De);for(const ve of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[ve]&&f[ve].enable(l[ve])}_add(l,f,w){this._handlers.push({handlerName:l,handler:f,allowed:w}),this._handlersById[l]=f}stop(l){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(en(this._eventsInProgress))||this.isZooming()}_blockedByActive(l,f,w){for(const A in l)if(A!==w&&(!f||f.indexOf(A)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const f=[];for(const w of l)this._el.contains(w.target)&&f.push(w);return f}handleEvent(l,f){this._updatingCamera=!0;const w="renderFrame"===l.type,A=w?void 0:l,M={needsRenderFrame:!1},O={},U={},X=l.touches?this._getMapTouches(l.touches):void 0,Z=X?ht.touchPos(this._el,X):w?void 0:ht.mousePos(this._el,l);for(const{handlerName:de,handler:ye,allowed:me}of this._handlers){if(!ye.isEnabled())continue;let _e;this._blockedByActive(U,me,de)?ye.reset():ye[f||l.type]&&(_e=ye[f||l.type](l,Z,X),this.mergeHandlerResult(M,O,_e,de,A),_e&&_e.needsRenderFrame&&this._triggerRenderFrame()),(_e||ye.isActive())&&(U[de]=ye)}const ee={};for(const de in this._previousActiveHandlers)U[de]||(ee[de]=A);this._previousActiveHandlers=U,(Object.keys(ee).length||Ac(M))&&(this._changes.push([M,O,ee]),this._triggerRenderFrame()),(Object.keys(U).length||Ac(M))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ne}=M;ne&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ne(this._map))}mergeHandlerResult(l,f,w,A,M){if(!w)return;v.extend(l,w);const O={handlerName:A,originalEvent:w.originalEvent||M};void 0!==w.zoomDelta&&(f.zoom=O),void 0!==w.panDelta&&(f.drag=O),void 0!==w.pitchDelta&&(f.pitch=O),void 0!==w.bearingDelta&&(f.rotate=O)}_applyChanges(){const l={},f={},w={};for(const[A,M,O]of this._changes)A.panDelta&&(l.panDelta=(l.panDelta||new v.pointGeometry(0,0))._add(A.panDelta)),A.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+A.zoomDelta),A.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+A.bearingDelta),A.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+A.pitchDelta),void 0!==A.around&&(l.around=A.around),void 0!==A.aroundCoord&&(l.aroundCoord=A.aroundCoord),void 0!==A.pinchAround&&(l.pinchAround=A.pinchAround),A.noInertia&&(l.noInertia=A.noInertia),v.extend(f,M),v.extend(w,O);this._updateMapTransform(l,f,w),this._changes=[]}_updateMapTransform(l,f,w){const A=this._map,M=A.transform,O=Ee=>[Ee.x,Ee.y,Ee.z];if((Ee=>{const Me=this._eventsInProgress.drag;return Me&&!this._handlersById[Me.handlerName].isActive()})()&&!Ac(l)){const Ee=M.zoom;M.cameraElevationReference="sea",M.recenterOnTerrain(),M.cameraElevationReference="ground",Ee!==M.zoom&&this._map._update(!0)}if(!Ac(l))return this._fireEvents(f,w,!0);let{panDelta:U,zoomDelta:X,bearingDelta:Z,pitchDelta:ee,around:ne,aroundCoord:de,pinchAround:ye}=l;void 0!==ye&&(ne=ye),(Ee=>f.drag&&!this._eventsInProgress.drag)()&&ne&&(this._dragOrigin=O(M.pointCoordinate3D(ne)),this._trackingEllipsoid.setup(M._camera.position,this._dragOrigin)),M.cameraElevationReference="sea",A._stop(!0),ne=ne||A.transform.centerPoint,Z&&(M.bearing+=Z),ee&&(M.pitch+=ee),M._updateCameraState();const me=[0,0,0];if(U){const Ee=M.screenPointToMercatorRay(ne),Me=M.screenPointToMercatorRay(ne.sub(U)),be=this._trackingEllipsoid.projectRay(Ee.dir),ke=this._trackingEllipsoid.projectRay(Me.dir);me[0]=ke[0]-be[0],me[1]=ke[1]-be[1]}const _e=M.zoom,De=[0,0,0];if(X){const Ee=O(de||M.pointCoordinate3D(ne)),Me={dir:v.normalize([],v.sub([],Ee,M._camera.position))},be=M.screenPointToMercatorRay(M.centerPoint);if(Me.dir[2]<0){const ke=v.altitudeFromMercatorZ(Ee[2],Ee[1]),Fe=M.rayIntersectionCoordinate(M.pointRayIntersection(M.centerPoint,ke)),Qe=M.zoomDeltaToMovement(O(Fe),X)*(be.dir[2]/Me.dir[2]);v.scale(De,Me.dir,Qe)}else if(M._terrainEnabled()){const ke=M.zoomDeltaToMovement(Ee,X);v.scale(De,Me.dir,ke)}}const ve=v.add(me,me,De);M._translateCameraConstrained(ve),X&&Math.abs(M.zoom-_e)>1e-4&&M.recenterOnTerrain(),M.cameraElevationReference="ground",this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(f,w,!0)}_fireEvents(l,f,w){const A=en(this._eventsInProgress),M=en(l),O={};for(const ee in l){const{originalEvent:ne}=l[ee];this._eventsInProgress[ee]||(O[`${ee}start`]=ne),this._eventsInProgress[ee]=l[ee]}!A&&M&&this._fireEvent("movestart",M.originalEvent);for(const ee in O)this._fireEvent(ee,O[ee]);M&&this._fireEvent("move",M.originalEvent);for(const ee in l){const{originalEvent:ne}=l[ee];this._fireEvent(ee,ne)}const U={};let X;for(const ee in this._eventsInProgress){const{handlerName:ne,originalEvent:de}=this._eventsInProgress[ee];this._handlersById[ne].isActive()||(delete this._eventsInProgress[ee],X=f[ne]||de,U[`${ee}end`]=X)}for(const ee in U)this._fireEvent(ee,U[ee]);const Z=en(this._eventsInProgress);if(w&&(A||M)&&!Z){this._updatingCamera=!0;const ee=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ne=de=>0!==de&&-this._bearingSnap<de&&de<this._bearingSnap;ee?(ne(ee.bearing||this._map.getBearing())&&(ee.bearing=0),this._map.easeTo(ee,{originalEvent:X})):(this._map.fire(new v.Event("moveend",{originalEvent:X})),ne(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,f){this._map.fire(new v.Event(l,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new fg("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Qu="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ap extends v.Evented{constructor(l,f){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=f.bearingSnap,v.bindAll(["_renderFrameCallback"],this)}getCenter(){return new v.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(l,f){return this.jumpTo({center:l},f)}panBy(l,f,w){return l=v.pointGeometry.convert(l).mult(-1),this.panTo(this.transform.center,v.extend({offset:l},f),w)}panTo(l,f,w){return this.easeTo(v.extend({center:l},f),w)}getZoom(){return this.transform.zoom}setZoom(l,f){return this.jumpTo({zoom:l},f),this}zoomTo(l,f,w){return this.easeTo(v.extend({zoom:l},f),w)}zoomIn(l,f){return this.zoomTo(this.getZoom()+1,l,f),this}zoomOut(l,f){return this.zoomTo(this.getZoom()-1,l,f),this}getBearing(){return this.transform.bearing}setBearing(l,f){return this.jumpTo({bearing:l},f),this}getPadding(){return this.transform.padding}setPadding(l,f){return this.jumpTo({padding:l},f),this}rotateTo(l,f,w){return this.easeTo(v.extend({bearing:l},f),w)}resetNorth(l,f){return this.rotateTo(0,v.extend({duration:1e3},l),f),this}resetNorthPitch(l,f){return this.easeTo(v.extend({bearing:0,pitch:0,duration:1e3},l),f),this}snapToNorth(l,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,f):this}getPitch(){return this.transform.pitch}setPitch(l,f){return this.jumpTo({pitch:l},f),this}cameraForBounds(l,f){l=v.LngLatBounds.convert(l);const w=f&&f.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),w,f)}_extendCameraOptions(l){const f={top:0,bottom:0,right:0,left:0};if("number"==typeof(l=v.extend({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding){const w=l.padding;l.padding={top:w,bottom:w,right:w,left:w}}return l.padding=v.extend(f,l.padding),l}_cameraForBoxAndBearing(l,f,w,A){const M=this._extendCameraOptions(A),O=this.transform,U=O.padding,X=O.project(v.LngLat.convert(l)),Z=O.project(v.LngLat.convert(f)),ee=X.rotate(-v.degToRad(w)),ne=Z.rotate(-v.degToRad(w)),de=new v.pointGeometry(Math.max(ee.x,ne.x),Math.max(ee.y,ne.y)),ye=new v.pointGeometry(Math.min(ee.x,ne.x),Math.min(ee.y,ne.y)),me=de.sub(ye),_e=(O.width-(U.left+U.right+M.padding.left+M.padding.right))/me.x,De=(O.height-(U.top+U.bottom+M.padding.top+M.padding.bottom))/me.y;if(De<0||_e<0)return void v.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ve=Math.min(O.scaleZoom(O.scale*Math.min(_e,De)),M.maxZoom),Ee="number"==typeof M.offset.x?new v.pointGeometry(M.offset.x,M.offset.y):v.pointGeometry.convert(M.offset),Me=new v.pointGeometry((M.padding.left-M.padding.right)/2,(M.padding.top-M.padding.bottom)/2).rotate(w*Math.PI/180),be=Ee.add(Me).mult(O.scale/O.zoomScale(ve));return{center:O.unproject(X.add(Z).div(2).sub(be)),zoom:ve,bearing:w}}_cameraForBox(l,f,w,A,M){const O=this._extendCameraOptions(M);w=w||0,A=A||0,l=v.LngLat.convert(l),f=v.LngLat.convert(f);const U=this.transform.clone();U.padding=O.padding;const X=this.getFreeCameraOptions(),Z=new v.LngLat(.5*(l.lng+f.lng),.5*(l.lat+f.lat)),ee=.5*(w+A);if(U._camera.position[2]<v.mercatorZfromAltitude(ee,Z.lat))return void v.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");X.lookAtPoint(Z),U.setFreeCameraOptions(X);const ne=v.MercatorCoordinate.fromLngLat(l),de=v.MercatorCoordinate.fromLngLat(f),ye=U.pointRayIntersection(U.centerPoint,ee),me=[(_e=U.rayIntersectionCoordinate(ye)).x,_e.y,_e.z];var _e;const De=U.screenPointToMercatorRay(U.centerPoint);let ve,Ee=0;do{const Me=Math.floor(U.zoom),be=1<<Me,ke=Math.min(be*ne.x,be*de.x),Fe=Math.min(be*ne.y,be*de.y),Qe=Math.max(be*ne.x,be*de.x),Ke=Math.max(be*ne.y,be*de.y),rt=new yt([ke,Fe,w],[Qe,Ke,A]),st=pi.fromInvProjectionMatrix(U.invProjMatrix,U.worldSize,Me);if(2!==rt.intersects(st)){ve&&(U._camera.position=v.scaleAndAdd([],U._camera.position,De.dir,-ve),U._updateStateFromCamera());break}const _t=v.sub([],U._camera.position,me);ve=.5*v.length(_t),U._camera.position=v.scaleAndAdd([],U._camera.position,De.dir,ve);try{U._updateStateFromCamera()}catch(it){return void v.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++Ee<10);return{center:U.center,zoom:U.zoom,bearing:U.bearing,pitch:U.pitch}}fitBounds(l,f,w){return this._fitInternal(this.cameraForBounds(l,f),f,w)}_raycastElevationBox(l,f){const w=this.transform.elevation;if(!w)return;const A=new v.pointGeometry(l.x,f.y),M=new v.pointGeometry(f.x,l.y),O=w.pointCoordinate(l);if(!O)return;const U=w.pointCoordinate(f);if(!U)return;const X=w.pointCoordinate(A);if(!X)return;const Z=w.pointCoordinate(M);if(!Z)return;const ee=new v.MercatorCoordinate(O[0],O[1]).toLngLat(),ne=new v.MercatorCoordinate(U[0],U[1]).toLngLat(),de=new v.MercatorCoordinate(X[0],X[1]).toLngLat(),ye=new v.MercatorCoordinate(Z[0],Z[1]).toLngLat(),me=Math.min(ee.lng,Math.min(ne.lng,Math.min(de.lng,ye.lng))),_e=Math.min(ee.lat,Math.min(ne.lat,Math.min(de.lat,ye.lat))),De=Math.max(ee.lng,Math.max(ne.lng,Math.max(de.lng,ye.lng))),ve=Math.max(ee.lat,Math.max(ne.lat,Math.max(de.lat,ye.lat))),Ee=Math.min(O[3],Math.min(U[3],Math.min(X[3],Z[3]))),Me=Math.max(O[3],Math.max(U[3],Math.max(X[3],Z[3])));return{minLngLat:new v.LngLat(me,_e),maxLngLat:new v.LngLat(De,ve),minAltitude:Ee,maxAltitude:Me}}fitScreenCoordinates(l,f,w,A,M){let O,U,X,Z;const ee=v.pointGeometry.convert(l),ne=v.pointGeometry.convert(f),de=this._raycastElevationBox(ee,ne);if(de)O=de.minLngLat,U=de.maxLngLat,X=de.minAltitude,Z=de.maxAltitude;else{if(this.transform.anyCornerOffEdge(ee,ne))return this;O=this.transform.pointLocation(ee),U=this.transform.pointLocation(ne)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(v.pointGeometry.convert(l)),this.transform.pointLocation(v.pointGeometry.convert(f)),w,A):this._cameraForBox(O,U,X,Z,A),A,M)}_fitInternal(l,f,w){return l?(delete(f=v.extend(l,f)).padding,f.linear?this.easeTo(f,w):this.flyTo(f,w)):this}jumpTo(l,f){this.stop();const w=this.transform;let A=!1,M=!1,O=!1;return"zoom"in l&&w.zoom!==+l.zoom&&(A=!0,w.zoom=+l.zoom),void 0!==l.center&&(w.center=v.LngLat.convert(l.center)),"bearing"in l&&w.bearing!==+l.bearing&&(M=!0,w.bearing=+l.bearing),"pitch"in l&&w.pitch!==+l.pitch&&(O=!0,w.pitch=+l.pitch),null==l.padding||w.isPaddingEqual(l.padding)||(w.padding=l.padding),this.fire(new v.Event("movestart",f)).fire(new v.Event("move",f)),A&&this.fire(new v.Event("zoomstart",f)).fire(new v.Event("zoom",f)).fire(new v.Event("zoomend",f)),M&&this.fire(new v.Event("rotatestart",f)).fire(new v.Event("rotate",f)).fire(new v.Event("rotateend",f)),O&&this.fire(new v.Event("pitchstart",f)).fire(new v.Event("pitch",f)).fire(new v.Event("pitchend",f)),this.fire(new v.Event("moveend",f))}getFreeCameraOptions(){return"mercator"!==this.transform.projection.name&&v.warnOnce(Qu),this.transform.getFreeCameraOptions()}setFreeCameraOptions(l,f){const w=this.transform;if("mercator"!==w.projection.name)return void v.warnOnce(Qu);this.stop();const A=w.zoom,M=w.pitch,O=w.bearing;w.setFreeCameraOptions(l);const U=A!==w.zoom,X=M!==w.pitch,Z=O!==w.bearing;return this.fire(new v.Event("movestart",f)).fire(new v.Event("move",f)),U&&this.fire(new v.Event("zoomstart",f)).fire(new v.Event("zoom",f)).fire(new v.Event("zoomend",f)),Z&&this.fire(new v.Event("rotatestart",f)).fire(new v.Event("rotate",f)).fire(new v.Event("rotateend",f)),X&&this.fire(new v.Event("pitchstart",f)).fire(new v.Event("pitch",f)).fire(new v.Event("pitchend",f)),this.fire(new v.Event("moveend",f)),this}easeTo(l,f){this._stop(!1,l.easeId),(!1===(l=v.extend({offset:[0,0],duration:500,easing:v.ease},l)).animate||!l.essential&&v.exported.prefersReducedMotion)&&(l.duration=0);const w=this.transform,A=this.getZoom(),M=this.getBearing(),O=this.getPitch(),U=this.getPadding(),X="zoom"in l?+l.zoom:A,Z="bearing"in l?this._normalizeBearing(l.bearing,M):M,ee="pitch"in l?+l.pitch:O,ne="padding"in l?l.padding:w.padding,de=v.pointGeometry.convert(l.offset);let ye=w.centerPoint.add(de);const me=w.pointLocation(ye),_e=v.LngLat.convert(l.center||me);this._normalizeCenter(_e);const De=w.project(me),ve=w.project(_e).sub(De),Ee=w.zoomScale(X-A);let Me,be;l.around&&(Me=v.LngLat.convert(l.around),be=w.locationPoint(Me));const ke={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||X!==A,this._rotating=this._rotating||M!==Z,this._pitching=this._pitching||ee!==O,this._padding=!w.isPaddingEqual(ne),this._easeId=l.easeId,this._prepareEase(f,l.noMoveStart,ke),this._ease(Fe=>{if(this._zooming&&(w.zoom=v.number(A,X,Fe)),this._rotating&&(w.bearing=v.number(M,Z,Fe)),this._pitching&&(w.pitch=v.number(O,ee,Fe)),this._padding&&(w.interpolatePadding(U,ne,Fe),ye=w.centerPoint.add(de)),Me)w.setLocationAtPoint(Me,be);else{const Qe=w.zoomScale(w.zoom-A),Ke=X>A?Math.min(2,Ee):Math.max(.5,Ee),rt=Math.pow(Ke,1-Fe),st=w.unproject(De.add(ve.mult(Fe*rt)).mult(Qe));w.setLocationAtPoint(w.renderWorldCopies?st.wrap():st,ye)}this._fireMoveEvents(f)},Fe=>{w.recenterOnTerrain(),this._afterEase(f,Fe)},l),this}_prepareEase(l,f,w={}){this._moving=!0,this.transform.cameraElevationReference="sea",f||w.moving||this.fire(new v.Event("movestart",l)),this._zooming&&!w.zooming&&this.fire(new v.Event("zoomstart",l)),this._rotating&&!w.rotating&&this.fire(new v.Event("rotatestart",l)),this._pitching&&!w.pitching&&this.fire(new v.Event("pitchstart",l))}_fireMoveEvents(l){this.fire(new v.Event("move",l)),this._zooming&&this.fire(new v.Event("zoom",l)),this._rotating&&this.fire(new v.Event("rotate",l)),this._pitching&&this.fire(new v.Event("pitch",l))}_afterEase(l,f){if(this._easeId&&f&&this._easeId===f)return;delete this._easeId,this.transform.cameraElevationReference="ground";const w=this._zooming,A=this._rotating,M=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,w&&this.fire(new v.Event("zoomend",l)),A&&this.fire(new v.Event("rotateend",l)),M&&this.fire(new v.Event("pitchend",l)),this.fire(new v.Event("moveend",l))}flyTo(l,f){if(!l.essential&&v.exported.prefersReducedMotion){const Et=v.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Et,f)}this.stop(),l=v.extend({offset:[0,0],speed:1.2,curve:1.42,easing:v.ease},l);const w=this.transform,A=this.getZoom(),M=this.getBearing(),O=this.getPitch(),U=this.getPadding(),X="zoom"in l?v.clamp(+l.zoom,w.minZoom,w.maxZoom):A,Z="bearing"in l?this._normalizeBearing(l.bearing,M):M,ee="pitch"in l?+l.pitch:O,ne="padding"in l?l.padding:w.padding,de=w.zoomScale(X-A),ye=v.pointGeometry.convert(l.offset);let me=w.centerPoint.add(ye);const _e=w.pointLocation(me),De=v.LngLat.convert(l.center||_e);this._normalizeCenter(De);const ve=w.project(_e),Ee=w.project(De).sub(ve);let Me=l.curve;const be=Math.max(w.width,w.height),ke=be/de,Fe=Ee.mag();if("minZoom"in l){const Et=v.clamp(Math.min(l.minZoom,A,X),w.minZoom,w.maxZoom),Lt=be/w.zoomScale(Et-A);Me=Math.sqrt(Lt/Fe*2)}const Qe=Me*Me;function Ke(Et){const Lt=(ke*ke-be*be+(Et?-1:1)*Qe*Qe*Fe*Fe)/(2*(Et?ke:be)*Qe*Fe);return Math.log(Math.sqrt(Lt*Lt+1)-Lt)}function rt(Et){return(Math.exp(Et)-Math.exp(-Et))/2}function st(Et){return(Math.exp(Et)+Math.exp(-Et))/2}const _t=Ke(0);let it=function(Et){return st(_t)/st(_t+Me*Et)},At=function(Et){return be*((st(_t)*(rt(Lt=_t+Me*Et)/st(Lt))-rt(_t))/Qe)/Fe;var Lt},Ye=(Ke(1)-_t)/Me;if(Math.abs(Fe)<1e-6||!isFinite(Ye)){if(Math.abs(be-ke)<1e-6)return this.easeTo(l,f);const Et=ke<be?-1:1;Ye=Math.abs(Math.log(ke/be))/Me,At=function(){return 0},it=function(Lt){return Math.exp(Et*Me*Lt)}}return l.duration="duration"in l?+l.duration:1e3*Ye/("screenSpeed"in l?+l.screenSpeed/Me:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=M!==Z,this._pitching=ee!==O,this._padding=!w.isPaddingEqual(ne),this._prepareEase(f,!1),this._ease(Et=>{const Lt=Et*Ye,Yt=1/it(Lt);w.zoom=1===Et?X:A+w.scaleZoom(Yt),this._rotating&&(w.bearing=v.number(M,Z,Et)),this._pitching&&(w.pitch=v.number(O,ee,Et)),this._padding&&(w.interpolatePadding(U,ne,Et),me=w.centerPoint.add(ye));const Zt=1===Et?De:w.unproject(ve.add(Ee.mult(At(Lt))).mult(Yt));w.setLocationAtPoint(w.renderWorldCopies?Zt.wrap():Zt,me),w._updateCenterElevation(),this._fireMoveEvents(f)},()=>this._afterEase(f),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const w=this._onEaseEnd;delete this._onEaseEnd,w.call(this,f)}if(!l){const w=this.handlers;w&&w.stop(!1)}return this}_ease(l,f,w){!1===w.animate||0===w.duration?(l(1),f()):(this._easeStart=v.exported.now(),this._easeOptions=w,this._onEaseFrame=l,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((v.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,f){l=v.wrap(l,-180,180);const w=Math.abs(l-f);return Math.abs(l-360-f)<w&&(l-=360),Math.abs(l+360-f)<w&&(l+=360),l}_normalizeCenter(l){const f=this.transform;if(!f.renderWorldCopies||f.maxBounds)return;const w=l.lng-f.center.lng;l.lng+=w>180?-360:w<-180?360:0}}class nd{constructor(l={}){this.options=l,v.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){const f=this.options&&this.options.compact;return this._map=l,this._container=ht.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ht.create("button","mapboxgl-ctrl-attrib-button",this._container),ht.create("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden",!0),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ht.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===f&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){ht.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(l,f){const w=this._map._getUIString(`AttributionControl.${f}`);l.setAttribute("aria-label",w),l.firstElementChild&&l.firstElementChild.setAttribute("title",w)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||v.config.ACCESS_TOKEN}];if(l){const w=f.reduce((A,M,O)=>(M.value&&(A+=`${M.key}=${M.value}${O<f.length-1?"&":""}`),A),"?");l.href=`${v.config.FEEDBACK_URL}/${w}${this._map._hash?this._map._hash.getHashString(!0):""}`,l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}}_updateData(l){!l||"metadata"!==l.sourceDataType&&"visibility"!==l.sourceDataType&&"style"!==l.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(A=>"string"!=typeof A?"":A)):"string"==typeof this.options.customAttribution&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const A=this._map.style.stylesheet;this.styleOwner=A.owner,this.styleId=A.id}const f=this._map.style._sourceCaches;for(const A in f){const M=f[A];if(M.used){const O=M.getSource();O.attribution&&l.indexOf(O.attribution)<0&&l.push(O.attribution)}}l.sort((A,M)=>A.length-M.length),l=l.filter((A,M)=>{for(let O=M+1;O<l.length;O++)if(l[O].indexOf(A)>=0)return!1;return!0});const w=l.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,l.length?(this._innerContainer.innerHTML=w,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class bt{constructor(){v.bindAll(["_updateLogo"],this),v.bindAll(["_updateCompact"],this)}onAdd(l){this._map=l,this._container=ht.create("div","mapboxgl-ctrl");const f=ht.create("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ht.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(l){l&&"metadata"!==l.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const l=this._map.style._sourceCaches;if(0===Object.entries(l).length)return!0;for(const f in l){const w=l[f].getSource();if(w.hasOwnProperty("mapbox_logo")&&!w.mapbox_logo)return!1}return!0}_updateCompact(){const l=this._container.children;if(l.length){const f=l[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class zn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const f=++this._id;return this._queue.push({callback:l,id:f,cancelled:!1}),f}remove(l){const f=this._currentlyRunning,w=f?this._queue.concat(f):this._queue;for(const A of w)if(A.id===l)return void(A.cancelled=!0)}run(l=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const w of f)if(!w.cancelled&&(w.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function qn(x,l,f){if(x=new v.LngLat(x.lng,x.lat),l){const w=new v.LngLat(x.lng-360,x.lat),A=new v.LngLat(x.lng+360,x.lat),M=360*Math.ceil(Math.abs(x.lng-f.center.lng)/360),O=f.locationPoint(x).distSqr(l),U=l.x<0||l.y<0||l.x>f.width||l.y>f.height;f.locationPoint(w).distSqr(l)<O&&(U||Math.abs(w.lng-f.center.lng)<M)?x=w:f.locationPoint(A).distSqr(l)<O&&(U||Math.abs(A.lng-f.center.lng)<M)&&(x=A)}for(;Math.abs(x.lng-f.center.lng)>180;){const w=f.locationPoint(x);if(w.x>=0&&w.y>=0&&w.x<=f.width&&w.y<=f.height)break;x.lng>f.center.lng?x.lng-=360:x.lng+=360}return x}const $i={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Tc extends v.Evented{constructor(l,f){if(super(),(l instanceof v.window.HTMLElement||f)&&(l=v.extend({element:l},f)),v.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&"auto"!==l.pitchAlignment?l.pitchAlignment:this._rotationAlignment,l&&l.element)this._element=l.element,this._offset=v.pointGeometry.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=ht.create("div"),this._element.setAttribute("aria-label","Map marker");const A=ht.createNS("http://www.w3.org/2000/svg","svg"),M=41,O=27;A.setAttributeNS(null,"display","block"),A.setAttributeNS(null,"height",`${M}px`),A.setAttributeNS(null,"width",`${O}px`),A.setAttributeNS(null,"viewBox",`0 0 ${O} ${M}`);const U=ht.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"stroke","none"),U.setAttributeNS(null,"stroke-width","1"),U.setAttributeNS(null,"fill","none"),U.setAttributeNS(null,"fill-rule","evenodd");const X=ht.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"fill-rule","nonzero");const Z=ht.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Z.setAttributeNS(null,"fill","#000000");const ee=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Me of ee){const be=ht.createNS("http://www.w3.org/2000/svg","ellipse");be.setAttributeNS(null,"opacity","0.04"),be.setAttributeNS(null,"cx","10.5"),be.setAttributeNS(null,"cy","5.80029008"),be.setAttributeNS(null,"rx",Me.rx),be.setAttributeNS(null,"ry",Me.ry),Z.appendChild(be)}const ne=ht.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"fill",this._color);const de=ht.createNS("http://www.w3.org/2000/svg","path");de.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),ne.appendChild(de);const ye=ht.createNS("http://www.w3.org/2000/svg","g");ye.setAttributeNS(null,"opacity","0.25"),ye.setAttributeNS(null,"fill","#000000");const me=ht.createNS("http://www.w3.org/2000/svg","path");me.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ye.appendChild(me);const _e=ht.createNS("http://www.w3.org/2000/svg","g");_e.setAttributeNS(null,"transform","translate(6.0, 7.0)"),_e.setAttributeNS(null,"fill","#FFFFFF");const De=ht.createNS("http://www.w3.org/2000/svg","g");De.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ve=ht.createNS("http://www.w3.org/2000/svg","circle");ve.setAttributeNS(null,"fill","#000000"),ve.setAttributeNS(null,"opacity","0.25"),ve.setAttributeNS(null,"cx","5.5"),ve.setAttributeNS(null,"cy","5.5"),ve.setAttributeNS(null,"r","5.4999962");const Ee=ht.createNS("http://www.w3.org/2000/svg","circle");Ee.setAttributeNS(null,"fill","#FFFFFF"),Ee.setAttributeNS(null,"cx","5.5"),Ee.setAttributeNS(null,"cy","5.5"),Ee.setAttributeNS(null,"r","5.4999962"),De.appendChild(ve),De.appendChild(Ee),X.appendChild(Z),X.appendChild(ne),X.appendChild(ye),X.appendChild(_e),X.appendChild(De),A.appendChild(X),A.setAttributeNS(null,"height",M*this._scale+"px"),A.setAttributeNS(null,"width",O*this._scale+"px"),this._element.appendChild(A),this._offset=v.pointGeometry.convert(l&&l.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",A=>{A.preventDefault()}),this._element.addEventListener("mousedown",A=>{A.preventDefault()});const w=this._element.classList;for(const A in $i)w.remove(`mapboxgl-marker-anchor-${A}`);w.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),l.on("remove",this._clearFadeTimer),l._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),ht.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=v.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const f=38.1,w=13.5,A=Math.sqrt(Math.pow(w,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-f],"bottom-left":[A,-1*(f-w+A)],"bottom-right":[-A,-1*(f-w+A)],left:[w,-1*(f-w)],right:[-w,-1*(f-w)]}:this._offset}this._popup=l,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(l){const f=l.code,w=l.charCode||l.keyCode;"Space"!==f&&"Enter"!==f&&32!==w&&13!==w||this.togglePopup()}_onMapClick(l){const f=l.originalEvent.target,w=this._element;this._popup&&(f===w||w.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?(l.remove(),this._element.setAttribute("aria-expanded","false")):(l.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const l=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(l))return void this._clearFadeTimer();const f=this._map.unproject(l);let w=!1;if(this._map.transform._terrainEnabled()&&this._map.getTerrain()){const M=this._map.getFreeCameraOptions();if(M.position){const O=M.position.toLngLat();w=O.distanceTo(f)<.9*O.distanceTo(this._lngLat)}}const A=(1-this._map._queryFogOpacity(f))*(w?.2:1);this._element.style.opacity=`${A}`,this._popup&&this._popup._setOpacity(`${A}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(l){const f=this._map.transform;return!!l&&l.x>=0&&l.x<f.width&&l.y>=0&&l.y<f.height}_update(l){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=qn(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());let f="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?f=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?w="rotateX(0deg)":"map"===this._pitchAlignment&&(w=`rotateX(${this._map.getPitch()}deg)`),l&&"moveend"!==l.type||(this._pos=this._pos.round()),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&ht.setTransform(this._element,`${$i[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${f}`),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})}_transformedOffset(){if(!this._defaultMarker)return this._offset;const l=this._map.transform,f=this._offset.mult(this._scale);return"map"===this._rotationAlignment&&f._rotate(l.angle),"map"===this._pitchAlignment&&(f.y*=Math.cos(l._pitch)),f}getOffset(){return this._offset}setOffset(l){return this._offset=v.pointGeometry.convert(l),this._update(),this}_onMove(l){if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new v.Event("dragstart"))),this.fire(new v.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new v.Event("dragend")),this._state="inactive"}_addDragHandler(l){this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&"auto"!==l?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class Mc{constructor(l){this.jumpTo(l)}getValue(l){if(l<=this._startTime)return this._start;if(l>=this._endTime)return this._end;const f=v.easeCubicInOut((l-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(l){return l>=this._startTime&&l<=this._endTime}jumpTo(l){this._startTime=-1/0,this._endTime=-1/0,this._start=l,this._end=l}easeTo(l,f,w){this._start=this.getValue(f),this._end=l,this._startTime=f,this._endTime=f+w}}const Xo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},{HTMLImageElement:Al,HTMLElement:eh,ImageBitmap:Tl}=v.window,Tp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Ya(x){x.parentNode&&x.parentNode.removeChild(x)}const pu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Vr{constructor(l,f,w=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new Wo({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,w&&(this.mousePitch=new El({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),v.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),ht.addEventListener(f,"mousedown",this.mousedown),ht.addEventListener(f,"touchstart",this.touchstart,{passive:!1}),ht.addEventListener(f,"touchmove",this.touchmove),ht.addEventListener(f,"touchend",this.touchend),ht.addEventListener(f,"touchcancel",this.reset)}down(l,f){this.mouseRotate.mousedown(l,f),this.mousePitch&&this.mousePitch.mousedown(l,f),ht.disableDrag()}move(l,f){const w=this.map,A=this.mouseRotate.mousemoveWindow(l,f);if(A&&A.bearingDelta&&w.setBearing(w.getBearing()+A.bearingDelta),this.mousePitch){const M=this.mousePitch.mousemoveWindow(l,f);M&&M.pitchDelta&&w.setPitch(w.getPitch()+M.pitchDelta)}}off(){const l=this.element;ht.removeEventListener(l,"mousedown",this.mousedown),ht.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),ht.removeEventListener(l,"touchmove",this.touchmove),ht.removeEventListener(l,"touchend",this.touchend),ht.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){ht.enableDrag(),ht.removeEventListener(v.window,"mousemove",this.mousemove),ht.removeEventListener(v.window,"mouseup",this.mouseup)}mousedown(l){this.down(v.extend({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),ht.mousePos(this.element,l)),ht.addEventListener(v.window,"mousemove",this.mousemove),ht.addEventListener(v.window,"mouseup",this.mouseup)}mousemove(l){this.move(l,ht.mousePos(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){1!==l.targetTouches.length?this.reset():(this._startPos=this._lastPos=ht.touchPos(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){1!==l.targetTouches.length?this.reset():(this._lastPos=ht.touchPos(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){0===l.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Yo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let ka,Ia=0,qs=!1;const id={maxWidth:100,unit:"metric"};function th(x,l,f){const w=f&&f.maxWidth||100,A=x._container.getBoundingClientRect().height/2,M=x.unproject([0,A]),O=x.unproject([w,A]),U=M.distanceTo(O);if(f&&"imperial"===f.unit){const X=3.2808*U;X>5280?kc(l,w,X/5280,x._getUIString("ScaleControl.Miles"),x):kc(l,w,X,x._getUIString("ScaleControl.Feet"),x)}else f&&"nautical"===f.unit?kc(l,w,U/1852,x._getUIString("ScaleControl.NauticalMiles"),x):U>=1e3?kc(l,w,U/1e3,x._getUIString("ScaleControl.Kilometers"),x):kc(l,w,U,x._getUIString("ScaleControl.Meters"),x)}function kc(x,l,f,w,A){const M=function(U){const X=Math.pow(10,`${Math.floor(U)}`.length-1);let Z=U/X;return Z=Z>=10?10:Z>=5?5:Z>=3?3:Z>=2?2:Z>=1?1:function(ee){const ne=Math.pow(10,Math.ceil(-Math.log(ee)/Math.LN10));return Math.round(ee*ne)/ne}(Z),X*Z}(f),O=M/f;A._requestDomTask(()=>{x.style.width=l*O+"px",x.innerHTML=`${M}&nbsp;${w}`})}const gg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},rd=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),qa={version:v.version,supported:St,setRTLTextPlugin:v.setRTLTextPlugin,getRTLTextPluginStatus:v.getRTLTextPluginStatus,Map:class extends Ap{constructor(x){if(null!=(x=v.extend({},Tp,x)).minZoom&&null!=x.maxZoom&&x.minZoom>x.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=x.minPitch&&null!=x.maxPitch&&x.minPitch>x.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=x.minPitch&&x.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=x.maxPitch&&x.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new _p(x.minZoom,x.maxZoom,x.minPitch,x.maxPitch,x.renderWorldCopies),x),this._interactive=x.interactive,this._maxTileCacheSize=x.maxTileCacheSize,this._failIfMajorPerformanceCaveat=x.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=x.preserveDrawingBuffer,this._antialias=x.antialias,this._trackResize=x.trackResize,this._bearingSnap=x.bearingSnap,this._refreshExpiredTiles=x.refreshExpiredTiles,this._fadeDuration=x.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=x.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=x.collectResourceTiming,this._optimizeForTerrain=x.optimizeForTerrain,this._renderTaskQueue=new zn,this._domRenderTaskQueue=new zn,this._controls=[],this._markers=[],this._mapId=v.uniqueId(),this._locale=v.extend({},Xo,x.locale),this._clickTolerance=x.clickTolerance,this._cooperativeGestures=x.cooperativeGestures,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new Mc(0),this._requestManager=new v.RequestManager(x.transformRequest,x.accessToken,x.testMode),this._silenceAuthErrors=!!x.testMode,"string"==typeof x.container){if(this._container=v.window.document.getElementById(x.container),!this._container)throw new Error(`Container '${x.container}' not found.`)}else{if(!(x.container instanceof eh))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=x.container}if(x.maxBounds&&this.setMaxBounds(x.maxBounds),v.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==v.window&&(v.window.addEventListener("online",this._onWindowOnline,!1),v.window.addEventListener("resize",this._onWindowResize,!1),v.window.addEventListener("orientationchange",this._onWindowResize,!1),v.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Ku(this,x),this._localFontFamily=x.localFontFamily,this._localIdeographFontFamily=x.localIdeographFontFamily,x.style&&this.setStyle(x.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),x.projection&&this.setProjection(x.projection),this._hash=x.hash&&new Yh("string"==typeof x.hash&&x.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch}),x.bounds&&(this.resize(),this.fitBounds(x.bounds,v.extend({},x.fitBoundsOptions,{duration:0})))),this.resize(),x.attributionControl&&this.addControl(new nd({customAttribution:x.customAttribution})),this._logoControl=new bt,this.addControl(this._logoControl,x.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update("style"===l.dataType),this.fire(new v.Event(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new v.Event(`${l.dataType}dataloading`,l))})}_getMapId(){return this._mapId}addControl(x,l){if(void 0===l&&(l=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new v.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=x.onAdd(this);this._controls.push(x);const w=this._controlPositions[l];return-1!==l.indexOf("bottom")?w.insertBefore(f,w.firstChild):w.appendChild(f),this}removeControl(x){if(!x||!x.onRemove)return this.fire(new v.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(x);return l>-1&&this._controls.splice(l,1),x.onRemove(this),this}hasControl(x){return this._controls.indexOf(x)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(x){const[l,f]=this._containerDimensions();if(l===this.transform.width&&f===this.transform.height)return this;this._resizeCanvas(l,f),this.transform.resize(l,f),this.painter.resize(Math.ceil(l),Math.ceil(f));const w=!this._moving;return w&&this.fire(new v.Event("movestart",x)).fire(new v.Event("move",x)),this.fire(new v.Event("resize",x)),w&&this.fire(new v.Event("moveend",x)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(x){return this.transform.setMaxBounds(v.LngLatBounds.convert(x)),this._update()}setMinZoom(x){if((x=null==x?-2:x)>=-2&&x<=this.transform.maxZoom)return this.transform.minZoom=x,this._update(),this.getZoom()<x?this.setZoom(x):this.fire(new v.Event("zoomstart")).fire(new v.Event("zoom")).fire(new v.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(x){if((x=null==x?22:x)>=this.transform.minZoom)return this.transform.maxZoom=x,this._update(),this.getZoom()>x?this.setZoom(x):this.fire(new v.Event("zoomstart")).fire(new v.Event("zoom")).fire(new v.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(x){if((x=null==x?0:x)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.minPitch=x,this._update(),this.getPitch()<x?this.setPitch(x):this.fire(new v.Event("pitchstart")).fire(new v.Event("pitch")).fire(new v.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(x){if((x=null==x?85:x)>85)throw new Error("maxPitch must be less than or equal to 85");if(x>=this.transform.minPitch)return this.transform.maxPitch=x,this._update(),this.getPitch()>x?this.setPitch(x):this.fire(new v.Event("pitchstart")).fire(new v.Event("pitch")).fire(new v.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(x){return this.transform.renderWorldCopies=x,this._update()}getProjection(){return this.transform.getProjection()}setProjection(x){this._lazyInitEmptyStyle(),"string"==typeof x&&(x={name:x}),this._runtimeProjection=x,this.style.updateProjection()}project(x){return this.transform.locationPoint3D(v.LngLat.convert(x))}unproject(x){return this.transform.pointLocation3D(v.pointGeometry.convert(x))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(x,l,f){if("mouseenter"===x||"mouseover"===x){let w=!1;const A=O=>{const U=l.filter(Z=>this.getLayer(Z)),X=U.length?this.queryRenderedFeatures(O.point,{layers:U}):[];X.length?w||(w=!0,f.call(this,new ps(x,this,O.originalEvent,{features:X}))):w=!1},M=()=>{w=!1};return{layers:new Set(l),listener:f,delegates:{mousemove:A,mouseout:M}}}if("mouseleave"===x||"mouseout"===x){let w=!1;const A=O=>{const U=l.filter(X=>this.getLayer(X));(U.length?this.queryRenderedFeatures(O.point,{layers:U}):[]).length?w=!0:w&&(w=!1,f.call(this,new ps(x,this,O.originalEvent)))},M=O=>{w&&(w=!1,f.call(this,new ps(x,this,O.originalEvent)))};return{layers:new Set(l),listener:f,delegates:{mousemove:A,mouseout:M}}}{const w=A=>{const M=l.filter(U=>this.getLayer(U)),O=M.length?this.queryRenderedFeatures(A.point,{layers:M}):[];O.length&&(A.features=O,f.call(this,A),delete A.features)};return{layers:new Set(l),listener:f,delegates:{[x]:w}}}}on(x,l,f){if(void 0===f)return super.on(x,l);Array.isArray(l)||(l=[l]);const w=this._createDelegatedListener(x,l,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(w);for(const A in w.delegates)this.on(A,w.delegates[A]);return this}once(x,l,f){if(void 0===f)return super.once(x,l);Array.isArray(l)||(l=[l]);const w=this._createDelegatedListener(x,l,f);for(const A in w.delegates)this.once(A,w.delegates[A]);return this}off(x,l,f){if(void 0===f)return super.off(x,l);l=new Set(Array.isArray(l)?l:[l]);const w=(M,O)=>{if(M.size!==O.size)return!1;for(const U of M)if(!O.has(U))return!1;return!0},A=this._delegatedListeners?this._delegatedListeners[x]:void 0;return A&&(M=>{for(let O=0;O<M.length;O++){const U=M[O];if(U.listener===f&&w(U.layers,l)){for(const X in U.delegates)this.off(X,U.delegates[X]);return M.splice(O,1),this}}})(A),this}queryRenderedFeatures(x,l){return this.style?(void 0!==l||void 0===x||x instanceof v.pointGeometry||Array.isArray(x)||(l=x,x=void 0),this.style.queryRenderedFeatures(x=x||[[0,0],[this.transform.width,this.transform.height]],l=l||{},this.transform)):[]}querySourceFeatures(x,l){return this.style.querySourceFeatures(x,l)}queryTerrainElevation(x,l){const f=this.transform.elevation;return f?(l=v.extend({},{exaggerated:!0},l),f.getAtPoint(v.MercatorCoordinate.fromLngLat(x),null,l.exaggerated)):null}setStyle(x,l){return!1!==(l=v.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},l)).diff&&l.localIdeographFontFamily===this._localIdeographFontFamily&&l.localFontFamily===this._localFontFamily&&this.style&&x?(this._diffStyle(x,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._localFontFamily=l.localFontFamily,this._updateStyle(x,l))}_getUIString(x){const l=this._locale[x];if(null==l)throw new Error(`Missing UI string '${x}'`);return l}_updateStyle(x,l){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),x&&(this.style=new hs(this,l||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof x?this.style.loadURL(x):this.style.loadJSON(x)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new hs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(x,l){if("string"==typeof x){const f=this._requestManager.normalizeStyleURL(x),w=this._requestManager.transformRequest(f,v.ResourceType.Style);v.getJSON(w,(A,M)=>{A?this.fire(new v.ErrorEvent(A)):M&&this._updateDiff(M,l)})}else"object"==typeof x&&this._updateDiff(x,l)}_updateDiff(x,l){try{this.style.setState(x)&&this._update(!0)}catch(f){v.warnOnce(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(x,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():v.warnOnce("There is no style added to the map.")}addSource(x,l){return this._lazyInitEmptyStyle(),this.style.addSource(x,l),this._update(!0)}isSourceLoaded(x){const l=this.style&&this.style._getSourceCaches(x);if(0!==l.length)return l.every(f=>f.loaded());this.fire(new v.ErrorEvent(new Error(`There is no source with ID '${x}'`)))}areTilesLoaded(){const x=this.style&&this.style._sourceCaches;for(const l in x){const f=x[l]._tiles;for(const w in f){const A=f[w];if("loaded"!==A.state&&"errored"!==A.state)return!1}}return!0}addSourceType(x,l,f){return this._lazyInitEmptyStyle(),this.style.addSourceType(x,l,f)}removeSource(x){return this.style.removeSource(x),this._updateTerrain(),this._update(!0)}getSource(x){return this.style.getSource(x)}addImage(x,l,{pixelRatio:f=1,sdf:w=!1,stretchX:A,stretchY:M,content:O}={}){if(this._lazyInitEmptyStyle(),l instanceof Al||Tl&&l instanceof Tl){const{width:U,height:X,data:Z}=v.exported.getImageData(l);this.style.addImage(x,{data:new v.RGBAImage({width:U,height:X},Z),pixelRatio:f,stretchX:A,stretchY:M,content:O,sdf:w,version:0})}else{if(void 0===l.width||void 0===l.height)return this.fire(new v.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:U,height:X,data:Z}=l,ee=l;this.style.addImage(x,{data:new v.RGBAImage({width:U,height:X},new Uint8Array(Z)),pixelRatio:f,stretchX:A,stretchY:M,content:O,sdf:w,version:0,userImage:ee}),ee.onAdd&&ee.onAdd(this,x)}}}updateImage(x,l){const f=this.style.getImage(x);if(!f)return this.fire(new v.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=l instanceof Al||Tl&&l instanceof Tl?v.exported.getImageData(l):l,{width:A,height:M,data:O}=w;return void 0===A||void 0===M?this.fire(new v.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):A!==f.data.width||M!==f.data.height?this.fire(new v.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(f.data.replace(O,!(l instanceof Al||Tl&&l instanceof Tl)),void this.style.updateImage(x,f))}hasImage(x){return x?!!this.style.getImage(x):(this.fire(new v.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(x){this.style.removeImage(x)}loadImage(x,l){v.getImage(this._requestManager.transformRequest(x,v.ResourceType.Image),(f,w)=>{l(f,w instanceof Al?v.exported.getImageData(w):w)})}listImages(){return this.style.listImages()}addLayer(x,l){return this._lazyInitEmptyStyle(),this.style.addLayer(x,l),this._update(!0)}moveLayer(x,l){return this.style.moveLayer(x,l),this._update(!0)}removeLayer(x){return this.style.removeLayer(x),this._update(!0)}getLayer(x){return this.style.getLayer(x)}setLayerZoomRange(x,l,f){return this.style.setLayerZoomRange(x,l,f),this._update(!0)}setFilter(x,l,f={}){return this.style.setFilter(x,l,f),this._update(!0)}getFilter(x){return this.style.getFilter(x)}setPaintProperty(x,l,f,w={}){return this.style.setPaintProperty(x,l,f,w),this._update(!0)}getPaintProperty(x,l){return this.style.getPaintProperty(x,l)}setLayoutProperty(x,l,f,w={}){return this.style.setLayoutProperty(x,l,f,w),this._update(!0)}getLayoutProperty(x,l){return this.style.getLayoutProperty(x,l)}setLight(x,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(x,l),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(x){return this._lazyInitEmptyStyle(),this.style.setTerrain(x),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(x){return this._lazyInitEmptyStyle(),this.style.setFog(x),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(x){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(v.LngLat.convert(x),this.transform):0}setFeatureState(x,l){return this.style.setFeatureState(x,l),this._update()}removeFeatureState(x,l){return this.style.removeFeatureState(x,l),this._update()}getFeatureState(x){return this.style.getFeatureState(x)}_containerDimensions(){let x=0,l=0;return this._container&&(x=this._container.getBoundingClientRect().width||400,l=this._container.getBoundingClientRect().height||300),[x,l]}_detectMissingCSS(){"rgb(250, 128, 114)"!==v.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&v.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const x=this._container;x.classList.add("mapboxgl-map"),(this._missingCSSCanary=ht.create("div","mapboxgl-canary",x)).style.visibility="hidden",this._detectMissingCSS();const l=this._canvasContainer=ht.create("div","mapboxgl-canvas-container",x);this._interactive&&l.classList.add("mapboxgl-interactive"),this._canvas=ht.create("canvas","mapboxgl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const f=this._containerDimensions();this._resizeCanvas(f[0],f[1]);const w=this._controlContainer=ht.create("div","mapboxgl-control-container",x),A=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(M=>{A[M]=ht.create("div",`mapboxgl-ctrl-${M}`,w)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(x,l){const f=v.exported.devicePixelRatio||1;this._canvas.width=f*Math.ceil(x),this._canvas.height=f*Math.ceil(l),this._canvas.style.width=`${x}px`,this._canvas.style.height=`${l}px`}_addMarker(x){this._markers.push(x)}_removeMarker(x){const l=this._markers.indexOf(x);-1!==l&&this._markers.splice(l,1)}_setupPainter(){const x=v.extend({},St.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._canvas.getContext("webgl",x)||this._canvas.getContext("experimental-webgl",x);l?(v.storeAuthState(l,!0),this.painter=new lu(l,this.transform),this.on("data",f=>{"source"===f.dataType&&this.painter.setTileLoadedFlag(!0)}),v.exported$1.testSupport(l)):this.fire(new v.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(x){x.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new v.Event("webglcontextlost",{originalEvent:x}))}_contextRestored(x){this._setupPainter(),this.resize(),this._update(),this.fire(new v.Event("webglcontextrestored",{originalEvent:x}))}_onMapScroll(x){if(x.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(x){return this.style?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(x){return this._update(),this._renderTaskQueue.add(x)}_cancelRenderFrame(x){this._renderTaskQueue.remove(x)}_requestDomTask(x){!this.loaded()||this.loaded()&&!this.isMoving()?x():this._domRenderTaskQueue.add(x)}_render(x){let l;const f=this.painter.context.extTimerQuery,w=v.exported.now();this.listens("gpu-timing-frame")&&(l=f.createQueryEXT(),f.beginQueryEXT(f.TIME_ELAPSED_EXT,l));let A=this._updateAverageElevation(w);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(x),this._domRenderTaskQueue.run(x),this._removed)return;let M=!1;const O=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const X=this.transform.zoom,Z=this.transform.pitch,ee=v.exported.now();this.style.zoomHistory.update(X,ee);const ne=new v.EvaluationParameters(X,{now:ee,fadeDuration:O,pitch:Z,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),de=ne.crossFadingFactor();1===de&&de===this._crossFadingFactor||(M=!0,this._crossFadingFactor=de),this.style.update(ne)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,O,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:O,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new v.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new v.Event("load"))),this.style&&(this.style.hasTransitions()||M)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const X=v.exported.now()-w;f.endQueryEXT(f.TIME_ELAPSED_EXT,l),setTimeout(()=>{const Z=f.getQueryObjectEXT(l,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(l),this.fire(new v.Event("gpu-timing-frame",{cpuTime:X,gpuTime:Z}))},50)}if(this.listens("gpu-timing-layer")){const X=this.painter.collectGpuTimers();setTimeout(()=>{const Z=this.painter.queryGpuTimers(X);this.fire(new v.Event("gpu-timing-layer",{layerTimes:Z}))},50)}const U=this._sourcesDirty||this._styleDirty||this._placementDirty||A;if(U||this._repaint)this.triggerRepaint();else{const X=!this.isMoving()&&this.loaded();if(X&&(A=this._updateAverageElevation(w,!0)),A)this.triggerRepaint();else if(this._triggerFrame(!1),X&&(this.fire(new v.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Z=this._calculateSpeedIndex();this.fire(new v.Event("speedindexcompleted",{speedIndex:Z})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||U||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const x of this._markers)x._update()}_updateAverageElevation(x,l=!1){const f=w=>(this.transform.averageElevation=w,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&f(0);if((l||x-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(x)){const w=this.transform.averageElevation;let A=this.transform.sampleAverageElevation();isNaN(A)?A=0:this._averageElevationLastSampledAt=x;const M=Math.abs(w-A);if(M>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(A),f(A);this._averageElevation.easeTo(A,x,300)}else if(M>1e-4)return this._averageElevation.jumpTo(A),f(A)}return!!this._averageElevation.isEasing(x)&&f(this._averageElevation.getValue(x))}_authenticate(){v.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,x=>{if(x&&(x.message===v.AUTH_ERR_MSG||401===x.status)){const l=this.painter.context.gl;v.storeAuthState(l,!1),this._logoControl instanceof bt&&this._logoControl._updateLogo(),l&&l.clear(l.DEPTH_BUFFER_BIT|l.COLOR_BUFFER_BIT|l.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new v.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),v.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const x=this.painter.canvasCopy(),l=this.painter.getCanvasCopiesAndTimestamps();l.timeStamps.push(performance.now());const f=this.painter.context.gl,w=f.createFramebuffer();function A(M){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,M,0);const O=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,O),O}return f.bindFramebuffer(f.FRAMEBUFFER,w),this._canvasPixelComparison(A(x),l.canvasCopies.map(A),l.timeStamps)}_canvasPixelComparison(x,l,f){let w=f[1]-f[0];const A=x.length/4;for(let M=0;M<l.length;M++){const O=l[M];let U=0;for(let X=0;X<O.length;X+=4)O[X]===x[X]&&O[X+1]===x[X+1]&&O[X+2]===x[X+2]&&O[X+3]===x[X+3]&&(U+=1);w+=(f[M+2]-f[M+1])*(1-U/A)}return w}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.clearWorkerCaches(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==v.window&&(v.window.removeEventListener("resize",this._onWindowResize,!1),v.window.removeEventListener("orientationchange",this._onWindowResize,!1),v.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),v.window.removeEventListener("online",this._onWindowOnline,!1));const x=this.painter.context.gl.getExtension("WEBGL_lose_context");x&&x.loseContext(),Ya(this._canvasContainer),Ya(this._controlContainer),Ya(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),v.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new v.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(x){this._renderNextFrame=this._renderNextFrame||x,this.style&&!this._frame&&(this._frame=v.exported.frame(l=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(l)}))}_onWindowOnline(){this._update()}_onWindowResize(x){this._trackResize&&this.resize({originalEvent:x})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(x){this._showTerrainWireframe!==x&&(this._showTerrainWireframe=x,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(x){this._speedIndexTiming!==x&&(this._speedIndexTiming=x,this._update())}get showPadding(){return!!this._showPadding}set showPadding(x){this._showPadding!==x&&(this._showPadding=x,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,x?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._update())}get repaint(){return!!this._repaint}set repaint(x){this._repaint!==x&&(this._repaint=x,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(x){this._vertices=x,this._update()}_setCacheLimits(x,l){v.setCacheLimits(x,l)}get version(){return v.version}},NavigationControl:class{constructor(x){this.options=v.extend({},pu,x),this._container=ht.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(v.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),ht.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),ht.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(v.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=ht.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const x=this._map.getZoom(),l=x===this._map.getMaxZoom(),f=x===this._map.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())}_rotateCompassArrow(){const x=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=x)})}onAdd(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Vr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ht.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(x,l){const f=ht.create("button",x,this._container);return f.type="button",f.addEventListener("click",l),f}_setButtonTitle(x,l){const f=this._map._getUIString(`NavigationControl.${l}`);x.setAttribute("aria-label",f),x.firstElementChild&&x.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends v.Evented{constructor(x){super(),this.options=v.extend({},Yo,x),v.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=vp(this._updateMarkerRotation,20)}onAdd(x){var l;return this._map=x,this._container=ht.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,void 0!==ka?l(ka):void 0!==v.window.navigator.permissions?v.window.navigator.permissions.query({name:"geolocation"}).then(f=>{ka="denied"!==f.state,l(ka)}):(ka=!!v.window.navigator.geolocation,l(ka)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(v.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ht.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ia=0,qs=!1}_isOutOfMapMaxBounds(x){const l=this._map.getMaxBounds(),f=x.coords;return l&&(f.longitude<l.getWest()||f.longitude>l.getEast()||f.latitude<l.getSouth()||f.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(x){if(this._map){if(this._isOutOfMapMaxBounds(x))return this._setErrorState(),this.fire(new v.Event("outofmaxbounds",x)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=x,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(x),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(x),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new v.Event("geolocate",x)),this._finish()}}_updateCamera(x){const l=new v.LngLat(x.coords.longitude,x.coords.latitude),f=x.coords.accuracy,w=this._map.getBearing(),A=v.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(f),A,{geolocateSource:!0})}_updateMarker(x){if(x){const l=new v.LngLat(x.coords.longitude,x.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=x.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const x=this._map._container.getBoundingClientRect().height/2,l=this._map.unproject([0,x]),f=this._map.unproject([100,x]),w=l.distanceTo(f)/100,A=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=`${A}px`,this._circleElement.style.height=`${A}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(x){if(this._map){if(this.options.trackUserLocation)if(1===x.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===x.code&&qs)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new v.Event("error",x)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(x){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=ht.create("button","mapboxgl-ctrl-geolocate",this._container),ht.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===x){v.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ht.create("div","mapboxgl-user-location"),this._dotElement.appendChild(ht.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ht.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Tc({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ht.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Tc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||"ACTIVE_LOCK"!==this._watchState||l.originalEvent&&"resize"===l.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new v.Event("trackuserlocationend")))})}_onDeviceOrientation(x){this._userLocationDotMarker&&(x.webkitCompassHeading?this._heading=x.webkitCompassHeading:!0===x.absolute&&(this._heading=-1*x.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return v.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new v.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ia--,qs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new v.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new v.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let x;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ia++,Ia>1?(x={maximumAge:6e5,timeout:0},qs=!0):(x=this.options.positionOptions,qs=!1),this._geolocationWatchID=v.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,x),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else v.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const x=()=>{v.window.addEventListener("ondeviceorientationabsolute"in v.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};void 0!==v.window.DeviceMotionEvent&&"function"==typeof v.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(l=>{"granted"===l&&x()}).catch(console.error):x()}_clearWatch(){v.window.navigator.geolocation.clearWatch(this._geolocationWatchID),v.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),v.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:nd,ScaleControl:class{constructor(x){this.options=v.extend({},id,x),v.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){th(this._map,this._container,this.options)}onAdd(x){return this._map=x,this._container=ht.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",x.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ht.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(x){this.options.unit=x,th(this._map,this._container,this.options)}},FullscreenControl:class{constructor(x){this._fullscreen=!1,x&&x.container&&(x.container instanceof v.window.HTMLElement?this._container=x.container:v.warnOnce("Full screen control 'container' must be a DOM element.")),v.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in v.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in v.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=ht.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",v.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){ht.remove(this._controlContainer),this._map=null,v.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!v.window.document.fullscreenEnabled&&!v.window.document.webkitFullscreenEnabled)}_setupUI(){const x=this._fullscreenButton=ht.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ht.create("span","mapboxgl-ctrl-icon",x).setAttribute("aria-hidden",!0),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),v.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",x)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(v.window.document.fullscreenElement||v.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?v.window.document.exitFullscreen?v.window.document.exitFullscreen():v.window.document.webkitCancelFullScreen&&v.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends v.Evented{constructor(x){super(),this.options=v.extend(Object.create(gg),x),v.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(x&&x.className?x.className.trim().split(/\s+/):[])}addTo(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new v.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&ht.remove(this._content),this._container&&(ht.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new v.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(x){return this._lngLat=v.LngLat.convert(x),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(x){return this.setDOMContent(v.window.document.createTextNode(x))}setHTML(x){const l=v.window.document.createDocumentFragment(),f=v.window.document.createElement("body");let w;for(f.innerHTML=x;w=f.firstChild,w;)l.appendChild(w);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(x){return this.options.maxWidth=x,this._update(),this}setDOMContent(x){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ht.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(x),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(x){return this._classList.add(x),this._container&&this._updateClassList(),this}removeClassName(x){return this._classList.delete(x),this._container&&this._updateClassList(),this}setOffset(x){return this.options.offset=x,this._update(),this}toggleClassName(x){let l;return this._classList.delete(x)?l=!1:(this._classList.add(x),l=!0),this._container&&this._updateClassList(),l}_createCloseButton(){this.options.closeButton&&(this._closeButton=ht.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.setAttribute("aria-hidden","true"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(x){this._update(x.point)}_onMouseMove(x){this._update(x.point)}_onDrag(x){this._update(x.point)}_getAnchor(x){if(this.options.anchor)return this.options.anchor;const l=this._pos,f=this._container.offsetWidth,w=this._container.offsetHeight;let A;return A=l.y+x.bottom.y<w?["top"]:l.y>this._map.transform.height-w?["bottom"]:[],l.x<f/2?A.push("left"):l.x>this._map.transform.width-f/2&&A.push("right"),0===A.length?"bottom":A.join("-")}_updateClassList(){const x=[...this._classList];x.push("mapboxgl-popup"),this._anchor&&x.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&x.push("mapboxgl-popup-track-pointer"),this._container.className=x.join(" ")}_update(x){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=ht.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=ht.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=qn(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||x){const l=this._pos=this._trackPointer&&x?x:this._map.project(this._lngLat),f=function(M){if(M||(M=new v.pointGeometry(0,0)),"number"==typeof M){const O=Math.round(Math.sqrt(.5*Math.pow(M,2)));return{center:new v.pointGeometry(0,0),top:new v.pointGeometry(0,M),"top-left":new v.pointGeometry(O,O),"top-right":new v.pointGeometry(-O,O),bottom:new v.pointGeometry(0,-M),"bottom-left":new v.pointGeometry(O,-O),"bottom-right":new v.pointGeometry(-O,-O),left:new v.pointGeometry(M,0),right:new v.pointGeometry(-M,0)}}if(M instanceof v.pointGeometry||Array.isArray(M)){const O=v.pointGeometry.convert(M);return{center:O,top:O,"top-left":O,"top-right":O,bottom:O,"bottom-left":O,"bottom-right":O,left:O,right:O}}return{center:v.pointGeometry.convert(M.center||[0,0]),top:v.pointGeometry.convert(M.top||[0,0]),"top-left":v.pointGeometry.convert(M["top-left"]||[0,0]),"top-right":v.pointGeometry.convert(M["top-right"]||[0,0]),bottom:v.pointGeometry.convert(M.bottom||[0,0]),"bottom-left":v.pointGeometry.convert(M["bottom-left"]||[0,0]),"bottom-right":v.pointGeometry.convert(M["bottom-right"]||[0,0]),left:v.pointGeometry.convert(M.left||[0,0]),right:v.pointGeometry.convert(M.right||[0,0])}}(this.options.offset),w=this._anchor=this._getAnchor(f),A=l.add(f[w]).round();this._map._requestDomTask(()=>{this._container&&w&&ht.setTransform(this._container,`${$i[w]} translate(${A.x}px,${A.y}px)`)})}this._updateClassList()}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const x=this._container.querySelector(rd);x&&x.focus()}_onClose(){this.remove()}_setOpacity(x){this._content&&(this._content.style.opacity=x),this._tip&&(this._tip.style.opacity=x)}},Marker:Tc,Style:hs,LngLat:v.LngLat,LngLatBounds:v.LngLatBounds,Point:v.pointGeometry,MercatorCoordinate:v.MercatorCoordinate,FreeCameraOptions:mp,Evented:v.Evented,config:v.config,prewarm:function(){Tt().acquire(Oe)},clearPrewarmedResources:function(){const x=at;x&&(x.isPreloaded()&&1===x.numActive()?(x.release(Oe),at=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return v.config.ACCESS_TOKEN},set accessToken(x){v.config.ACCESS_TOKEN=x},get baseApiUrl(){return v.config.API_URL},set baseApiUrl(x){v.config.API_URL=x},get workerCount(){return We.workerCount},set workerCount(x){We.workerCount=x},get maxParallelImageRequests(){return v.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(x){v.config.MAX_PARALLEL_IMAGE_REQUESTS=x},clearStorage(x){v.clearTileCache(x)},workerUrl:"",workerClass:null,setNow:v.exported.setNow,restoreNow:v.exported.restoreNow};return qa}),Vn}()},147:(os,tr,gr)=>{"use strict";function Vn(t){return"function"==typeof t}function nr(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const zt=nr(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,s)=>`${s+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function v(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class St{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const h of e)h.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(Vn(i))try{i()}catch(h){n=h instanceof zt?h.errors:[h]}const{_teardowns:s}=this;if(s){this._teardowns=null;for(const h of s)try{Je(h)}catch(m){n=null!=n?n:[],m instanceof zt?n=[...n,...m.errors]:n.push(m)}}if(n)throw new zt(n)}}add(n){var e;if(n&&n!==this)if(this.closed)Je(n);else{if(n instanceof St){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._teardowns=null!==(e=this._teardowns)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&v(e,n)}remove(n){const{_teardowns:e}=this;e&&v(e,n),n instanceof St&&n._removeParent(this)}}St.EMPTY=(()=>{const t=new St;return t.closed=!0,t})();const Cs=St.EMPTY;function Nr(t){return t instanceof St||t&&"closed"in t&&Vn(t.remove)&&Vn(t.add)&&Vn(t.unsubscribe)}function Je(t){Vn(t)?t():t.unsubscribe()}const ht={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},$t={setTimeout(...t){const{delegate:n}=$t;return((null==n?void 0:n.setTimeout)||setTimeout)(...t)},clearTimeout(t){const{delegate:n}=$t;return((null==n?void 0:n.clearTimeout)||clearTimeout)(t)},delegate:void 0};function Ss(t){$t.setTimeout(()=>{const{onUnhandledError:n}=ht;if(!n)throw t;n(t)})}function Ds(){}const co=Xe("C",void 0,void 0);function Xe(t,n,e){return{kind:t,value:n,error:e}}let mr=null;function pi(t){if(ht.useDeprecatedSynchronousErrorHandling){const n=!mr;if(n&&(mr={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=mr;if(mr=null,e)throw i}}else t()}class On extends St{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Nr(n)&&n.add(this)):this.destination=cc}static create(n,e,i){return new Ro(n,e,i)}next(n){this.isStopped?Mi(Xe("N",n,void 0),this):this._next(n)}error(n){this.isStopped?Mi(Xe("E",void 0,n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?Mi(co,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class Ro extends On{constructor(n,e,i){let s;if(super(),Vn(n))s=n;else if(n){let h;({next:s,error:e,complete:i}=n),this&&ht.useDeprecatedNextContext?(h=Object.create(n),h.unsubscribe=()=>this.unsubscribe()):h=n,s=null==s?void 0:s.bind(h),e=null==e?void 0:e.bind(h),i=null==i?void 0:i.bind(h)}this.destination={next:s?fi(s):Ds,error:fi(null!=e?e:va),complete:i?fi(i):Ds}}}function fi(t,n){return(...e)=>{try{t(...e)}catch(i){ht.useDeprecatedSynchronousErrorHandling?function(t){ht.useDeprecatedSynchronousErrorHandling&&mr&&(mr.errorThrown=!0,mr.error=t)}(i):Ss(i)}}}function va(t){throw t}function Mi(t,n){const{onStoppedNotification:e}=ht;e&&$t.setTimeout(()=>e(t,n))}const cc={closed:!0,next:Ds,error:va,complete:Ds},Fr="function"==typeof Symbol&&Symbol.observable||"@@observable";function as(t){return t}let Cn=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,s){const h=function(t){return t&&t instanceof On||function(t){return t&&Vn(t.next)&&Vn(t.error)&&Vn(t.complete)}(t)&&Nr(t)}(e)?e:new Ro(e,i,s);return pi(()=>{const{operator:m,source:S}=this;h.add(m?m.call(h,S):S?this._subscribe(h):this._trySubscribe(h))}),h}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=ls(i))((s,h)=>{let m;m=this.subscribe(S=>{try{e(S)}catch(I){h(I),null==m||m.unsubscribe()}},h,s)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[Fr](){return this}pipe(...e){return function(t){return 0===t.length?as:1===t.length?t[0]:function(e){return t.reduce((i,s)=>s(i),e)}}(e)(this)}toPromise(e){return new(e=ls(e))((i,s)=>{let h;this.subscribe(m=>h=m,m=>s(m),()=>i(h))})}}return t.create=n=>new t(n),t})();function ls(t){var n;return null!==(n=null!=t?t:ht.Promise)&&void 0!==n?n:Promise}const ir=nr(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Dn=(()=>{class t extends Cn{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new mn(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new ir}next(e){pi(()=>{if(this._throwIfClosed(),!this.isStopped){const i=this.observers.slice();for(const s of i)s.next(e)}})}error(e){pi(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){pi(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:s,observers:h}=this;return i||s?Cs:(h.push(e),new St(()=>v(h,e)))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:s,isStopped:h}=this;i?e.error(s):h&&e.complete()}asObservable(){const e=new Cn;return e.source=this,e}}return t.create=(n,e)=>new mn(n,e),t})();class mn extends Dn{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,n)}error(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==i?i:Cs}}function Or(t){return Vn(null==t?void 0:t.lift)}function ni(t){return n=>{if(Or(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}class vn extends On{constructor(n,e,i,s,h){super(n),this.onFinalize=h,this._next=e?function(m){try{e(m)}catch(S){n.error(S)}}:super._next,this._error=s?function(m){try{s(m)}catch(S){n.error(S)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(m){n.error(m)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}function Kt(t,n){return ni((e,i)=>{let s=0;e.subscribe(new vn(i,h=>{i.next(t.call(n,h,s++))}))})}function Es(t){return this instanceof Es?(this.v=t,this):new Es(t)}function As(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,i=e.apply(t,n||[]),h=[];return s={},m("next"),m("throw"),m("return"),s[Symbol.asyncIterator]=function(){return this},s;function m(re){i[re]&&(s[re]=function(he){return new Promise(function(Se,ze){h.push([re,he,Se,ze])>1||S(re,he)})})}function S(re,he){try{!function(re){re.value instanceof Es?Promise.resolve(re.value.v).then(F,G):J(h[0][2],re)}(i[re](he))}catch(Se){J(h[0][3],Se)}}function F(re){S("next",re)}function G(re){S("throw",re)}function J(re,he){re(he),h.shift(),h.length&&S(h[0][0],h[0][1])}}function uc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(h){e[h]=t[h]&&function(m){return new Promise(function(S,I){!function(h,m,S,I){Promise.resolve(I).then(function(F){h({value:F,done:S})},m)}(S,I,(m=t[h](m)).done,m.value)})}}}const Oo=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function dc(t){return Vn(null==t?void 0:t.then)}function Ha(t){return Vn(t[Fr])}function gl(t){return Symbol.asyncIterator&&Vn(null==t?void 0:t[Symbol.asyncIterator])}function Lo(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const us="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function zo(t){return Vn(null==t?void 0:t[us])}function wa(t){return As(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:s}=yield Es(e.read());if(s)return yield Es(void 0);yield yield Es(i)}}finally{e.releaseLock()}})}function Bo(t){return Vn(null==t?void 0:t.getReader)}function Ei(t){if(t instanceof Cn)return t;if(null!=t){if(Ha(t))return function(t){return new Cn(n=>{const e=t[Fr]();if(Vn(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(Oo(t))return function(t){return new Cn(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(dc(t))return function(t){return new Cn(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,Ss)})}(t);if(gl(t))return we(t);if(zo(t))return function(t){return new Cn(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(Bo(t))return function(t){return we(wa(t))}(t)}throw Lo(t)}function we(t){return new Cn(n=>{(function(t,n){var e,i,s,h;return function(t,n,e,i){return new(e||(e=Promise))(function(h,m){function S(G){try{F(i.next(G))}catch(J){m(J)}}function I(G){try{F(i.throw(G))}catch(J){m(J)}}function F(G){G.done?h(G.value):function(h){return h instanceof e?h:new e(function(m){m(h)})}(G.value).then(S,I)}F((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=uc(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(m){s={error:m}}finally{try{i&&!i.done&&(h=e.return)&&(yield h.call(e))}finally{if(s)throw s.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function xe(t,n,e,i=0,s=!1){const h=n.schedule(function(){e(),s?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(h),!s)return h}function Ie(t,n,e=1/0){return Vn(n)?Ie((i,s)=>Kt((h,m)=>n(i,h,s,m))(Ei(t(i,s))),e):("number"==typeof n&&(e=n),ni((i,s)=>function(t,n,e,i,s,h,m,S){const I=[];let F=0,G=0,J=!1;const re=()=>{J&&!I.length&&!F&&n.complete()},he=ze=>F<i?Se(ze):I.push(ze),Se=ze=>{F++;let Le=!1;Ei(e(ze,G++)).subscribe(new vn(n,et=>{n.next(et)},()=>{Le=!0},void 0,()=>{if(Le)try{for(F--;I.length&&F<i;){const et=I.shift();Se(et)}re()}catch(et){n.error(et)}}))};return t.subscribe(new vn(n,he,()=>{J=!0,re()})),()=>{}}(i,s,t,e)))}function $e(t=1/0){return Ie(as,t)}const Ue=new Cn(t=>t.complete());function at(t){return t&&Vn(t.schedule)}function Tt(t){return t[t.length-1]}function te(t){return Vn(Tt(t))?t.pop():void 0}function o(t){return at(Tt(t))?t.pop():void 0}function d(t,n=0){return ni((e,i)=>{e.subscribe(new vn(i,s=>xe(i,t,()=>i.next(s),n),()=>xe(i,t,()=>i.complete(),n),s=>xe(i,t,()=>i.error(s),n)))})}function g(t,n=0){return ni((e,i)=>{i.add(t.schedule(()=>e.subscribe(i),n))})}function P(t,n){if(!t)throw new Error("Iterable cannot be null");return new Cn(e=>{xe(e,n,()=>{const i=t[Symbol.asyncIterator]();xe(e,n,()=>{i.next().then(s=>{s.done?e.complete():e.next(s.value)})},0,!0)})})}function V(t,n){return n?function(t,n){if(null!=t){if(Ha(t))return function(t,n){return Ei(t).pipe(g(n),d(n))}(t,n);if(Oo(t))return function(t,n){return new Cn(e=>{let i=0;return n.schedule(function(){i===t.length?e.complete():(e.next(t[i++]),e.closed||this.schedule())})})}(t,n);if(dc(t))return function(t,n){return Ei(t).pipe(g(n),d(n))}(t,n);if(gl(t))return P(t,n);if(zo(t))return function(t,n){return new Cn(e=>{let i;return xe(e,n,()=>{i=t[us](),xe(e,n,()=>{let s,h;try{({value:s,done:h}=i.next())}catch(m){return void e.error(m)}h?e.complete():e.next(s)},0,!0)}),()=>Vn(null==i?void 0:i.return)&&i.return()})}(t,n);if(Bo(t))return function(t,n){return P(wa(t),n)}(t,n)}throw Lo(t)}(t,n):Ei(t)}function q(t){return t<=0?()=>Ue:ni((n,e)=>{let i=0;n.subscribe(new vn(e,s=>{++i<=t&&(e.next(s),t<=i&&e.complete())}))})}function oe(t,n,...e){return!0===n?(t(),null):!1===n?null:n(...e).pipe(q(1)).subscribe(()=>t())}function ae(t){for(let n in t)if(t[n]===ae)return n;throw Error("Could not find renamed property on target object.")}function fe(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function ge(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(ge).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function R(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const H=ae({__forward_ref__:ae});function Q(t){return t.__forward_ref__=Q,t.toString=function(){return ge(this())},t}function le(t){return Re(t)?t():t}function Re(t){return"function"==typeof t&&t.hasOwnProperty(H)&&t.__forward_ref__===Q}class Ve extends Error{constructor(n,e){super(function(t,n){return`${t?`NG0${t}: `:""}${n}`}(n,e)),this.code=n}}function qe(t){return"string"==typeof t?t:null==t?"":String(t)}function Vt(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():qe(t)}function sr(t,n){const e=n?` in ${n}`:"";throw new Ve("201",`No provider for ${Vt(t)} found${e}`)}function gi(t,n){null==t&&function(t,n,e,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${e} ${i} ${n} <=Actual]`))}(n,t,null,"!=")}function Ft(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function kn(t){return{providers:t.providers||[],imports:t.imports||[]}}function go(t){return Uh(t,hs)||Uh(t,Lu)}function Uh(t,n){return t.hasOwnProperty(n)?t[n]:null}function dp(t){return t&&(t.hasOwnProperty(nu)||t.hasOwnProperty(iu))?t[nu]:null}const hs=ae({\u0275prov:ae}),nu=ae({\u0275inj:ae}),Lu=ae({ngInjectableDef:ae}),iu=ae({ngInjectorDef:ae});var Xt=(()=>((Xt=Xt||{})[Xt.Default=0]="Default",Xt[Xt.Host=1]="Host",Xt[Xt.Self=2]="Self",Xt[Xt.SkipSelf=4]="SkipSelf",Xt[Xt.Optional=8]="Optional",Xt))();let ha;function Vo(t){const n=ha;return ha=t,n}function Mn(t,n,e){const i=go(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&Xt.Optional?null:void 0!==n?n:void sr(ge(t),"Injector")}function Uo(t){return{toString:t}.toString()}var Ms=(()=>((Ms=Ms||{})[Ms.OnPush=0]="OnPush",Ms[Ms.Default=1]="Default",Ms))(),ln=(()=>{return(t=ln||(ln={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",ln;var t})();const ru="undefined"!=typeof globalThis&&globalThis,Vu="undefined"!=typeof window&&window,jh="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Gn=ru||"undefined"!=typeof global&&global||Vu||jh,vl={},ii=[],xl=ae({\u0275cmp:ae}),gc=ae({\u0275dir:ae}),mc=ae({\u0275pipe:ae}),Uu=ae({\u0275mod:ae}),da=ae({\u0275fac:ae}),yc=ae({__NG_ELEMENT_ID__:ae});let _c=0;function Jn(t){return Uo(()=>{const e={},i={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Ms.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||ii,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||ln.Emulated,id:"c",styles:t.styles||ii,_:null,setInput:null,schemas:t.schemas||null,tView:null},s=t.directives,h=t.features,m=t.pipes;return i.id+=_c++,i.inputs=ju(t.inputs,e),i.outputs=ju(t.outputs),h&&h.forEach(S=>S(i)),i.directiveDefs=s?()=>("function"==typeof s?s():s).map(ks):null,i.pipeDefs=m?()=>("function"==typeof m?m():m).map(Hu):null,i})}function ks(t){return _r(t)||function(t){return t[gc]||null}(t)}function Hu(t){return function(t){return t[mc]||null}(t)}const su={};function Ln(t){return Uo(()=>{const n={type:t.type,bootstrap:t.bootstrap||ii,declarations:t.declarations||ii,imports:t.imports||ii,exports:t.exports||ii,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(su[t.id]=t.type),n})}function ju(t,n){if(null==t)return vl;const e={};for(const i in t)if(t.hasOwnProperty(i)){let s=t[i],h=s;Array.isArray(s)&&(h=s[1],s=s[0]),e[s]=i,n&&(n[s]=h)}return e}const Rt=Jn;function _r(t){return t[xl]||null}function Ws(t,n){const e=t[Uu]||null;if(!e&&!0===n)throw new Error(`Type ${ge(t)} does not have '\u0275mod' property.`);return e}function ds(t){return Array.isArray(t)&&"object"==typeof t[1]}function Er(t){return Array.isArray(t)&&!0===t[1]}function bc(t){return 0!=(8&t.flags)}function lu(t){return 2==(2&t.flags)}function Ta(t){return 1==(1&t.flags)}function Ar(t){return null!==t.template}function _o(t){return 0!=(512&t[2])}function Go(t,n){return t.hasOwnProperty(da)?t[da]:null}class ps{constructor(n,e,i){this.previousValue=n,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function In(){return Dl}function Dl(t){return t.type.prototype.ngOnChanges&&(t.setInput=wp),bp}function bp(){const t=hu(this),n=null==t?void 0:t.current;if(n){const e=t.previous;if(e===vl)t.previous=n;else for(let i in n)e[i]=n[i];t.current=null,this.ngOnChanges(n)}}function wp(t,n,e,i){const s=hu(t)||function(t,n){return t[Zh]=n}(t,{previous:vl,current:null}),h=s.current||(s.current={}),m=s.previous,S=this.declaredInputs[e],I=m[S];h[S]=new ps(I&&I.currentValue,n,m===vl),t[i]=n}In.ngInherit=!0;const Zh="__ngSimpleChanges__";function hu(t){return t[Zh]||null}const xo="http://www.w3.org/2000/svg";let Wo;function Ii(t){return!!t.listen}const Qh={createRenderer:(t,n)=>void 0!==Wo?Wo:"undefined"!=typeof document?document:void 0};function Pi(t){for(;Array.isArray(t);)t=t[0];return t}function du(t,n){return Pi(n[t])}function qr(t,n){return Pi(n[t.index])}function Yu(t,n){return t.data[n]}function Br(t,n){const e=n[t];return ds(e)?e:e[0]}function Ec(t){return 4==(4&t[2])}function qu(t){return 128==(128&t[2])}function Ma(t,n){return null==n?null:t[n]}function td(t){t[18]=0}function Zu(t,n){t[5]+=n;let e=t,i=t[3];for(;null!==i&&(1===n&&1===e[5]||-1===n&&0===e[5]);)i[5]+=n,e=i,i=i[3]}const en={lFrame:O(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Qu(){return en.bindingsEnabled}function bt(){return en.lFrame.lView}function zn(){return en.lFrame.tView}function $i(){let t=Tc();for(;null!==t&&64===t.type;)t=t.parent;return t}function Tc(){return en.lFrame.currentTNode}function Xo(t,n){const e=en.lFrame;e.currentTNode=t,e.isParent=n}function Al(){return en.lFrame.isParent}function eh(){en.lFrame.isParent=!1}function Ya(){return en.isInCheckNoChangesMode}function pu(t){en.isInCheckNoChangesMode=t}function Vr(){const t=en.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function Ia(){return en.lFrame.bindingIndex++}function qs(t){const n=en.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function kc(t,n){const e=en.lFrame;e.bindingIndex=e.bindingRootIndex=t,rd(n)}function rd(t){en.lFrame.currentDirectiveIndex=t}function x(){return en.lFrame.currentQueryIndex}function l(t){en.lFrame.currentQueryIndex=t}function f(t){const n=t[1];return 2===n.type?n.declTNode:1===n.type?t[6]:null}function w(t,n,e){if(e&Xt.SkipSelf){let s=n,h=t;for(;!(s=s.parent,null!==s||e&Xt.Host||(s=f(h),null===s||(h=h[15],10&s.type))););if(null===s)return!1;n=s,t=h}const i=en.lFrame=M();return i.currentTNode=n,i.lView=t,!0}function A(t){const n=M(),e=t[1];en.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function M(){const t=en.lFrame,n=null===t?null:t.child;return null===n?O(t):n}function O(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function U(){const t=en.lFrame;return en.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const X=U;function Z(){const t=U();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function de(){return en.lFrame.selectedIndex}function ye(t){en.lFrame.selectedIndex=t}function me(){const t=en.lFrame;return Yu(t.tView,t.selectedIndex)}function ke(t,n){for(let e=n.directiveStart,i=n.directiveEnd;e<i;e++){const h=t.data[e].type.prototype,{ngAfterContentInit:m,ngAfterContentChecked:S,ngAfterViewInit:I,ngAfterViewChecked:F,ngOnDestroy:G}=h;m&&(t.contentHooks||(t.contentHooks=[])).push(-e,m),S&&((t.contentHooks||(t.contentHooks=[])).push(e,S),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(e,S)),I&&(t.viewHooks||(t.viewHooks=[])).push(-e,I),F&&((t.viewHooks||(t.viewHooks=[])).push(e,F),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(e,F)),null!=G&&(t.destroyHooks||(t.destroyHooks=[])).push(e,G)}}function Fe(t,n,e){rt(t,n,3,e)}function Qe(t,n,e,i){(3&t[2])===e&&rt(t,n,e,i)}function Ke(t,n){let e=t[2];(3&e)===n&&(e&=2047,e+=1,t[2]=e)}function rt(t,n,e,i){const h=null!=i?i:-1,m=n.length-1;let S=0;for(let I=void 0!==i?65535&t[18]:0;I<m;I++)if("number"==typeof n[I+1]){if(S=n[I],null!=i&&S>=i)break}else n[I]<0&&(t[18]+=65536),(S<h||-1==h)&&(st(t,e,n,I),t[18]=(4294901760&t[18])+I+2),I++}function st(t,n,e,i){const s=e[i]<0,h=e[i+1],S=t[s?-e[i]:e[i]];if(s){if(t[2]>>11<t[18]>>16&&(3&t[2])===n){t[2]+=2048;try{h.call(S)}finally{}}}else try{h.call(S)}finally{}}class it{constructor(n,e,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function Gt(t,n,e){const i=Ii(t);let s=0;for(;s<e.length;){const h=e[s];if("number"==typeof h){if(0!==h)break;s++;const m=e[s++],S=e[s++],I=e[s++];i?t.setAttribute(n,S,I,m):n.setAttributeNS(m,S,I)}else{const m=h,S=e[++s];Un(m)?i&&t.setProperty(n,m,S):i?t.setAttribute(n,m,S):n.setAttribute(m,S),s++}}return s}function sn(t){return 3===t||4===t||6===t}function Un(t){return 64===t.charCodeAt(0)}function Vi(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let i=0;i<n.length;i++){const s=n[i];"number"==typeof s?e=s:0===e||Tr(t,e,s,null,-1===e||2===e?n[++i]:null)}}return t}function Tr(t,n,e,i,s){let h=0,m=t.length;if(-1===n)m=-1;else for(;h<t.length;){const S=t[h++];if("number"==typeof S){if(S===n){m=-1;break}if(S>n){m=h-1;break}}}for(;h<t.length;){const S=t[h];if("number"==typeof S)break;if(S===e){if(null===i)return void(null!==s&&(t[h+1]=s));if(i===t[h+1])return void(t[h+2]=s)}h++,null!==i&&h++,null!==s&&h++}-1!==m&&(t.splice(m,0,n),h=m+1),t.splice(h++,0,e),null!==i&&t.splice(h++,0,i),null!==s&&t.splice(h++,0,s)}function Ur(t){return-1!==t}function ar(t){return 32767&t}function Is(t,n){let e=function(t){return t>>16}(t),i=n;for(;e>0;)i=i[15],e--;return i}let bo=!0;function ri(t){const n=bo;return bo=t,n}let Hr=0;function jr(t,n){const e=Zr(t,n);if(-1!==e)return e;const i=n[1];i.firstCreatePass&&(t.injectorIndex=n.length,Ml(i.data,t),Ml(n,null),Ml(i.blueprint,null));const s=qo(t,n),h=t.injectorIndex;if(Ur(s)){const m=ar(s),S=Is(s,n),I=S[1].data;for(let F=0;F<8;F++)n[h+F]=S[m+F]|I[m+F]}return n[h+8]=s,h}function Ml(t,n){t.push(0,0,0,0,0,0,0,0,n)}function Zr(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function qo(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,i=null,s=n;for(;null!==s;){const h=s[1],m=h.type;if(i=2===m?h.declTNode:1===m?s[6]:null,null===i)return-1;if(e++,s=s[15],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return-1}function fu(t,n,e){!function(t,n,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(yc)&&(i=e[yc]),null==i&&(i=e[yc]=Hr++);const s=255&i;n.data[t+(s>>5)]|=1<<s}(t,n,e)}function kl(t,n,e){if(e&Xt.Optional)return t;sr(n,"NodeInjector")}function sd(t,n,e,i){if(e&Xt.Optional&&void 0===i&&(i=null),0==(e&(Xt.Self|Xt.Host))){const s=t[9],h=Vo(void 0);try{return s?s.get(n,i,e&Xt.Optional):Mn(n,i,e&Xt.Optional)}finally{Vo(h)}}return kl(i,n,e)}function Ic(t,n,e,i=Xt.Default,s){if(null!==t){const h=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(yc)?t[yc]:void 0;return"number"==typeof n?n>=0?255&n:Iy:n}(e);if("function"==typeof h){if(!w(n,t,i))return i&Xt.Host?kl(s,e,i):sd(n,e,i,s);try{const m=h(i);if(null!=m||i&Xt.Optional)return m;sr(e)}finally{X()}}else if("number"==typeof h){let m=null,S=Zr(t,n),I=-1,F=i&Xt.Host?n[16][6]:null;for((-1===S||i&Xt.SkipSelf)&&(I=-1===S?qo(t,n):n[S+8],-1!==I&&Ry(i,!1)?(m=n[1],S=ar(I),n=Is(I,n)):S=-1);-1!==S;){const G=n[1];if(mg(h,S,G.data)){const J=Py(S,n,e,m,i,F);if(J!==gu)return J}I=n[S+8],-1!==I&&Ry(i,n[1].data[S+8]===F)&&mg(h,S,n)?(m=G,S=ar(I),n=Is(I,n)):S=-1}}}return sd(n,e,i,s)}const gu={};function Iy(){return new Za($i(),bt())}function Py(t,n,e,i,s,h){const m=n[1],S=m.data[t+8],G=od(S,m,e,null==i?lu(S)&&bo:i!=m&&0!=(3&S.type),s&Xt.Host&&h===S);return null!==G?ad(n,m,G,S):gu}function od(t,n,e,i,s){const h=t.providerIndexes,m=n.data,S=1048575&h,I=t.directiveStart,G=h>>20,re=s?S+G:t.directiveEnd;for(let he=i?S:S+G;he<re;he++){const Se=m[he];if(he<I&&e===Se||he>=I&&Se.type===e)return he}if(s){const he=m[I];if(he&&Ar(he)&&he.type===e)return I}return null}function ad(t,n,e,i){let s=t[e];const h=n.data;if(function(t){return t instanceof it}(s)){const m=s;m.resolving&&function(t,n){throw new Ve("200",`Circular dependency in DI detected for ${t}`)}(Vt(h[e]));const S=ri(m.canSeeViewProviders);m.resolving=!0;const I=m.injectImpl?Vo(m.injectImpl):null;w(t,i,Xt.Default);try{s=t[e]=m.factory(void 0,h,t,i),n.firstCreatePass&&e>=i.directiveStart&&function(t,n,e){const{ngOnChanges:i,ngOnInit:s,ngDoCheck:h}=n.type.prototype;if(i){const m=Dl(n);(e.preOrderHooks||(e.preOrderHooks=[])).push(t,m),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,m)}s&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-t,s),h&&((e.preOrderHooks||(e.preOrderHooks=[])).push(t,h),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,h))}(e,h[e],n)}finally{null!==I&&Vo(I),ri(S),m.resolving=!1,X()}}return s}function mg(t,n,e){return!!(e[n+(t>>5)]&1<<t)}function Ry(t,n){return!(t&Xt.Self||t&Xt.Host&&n)}class Za{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,i){return Ic(this._tNode,this._lView,n,i,e)}}function Jr(t){return Uo(()=>{const n=t.prototype.constructor,e=n[da]||ih(n),i=Object.prototype;let s=Object.getPrototypeOf(t.prototype).constructor;for(;s&&s!==i;){const h=s[da]||ih(s);if(h&&h!==e)return h;s=Object.getPrototypeOf(s)}return h=>new h})}function ih(t){return Re(t)?()=>{const n=ih(le(t));return n&&n()}:Go(t)}const Pl="__parameters__";function Nc(t,n,e){return Uo(()=>{const i=function(t){return function(...e){if(t){const i=t(...e);for(const s in i)this[s]=i[s]}}}(n);function s(...h){if(this instanceof s)return i.apply(this,h),this;const m=new s(...h);return S.annotation=m,S;function S(I,F,G){const J=I.hasOwnProperty(Pl)?I[Pl]:Object.defineProperty(I,Pl,{value:[]})[Pl];for(;J.length<=G;)J.push(null);return(J[G]=J[G]||[]).push(m),I}}return e&&(s.prototype=Object.create(e.prototype)),s.prototype.ngMetadataName=t,s.annotationCls=s,s})}class on{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Ft({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Rl=new on("AnalyzeForEntryComponents");function yi(t,n){void 0===n&&(n=t);for(let e=0;e<t.length;e++){let i=t[e];Array.isArray(i)?(n===t&&(n=t.slice(0,e)),yi(i,n)):n!==t&&n.push(i)}return n}function cn(t,n){t.forEach(e=>Array.isArray(e)?cn(e,n):n(e))}function Ka(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function Oc(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function Rn(t,n){const e=[];for(let i=0;i<t;i++)e.push(n);return e}function cr(t,n,e){let i=Zo(t,n);return i>=0?t[1|i]=e:(i=~i,function(t,n,e,i){let s=t.length;if(s==n)t.push(e,i);else if(1===s)t.push(i,t[0]),t[0]=e;else{for(s--,t.push(t[s-1],t[s]);s>n;)t[s]=t[s-2],s--;t[n]=e,t[n+1]=i}}(t,i,n,e)),i}function ud(t,n){const e=Zo(t,n);if(e>=0)return t[1|e]}function Zo(t,n){return function(t,n,e){let i=0,s=t.length>>e;for(;s!==i;){const h=i+(s-i>>1),m=t[h<<e];if(n===m)return h<<e;m>n?s=h:i=h+1}return~(s<<e)}(t,n,1)}const hd={},Ip="__NG_DI_FLAG__",lh="ngTempTokenPath",Px=/\n/gm,Pp="__source",Rp=ae({provide:String,useValue:ae});let Qa;function yu(t){const n=Qa;return Qa=t,n}function Rx(t,n=Xt.Default){if(void 0===Qa)throw new Error("inject() must be called from an injection context");return null===Qa?Mn(t,void 0,n):Qa.get(t,n&Xt.Optional?null:void 0,n)}function dt(t,n=Xt.Default){return(ha||Rx)(le(t),n)}function zc(t){const n=[];for(let e=0;e<t.length;e++){const i=le(t[e]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let s,h=Xt.Default;for(let m=0;m<i.length;m++){const S=i[m],I=Fx(S);"number"==typeof I?-1===I?s=S.token:h|=I:s=S}n.push(dt(s,h))}else n.push(dt(i))}return n}function pd(t,n){return t[Ip]=n,t.prototype[Ip]=n,t}function Fx(t){return t[Ip]}function fs(t,n,e,i){const s=t[lh];throw n[Pp]&&s.unshift(n[Pp]),t.message=function(t,n,e,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let s=ge(n);if(Array.isArray(n))s=n.map(ge).join(" -> ");else if("object"==typeof n){let h=[];for(let m in n)if(n.hasOwnProperty(m)){let S=n[m];h.push(m+":"+("string"==typeof S?JSON.stringify(S):ge(S)))}s=`{${h.join(", ")}}`}return`${e}${i?"("+i+")":""}[${s}]: ${t.replace(Px,"\n  ")}`}("\n"+t.message,s,e,i),t.ngTokenPath=s,t[lh]=null,t}const Bc=pd(Nc("Inject",t=>({token:t})),-1),Js=pd(Nc("Optional"),8),Ra=pd(Nc("SkipSelf"),4);function Ps(t){return t instanceof class{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?t.changingThisBreaksApplicationSecurity:t}const fh="__ngContext__";function ms(t,n){t[fh]=n}function Fg(t){const n=function(t){return t[fh]||null}(t);return n?Array.isArray(n)?n:n.lView:null}function Wp(t){return t.ngOriginalError}function tl(t,...n){t.error(...n)}class zl{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n),i=this._findContext(n),s=(t=n)&&t.ngErrorLogger||tl;var t;s(this._console,"ERROR",n),e&&s(this._console,"ORIGINAL ERROR",e),i&&s(this._console,"ERROR CONTEXT",i)}_findContext(n){return n?n.ngDebugContext||this._findContext(Wp(n)):null}_findOriginalError(n){let e=n&&Wp(n);for(;e&&Wp(e);)e=Wp(e);return e||null}}const si=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Gn))();function Ks(t){return t instanceof Function?t():t}var Jo=(()=>((Jo=Jo||{})[Jo.Important=1]="Important",Jo[Jo.DashCase=2]="DashCase",Jo))();function Ug(t,n){return undefined(t,n)}function Dd(t){const n=t[3];return Er(n)?n[3]:n}function qp(t){return d_(t[13])}function Hg(t){return d_(t[4])}function d_(t){for(;null!==t&&!Er(t);)t=t[4];return t}function Uc(t,n,e,i,s){if(null!=i){let h,m=!1;Er(i)?h=i:ds(i)&&(m=!0,i=i[0]);const S=Pi(i);0===t&&null!==e?null==s?Yg(n,e,S):Do(n,e,S,s||null,!0):1===t&&null!==e?Do(n,e,S,s||null,!0):2===t?function(t,n,e){const i=Md(t,n);i&&function(t,n,e,i){Ii(t)?t.removeChild(n,e,i):n.removeChild(e)}(t,i,n,e)}(n,S,m):3===t&&n.destroyNode(S),null!=h&&function(t,n,e,i,s){const h=e[7];h!==Pi(e)&&Uc(n,t,i,h,s);for(let S=10;S<e.length;S++){const I=e[S];Hc(I[1],I,t,n,i,h)}}(n,t,h,e,s)}}function bu(t,n,e){return Ii(t)?t.createElement(n,e):null===e?t.createElement(n):t.createElementNS(e,n)}function g_(t,n){const e=t[9],i=e.indexOf(n),s=n[3];1024&n[2]&&(n[2]&=-1025,Zu(s,-1)),e.splice(i,1)}function Jp(t,n){if(t.length<=10)return;const e=10+n,i=t[e];if(i){const s=i[17];null!==s&&s!==t&&g_(s,i),n>0&&(t[e-1][4]=i[4]);const h=Oc(t,10+n);!function(t,n){Hc(t,n,n[11],2,null,null),n[0]=null,n[6]=null}(i[1],i);const m=h[19];null!==m&&m.detachView(h[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function Gg(t,n){if(!(256&n[2])){const e=n[11];Ii(e)&&e.destroyNode&&Hc(t,n,e,3,null,null),function(t){let n=t[13];if(!n)return Td(t[1],t);for(;n;){let e=null;if(ds(n))e=n[13];else{const i=n[10];i&&(e=i)}if(!e){for(;n&&!n[4]&&n!==t;)ds(n)&&Td(n[1],n),n=n[3];null===n&&(n=t),ds(n)&&Td(n[1],n),e=n&&n[4]}n=e}}(n)}}function Td(t,n){if(!(256&n[2])){n[2]&=-129,n[2]|=256,function(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let i=0;i<e.length;i+=2){const s=n[e[i]];if(!(s instanceof it)){const h=e[i+1];if(Array.isArray(h))for(let m=0;m<h.length;m+=2){const S=s[h[m]],I=h[m+1];try{I.call(S)}finally{}}else try{h.call(s)}finally{}}}}(t,n),function(t,n){const e=t.cleanup,i=n[7];let s=-1;if(null!==e)for(let h=0;h<e.length-1;h+=2)if("string"==typeof e[h]){const m=e[h+1],S="function"==typeof m?m(n):Pi(n[m]),I=i[s=e[h+2]],F=e[h+3];"boolean"==typeof F?S.removeEventListener(e[h],I,F):F>=0?i[s=F]():i[s=-F].unsubscribe(),h+=2}else{const m=i[s=e[h+1]];e[h].call(m)}if(null!==i){for(let h=s+1;h<i.length;h++)i[h]();n[7]=null}}(t,n),1===n[1].type&&Ii(n[11])&&n[11].destroy();const e=n[17];if(null!==e&&Er(n[3])){e!==n[3]&&g_(e,n);const i=n[19];null!==i&&i.detachView(t)}}}function y_(t,n,e){return function(t,n,e){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return e[0];if(2&i.flags){const s=t.data[i.directiveStart].encapsulation;if(s===ln.None||s===ln.Emulated)return null}return qr(i,e)}(t,n.parent,e)}function Do(t,n,e,i,s){Ii(t)?t.insertBefore(n,e,i,s):n.insertBefore(e,i,s)}function Yg(t,n,e){Ii(t)?t.appendChild(n,e):n.appendChild(e)}function qg(t,n,e,i,s){null!==i?Do(t,n,e,i,s):Yg(t,n,e)}function Md(t,n){return Ii(t)?t.parentNode(n):n.parentNode}function v_(t,n,e){return Jg(t,n,e)}let Jg=function(t,n,e){return 40&t.type?qr(t,e):null};function kd(t,n,e,i){const s=y_(t,i,n),h=n[11],S=v_(i.parent||n[6],i,n);if(null!=s)if(Array.isArray(e))for(let I=0;I<e.length;I++)qg(h,s,e[I],S,!1);else qg(h,s,e,S,!1)}function vh(t,n){if(null!==n){const e=n.type;if(3&e)return qr(n,t);if(4&e)return Kp(-1,t[n.index]);if(8&e){const i=n.child;if(null!==i)return vh(t,i);{const s=t[n.index];return Er(s)?Kp(-1,s):Pi(s)}}if(32&e)return Ug(n,t)()||Pi(t[n.index]);{const i=Cu(t,n);return null!==i?Array.isArray(i)?i[0]:vh(Dd(t[16]),i):vh(t,n.next)}}return null}function Cu(t,n){return null!==n?t[16][6].projection[n.projection]:null}function Kp(t,n){const e=10+t+1;if(e<n.length){const i=n[e],s=i[1].firstChild;if(null!==s)return vh(i,s)}return n[7]}function Qp(t,n,e,i,s,h,m){for(;null!=e;){const S=i[e.index],I=e.type;if(m&&0===n&&(S&&ms(Pi(S),i),e.flags|=4),64!=(64&e.flags))if(8&I)Qp(t,n,e.child,i,s,h,!1),Uc(n,t,s,S,h);else if(32&I){const F=Ug(e,i);let G;for(;G=F();)Uc(n,t,s,G,h);Uc(n,t,s,S,h)}else 16&I?x_(t,n,i,e,s,h):Uc(n,t,s,S,h);e=m?e.projectionNext:e.next}}function Hc(t,n,e,i,s,h){Qp(e,i,t.firstChild,n,s,h,!1)}function x_(t,n,e,i,s,h){const m=e[16],I=m[6].projection[i.projection];if(Array.isArray(I))for(let F=0;F<I.length;F++)Uc(n,t,s,I[F],h);else Qp(t,n,I,m[3],s,h,!0)}function b_(t,n,e){Ii(t)?t.setAttribute(n,"style",e):n.style.cssText=e}function Qg(t,n,e){Ii(t)?""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e):n.className=e}function Su(t,n,e){let i=t.length;for(;;){const s=t.indexOf(n,e);if(-1===s)return s;if(0===s||t.charCodeAt(s-1)<=32){const h=n.length;if(s+h===i||t.charCodeAt(s+h)<=32)return s}e=s+1}}const C_="ng-template";function S_(t,n,e){let i=0;for(;i<t.length;){let s=t[i++];if(e&&"class"===s){if(s=t[i],-1!==Su(s.toLowerCase(),n,0))return!0}else if(1===s){for(;i<t.length&&"string"==typeof(s=t[i++]);)if(s.toLowerCase()===n)return!0;return!1}}return!1}function D_(t){return 4===t.type&&t.value!==C_}function em(t,n,e){return n===(4!==t.type||e?t.value:C_)}function _b(t,n,e){let i=4;const s=t.attrs||[],h=function(t){for(let n=0;n<t.length;n++)if(sn(t[n]))return n;return t.length}(s);let m=!1;for(let S=0;S<n.length;S++){const I=n[S];if("number"!=typeof I){if(!m)if(4&i){if(i=2|1&i,""!==I&&!em(t,I,e)||""===I&&1===n.length){if(Qr(i))return!1;m=!0}}else{const F=8&i?I:n[++S];if(8&i&&null!==t.attrs){if(!S_(t.attrs,F,e)){if(Qr(i))return!1;m=!0}continue}const J=E_(8&i?"class":I,s,D_(t),e);if(-1===J){if(Qr(i))return!1;m=!0;continue}if(""!==F){let re;re=J>h?"":s[J+1].toLowerCase();const he=8&i?re:null;if(he&&-1!==Su(he,F,0)||2&i&&F!==re){if(Qr(i))return!1;m=!0}}}}else{if(!m&&!Qr(i)&&!Qr(I))return!1;if(m&&Qr(I))continue;m=!1,i=I|1&i}}return Qr(i)||m}function Qr(t){return 0==(1&t)}function E_(t,n,e,i){if(null===n)return-1;let s=0;if(i||!e){let h=!1;for(;s<n.length;){const m=n[s];if(m===t)return s;if(3===m||6===m)h=!0;else{if(1===m||2===m){let S=n[++s];for(;"string"==typeof S;)S=n[++s];continue}if(4===m)break;if(0===m){s+=4;continue}}s+=h?1:2}return-1}return function(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const i=t[e];if("number"==typeof i)return-1;if(i===n)return e;e++}return-1}(n,t)}function tm(t,n,e=!1){for(let i=0;i<n.length;i++)if(_b(t,n[i],e))return!0;return!1}function xb(t,n){e:for(let e=0;e<n.length;e++){const i=n[e];if(t.length===i.length){for(let s=0;s<t.length;s++)if(t[s]!==i[s])continue e;return!0}}return!1}function A_(t,n){return t?":not("+n.trim()+")":n}function nf(t){let n=t[0],e=1,i=2,s="",h=!1;for(;e<t.length;){let m=t[e];if("string"==typeof m)if(2&i){const S=t[++e];s+="["+m+(S.length>0?'="'+S+'"':"")+"]"}else 8&i?s+="."+m:4&i&&(s+=" "+m);else""!==s&&!Qr(m)&&(n+=A_(h,s),s=""),i=m,h=h||!Qr(i);e++}return""!==s&&(n+=A_(h,s)),n}const dn={};function wt(t){Bl(zn(),bt(),de()+t,Ya())}function Bl(t,n,e,i){if(!i)if(3==(3&n[2])){const h=t.preOrderCheckHooks;null!==h&&Fe(n,h,e)}else{const h=t.preOrderHooks;null!==h&&Qe(n,h,0,e)}ye(e)}function xh(t,n){return t<<17|n<<2}function fa(t){return t>>17&32767}function rm(t){return 2|t}function Vl(t){return(131068&t)>>2}function sm(t,n){return-131069&t|n<<2}function om(t){return 1|t}function hf(t,n){const e=t.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const s=e[i],h=e[i+1];if(-1!==h){const m=t.data[h];l(s),m.contentQueries(2,n[h],h)}}}function Tu(t,n,e,i,s,h,m,S,I,F){const G=n.blueprint.slice();return G[0]=s,G[2]=140|i,td(G),G[3]=G[15]=t,G[8]=e,G[10]=m||t&&t[10],G[11]=S||t&&t[11],G[12]=I||t&&t[12]||null,G[9]=F||t&&t[9]||null,G[6]=h,G[16]=2==n.type?t[16]:G,G}function Rs(t,n,e,i,s){let h=t.data[n];if(null===h)h=function(t,n,e,i,s){const h=Tc(),m=Al(),I=t.data[n]=function(t,n,e,i,s,h){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:h,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,m?h:h&&h.parent,e,n,i,s);return null===t.firstChild&&(t.firstChild=I),null!==h&&(m?null==h.child&&null!==I.parent&&(h.child=I):null===h.next&&(h.next=I)),I}(t,n,e,i,s),en.lFrame.inI18n&&(h.flags|=64);else if(64&h.type){h.type=e,h.value=i,h.attrs=s;const m=function(){const t=en.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();h.injectorIndex=null===m?-1:m.injectorIndex}return Xo(h,!0),h}function Mu(t,n,e,i){if(0===e)return-1;const s=n.length;for(let h=0;h<e;h++)n.push(i),t.blueprint.push(i),t.data.push(null);return s}function wh(t,n,e){A(n);try{const i=t.viewQuery;null!==i&&rn(1,i,e);const s=t.template;null!==s&&mm(t,n,s,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&hf(t,n),t.staticViewQueries&&rn(2,t.viewQuery,e);const h=t.components;null!==h&&function(t,n){for(let e=0;e<n.length;e++)ot(t,n[e])}(n,h)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[2]&=-5,Z()}}function Wl(t,n,e,i){const s=n[2];if(256==(256&s))return;A(n);const h=Ya();try{td(n),function(t){en.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&mm(t,n,e,2,i);const m=3==(3&s);if(!h)if(m){const F=t.preOrderCheckHooks;null!==F&&Fe(n,F,null)}else{const F=t.preOrderHooks;null!==F&&Qe(n,F,0,null),Ke(n,0)}if(function(t){for(let n=qp(t);null!==n;n=Hg(n)){if(!n[2])continue;const e=n[9];for(let i=0;i<e.length;i++){const s=e[i],h=s[3];0==(1024&s[2])&&Zu(h,1),s[2]|=1024}}}(n),function(t){for(let n=qp(t);null!==n;n=Hg(n))for(let e=10;e<n.length;e++){const i=n[e],s=i[1];qu(i)&&Wl(s,i,s.template,i[8])}}(n),null!==t.contentQueries&&hf(t,n),!h)if(m){const F=t.contentCheckHooks;null!==F&&Fe(n,F)}else{const F=t.contentHooks;null!==F&&Qe(n,F,1),Ke(n,1)}!function(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const s=e[i];if(s<0)ye(~s);else{const h=s,m=e[++i],S=e[++i];kc(m,h),S(2,n[h])}}}finally{ye(-1)}}(t,n);const S=t.components;null!==S&&function(t,n){for(let e=0;e<n.length;e++)He(t,n[e])}(n,S);const I=t.viewQuery;if(null!==I&&rn(2,I,i),!h)if(m){const F=t.viewCheckHooks;null!==F&&Fe(n,F)}else{const F=t.viewHooks;null!==F&&Qe(n,F,2),Ke(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),h||(n[2]&=-73),1024&n[2]&&(n[2]&=-1025,Zu(n[3],-1))}finally{Z()}}function R_(t,n,e,i){const s=n[10],h=!Ya(),m=Ec(n);try{h&&!m&&s.begin&&s.begin(),m&&wh(t,n,i),Wl(t,n,e,i)}finally{h&&!m&&s.end&&s.end()}}function mm(t,n,e,i,s){const h=de(),m=2&i;try{ye(-1),m&&n.length>20&&Bl(t,n,20,Ya()),e(i,s)}finally{ye(h)}}function df(t,n,e){!Qu()||(function(t,n,e,i){const s=e.directiveStart,h=e.directiveEnd;t.firstCreatePass||jr(e,n),ms(i,n);const m=e.initialInputs;for(let S=s;S<h;S++){const I=t.data[S],F=Ar(I);F&&Y(n,e,I);const G=ad(n,t,S,e);ms(G,n),null!==m&&pe(0,S-s,G,I,0,m),F&&(Br(e.index,n)[8]=G)}}(t,n,e,qr(e,n)),128==(128&e.flags)&&function(t,n,e){const i=e.directiveStart,s=e.directiveEnd,m=e.index,S=en.lFrame.currentDirectiveIndex;try{ye(m);for(let I=i;I<s;I++){const F=t.data[I],G=n[I];rd(I),(null!==F.hostBindings||0!==F.hostVars||null!==F.hostAttrs)&&b(F,G)}}finally{ye(-1),rd(S)}}(t,n,e))}function ym(t,n,e=qr){const i=n.localNames;if(null!==i){let s=n.index+1;for(let h=0;h<i.length;h+=2){const m=i[h+1],S=-1===m?e(n,t):t[m];t[s++]=S}}}function pf(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=Od(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function Od(t,n,e,i,s,h,m,S,I,F){const G=20+i,J=G+s,re=function(t,n){const e=[];for(let i=0;i<n;i++)e.push(i<t?null:dn);return e}(G,J),he="function"==typeof F?F():F;return re[1]={type:t,blueprint:re,template:e,queries:null,viewQuery:S,declTNode:n,data:re.slice().fill(null,G),bindingStartIndex:G,expandoStartIndex:J,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof h?h():h,pipeRegistry:"function"==typeof m?m():m,firstChild:null,schemas:I,consts:he,incompleteFirstPass:!1}}function Sh(t,n,e,i){const s=Wn(n);null===e?s.push(i):(s.push(e),t.firstCreatePass&&Pt(t).push(i,s.length-1))}function zd(t,n,e){for(let i in t)if(t.hasOwnProperty(i)){const s=t[i];(e=null===e?{}:e).hasOwnProperty(i)?e[i].push(n,s):e[i]=[n,s]}return e}function c(t,n,e,i){let s=!1;if(Qu()){const h=function(t,n,e){const i=t.directiveRegistry;let s=null;if(i)for(let h=0;h<i.length;h++){const m=i[h];tm(e,m.selectors,!1)&&(s||(s=[]),fu(jr(e,n),t,m.type),Ar(m)?(k(t,e),s.unshift(m)):s.push(m))}return s}(t,n,e),m=null===i?null:{"":-1};if(null!==h){s=!0,j(e,t.data.length,h.length);for(let G=0;G<h.length;G++){const J=h[G];J.providersResolver&&J.providersResolver(J)}let S=!1,I=!1,F=Mu(t,n,h.length,null);for(let G=0;G<h.length;G++){const J=h[G];e.mergedAttrs=Vi(e.mergedAttrs,J.hostAttrs),W(t,e,n,F,J),z(F,J,m),null!==J.contentQueries&&(e.flags|=8),(null!==J.hostBindings||null!==J.hostAttrs||0!==J.hostVars)&&(e.flags|=128);const re=J.type.prototype;!S&&(re.ngOnChanges||re.ngOnInit||re.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(e.index),S=!0),!I&&(re.ngOnChanges||re.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(e.index),I=!0),F++}!function(t,n){const i=n.directiveEnd,s=t.data,h=n.attrs,m=[];let S=null,I=null;for(let F=n.directiveStart;F<i;F++){const G=s[F],J=G.inputs,re=null===h||D_(n)?null:Ce(J,h);m.push(re),S=zd(J,F,S),I=zd(G.outputs,F,I)}null!==S&&(S.hasOwnProperty("class")&&(n.flags|=16),S.hasOwnProperty("style")&&(n.flags|=32)),n.initialInputs=m,n.inputs=S,n.outputs=I}(t,e)}m&&function(t,n,e){if(n){const i=t.localNames=[];for(let s=0;s<n.length;s+=2){const h=e[n[s+1]];if(null==h)throw new Ve("301",`Export of name '${n[s+1]}' not found!`);i.push(n[s],h)}}}(e,i,m)}return e.mergedAttrs=Vi(e.mergedAttrs,e.attrs),s}function r(t,n,e,i,s,h){const m=h.hostBindings;if(m){let S=t.hostBindingOpCodes;null===S&&(S=t.hostBindingOpCodes=[]);const I=~n.index;(function(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(S)!=I&&S.push(I),S.push(i,s,m)}}function b(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function k(t,n){n.flags|=2,(t.components||(t.components=[])).push(n.index)}function z(t,n,e){if(e){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)e[n.exportAs[i]]=t;Ar(n)&&(e[""]=t)}}function j(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}function W(t,n,e,i,s){t.data[i]=s;const h=s.factory||(s.factory=Go(s.type)),m=new it(h,Ar(s),null);t.blueprint[i]=m,e[i]=m,r(t,n,0,i,Mu(t,e,s.hostVars,dn),s)}function Y(t,n,e){const i=qr(n,t),s=pf(e),h=t[10],m=Mt(t,Tu(t,s,null,e.onPush?64:16,i,n,h,h.createRenderer(i,e),null,null));t[n.index]=m}function ie(t,n,e,i,s,h){const m=qr(t,n);!function(t,n,e,i,s,h,m){if(null==h)Ii(t)?t.removeAttribute(n,s,e):n.removeAttribute(s);else{const S=null==m?qe(h):m(h,i||"",s);Ii(t)?t.setAttribute(n,s,S,e):e?n.setAttributeNS(e,s,S):n.setAttribute(s,S)}}(n[11],m,h,t.value,e,i,s)}function pe(t,n,e,i,s,h){const m=h[n];if(null!==m){const S=i.setInput;for(let I=0;I<m.length;){const F=m[I++],G=m[I++],J=m[I++];null!==S?i.setInput(e,J,F,G):e[G]=J}}}function Ce(t,n){let e=null,i=0;for(;i<n.length;){const s=n[i];if(0!==s)if(5!==s){if("number"==typeof s)break;t.hasOwnProperty(s)&&(null===e&&(e=[]),e.push(s,t[s],n[i+1])),i+=2}else i+=2;else i+=4}return e}function Pe(t,n,e,i){return new Array(t,!0,!1,n,null,0,i,e,null,null)}function He(t,n){const e=Br(n,t);if(qu(e)){const i=e[1];80&e[2]?Wl(i,e,i.template,e[8]):e[5]>0&&Ge(e)}}function Ge(t){for(let i=qp(t);null!==i;i=Hg(i))for(let s=10;s<i.length;s++){const h=i[s];if(1024&h[2]){const m=h[1];Wl(m,h,m.template,h[8])}else h[5]>0&&Ge(h)}const e=t[1].components;if(null!==e)for(let i=0;i<e.length;i++){const s=Br(e[i],t);qu(s)&&s[5]>0&&Ge(s)}}function ot(t,n){const e=Br(n,t),i=e[1];(function(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])})(i,e),wh(i,e,e[8])}function Mt(t,n){return t[13]?t[14][4]=n:t[13]=n,t[14]=n,n}function ft(t){for(;t;){t[2]|=64;const n=Dd(t);if(_o(t)&&!n)return t;t=n}return null}function Ct(t,n,e){const i=n[10];i.begin&&i.begin();try{Wl(t,n,t.template,e)}catch(s){throw Hn(n,s),s}finally{i.end&&i.end()}}function ct(t){!function(t){for(let n=0;n<t.components.length;n++){const e=t.components[n],i=Fg(e),s=i[1];R_(s,i,s.template,e)}}(t[8])}function rn(t,n,e){l(0),n(t,e)}const Jt=(()=>Promise.resolve(null))();function Wn(t){return t[7]||(t[7]=[])}function Pt(t){return t.cleanup||(t.cleanup=[])}function Hn(t,n){const e=t[9],i=e?e.get(zl,null):null;i&&i.handleError(n)}function Ki(t,n,e,i,s){for(let h=0;h<e.length;){const m=e[h++],S=e[h++],I=n[m],F=t.data[m];null!==F.setInput?F.setInput(I,s,i,S):I[S]=s}}function _i(t,n,e){const i=du(n,t);!function(t,n,e){Ii(t)?t.setValue(n,e):n.textContent=e}(t[11],i,e)}function Gi(t,n,e){let i=e?t.styles:null,s=e?t.classes:null,h=0;if(null!==n)for(let m=0;m<n.length;m++){const S=n[m];"number"==typeof S?h=S:1==h?s=R(s,S):2==h&&(i=R(i,S+": "+n[++m]+";"))}e?t.styles=i:t.stylesWithoutHost=i,e?t.classes=s:t.classesWithoutHost=s}const ei=new on("INJECTOR",-1);class Gr{get(n,e=hd){if(e===hd){const i=new Error(`NullInjectorError: No provider for ${ge(n)}!`);throw i.name="NullInjectorError",i}return e}}const zi=new on("Set Injector scope."),Wi={},ts={};let Ni;function Ns(){return void 0===Ni&&(Ni=new Gr),Ni}function Qi(t,n=null,e=null,i){return new ur(t,e,n||Ns(),i)}class ur{constructor(n,e,i,s=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const h=[];e&&cn(e,S=>this.processProvider(S,n,e)),cn([n],S=>this.processInjectorType(S,[],h)),this.records.set(ei,hr(void 0,this));const m=this.records.get(zi);this.scope=null!=m?m.value:null,this.source=s||("object"==typeof n?null:ge(n))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(n=>n.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(n,e=hd,i=Xt.Default){this.assertNotDestroyed();const s=yu(this),h=Vo(void 0);try{if(!(i&Xt.SkipSelf)){let S=this.records.get(n);if(void 0===S){const I=("function"==typeof(t=n)||"object"==typeof t&&t instanceof on)&&go(n);S=I&&this.injectableDefInScope(I)?hr(Ui(n),Wi):null,this.records.set(n,S)}if(null!=S)return this.hydrate(n,S)}return(i&Xt.Self?Ns():this.parent).get(n,e=i&Xt.Optional&&e===hd?null:e)}catch(m){if("NullInjectorError"===m.name){if((m[lh]=m[lh]||[]).unshift(ge(n)),s)throw m;return fs(m,n,"R3InjectorError",this.source)}throw m}finally{Vo(h),yu(s)}var t}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(n=>this.get(n))}toString(){const n=[];return this.records.forEach((i,s)=>n.push(ge(s))),`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(n,e,i){if(!(n=le(n)))return!1;let s=dp(n);const h=null==s&&n.ngModule||void 0,m=void 0===h?n:h,S=-1!==i.indexOf(m);if(void 0!==h&&(s=dp(h)),null==s)return!1;if(null!=s.imports&&!S){let G;i.push(m);try{cn(s.imports,J=>{this.processInjectorType(J,e,i)&&(void 0===G&&(G=[]),G.push(J))})}finally{}if(void 0!==G)for(let J=0;J<G.length;J++){const{ngModule:re,providers:he}=G[J];cn(he,Se=>this.processProvider(Se,re,he||ii))}}this.injectorDefTypes.add(m);const I=Go(m)||(()=>new m);this.records.set(m,hr(I,Wi));const F=s.providers;if(null!=F&&!S){const G=n;cn(F,J=>this.processProvider(J,G,F))}return void 0!==h&&void 0!==n.providers}processProvider(n,e,i){let s=ns(n=le(n))?n:le(n&&n.provide);const h=(t=n,ga(t)?hr(void 0,t.useValue):hr(ui(t),Wi));var t;if(ns(n)||!0!==n.multi)this.records.get(s);else{let m=this.records.get(s);m||(m=hr(void 0,Wi,!0),m.factory=()=>zc(m.multi),this.records.set(s,m)),s=n,m.multi.push(n)}this.records.set(s,h)}hydrate(n,e){return e.value===Wi&&(e.value=ts,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(t=e.value)&&"object"==typeof t&&"function"==typeof t.ngOnDestroy&&this.onDestroy.add(e.value),e.value;var t}injectableDefInScope(n){if(!n.providedIn)return!1;const e=le(n.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function Ui(t){const n=go(t),e=null!==n?n.factory:Go(t);if(null!==e)return e;if(t instanceof on)throw new Error(`Token ${ge(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const n=t.length;if(n>0){const i=Rn(n,"?");throw new Error(`Can't resolve all parameters for ${ge(t)}: (${i.join(", ")}).`)}const e=function(t){const n=t&&(t[hs]||t[Lu]);if(n){const e=function(t){if(t.hasOwnProperty("name"))return t.name;const n=(""+t).match(/^function\s*([^\s(]+)/);return null===n?"":n[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),n}return null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new Error("unreachable")}function ui(t,n,e){let i;if(ns(t)){const s=le(t);return Go(s)||Ui(s)}if(ga(t))i=()=>le(t.useValue);else if(function(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...zc(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))i=()=>dt(le(t.useExisting));else{const s=le(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return Go(s)||Ui(s);i=()=>new s(...zc(t.deps))}return i}function hr(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function ga(t){return null!==t&&"object"==typeof t&&Rp in t}function ns(t){return"function"==typeof t}const _m=function(t,n,e){return function(t,n=null,e=null,i){const s=Qi(t,n,e,i);return s._resolveInjectorDefTypes(),s}({name:e},n,t,e)};let Bn=(()=>{class t{static create(e,i){return Array.isArray(e)?_m(e,i,""):_m(e.providers,e.parent,e.name||"")}}return t.THROW_IF_NOT_FOUND=hd,t.NULL=new Gr,t.\u0275prov=Ft({token:t,providedIn:"any",factory:()=>dt(ei)}),t.__NG_ELEMENT_ID__=-1,t})();function f2(t,n){ke(Fg(t)[1],$i())}function Hi(t){let n=function(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const i=[t];for(;n;){let s;if(Ar(t))s=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Error("Directives cannot inherit Components");s=n.\u0275dir}if(s){if(e){i.push(s);const m=t;m.inputs=Bb(t.inputs),m.declaredInputs=Bb(t.declaredInputs),m.outputs=Bb(t.outputs);const S=s.hostBindings;S&&_2(t,S);const I=s.viewQuery,F=s.contentQueries;if(I&&m2(t,I),F&&y2(t,F),fe(t.inputs,s.inputs),fe(t.declaredInputs,s.declaredInputs),fe(t.outputs,s.outputs),Ar(s)&&s.data.animation){const G=t.data;G.animation=(G.animation||[]).concat(s.data.animation)}}const h=s.features;if(h)for(let m=0;m<h.length;m++){const S=h[m];S&&S.ngInherit&&S(t),S===Hi&&(e=!1)}}n=Object.getPrototypeOf(n)}!function(t){let n=0,e=null;for(let i=t.length-1;i>=0;i--){const s=t[i];s.hostVars=n+=s.hostVars,s.hostAttrs=Vi(s.hostAttrs,e=Vi(e,s.hostAttrs))}}(i)}function Bb(t){return t===vl?{}:t===ii?[]:t}function m2(t,n){const e=t.viewQuery;t.viewQuery=e?(i,s)=>{n(i,s),e(i,s)}:n}function y2(t,n){const e=t.contentQueries;t.contentQueries=e?(i,s,h)=>{n(i,s,h),e(i,s,h)}:n}function _2(t,n){const e=t.hostBindings;t.hostBindings=e?(i,s)=>{n(i,s),e(i,s)}:n}let B_=null;function yf(){if(!B_){const t=Gn.Symbol;if(t&&t.iterator)B_=t.iterator;else{const n=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<n.length;++e){const i=n[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(B_=i)}}}return B_}function wm(t){return!!Vb(t)&&(Array.isArray(t)||!(t instanceof Map)&&yf()in t)}function Vb(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Wc(t,n,e){return t[n]=e}function Mo(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function ai(t,n,e,i){const s=bt();return Mo(s,Ia(),n)&&(zn(),ie(me(),s,t,n,e,i)),ai}function kt(t,n,e,i,s,h,m,S){const I=bt(),F=zn(),G=t+20,J=F.firstCreatePass?function(t,n,e,i,s,h,m,S,I){const F=n.consts,G=Rs(n,t,4,m||null,Ma(F,S));c(n,e,G,Ma(F,I)),ke(n,G);const J=G.tViews=Od(2,G,i,s,h,n.directiveRegistry,n.pipeRegistry,null,n.schemas,F);return null!==n.queries&&(n.queries.template(n,G),J.queries=n.queries.embeddedTView(G)),G}(G,F,I,n,e,i,s,h,m):F.data[G];Xo(J,!1);const re=I[11].createComment("");kd(F,I,re,J),ms(re,I),Mt(I,I[G]=Pe(re,I,re,J)),Ta(J)&&df(F,I,J),null!=m&&ym(I,J,S)}function Ne(t,n=Xt.Default){const e=bt();return null===e?dt(t,n):Ic($i(),e,le(t),n)}function Gb(){throw new Error("invalid")}function mt(t,n,e){const i=bt();return Mo(i,Ia(),n)&&function(t,n,e,i,s,h,m,S){const I=qr(n,e);let G,F=n.inputs;!S&&null!=F&&(G=F[i])?(Ki(t,e,G,i,s),lu(n)&&function(t,n){const e=Br(n,t);16&e[2]||(e[2]|=64)}(e,n.index)):3&n.type&&(i=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),s=null!=m?m(s,n.value||"",i):s,Ii(h)?h.setProperty(I,i,s):Un(i)||(I.setProperty?I.setProperty(i,s):I[i]=s))}(zn(),me(),i,t,n,i[11],e,!1),mt}function Wb(t,n,e,i,s){const m=s?"class":"style";Ki(t,e,n.inputs[m],m,i)}function vt(t,n,e,i){const s=bt(),h=zn(),m=20+t,S=s[11],I=s[m]=bu(S,n,en.lFrame.currentNamespace),F=h.firstCreatePass?function(t,n,e,i,s,h,m){const S=n.consts,F=Rs(n,t,2,s,Ma(S,h));return c(n,e,F,Ma(S,m)),null!==F.attrs&&Gi(F,F.attrs,!1),null!==F.mergedAttrs&&Gi(F,F.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,F),F}(m,h,s,0,n,e,i):h.data[m];Xo(F,!0);const G=F.mergedAttrs;null!==G&&Gt(S,I,G);const J=F.classes;null!==J&&Qg(S,I,J);const re=F.styles;null!==re&&b_(S,I,re),64!=(64&F.flags)&&kd(h,s,I,F),0===en.lFrame.elementDepthCount&&ms(I,s),en.lFrame.elementDepthCount++,Ta(F)&&(df(h,s,F),function(t,n,e){if(bc(n)){const s=n.directiveEnd;for(let h=n.directiveStart;h<s;h++){const m=t.data[h];m.contentQueries&&m.contentQueries(1,e[h],h)}}}(h,F,s)),null!==i&&ym(s,F)}function xt(){let t=$i();Al()?eh():(t=t.parent,Xo(t,!1));const n=t;en.lFrame.elementDepthCount--;const e=zn();e.firstCreatePass&&(ke(e,t),bc(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(n)&&Wb(e,n,bt(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(n)&&Wb(e,n,bt(),n.stylesWithoutHost,!1)}function Fi(t,n,e,i){vt(t,n,e,i),xt()}function Sm(t){return!!t&&"function"==typeof t.then}const H_=function(t){return!!t&&"function"==typeof t.subscribe};function qt(t,n,e,i){const s=bt(),h=zn(),m=$i();return function(t,n,e,i,s,h,m,S){const I=Ta(i),G=t.firstCreatePass&&Pt(t),J=n[8],re=Wn(n);let he=!0;if(3&i.type||S){const Le=qr(i,n),et=S?S(Le):Le,Ze=re.length,Ht=S?Wt=>S(Pi(Wt[i.index])):i.index;if(Ii(e)){let Wt=null;if(!S&&I&&(Wt=function(t,n,e,i){const s=t.cleanup;if(null!=s)for(let h=0;h<s.length-1;h+=2){const m=s[h];if(m===e&&s[h+1]===i){const S=n[7],I=s[h+2];return S.length>I?S[I]:null}"string"==typeof m&&(h+=2)}return null}(t,n,s,i.index)),null!==Wt)(Wt.__ngLastListenerFn__||Wt).__ngNextListenerFn__=h,Wt.__ngLastListenerFn__=h,he=!1;else{h=qb(i,n,J,h,!1);const gn=e.listen(et,s,h);re.push(h,gn),G&&G.push(s,Ht,Ze,Ze+1)}}else h=qb(i,n,J,h,!0),et.addEventListener(s,h,m),re.push(h),G&&G.push(s,Ht,Ze,m)}else h=qb(i,n,J,h,!1);const Se=i.outputs;let ze;if(he&&null!==Se&&(ze=Se[s])){const Le=ze.length;if(Le)for(let et=0;et<Le;et+=2){const Rr=n[ze[et]][ze[et+1]].subscribe(h),ca=re.length;re.push(h,Rr),G&&G.push(s,i.index,ca,-(ca+1))}}}(h,s,s[11],m,t,n,!!e,i),qt}function tS(t,n,e,i){try{return!1!==e(i)}catch(s){return Hn(t,s),!1}}function qb(t,n,e,i,s){return function h(m){if(m===Function)return i;const S=2&t.flags?Br(t.index,n):n;0==(32&n[2])&&ft(S);let I=tS(n,0,i,m),F=h.__ngNextListenerFn__;for(;F;)I=tS(n,0,F,m)&&I,F=F.__ngNextListenerFn__;return s&&!1===I&&(m.preventDefault(),m.returnValue=!1),I}}function Nt(t=1){return function(t){return(en.lFrame.contextLView=function(t,n){for(;t>0;)n=n[15],t--;return n}(t,en.lFrame.contextLView))[8]}(t)}function K2(t,n){let e=null;const i=function(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(0==(1&e))return n[e+1]}return null}(t);for(let s=0;s<n.length;s++){const h=n[s];if("*"!==h){if(null===i?tm(t,h,!0):xb(i,h))return s}else e=s}return e}function uS(t,n,e,i,s){const h=t[e+1],m=null===n;let S=i?fa(h):Vl(h),I=!1;for(;0!==S&&(!1===I||m);){const G=t[S+1];tP(t[S],n)&&(I=!0,t[S+1]=i?om(G):rm(G)),S=i?fa(G):Vl(G)}I&&(t[e+1]=i?rm(h):om(h))}function tP(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&Zo(t,n)>=0}const _s={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function hS(t){return t.substring(_s.key,_s.keyEnd)}function nP(t){return t.substring(_s.value,_s.valueEnd)}function dS(t,n){const e=_s.textEnd;return e===n?-1:(n=_s.keyEnd=function(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}(t,_s.key=n,e),Tf(t,n,e))}function pS(t,n){const e=_s.textEnd;let i=_s.key=Tf(t,n,e);return e===i?-1:(i=_s.keyEnd=function(t,n,e){let i;for(;n<e&&(45===(i=t.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(t,i,e),i=gS(t,i,e),i=_s.value=Tf(t,i,e),i=_s.valueEnd=function(t,n,e){let i=-1,s=-1,h=-1,m=n,S=m;for(;m<e;){const I=t.charCodeAt(m++);if(59===I)return S;34===I||39===I?S=m=mS(t,I,m,e):n===m-4&&85===h&&82===s&&76===i&&40===I?S=m=mS(t,41,m,e):I>32&&(S=m),h=s,s=i,i=-33&I}return S}(t,i,e),gS(t,i,e))}function fS(t){_s.key=0,_s.keyEnd=0,_s.value=0,_s.valueEnd=0,_s.textEnd=t.length}function Tf(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function gS(t,n,e,i){return(n=Tf(t,n,e))<e&&n++,n}function mS(t,n,e,i){let s=-1,h=e;for(;h<i;){const m=t.charCodeAt(h++);if(m==n&&92!==s)return h;s=92==m&&92===s?0:m}throw new Error}function An(t,n){return function(t,n,e,i){const s=bt(),h=zn(),m=qs(2);h.firstUpdatePass&&_S(h,t,m,i),n!==dn&&Mo(s,m,n)&&xS(h,h.data[de()],s,s[11],t,s[m+1]=function(t,n){return null==t||("string"==typeof n?t+=n:"object"==typeof t&&(t=ge(Ps(t)))),t}(n,e),i,m)}(t,n,null,!0),An}function lP(t,n){for(let e=function(t){return fS(t),pS(t,Tf(t,0,_s.textEnd))}(n);e>=0;e=pS(n,e))vS(t,hS(n),nP(n))}function Zl(t){Kl(cr,Xc,t,!0)}function Xc(t,n){for(let e=function(t){return fS(t),dS(t,Tf(t,0,_s.textEnd))}(n);e>=0;e=dS(n,e))cr(t,hS(n),!0)}function Kl(t,n,e,i){const s=zn(),h=qs(2);s.firstUpdatePass&&_S(s,null,h,i);const m=bt();if(e!==dn&&Mo(m,h,e)){const S=s.data[de()];if(wS(S,i)&&!yS(s,h)){let I=i?S.classesWithoutHost:S.stylesWithoutHost;null!==I&&(e=R(I,e||"")),Wb(s,S,m,e,i)}else!function(t,n,e,i,s,h,m,S){s===dn&&(s=ii);let I=0,F=0,G=0<s.length?s[0]:null,J=0<h.length?h[0]:null;for(;null!==G||null!==J;){const re=I<s.length?s[I+1]:void 0,he=F<h.length?h[F+1]:void 0;let ze,Se=null;G===J?(I+=2,F+=2,re!==he&&(Se=J,ze=he)):null===J||null!==G&&G<J?(I+=2,Se=G):(F+=2,Se=J,ze=he),null!==Se&&xS(t,n,e,i,Se,ze,m,S),G=I<s.length?s[I]:null,J=F<h.length?h[F]:null}}(s,S,m,m[11],m[h+1],m[h+1]=function(t,n,e){if(null==e||""===e)return ii;const i=[],s=Ps(e);if(Array.isArray(s))for(let h=0;h<s.length;h++)t(i,s[h],!0);else if("object"==typeof s)for(const h in s)s.hasOwnProperty(h)&&t(i,h,s[h]);else"string"==typeof s&&n(i,s);return i}(t,n,e),i,h)}}function yS(t,n){return n>=t.expandoStartIndex}function _S(t,n,e,i){const s=t.data;if(null===s[e+1]){const h=s[de()],m=yS(t,e);wS(h,i)&&null===n&&!m&&(n=!1),n=function(t,n,e,i){const s=function(t){const n=en.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let h=i?n.residualClasses:n.residualStyles;if(null===s)0===(i?n.classBindings:n.styleBindings)&&(e=Dm(e=Jb(null,t,n,e,i),n.attrs,i),h=null);else{const m=n.directiveStylingLast;if(-1===m||t[m]!==s)if(e=Jb(s,t,n,e,i),null===h){let I=function(t,n,e){const i=e?n.classBindings:n.styleBindings;if(0!==Vl(i))return t[fa(i)]}(t,n,i);void 0!==I&&Array.isArray(I)&&(I=Jb(null,t,n,I[1],i),I=Dm(I,n.attrs,i),function(t,n,e,i){t[fa(e?n.classBindings:n.styleBindings)]=i}(t,n,i,I))}else h=function(t,n,e){let i;const s=n.directiveEnd;for(let h=1+n.directiveStylingLast;h<s;h++)i=Dm(i,t[h].hostAttrs,e);return Dm(i,n.attrs,e)}(t,n,i)}return void 0!==h&&(i?n.residualClasses=h:n.residualStyles=h),e}(s,h,n,i),function(t,n,e,i,s,h){let m=h?n.classBindings:n.styleBindings,S=fa(m),I=Vl(m);t[i]=e;let G,F=!1;if(Array.isArray(e)){const J=e;G=J[1],(null===G||Zo(J,G)>0)&&(F=!0)}else G=e;if(s)if(0!==I){const re=fa(t[S+1]);t[i+1]=xh(re,S),0!==re&&(t[re+1]=sm(t[re+1],i)),t[S+1]=function(t,n){return 131071&t|n<<17}(t[S+1],i)}else t[i+1]=xh(S,0),0!==S&&(t[S+1]=sm(t[S+1],i)),S=i;else t[i+1]=xh(I,0),0===S?S=i:t[I+1]=sm(t[I+1],i),I=i;F&&(t[i+1]=rm(t[i+1])),uS(t,G,i,!0),uS(t,G,i,!1),function(t,n,e,i,s){const h=s?t.residualClasses:t.residualStyles;null!=h&&"string"==typeof n&&Zo(h,n)>=0&&(e[i+1]=om(e[i+1]))}(n,G,t,i,h),m=xh(S,I),h?n.classBindings=m:n.styleBindings=m}(s,h,n,e,m,i)}}function Jb(t,n,e,i,s){let h=null;const m=e.directiveEnd;let S=e.directiveStylingLast;for(-1===S?S=e.directiveStart:S++;S<m&&(h=n[S],i=Dm(i,h.hostAttrs,s),h!==t);)S++;return null!==t&&(e.directiveStylingLast=S),i}function Dm(t,n,e){const i=e?1:2;let s=-1;if(null!==n)for(let h=0;h<n.length;h++){const m=n[h];"number"==typeof m?s=m:s===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),cr(t,m,!!e||n[++h]))}return void 0===t?null:t}function vS(t,n,e){cr(t,n,Ps(e))}function xS(t,n,e,i,s,h,m,S){if(!(3&n.type))return;const I=t.data,F=I[S+1];$_(function(t){return 1==(1&t)}(F)?bS(I,n,e,s,Vl(F),m):void 0)||($_(h)||function(t){return 2==(2&t)}(F)&&(h=bS(I,null,e,s,S,m)),function(t,n,e,i,s){const h=Ii(t);if(n)s?h?t.addClass(e,i):e.classList.add(i):h?t.removeClass(e,i):e.classList.remove(i);else{let m=-1===i.indexOf("-")?void 0:Jo.DashCase;if(null==s)h?t.removeStyle(e,i,m):e.style.removeProperty(i);else{const S="string"==typeof s&&s.endsWith("!important");S&&(s=s.slice(0,-10),m|=Jo.Important),h?t.setStyle(e,i,s,m):e.style.setProperty(i,s,S?"important":"")}}}(i,m,du(de(),e),s,h))}function bS(t,n,e,i,s,h){const m=null===n;let S;for(;s>0;){const I=t[s],F=Array.isArray(I),G=F?I[1]:I,J=null===G;let re=e[s+1];re===dn&&(re=J?ii:void 0);let he=J?ud(re,i):G===i?re:void 0;if(F&&!$_(he)&&(he=ud(I,i)),$_(he)&&(S=he,m))return S;const Se=t[s+1];s=m?fa(Se):Vl(Se)}if(null!==n){let I=h?n.residualClasses:n.residualStyles;null!=I&&(S=ud(I,i))}return S}function $_(t){return void 0!==t}function wS(t,n){return 0!=(t.flags&(n?16:32))}function Yi(t,n=""){const e=bt(),i=zn(),s=t+20,h=i.firstCreatePass?Rs(i,s,1,n,null):i.data[s],m=e[s]=function(t,n){return Ii(t)?t.createText(n):t.createTextNode(n)}(e[11],n);kd(i,e,m,h),Xo(h,!1)}function ea(t){return Th("",t,""),ea}function Th(t,n,e){const i=bt(),s=function(t,n,e,i){return Mo(t,Ia(),e)?n+qe(e)+i:dn}(i,t,n,e);return s!==dn&&_i(i,de(),s),Th}const Gd=void 0;var NP=["en",[["a","p"],["AM","PM"],Gd],[["AM","PM"],Gd,Gd],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Gd,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Gd,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Gd,"{1} 'at' {0}",Gd],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let kf={};function jS(t){return t in kf||(kf[t]=Gn.ng&&Gn.ng.common&&Gn.ng.common.locales&&Gn.ng.common.locales[t]),kf[t]}var jt=(()=>((jt=jt||{})[jt.LocaleId=0]="LocaleId",jt[jt.DayPeriodsFormat=1]="DayPeriodsFormat",jt[jt.DayPeriodsStandalone=2]="DayPeriodsStandalone",jt[jt.DaysFormat=3]="DaysFormat",jt[jt.DaysStandalone=4]="DaysStandalone",jt[jt.MonthsFormat=5]="MonthsFormat",jt[jt.MonthsStandalone=6]="MonthsStandalone",jt[jt.Eras=7]="Eras",jt[jt.FirstDayOfWeek=8]="FirstDayOfWeek",jt[jt.WeekendRange=9]="WeekendRange",jt[jt.DateFormat=10]="DateFormat",jt[jt.TimeFormat=11]="TimeFormat",jt[jt.DateTimeFormat=12]="DateTimeFormat",jt[jt.NumberSymbols=13]="NumberSymbols",jt[jt.NumberFormats=14]="NumberFormats",jt[jt.CurrencyCode=15]="CurrencyCode",jt[jt.CurrencySymbol=16]="CurrencySymbol",jt[jt.CurrencyName=17]="CurrencyName",jt[jt.Currencies=18]="Currencies",jt[jt.Directionality=19]="Directionality",jt[jt.PluralCase=20]="PluralCase",jt[jt.ExtraData=21]="ExtraData",jt))();const G_="en-US";let $S=G_;function e0(t,n,e,i,s){if(t=le(t),Array.isArray(t))for(let h=0;h<t.length;h++)e0(t[h],n,e,i,s);else{const h=zn(),m=bt();let S=ns(t)?t:le(t.provide),I=ui(t);const F=$i(),G=1048575&F.providerIndexes,J=F.directiveStart,re=F.providerIndexes>>20;if(ns(t)||!t.multi){const he=new it(I,s,Ne),Se=n0(S,n,s?G:G+re,J);-1===Se?(fu(jr(F,m),h,S),t0(h,t,n.length),n.push(S),F.directiveStart++,F.directiveEnd++,s&&(F.providerIndexes+=1048576),e.push(he),m.push(he)):(e[Se]=he,m[Se]=he)}else{const he=n0(S,n,G+re,J),Se=n0(S,n,G,G+re),ze=he>=0&&e[he],Le=Se>=0&&e[Se];if(s&&!Le||!s&&!ze){fu(jr(F,m),h,S);const et=function(t,n,e,i,s){const h=new it(t,e,Ne);return h.multi=[],h.index=n,h.componentProviders=0,pD(h,s,i&&!e),h}(s?kR:MR,e.length,s,i,I);!s&&Le&&(e[Se].providerFactory=et),t0(h,t,n.length,0),n.push(S),F.directiveStart++,F.directiveEnd++,s&&(F.providerIndexes+=1048576),e.push(et),m.push(et)}else t0(h,t,he>-1?he:Se,pD(e[s?Se:he],I,!s&&i));!s&&i&&Le&&e[Se].componentProviders++}}}function t0(t,n,e,i){const s=ns(n);if(s||function(t){return!!t.useClass}(n)){const m=(n.useClass||n).prototype.ngOnDestroy;if(m){const S=t.destroyHooks||(t.destroyHooks=[]);if(!s&&n.multi){const I=S.indexOf(e);-1===I?S.push(e,[i,m]):S[I+1].push(i,m)}else S.push(e,m)}}}function pD(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function n0(t,n,e,i){for(let s=e;s<i;s++)if(n[s]===t)return s;return-1}function MR(t,n,e,i){return r0(this.multi,[])}function kR(t,n,e,i){const s=this.multi;let h;if(this.providerFactory){const m=this.providerFactory.componentProviders,S=ad(e,e[1],this.providerFactory.index,i);h=S.slice(0,m),r0(s,h);for(let I=m;I<S.length;I++)h.push(S[I])}else h=[],r0(s,h);return h}function r0(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function ti(t,n=[]){return e=>{e.providersResolver=(i,s)=>function(t,n,e){const i=zn();if(i.firstCreatePass){const s=Ar(t);e0(e,i.data,i.blueprint,s,!0),e0(n,i.data,i.blueprint,s,!1)}}(i,s?s(t):t,n)}}class fD{}const mD="ngComponent";class RR{resolveComponentFactory(n){throw function(t){const n=Error(`No component factory found for ${ge(t)}. Did you add it to @NgModule.entryComponents?`);return n[mD]=t,n}(n)}}let La=(()=>{class t{}return t.NULL=new RR,t})();function Z_(...t){}function Rf(t,n){return new Nn(qr(t,n))}const OR=function(){return Rf($i(),bt())};let Nn=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=OR,t})();function yD(t){return t instanceof Nn?t.nativeElement:t}class Nf{}let to=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>zR(),t})();const zR=function(){const t=bt(),e=Br($i().index,t);return function(t){return t[11]}(ds(e)?e:t)};let o0=(()=>{class t{}return t.\u0275prov=Ft({token:t,providedIn:"root",factory:()=>null}),t})();class Im{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const _D=new Im("13.0.2"),Ff={};function J_(t,n,e,i,s=!1){for(;null!==e;){const h=n[e.index];if(null!==h&&i.push(Pi(h)),Er(h))for(let S=10;S<h.length;S++){const I=h[S],F=I[1].firstChild;null!==F&&J_(I[1],I,F,i)}const m=e.type;if(8&m)J_(t,n,e.child,i);else if(32&m){const S=Ug(e,n);let I;for(;I=S();)i.push(I)}else if(16&m){const S=Cu(n,e);if(Array.isArray(S))i.push(...S);else{const I=Dd(n[16]);J_(I[1],I,S,i,!0)}}e=s?e.projectionNext:e.next}return i}class Pm{constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const n=this._lView,e=n[1];return J_(e,n,e.firstChild,[])}get context(){return this._lView[8]}set context(n){this._lView[8]=n}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(Er(n)){const e=n[8],i=e?e.indexOf(this):-1;i>-1&&(Jp(n,i),Oc(e,i))}this._attachedToViewContainer=!1}Gg(this._lView[1],this._lView)}onDestroy(n){Sh(this._lView[1],this._lView,null,n)}markForCheck(){ft(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Ct(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,n,e){pu(!0);try{Ct(t,n,e)}finally{pu(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var n;this._appRef=null,Hc(this._lView[1],n=this._lView,n[11],2,null,null)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=n}}class UR extends Pm{constructor(n){super(n),this._view=n}detectChanges(){ct(this._view)}checkNoChanges(){!function(t){pu(!0);try{ct(t)}finally{pu(!1)}}(this._view)}get context(){return null}}class vD extends La{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=_r(n);return new a0(e,this.ngModule)}}function xD(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}const jR=new on("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>si});class a0 extends fD{constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=n.selectors.map(nf).join(","),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return xD(this.componentDef.inputs)}get outputs(){return xD(this.componentDef.outputs)}create(n,e,i,s){const h=(s=s||this.ngModule)?function(t,n){return{get:(e,i,s)=>{const h=t.get(e,Ff,s);return h!==Ff||i===Ff?h:n.get(e,i,s)}}}(n,s.injector):n,m=h.get(Nf,Qh),S=h.get(o0,null),I=m.createRenderer(null,this.componentDef),F=this.componentDef.selectors[0][0]||"div",G=i?function(t,n,e){if(Ii(t))return t.selectRootElement(n,e===ln.ShadowDom);let i="string"==typeof n?t.querySelector(n):n;return i.textContent="",i}(I,i,this.componentDef.encapsulation):bu(m.createRenderer(null,this.componentDef),F,function(t){const n=t.toLowerCase();return"svg"===n?xo:"math"===n?"http://www.w3.org/1998/MathML/":null}(F)),J=this.componentDef.onPush?576:528,re=function(t,n){return{components:[],scheduler:t||si,clean:Jt,playerHandler:n||null,flags:0}}(),he=Od(0,null,null,1,0,null,null,null,null,null),Se=Tu(null,he,re,J,null,null,m,I,S,h);let ze,Le;A(Se);try{const et=function(t,n,e,i,s,h){const m=e[1];e[20]=t;const I=Rs(m,20,2,"#host",null),F=I.mergedAttrs=n.hostAttrs;null!==F&&(Gi(I,F,!0),null!==t&&(Gt(s,t,F),null!==I.classes&&Qg(s,t,I.classes),null!==I.styles&&b_(s,t,I.styles)));const G=i.createRenderer(t,n),J=Tu(e,pf(n),null,n.onPush?64:16,e[20],I,i,G,h||null,null);return m.firstCreatePass&&(fu(jr(I,e),m,n.type),k(m,I),j(I,e.length,1)),Mt(e,J),e[20]=J}(G,this.componentDef,Se,m,I);if(G)if(i)Gt(I,G,["ng-version",_D.full]);else{const{attrs:Ze,classes:Ht}=function(t){const n=[],e=[];let i=1,s=2;for(;i<t.length;){let h=t[i];if("string"==typeof h)2===s?""!==h&&n.push(h,t[++i]):8===s&&e.push(h);else{if(!Qr(s))break;s=h}i++}return{attrs:n,classes:e}}(this.componentDef.selectors[0]);Ze&&Gt(I,G,Ze),Ht&&Ht.length>0&&Qg(I,G,Ht.join(" "))}if(Le=Yu(he,20),void 0!==e){const Ze=Le.projection=[];for(let Ht=0;Ht<this.ngContentSelectors.length;Ht++){const Wt=e[Ht];Ze.push(null!=Wt?Array.from(Wt):null)}}ze=function(t,n,e,i,s){const h=e[1],m=function(t,n,e){const i=$i();t.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),W(t,i,n,Mu(t,n,1,null),e));const s=ad(n,t,i.directiveStart,i);ms(s,n);const h=qr(i,n);return h&&ms(h,n),s}(h,e,n);if(i.components.push(m),t[8]=m,s&&s.forEach(I=>I(m,n)),n.contentQueries){const I=$i();n.contentQueries(1,m,I.directiveStart)}const S=$i();return!h.firstCreatePass||null===n.hostBindings&&null===n.hostAttrs||(ye(S.index),r(e[1],S,0,S.directiveStart,S.directiveEnd,n),b(n,m)),m}(et,this.componentDef,Se,re,[f2]),wh(he,Se,null)}finally{Z()}return new WR(this.componentType,ze,Rf(Le,Se),Se,Le)}}class WR extends class{}{constructor(n,e,i,s,h){super(),this.location=i,this._rootLView=s,this._tNode=h,this.instance=e,this.hostView=this.changeDetectorRef=new UR(s),this.componentType=n}get injector(){return new Za(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}class Yc{}class bD{}const Of=new Map;class CD extends Yc{constructor(n,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new vD(this);const i=Ws(n);this._bootstrapComponents=Ks(i.bootstrap),this._r3Injector=Qi(n,e,[{provide:Yc,useValue:this},{provide:La,useValue:this.componentFactoryResolver}],ge(n)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(n)}get(n,e=Bn.THROW_IF_NOT_FOUND,i=Xt.Default){return n===Bn||n===Yc||n===ei?this:this._r3Injector.get(n,e,i)}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class c0 extends bD{constructor(n){super(),this.moduleType=n,null!==Ws(n)&&function(t){const n=new Set;!function e(i){const s=Ws(i,!0),h=s.id;null!==h&&(function(t,n,e){if(n&&n!==e)throw new Error(`Duplicate module registered for ${t} - ${ge(n)} vs ${ge(n.name)}`)}(h,Of.get(h),i),Of.set(h,i));const m=Ks(s.imports);for(const S of m)n.has(S)||(n.add(S),e(S))}(t)}(n)}create(n){return new CD(this.moduleType,n)}}function K_(t,n,e){const i=Vr()+t,s=bt();return s[i]===dn?Wc(s,i,e?n.call(e):n()):function(t,n){return t[n]}(s,i)}function qc(t,n,e,i){return function(t,n,e,i,s,h){const m=n+e;return Mo(t,m,s)?Wc(t,m+1,h?i.call(h,s):i(s)):Rm(t,m+1)}(bt(),Vr(),t,n,e,i)}function Wd(t,n,e,i,s){return function(t,n,e,i,s,h,m){const S=n+e;return function(t,n,e,i){const s=Mo(t,n,e);return Mo(t,n+1,i)||s}(t,S,s,h)?Wc(t,S+2,m?i.call(m,s,h):i(s,h)):Rm(t,S+2)}(bt(),Vr(),t,n,e,i,s)}function Rm(t,n){const e=t[n];return e===dn?void 0:e}function u0(t){return n=>{setTimeout(t,void 0,n)}}const ut=class extends Dn{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,i){var I,F,G;let s=n,h=e||(()=>null),m=i;if(n&&"object"==typeof n){const J=n;s=null==(I=J.next)?void 0:I.bind(J),h=null==(F=J.error)?void 0:F.bind(J),m=null==(G=J.complete)?void 0:G.bind(J)}this.__isAsync&&(h=u0(h),s&&(s=u0(s)),m&&(m=u0(m)));const S=super.subscribe({next:s,error:h,complete:m});return n instanceof St&&n.add(S),S}};function aN(){return this._results[yf()]()}class ev{constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=yf(),i=ev.prototype;i[e]||(i[e]=aN)}get changes(){return this._changes||(this._changes=new ut)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const i=this;i.dirty=!1;const s=yi(n);(this._changesDetected=!function(t,n,e){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++){let s=t[i],h=n[i];if(e&&(s=e(s),h=e(h)),h!==s)return!1}return!0}(i._results,s,e))&&(i._results=s,i.length=s.length,i.last=s[this.length-1],i.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;const cN=function(){return tv($i(),bt())};let ji=(()=>{class t{}return t.__NG_ELEMENT_ID__=cN,t})();const uN=ji,hN=class extends uN{constructor(n,e,i){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(n){const e=this._declarationTContainer.tViews,i=Tu(this._declarationLView,e,n,16,null,e.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const h=this._declarationLView[19];return null!==h&&(i[19]=h.createEmbeddedView(e)),wh(e,i,n),new Pm(i)}};function tv(t,n){return 4&t.type?new hN(n,t,Rf(t,n)):null}const fN=function(){return RD($i(),bt())};let na=(()=>{class t{}return t.__NG_ELEMENT_ID__=fN,t})();const mN=na,ID=class extends mN{constructor(n,e,i){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=i}get element(){return Rf(this._hostTNode,this._hostLView)}get injector(){return new Za(this._hostTNode,this._hostLView)}get parentInjector(){const n=qo(this._hostTNode,this._hostLView);if(Ur(n)){const e=Is(n,this._hostLView),i=ar(n);return new Za(e[1].data[i+8],e)}return new Za(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=PD(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,e,i){const s=n.createEmbeddedView(e||{});return this.insert(s,i),s}createComponent(n,e,i,s,h){const m=n&&!("function"==typeof n);let S;if(m)S=e;else{const J=e||{};S=J.index,i=J.injector,s=J.projectableNodes,h=J.ngModuleRef}const I=m?n:new a0(_r(n)),F=i||this.parentInjector;if(!h&&null==I.ngModule&&F){const J=F.get(Yc,null);J&&(h=J)}const G=I.create(F,s,void 0,h);return this.insert(G.hostView,S),G}insert(n,e){const i=n._lView,s=i[1];if(Er(i[3])){const G=this.indexOf(n);if(-1!==G)this.detach(G);else{const J=i[3],re=new ID(J,J[6],J[3]);re.detach(re.indexOf(n))}}const h=this._adjustIndex(e),m=this._lContainer;!function(t,n,e,i){const s=10+i,h=e.length;i>0&&(e[s-1][4]=n),i<h-10?(n[4]=e[s],Ka(e,10+i,n)):(e.push(n),n[4]=null),n[3]=e;const m=n[17];null!==m&&e!==m&&function(t,n){const e=t[9];n[16]!==n[3][3][16]&&(t[2]=!0),null===e?t[9]=[n]:e.push(n)}(m,n);const S=n[19];null!==S&&S.insertView(t),n[2]|=128}(s,i,m,h);const S=Kp(h,m),I=i[11],F=Md(I,m[7]);return null!==F&&function(t,n,e,i,s,h){i[0]=s,i[6]=n,Hc(t,i,e,1,s,h)}(s,m[6],I,i,F,S),n.attachToViewContainerRef(),Ka(h0(m),h,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=PD(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),i=Jp(this._lContainer,e);i&&(Oc(h0(this._lContainer),e),Gg(i[1],i))}detach(n){const e=this._adjustIndex(n,-1),i=Jp(this._lContainer,e);return i&&null!=Oc(h0(this._lContainer),e)?new Pm(i):null}_adjustIndex(n,e=0){return null==n?this.length+e:n}};function PD(t){return t[8]}function h0(t){return t[8]||(t[8]=[])}function RD(t,n){let e;const i=n[t.index];if(Er(i))e=i;else{let s;if(8&t.type)s=Pi(i);else{const h=n[11];s=h.createComment("");const m=qr(t,n);Do(h,Md(h,m),s,function(t,n){return Ii(t)?t.nextSibling(n):n.nextSibling}(h,m),!1)}n[t.index]=e=Pe(i,n,s,t),Mt(n,e)}return new ID(e,t,n)}class d0{constructor(n){this.queryList=n,this.matches=null}clone(){return new d0(this.queryList)}setDirty(){this.queryList.setDirty()}}class p0{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const i=null!==n.contentQueries?n.contentQueries[0]:e.length,s=[];for(let h=0;h<i;h++){const m=e.getByIndex(h);s.push(this.queries[m.indexInDeclarationView].clone())}return new p0(s)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==zD(n,e).matches&&this.queries[e].setDirty()}}class ND{constructor(n,e,i=null){this.predicate=n,this.flags=e,this.read=i}}class f0{constructor(n=[]){this.queries=n}elementStart(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let i=0;i<this.length;i++){const s=null!==e?e.length:0,h=this.getByIndex(i).embeddedTView(n,s);h&&(h.indexInDeclarationView=i,null!==e?e.push(h):e=[h])}return null!==e?new f0(e):null}template(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class g0{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new g0(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let s=0;s<i.length;s++){const h=i[s];this.matchTNodeWithReadOption(n,e,vN(e,h)),this.matchTNodeWithReadOption(n,e,od(e,n,h,!1,!1))}else i===ji?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,od(e,n,i,!1,!1))}matchTNodeWithReadOption(n,e,i){if(null!==i){const s=this.metadata.read;if(null!==s)if(s===Nn||s===na||s===ji&&4&e.type)this.addMatch(e.index,-2);else{const h=od(e,n,s,!1,!1);null!==h&&this.addMatch(e.index,h)}else this.addMatch(e.index,i)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function vN(t,n){const e=t.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===n)return e[i+1];return null}function bN(t,n,e,i){return-1===e?function(t,n){return 11&t.type?Rf(t,n):4&t.type?tv(t,n):null}(n,t):-2===e?function(t,n,e){return e===Nn?Rf(n,t):e===ji?tv(n,t):e===na?RD(n,t):void 0}(t,n,i):ad(t,t[1],e,n)}function FD(t,n,e,i){const s=n[19].queries[i];if(null===s.matches){const h=t.data,m=e.matches,S=[];for(let I=0;I<m.length;I+=2){const F=m[I];S.push(F<0?null:bN(n,h[F],m[I+1],e.metadata.read))}s.matches=S}return s.matches}function m0(t,n,e,i){const s=t.queries.getByIndex(e),h=s.matches;if(null!==h){const m=FD(t,n,s,e);for(let S=0;S<h.length;S+=2){const I=h[S];if(I>0)i.push(m[S/2]);else{const F=h[S+1],G=n[-I];for(let J=10;J<G.length;J++){const re=G[J];re[17]===re[3]&&m0(re[1],re,F,i)}if(null!==G[9]){const J=G[9];for(let re=0;re<J.length;re++){const he=J[re];m0(he[1],he,F,i)}}}}}return i}function hi(t){const n=bt(),e=zn(),i=x();l(i+1);const s=zD(e,i);if(t.dirty&&Ec(n)===(2==(2&s.metadata.flags))){if(null===s.matches)t.reset([]);else{const h=s.crossesNgTemplate?m0(e,n,i,[]):FD(e,n,s,i);t.reset(h,yD),t.notifyOnChanges()}return!0}return!1}function Zc(t,n,e){const i=zn();i.firstCreatePass&&(function(t,n,e){null===t.queries&&(t.queries=new f0),t.queries.track(new g0(n,e))}(i,new ND(t,n,e),-1),2==(2&n)&&(i.staticViewQueries=!0)),function(t,n,e){const i=new ev(4==(4&e));Sh(t,n,i,i.destroy),null===n[19]&&(n[19]=new p0),n[19].queries.push(new d0(i))}(i,bt(),n)}function di(){return t=bt(),n=x(),t[19].queries[n].queryList;var t,n}function zD(t,n){return t.queries.getByIndex(n)}const Om=new on("Application Initializer");let zf=(()=>{class t{constructor(e){this.appInits=e,this.resolve=Z_,this.reject=Z_,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,s)=>{this.resolve=i,this.reject=s})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let s=0;s<this.appInits.length;s++){const h=this.appInits[s]();if(Sm(h))e.push(h);else if(H_(h)){const m=new Promise((S,I)=>{h.subscribe({complete:S,error:I})});e.push(m)}}Promise.all(e).then(()=>{i()}).catch(s=>{this.reject(s)}),0===e.length&&i(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(dt(Om,8))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const Lm=new on("AppId"),JN={provide:Lm,useFactory:function(){return`${w0()}${w0()}${w0()}`},deps:[]};function w0(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const nE=new on("Platform Initializer"),zm=new on("Platform ID"),iE=new on("appBootstrapListener");let rv=(()=>{class t{log(e){console.log(e)}warn(e){console.warn(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const sl=new on("LocaleId"),rE=new on("DefaultCurrencyCode");class QN{constructor(n,e){this.ngModuleFactory=n,this.componentFactories=e}}const C0=function(t){return new c0(t)},eF=C0,tF=function(t){return Promise.resolve(C0(t))},oE=function(t){const n=C0(t),i=Ks(Ws(t).declarations).reduce((s,h)=>{const m=_r(h);return m&&s.push(new a0(m)),s},[]);return new QN(n,i)},nF=oE,iF=function(t){return Promise.resolve(oE(t))};let sv=(()=>{class t{constructor(){this.compileModuleSync=eF,this.compileModuleAsync=tF,this.compileModuleAndAllComponentsSync=nF,this.compileModuleAndAllComponentsAsync=iF}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const oF=(()=>Promise.resolve(0))();function S0(t){"undefined"==typeof Zone?oF.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class jn{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ut(!1),this.onMicrotaskEmpty=new ut(!1),this.onStable=new ut(!1),this.onError=new ut(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&e,s.shouldCoalesceRunChangeDetection=i,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function(){let t=Gn.requestAnimationFrame,n=Gn.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&n){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function(t){const n=()=>{!function(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Gn,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,E0(t),t.isCheckStableRunning=!0,D0(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),E0(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,s,h,m,S)=>{try{return aE(t),e.invokeTask(s,h,m,S)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===h.type||t.shouldCoalesceRunChangeDetection)&&n(),lE(t)}},onInvoke:(e,i,s,h,m,S,I)=>{try{return aE(t),e.invoke(s,h,m,S,I)}finally{t.shouldCoalesceRunChangeDetection&&n(),lE(t)}},onHasTask:(e,i,s,h)=>{e.hasTask(s,h),i===s&&("microTask"==h.change?(t._hasPendingMicrotasks=h.microTask,E0(t),D0(t)):"macroTask"==h.change&&(t.hasPendingMacrotasks=h.macroTask))},onHandleError:(e,i,s,h)=>(e.handleError(s,h),t.runOutsideAngular(()=>t.onError.emit(h)),!1)})}(s)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!jn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(jn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(n,e,i){return this._inner.run(n,e,i)}runTask(n,e,i,s){const h=this._inner,m=h.scheduleEventTask("NgZoneEvent: "+s,n,lF,Z_,Z_);try{return h.runTask(m,e,i)}finally{h.cancelTask(m)}}runGuarded(n,e,i){return this._inner.runGuarded(n,e,i)}runOutsideAngular(n){return this._outer.run(n)}}const lF={};function D0(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function E0(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function aE(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function lE(t){t._nesting--,D0(t)}class hF{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ut,this.onMicrotaskEmpty=new ut,this.onStable=new ut,this.onError=new ut}run(n,e,i){return n.apply(e,i)}runGuarded(n,e,i){return n.apply(e,i)}runOutsideAngular(n){return n()}runTask(n,e,i,s){return n.apply(e,i)}}let A0=(()=>{class t{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{jn.assertNotInAngularZone(),S0(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())S0(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,s){let h=-1;i&&i>0&&(h=setTimeout(()=>{this._callbacks=this._callbacks.filter(m=>m.timeoutId!==h),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:h,updateCb:s})}whenStable(e,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,i,s){return[]}}return t.\u0275fac=function(e){return new(e||t)(dt(jn))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})(),cE=(()=>{class t{constructor(){this._applications=new Map,T0.addToWindow(this)}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return T0.findTestabilityInTree(this,e,i)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();class dF{addToWindow(n){}findTestabilityInTree(n,e,i){return null}}let T0=new dF,uE=!0,hE=!1;let Ql;const pE=new on("AllowMultipleToken");class M0{constructor(n,e){this.name=n,this.token=e}}function fE(t,n,e=[]){const i=`Platform: ${n}`,s=new on(i);return(h=[])=>{let m=gE();if(!m||m.injector.get(pE,!1))if(t)t(e.concat(h).concat({provide:s,useValue:!0}));else{const S=e.concat(h).concat({provide:s,useValue:!0},{provide:zi,useValue:"platform"});!function(t){if(Ql&&!Ql.destroyed&&!Ql.injector.get(pE,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Ql=t.get(mE);const n=t.get(nE,null);n&&n.forEach(e=>e())}(Bn.create({providers:S,name:i}))}return function(t){const n=gE();if(!n)throw new Error("No platform exists!");if(!n.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return n}(s)}}function gE(){return Ql&&!Ql.destroyed?Ql:null}let mE=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const S=function(t,n){let e;return e="noop"===t?new hF:("zone.js"===t?void 0:t)||new jn({enableLongStackTrace:(hE=!0,uE),shouldCoalesceEventChangeDetection:!!(null==n?void 0:n.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==n?void 0:n.ngZoneRunCoalescing)}),e}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),I=[{provide:jn,useValue:S}];return S.run(()=>{const F=Bn.create({providers:I,parent:this.injector,name:e.moduleType.name}),G=e.create(F),J=G.injector.get(zl,null);if(!J)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return S.runOutsideAngular(()=>{const re=S.onError.subscribe({next:he=>{J.handleError(he)}});G.onDestroy(()=>{k0(this._modules,G),re.unsubscribe()})}),function(t,n,e){try{const i=e();return Sm(i)?i.catch(s=>{throw n.runOutsideAngular(()=>t.handleError(s)),s}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(J,S,()=>{const re=G.injector.get(zf);return re.runInitializers(),re.donePromise.then(()=>(function(t){gi(t,"Expected localeId to be defined"),"string"==typeof t&&($S=t.toLowerCase().replace(/_/g,"-"))}(G.injector.get(sl,G_)||G_),this._moduleDoBootstrap(G),G))})})}bootstrapModule(e,i=[]){const s=yE({},i);return function(t,n,e){const i=new c0(e);return Promise.resolve(i)}(0,0,e).then(h=>this.bootstrapModuleFactory(h,s))}_moduleDoBootstrap(e){const i=e.injector.get(ec);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(s=>i.bootstrap(s));else{if(!e.instance.ngDoBootstrap)throw new Error(`The module ${ge(e.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(dt(Bn))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();function yE(t,n){return Array.isArray(n)?n.reduce(yE,t):Qt(Qt({},t),n)}let ec=(()=>{class t{constructor(e,i,s,h,m){this._zone=e,this._injector=i,this._exceptionHandler=s,this._componentFactoryResolver=h,this._initStatus=m,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const S=new Cn(F=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{F.next(this._stable),F.complete()})}),I=new Cn(F=>{let G;this._zone.runOutsideAngular(()=>{G=this._zone.onStable.subscribe(()=>{jn.assertNotInAngularZone(),S0(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,F.next(!0))})})});const J=this._zone.onUnstable.subscribe(()=>{jn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{F.next(!1)}))});return()=>{G.unsubscribe(),J.unsubscribe()}});this.isStable=function(...t){const n=o(t),e=function(t,n){return"number"==typeof Tt(t)?t.pop():1/0}(t),i=t;return i.length?1===i.length?Ei(i[0]):$e(e)(V(i,n)):Ue}(S,I.pipe(function(t={}){const{connector:n=(()=>new Dn),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:s=!0}=t;return h=>{let m=null,S=null,I=null,F=0,G=!1,J=!1;const re=()=>{null==S||S.unsubscribe(),S=null},he=()=>{re(),m=I=null,G=J=!1},Se=()=>{const ze=m;he(),null==ze||ze.unsubscribe()};return ni((ze,Le)=>{F++,!J&&!G&&re();const et=I=null!=I?I:n();Le.add(()=>{F--,0===F&&!J&&!G&&(S=oe(Se,s))}),et.subscribe(Le),m||(m=new Ro({next:Ze=>et.next(Ze),error:Ze=>{J=!0,re(),S=oe(he,e,Ze),et.error(Ze)},complete:()=>{G=!0,re(),S=oe(he,i),et.complete()}}),V(ze).subscribe(m))})(h)}}()))}bootstrap(e,i){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let s;s=e instanceof fD?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(s.componentType);const h=function(t){return t.isBoundToModule}(s)?void 0:this._injector.get(Yc),S=s.create(Bn.NULL,[],i||s.selector,h),I=S.location.nativeElement,F=S.injector.get(A0,null),G=F&&S.injector.get(cE);return F&&G&&G.registerApplication(I,F),S.onDestroy(()=>{this.detachView(S.hostView),k0(this.components,S),G&&G.unregisterApplication(I)}),this._loadComponent(S),S}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;k0(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(iE,[]).concat(this._bootstrapListeners).forEach(s=>s(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(dt(jn),dt(Bn),dt(zl),dt(La),dt(zf))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();function k0(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}const AF=function(t){return function(t,n,e){if(lu(t)&&!e){const i=Br(t.index,n);return new Pm(i,i)}return 47&t.type?new Pm(n[16],n):null}($i(),bt(),16==(16&t))};let io=(()=>{class t{}return t.__NG_ELEMENT_ID__=AF,t})();class SE{constructor(){}supports(n){return wm(n)}create(n){return new VF(n)}}const BF=(t,n)=>n;class VF{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||BF}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,i=this._removalsHead,s=0,h=null;for(;e||i;){const m=!i||e&&e.currentIndex<EE(i,s,h)?e:i,S=EE(m,s,h),I=m.currentIndex;if(m===i)s--,i=i._nextRemoved;else if(e=e._next,null==m.previousIndex)s++;else{h||(h=[]);const F=S-s,G=I-s;if(F!=G){for(let re=0;re<F;re++){const he=re<h.length?h[re]:h[re]=0,Se=he+re;G<=Se&&Se<F&&(h[re]=he+1)}h[m.previousIndex]=G-F}}S!==I&&n(m,S,I)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!wm(n))throw new Error(`Error trying to diff '${ge(n)}'. Only arrays and iterables are allowed`);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let s,h,m,e=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let S=0;S<this.length;S++)h=n[S],m=this._trackByFn(S,h),null!==e&&Object.is(e.trackById,m)?(i&&(e=this._verifyReinsertion(e,h,m,S)),Object.is(e.item,h)||this._addIdentityChange(e,h)):(e=this._mismatch(e,h,m,S),i=!0),e=e._next}else s=0,function(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[yf()]();let i;for(;!(i=e.next()).done;)n(i.value)}}(n,S=>{m=this._trackByFn(s,S),null!==e&&Object.is(e.trackById,m)?(i&&(e=this._verifyReinsertion(e,S,m,s)),Object.is(e.item,S)||this._addIdentityChange(e,S)):(e=this._mismatch(e,S,m,s),i=!0),e=e._next,s++}),this.length=s;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,i,s){let h;return null===n?h=this._itTail:(h=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,h,s)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,s))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,h,s)):n=this._addAfter(new UF(e,i),h,s),n}_verifyReinsertion(n,e,i,s){let h=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==h?n=this._reinsertAfter(h,n._prev,s):n.currentIndex!=s&&(n.currentIndex=s,this._addToMoves(n,s)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const s=n._prevRemoved,h=n._nextRemoved;return null===s?this._removalsHead=h:s._nextRemoved=h,null===h?this._removalsTail=s:h._prevRemoved=s,this._insertAfter(n,e,i),this._addToMoves(n,i),n}_moveAfter(n,e,i){return this._unlink(n),this._insertAfter(n,e,i),this._addToMoves(n,i),n}_addAfter(n,e,i){return this._insertAfter(n,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,i){const s=null===e?this._itHead:e._next;return n._next=s,n._prev=e,null===s?this._itTail=n:s._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new DE),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,i=n._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new DE),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class UF{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class HF{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const e=n._prevDup,i=n._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class DE{constructor(){this.map=new Map}put(n){const e=n.trackById;let i=this.map.get(e);i||(i=new HF,this.map.set(e,i)),i.add(n)}get(n,e){const s=this.map.get(n);return s?s.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function EE(t,n,e){const i=t.previousIndex;if(null===i)return i;let s=0;return e&&i<e.length&&(s=e[i]),i+n+s}class AE{constructor(){}supports(n){return n instanceof Map||Vb(n)}create(){return new jF}}class jF{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||Vb(n)))throw new Error(`Error trying to diff '${ge(n)}'. Only maps and objects are allowed`)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,s)=>{if(e&&e.key===s)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const h=this._getOrCreateRecordForKey(s,i);e=this._insertBeforeOrAppend(e,h)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const i=n._prev;return e._next=n,e._prev=i,n._prev=e,i&&(i._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const s=this._records.get(n);this._maybeAddToChanges(s,e);const h=s._prev,m=s._next;return h&&(h._next=m),m&&(m._prev=h),s._next=null,s._prev=null,s}const i=new $F(n);return this._records.set(n,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(i=>e(n[i],i))}}class $F{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function TE(){return new Bm([new SE])}let Bm=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(null!=i){const s=i.factories.slice();e=e.concat(s)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||TE()),deps:[[t,new Ra,new Js]]}}find(e){const i=this.factories.find(s=>s.supports(e));if(null!=i)return i;throw new Error(`Cannot find a differ supporting object '${e}' of type '${function(t){return t.name||typeof t}(e)}'`)}}return t.\u0275prov=Ft({token:t,providedIn:"root",factory:TE}),t})();function ME(){return new Bf([new AE])}let Bf=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(i){const s=i.factories.slice();e=e.concat(s)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||ME()),deps:[[t,new Ra,new Js]]}}find(e){const i=this.factories.find(s=>s.supports(e));if(i)return i;throw new Error(`Cannot find a differ supporting object '${e}'`)}}return t.\u0275prov=Ft({token:t,providedIn:"root",factory:ME}),t})();const WF=[new AE],YF=new Bm([new SE]),qF=new Bf(WF),ZF=fE(null,"core",[{provide:zm,useValue:"unknown"},{provide:mE,deps:[Bn]},{provide:cE,deps:[]},{provide:rv,deps:[]}]),tO=[{provide:ec,useClass:ec,deps:[jn,Bn,zl,La,zf]},{provide:jR,deps:[jn],useFactory:function(t){let n=[];return t.onStable.subscribe(()=>{for(;n.length;)n.pop()()}),function(e){n.push(e)}}},{provide:zf,useClass:zf,deps:[[new Js,Om]]},{provide:sv,useClass:sv,deps:[]},JN,{provide:Bm,useFactory:function(){return YF},deps:[]},{provide:Bf,useFactory:function(){return qF},deps:[]},{provide:sl,useFactory:function(t){return t||"undefined"!=typeof $localize&&$localize.locale||G_},deps:[[new Bc(sl),new Js,new Ra]]},{provide:rE,useValue:"USD"}];let iO=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)(dt(ec))},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({providers:tO}),t})(),vv=null;function Jc(){return vv}const Di=new on("DocumentToken");let Jd=(()=>{class t{historyGo(e){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Ft({token:t,factory:function(){return dt(pA)},providedIn:"platform"}),t})();const JL=new on("Location Initialized");let pA=(()=>{class t extends Jd{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Jc().getBaseHref(this._doc)}onPopState(e){const i=Jc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",e,!1),()=>i.removeEventListener("popstate",e)}onHashChange(e){const i=Jc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",e,!1),()=>i.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,i,s){fA()?this._history.pushState(e,i,s):this.location.hash=s}replaceState(e,i,s){fA()?this._history.replaceState(e,i,s):this.location.hash=s}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(dt(Di))},t.\u0275prov=Ft({token:t,factory:function(){return new pA(dt(Di))},providedIn:"platform"}),t})();function fA(){return!!window.history.pushState}function r1(t,n){if(0==t.length)return n;if(0==n.length)return t;let e=0;return t.endsWith("/")&&e++,n.startsWith("/")&&e++,2==e?t+n.substring(1):1==e?t+n:t+"/"+n}function gA(t){const n=t.match(/#|\?|$/),e=n&&n.index||t.length;return t.slice(0,e-("/"===t[e-1]?1:0))+t.slice(e)}function Iu(t){return t&&"?"!==t[0]?"?"+t:t}let Gf=(()=>{class t{historyGo(e){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Ft({token:t,factory:function(){return function(t){const n=dt(Di).location;return new mA(dt(Jd),n&&n.origin||"")}()},providedIn:"root"}),t})();const s1=new on("appBaseHref");let mA=(()=>{class t extends Gf{constructor(e,i){if(super(),this._platformLocation=e,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return r1(this._baseHref,e)}path(e=!1){const i=this._platformLocation.pathname+Iu(this._platformLocation.search),s=this._platformLocation.hash;return s&&e?`${i}${s}`:i}pushState(e,i,s,h){const m=this.prepareExternalUrl(s+Iu(h));this._platformLocation.pushState(e,i,m)}replaceState(e,i,s,h){const m=this.prepareExternalUrl(s+Iu(h));this._platformLocation.replaceState(e,i,m)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var i,s;null==(s=(i=this._platformLocation).historyGo)||s.call(i,e)}}return t.\u0275fac=function(e){return new(e||t)(dt(Jd),dt(s1,8))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})(),ez=(()=>{class t extends Gf{constructor(e,i){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(e){const i=r1(this._baseHref,e);return i.length>0?"#"+i:i}pushState(e,i,s,h){let m=this.prepareExternalUrl(s+Iu(h));0==m.length&&(m=this._platformLocation.pathname),this._platformLocation.pushState(e,i,m)}replaceState(e,i,s,h){let m=this.prepareExternalUrl(s+Iu(h));0==m.length&&(m=this._platformLocation.pathname),this._platformLocation.replaceState(e,i,m)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var i,s;null==(s=(i=this._platformLocation).historyGo)||s.call(i,e)}}return t.\u0275fac=function(e){return new(e||t)(dt(Jd),dt(s1,8))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})(),o1=(()=>{class t{constructor(e,i){this._subject=new ut,this._urlChangeListeners=[],this._platformStrategy=e;const s=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=gA(yA(s)),this._platformStrategy.onPopState(h=>{this._subject.emit({url:this.path(!0),pop:!0,state:h.state,type:h.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,i=""){return this.path()==this.normalize(e+Iu(i))}normalize(e){return t.stripTrailingSlash(function(t,n){return t&&n.startsWith(t)?n.substring(t.length):n}(this._baseHref,yA(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,i="",s=null){this._platformStrategy.pushState(s,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Iu(i)),s)}replaceState(e,i="",s=null){this._platformStrategy.replaceState(s,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Iu(i)),s)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(e=0){var i,s;null==(s=(i=this._platformStrategy).historyGo)||s.call(i,e)}onUrlChange(e){this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(e="",i){this._urlChangeListeners.forEach(s=>s(e,i))}subscribe(e,i,s){return this._subject.subscribe({next:e,error:i,complete:s})}}return t.normalizeQueryParams=Iu,t.joinWithSlash=r1,t.stripTrailingSlash=gA,t.\u0275fac=function(e){return new(e||t)(dt(Gf),dt(Jd))},t.\u0275prov=Ft({token:t,factory:function(){return new o1(dt(Gf),dt(Jd))},providedIn:"root"}),t})();function yA(t){return t.replace(/\/index.html$/,"")}var is=(()=>((is=is||{})[is.Zero=0]="Zero",is[is.One=1]="One",is[is.Two=2]="Two",is[is.Few=3]="Few",is[is.Many=4]="Many",is[is.Other=5]="Other",is))();const oz=function(t){return function(t){const n=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=jS(n);if(e)return e;const i=n.split("-")[0];if(e=jS(i),e)return e;if("en"===i)return NP;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[jt.PluralCase]};class Mv{}let Nz=(()=>{class t extends Mv{constructor(e){super(),this.locale=e}getPluralCategory(e,i){switch(oz(i||this.locale)(e)){case is.Zero:return"zero";case is.One:return"one";case is.Two:return"two";case is.Few:return"few";case is.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(dt(sl))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();function MA(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const i=e.indexOf("="),[s,h]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(s.trim()===n)return decodeURIComponent(h)}return null}class Lz{constructor(n,e,i,s){this.$implicit=n,this.ngForOf=e,this.index=i,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let za=(()=>{class t{constructor(e,i,s){this._viewContainer=e,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(i){throw new Error(`Cannot find a differ supporting object '${e}' of type '${function(t){return t.name||typeof t}(e)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=[];e.forEachOperation((s,h,m)=>{if(null==s.previousIndex){const S=this._viewContainer.createEmbeddedView(this._template,new Lz(null,this._ngForOf,-1,-1),null===m?void 0:m),I=new kA(s,S);i.push(I)}else if(null==m)this._viewContainer.remove(null===h?void 0:h);else if(null!==h){const S=this._viewContainer.get(h);this._viewContainer.move(S,m);const I=new kA(s,S);i.push(I)}});for(let s=0;s<i.length;s++)this._perViewChange(i[s].view,i[s].record);for(let s=0,h=this._viewContainer.length;s<h;s++){const m=this._viewContainer.get(s);m.context.index=s,m.context.count=h,m.context.ngForOf=this._ngForOf}e.forEachIdentityChange(s=>{this._viewContainer.get(s.currentIndex).context.$implicit=s.item})}_perViewChange(e,i){e.context.$implicit=i.item}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(Ne(na),Ne(ji),Ne(Bm))},t.\u0275dir=Rt({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class kA{constructor(n,e){this.record=n,this.view=e}}let sa=(()=>{class t{constructor(e,i){this._viewContainer=e,this._context=new Bz,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){IA("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){IA("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(Ne(na),Ne(ji))},t.\u0275dir=Rt({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class Bz{constructor(){this.$implicit=null,this.ngIf=null}}function IA(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${ge(n)}'.`)}let oa=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({providers:[{provide:Mv,useClass:Nz}]}),t})();let fB=(()=>{class t{}return t.\u0275prov=Ft({token:t,providedIn:"root",factory:()=>new gB(dt(Di),window)}),t})();class gB{constructor(n,e){this.document=n,this.window=e,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const e=function(t,n){const e=t.getElementById(n)||t.getElementsByName(n)[0];if(e)return e;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const i=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let s=i.currentNode;for(;s;){const h=s.shadowRoot;if(h){const m=h.getElementById(n)||h.querySelector(`[name="${n}"]`);if(m)return m}s=i.nextNode()}}return null}(this.document,n);e&&(this.scrollToElement(e),this.attemptFocus(e))}setHistoryScrollRestoration(n){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=n)}}scrollToElement(n){const e=n.getBoundingClientRect(),i=e.left+this.window.pageXOffset,s=e.top+this.window.pageYOffset,h=this.offset();this.window.scrollTo(i-h[0],s-h[1])}attemptFocus(n){return n.focus(),this.document.activeElement===n}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const n=OA(this.window.history)||OA(Object.getPrototypeOf(this.window.history));return!(!n||!n.writable&&!n.set)}catch(n){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(n){return!1}}}function OA(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class LA{}class x1 extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var t;t=new x1,vv||(vv=t)}onAndCancel(n,e,i){return n.addEventListener(e,i,!1),()=>{n.removeEventListener(e,i,!1)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=(Qm=Qm||document.querySelector("base"),Qm?Qm.getAttribute("href"):null);return null==e?null:function(t){kv=kv||document.createElement("a"),kv.setAttribute("href",t);const n=kv.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){Qm=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return MA(document.cookie,n)}}let kv,Qm=null;const zA=new on("TRANSITION_ID"),bB=[{provide:Om,useFactory:function(t,n,e){return()=>{e.get(zf).donePromise.then(()=>{const i=Jc(),s=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let h=0;h<s.length;h++)i.remove(s[h])})}},deps:[zA,Di,Bn],multi:!0}];class b1{static init(){var t;t=new b1,T0=t}addToWindow(n){Gn.getAngularTestability=(i,s=!0)=>{const h=n.findTestabilityInTree(i,s);if(null==h)throw new Error("Could not find testability for element.");return h},Gn.getAllAngularTestabilities=()=>n.getAllTestabilities(),Gn.getAllAngularRootElements=()=>n.getAllRootElements(),Gn.frameworkStabilizers||(Gn.frameworkStabilizers=[]),Gn.frameworkStabilizers.push(i=>{const s=Gn.getAllAngularTestabilities();let h=s.length,m=!1;const S=function(I){m=m||I,h--,0==h&&i(m)};s.forEach(function(I){I.whenStable(S)})})}findTestabilityInTree(n,e,i){if(null==e)return null;const s=n.getTestability(e);return null!=s?s:i?Jc().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null}}let wB=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const ey=new on("EventManagerPlugins");let Pv=(()=>{class t{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(s=>s.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,i,s){return this._findPluginFor(i).addEventListener(e,i,s)}addGlobalEventListener(e,i,s){return this._findPluginFor(i).addGlobalEventListener(e,i,s)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const s=this._plugins;for(let h=0;h<s.length;h++){const m=s[h];if(m.supports(e))return this._eventNameToPlugin.set(e,m),m}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)(dt(ey),dt(jn))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();class w1{constructor(n){this._doc=n}addGlobalEventListener(n,e,i){const s=Jc().getGlobalEventTarget(this._doc,n);if(!s)throw new Error(`Unsupported event target ${s} for event ${e}`);return this.addEventListener(s,e,i)}}let VA=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(e){const i=new Set;e.forEach(s=>{this._stylesSet.has(s)||(this._stylesSet.add(s),i.add(s))}),this.onStylesAdded(i)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})(),ty=(()=>{class t extends VA{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,i,s){e.forEach(h=>{const m=this._doc.createElement("style");m.textContent=h,s.push(i.appendChild(m))})}addHost(e){const i=[];this._addStylesToHost(this._stylesSet,e,i),this._hostNodes.set(e,i)}removeHost(e){const i=this._hostNodes.get(e);i&&i.forEach(UA),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((i,s)=>{this._addStylesToHost(e,s,i)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(UA))}}return t.\u0275fac=function(e){return new(e||t)(dt(Di))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();function UA(t){Jc().remove(t)}const C1={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},S1=/%COMP%/g;function Rv(t,n,e){for(let i=0;i<n.length;i++){let s=n[i];Array.isArray(s)?Rv(t,s,e):(s=s.replace(S1,t),e.push(s))}return e}function $A(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let D1=(()=>{class t{constructor(e,i,s){this.eventManager=e,this.sharedStylesHost=i,this.appId=s,this.rendererByCompId=new Map,this.defaultRenderer=new E1(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;switch(i.encapsulation){case ln.Emulated:{let s=this.rendererByCompId.get(i.id);return s||(s=new LB(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,s)),s.applyToHost(e),s}case 1:case ln.ShadowDom:return new zB(this.eventManager,this.sharedStylesHost,e,i);default:if(!this.rendererByCompId.has(i.id)){const s=Rv(i.id,i.styles,[]);this.sharedStylesHost.addStyles(s),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(dt(Pv),dt(ty),dt(Lm))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();class E1{constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?document.createElementNS(C1[e]||e,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,e){n.appendChild(e)}insertBefore(n,e,i){n&&n.insertBefore(e,i)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let i="string"==typeof n?document.querySelector(n):n;if(!i)throw new Error(`The selector "${n}" did not match any elements`);return e||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,i,s){if(s){e=s+":"+e;const h=C1[s];h?n.setAttributeNS(h,e,i):n.setAttribute(e,i)}else n.setAttribute(e,i)}removeAttribute(n,e,i){if(i){const s=C1[i];s?n.removeAttributeNS(s,e):n.removeAttribute(`${i}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,i,s){s&(Jo.DashCase|Jo.Important)?n.style.setProperty(e,i,s&Jo.Important?"important":""):n.style[e]=i}removeStyle(n,e,i){i&Jo.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,i){n[e]=i}setValue(n,e){n.nodeValue=e}listen(n,e,i){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,e,$A(i)):this.eventManager.addEventListener(n,e,$A(i))}}class LB extends E1{constructor(n,e,i,s){super(n),this.component=i;const h=Rv(s+"-"+i.id,i.styles,[]);e.addStyles(h),this.contentAttr="_ngcontent-%COMP%".replace(S1,s+"-"+i.id),this.hostAttr="_nghost-%COMP%".replace(S1,s+"-"+i.id)}applyToHost(n){super.setAttribute(n,this.hostAttr,"")}createElement(n,e){const i=super.createElement(n,e);return super.setAttribute(i,this.contentAttr,""),i}}class zB extends E1{constructor(n,e,i,s){super(n),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const h=Rv(s.id,s.styles,[]);for(let m=0;m<h.length;m++){const S=document.createElement("style");S.textContent=h[m],this.shadowRoot.appendChild(S)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,i){return super.insertBefore(this.nodeOrShadowRoot(n),e,i)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}}let BB=(()=>{class t extends w1{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,s){return e.addEventListener(i,s,!1),()=>this.removeEventListener(e,i,s)}removeEventListener(e,i,s){return e.removeEventListener(i,s)}}return t.\u0275fac=function(e){return new(e||t)(dt(Di))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const XA=["alt","control","meta","shift"],WB={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},YA={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},XB={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let YB=(()=>{class t extends w1{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,s){const h=t.parseEventName(i),m=t.eventCallback(h.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Jc().onAndCancel(e,h.domEventName,m))}static parseEventName(e){const i=e.toLowerCase().split("."),s=i.shift();if(0===i.length||"keydown"!==s&&"keyup"!==s)return null;const h=t._normalizeKey(i.pop());let m="";if(XA.forEach(I=>{const F=i.indexOf(I);F>-1&&(i.splice(F,1),m+=I+".")}),m+=h,0!=i.length||0===h.length)return null;const S={};return S.domEventName=s,S.fullKey=m,S}static getEventFullKey(e){let i="",s=function(t){let n=t.key;if(null==n){if(n=t.keyIdentifier,null==n)return"Unidentified";n.startsWith("U+")&&(n=String.fromCharCode(parseInt(n.substring(2),16)),3===t.location&&YA.hasOwnProperty(n)&&(n=YA[n]))}return WB[n]||n}(e);return s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),XA.forEach(h=>{h!=s&&XB[h](e)&&(i+=h+".")}),i+=s,i}static eventCallback(e,i,s){return h=>{t.getEventFullKey(h)===e&&s.runGuarded(()=>i(h))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)(dt(Di))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const n3=fE(ZF,"browser",[{provide:zm,useValue:"browser"},{provide:nE,useValue:function(){x1.makeCurrent(),b1.init()},multi:!0},{provide:Di,useFactory:function(){return t=document,Wo=t,document;var t},deps:[]}]),i3=[[],{provide:zi,useValue:"root"},{provide:zl,useFactory:function(){return new zl},deps:[]},{provide:ey,useClass:BB,multi:!0,deps:[Di,jn,zm]},{provide:ey,useClass:YB,multi:!0,deps:[Di]},[],{provide:D1,useClass:D1,deps:[Pv,ty,Lm]},{provide:Nf,useExisting:D1},{provide:VA,useExisting:ty},{provide:ty,useClass:ty,deps:[Di]},{provide:A0,useClass:A0,deps:[jn]},{provide:Pv,useClass:Pv,deps:[ey,jn]},{provide:LA,useClass:wB,deps:[]},[]];let r3=(()=>{class t{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:Lm,useValue:e.appId},{provide:zA,useExisting:Lm},bB]}}}return t.\u0275fac=function(e){return new(e||t)(dt(t,12))},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({providers:i3,imports:[oa,iO]}),t})();function fn(...t){return V(t,o(t))}"undefined"!=typeof window&&window;class xs extends Dn{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:i}=this;if(n)throw e;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}const{isArray:d3}=Array,{getPrototypeOf:p3,prototype:f3,keys:g3}=Object;function ZA(t){if(1===t.length){const n=t[0];if(d3(n))return{args:n,keys:null};if(function(t){return t&&"object"==typeof t&&p3(t)===f3}(n)){const e=g3(n);return{args:e.map(i=>n[i]),keys:e}}}return{args:t,keys:null}}const{isArray:y3}=Array;function I1(t){return Kt(n=>function(t,n){return y3(n)?t(...n):t(n)}(t,n))}function JA(t,n){return t.reduce((e,i,s)=>(e[i]=n[s],e),{})}function KA(t,n,e){t?xe(e,t,n):n()}const Nv=nr(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function ny(...t){return $e(1)(V(t,o(t)))}function QA(t){return new Cn(n=>{Ei(t()).subscribe(n)})}function eT(){return ni((t,n)=>{let e=null;t._refCount++;const i=new vn(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const s=t._connection,h=e;e=null,s&&(!h||s===h)&&s.unsubscribe(),n.unsubscribe()});t.subscribe(i),i.closed||(e=t.connect())})}class b3 extends Cn{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,Or(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,null==n||n.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new St;const e=this.getSubject();n.add(this.source.subscribe(new vn(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=St.EMPTY)}return n}refCount(){return eT()(this)}}function Kc(t,n){return ni((e,i)=>{let s=null,h=0,m=!1;const S=()=>m&&!s&&i.complete();e.subscribe(new vn(i,I=>{null==s||s.unsubscribe();let F=0;const G=h++;Ei(t(I,G)).subscribe(s=new vn(i,J=>i.next(n?n(I,J,G,F++):J),()=>{s=null,S()}))},()=>{m=!0,S()}))})}function w3(t,n,e,i,s){return(h,m)=>{let S=e,I=n,F=0;h.subscribe(new vn(m,G=>{const J=F++;I=S?t(I,G,J):(S=!0,G),i&&m.next(I)},s&&(()=>{S&&m.next(I),m.complete()})))}}function tT(t,n){return ni(w3(t,n,arguments.length>=2,!0))}function Wr(t,n){return ni((e,i)=>{let s=0;e.subscribe(new vn(i,h=>t.call(n,h,s++)&&i.next(h)))})}function Ph(t){return ni((n,e)=>{let h,i=null,s=!1;i=n.subscribe(new vn(e,void 0,void 0,m=>{h=Ei(t(m,Ph(t)(n))),i?(i.unsubscribe(),i=null,h.subscribe(e)):s=!0})),s&&(i.unsubscribe(),i=null,h.subscribe(e))})}function Wf(t,n){return Vn(n)?Ie(t,n,1):Ie(t,1)}function R1(t){return t<=0?()=>Ue:ni((n,e)=>{let i=[];n.subscribe(new vn(e,s=>{i.push(s),t<i.length&&i.shift()},()=>{for(const s of i)e.next(s);e.complete()},void 0,()=>{i=null}))})}function nT(t=C3){return ni((n,e)=>{let i=!1;n.subscribe(new vn(e,s=>{i=!0,e.next(s)},()=>i?e.complete():e.error(t())))})}function C3(){return new Nv}function iT(t){return ni((n,e)=>{let i=!1;n.subscribe(new vn(e,s=>{i=!0,e.next(s)},()=>{i||e.next(t),e.complete()}))})}function Kd(t,n){const e=arguments.length>=2;return i=>i.pipe(t?Wr((s,h)=>t(s,h,i)):as,q(1),e?iT(n):nT(()=>new Nv))}function ro(t,n,e){const i=Vn(t)||n||e?{next:t,error:n,complete:e}:t;return i?ni((s,h)=>{var m;null===(m=i.subscribe)||void 0===m||m.call(i);let S=!0;s.subscribe(new vn(h,I=>{var F;null===(F=i.next)||void 0===F||F.call(i,I),h.next(I)},()=>{var I;S=!1,null===(I=i.complete)||void 0===I||I.call(i),h.complete()},I=>{var F;S=!1,null===(F=i.error)||void 0===F||F.call(i,I),h.error(I)},()=>{var I,F;S&&(null===(I=i.unsubscribe)||void 0===I||I.call(i)),null===(F=i.finalize)||void 0===F||F.call(i)}))}):as}class Ru{constructor(n,e){this.id=n,this.url=e}}class N1 extends Ru{constructor(n,e,i="imperative",s=null){super(n,e),this.navigationTrigger=i,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class iy extends Ru{constructor(n,e,i){super(n,e),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class rT extends Ru{constructor(n,e,i){super(n,e),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class E3 extends Ru{constructor(n,e,i){super(n,e),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class A3 extends Ru{constructor(n,e,i,s){super(n,e),this.urlAfterRedirects=i,this.state=s}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class T3 extends Ru{constructor(n,e,i,s){super(n,e),this.urlAfterRedirects=i,this.state=s}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class M3 extends Ru{constructor(n,e,i,s,h){super(n,e),this.urlAfterRedirects=i,this.state=s,this.shouldActivate=h}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class k3 extends Ru{constructor(n,e,i,s){super(n,e),this.urlAfterRedirects=i,this.state=s}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class I3 extends Ru{constructor(n,e,i,s){super(n,e),this.urlAfterRedirects=i,this.state=s}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class sT{constructor(n){this.route=n}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class oT{constructor(n){this.route=n}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class P3{constructor(n){this.snapshot=n}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class R3{constructor(n){this.snapshot=n}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class N3{constructor(n){this.snapshot=n}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class F3{constructor(n){this.snapshot=n}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class aT{constructor(n,e,i){this.routerEvent=n,this.position=e,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Xn="primary";class O3{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e[0]:e}return null}getAll(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Xf(t){return new O3(t)}const lT="ngNavigationCancelingError";function F1(t){const n=Error("NavigationCancelingError: "+t);return n[lT]=!0,n}function z3(t,n,e){const i=e.path.split("/");if(i.length>t.length||"full"===e.pathMatch&&(n.hasChildren()||i.length<t.length))return null;const s={};for(let h=0;h<i.length;h++){const m=i[h],S=t[h];if(m.startsWith(":"))s[m.substring(1)]=S;else if(m!==S.path)return null}return{consumed:t.slice(0,i.length),posParams:s}}function Qc(t,n){const e=t?Object.keys(t):void 0,i=n?Object.keys(n):void 0;if(!e||!i||e.length!=i.length)return!1;let s;for(let h=0;h<e.length;h++)if(s=e[h],!cT(t[s],n[s]))return!1;return!0}function cT(t,n){if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;const e=[...t].sort(),i=[...n].sort();return e.every((s,h)=>i[h]===s)}return t===n}function uT(t){return Array.prototype.concat.apply([],t)}function hT(t){return t.length>0?t[t.length-1]:null}function so(t,n){for(const e in t)t.hasOwnProperty(e)&&n(t[e],e)}function eu(t){return H_(t)?t:Sm(t)?V(Promise.resolve(t)):fn(t)}const U3={exact:function fT(t,n,e){if(!ep(t.segments,n.segments)||!Ov(t.segments,n.segments,e)||t.numberOfChildren!==n.numberOfChildren)return!1;for(const i in n.children)if(!t.children[i]||!fT(t.children[i],n.children[i],e))return!1;return!0},subset:gT},dT={exact:function(t,n){return Qc(t,n)},subset:function(t,n){return Object.keys(n).length<=Object.keys(t).length&&Object.keys(n).every(e=>cT(t[e],n[e]))},ignored:()=>!0};function pT(t,n,e){return U3[e.paths](t.root,n.root,e.matrixParams)&&dT[e.queryParams](t.queryParams,n.queryParams)&&!("exact"===e.fragment&&t.fragment!==n.fragment)}function gT(t,n,e){return mT(t,n,n.segments,e)}function mT(t,n,e,i){if(t.segments.length>e.length){const s=t.segments.slice(0,e.length);return!(!ep(s,e)||n.hasChildren()||!Ov(s,e,i))}if(t.segments.length===e.length){if(!ep(t.segments,e)||!Ov(t.segments,e,i))return!1;for(const s in n.children)if(!t.children[s]||!gT(t.children[s],n.children[s],i))return!1;return!0}{const s=e.slice(0,t.segments.length),h=e.slice(t.segments.length);return!!(ep(t.segments,s)&&Ov(t.segments,s,i)&&t.children[Xn])&&mT(t.children[Xn],n,h,i)}}function Ov(t,n,e){return n.every((i,s)=>dT[e](t[s].parameters,i.parameters))}class Qd{constructor(n,e,i){this.root=n,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Xf(this.queryParams)),this._queryParamMap}toString(){return W3.serialize(this)}}class Qn{constructor(n,e){this.segments=n,this.children=e,this.parent=null,so(e,(i,s)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Lv(this)}}class ry{constructor(n,e){this.path=n,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Xf(this.parameters)),this._parameterMap}toString(){return bT(this)}}function ep(t,n){return t.length===n.length&&t.every((e,i)=>e.path===n[i].path)}class yT{}class _T{parse(n){const e=new tV(n);return new Qd(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(n){const e=`/${sy(n.root,!0)}`,i=function(t){const n=Object.keys(t).map(e=>{const i=t[e];return Array.isArray(i)?i.map(s=>`${zv(e)}=${zv(s)}`).join("&"):`${zv(e)}=${zv(i)}`}).filter(e=>!!e);return n.length?`?${n.join("&")}`:""}(n.queryParams);var t;return`${e}${i}${"string"==typeof n.fragment?`#${t=n.fragment,encodeURI(t)}`:""}`}}const W3=new _T;function Lv(t){return t.segments.map(n=>bT(n)).join("/")}function sy(t,n){if(!t.hasChildren())return Lv(t);if(n){const e=t.children[Xn]?sy(t.children[Xn],!1):"",i=[];return so(t.children,(s,h)=>{h!==Xn&&i.push(`${h}:${sy(s,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}{const e=function(t,n){let e=[];return so(t.children,(i,s)=>{s===Xn&&(e=e.concat(n(i,s)))}),so(t.children,(i,s)=>{s!==Xn&&(e=e.concat(n(i,s)))}),e}(t,(i,s)=>s===Xn?[sy(t.children[Xn],!1)]:[`${s}:${sy(i,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[Xn]?`${Lv(t)}/${e[0]}`:`${Lv(t)}/(${e.join("//")})`}}function vT(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function zv(t){return vT(t).replace(/%3B/gi,";")}function O1(t){return vT(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Bv(t){return decodeURIComponent(t)}function xT(t){return Bv(t.replace(/\+/g,"%20"))}function bT(t){return`${O1(t.path)}${function(t){return Object.keys(t).map(n=>`;${O1(n)}=${O1(t[n])}`).join("")}(t.parameters)}`}const Z3=/^[^\/()?;=#]+/;function Vv(t){const n=t.match(Z3);return n?n[0]:""}const J3=/^[^=?&#]+/,Q3=/^[^&#]+/;class tV{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Qn([],{}):new Qn([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(n.length>0||Object.keys(e).length>0)&&(i[Xn]=new Qn(n,e)),i}parseSegment(){const n=Vv(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(n),new ry(Bv(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const e=Vv(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const s=Vv(this.remaining);s&&(i=s,this.capture(i))}n[Bv(e)]=Bv(i)}parseQueryParam(n){const e=function(t){const n=t.match(J3);return n?n[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const m=function(t){const n=t.match(Q3);return n?n[0]:""}(this.remaining);m&&(i=m,this.capture(i))}const s=xT(e),h=xT(i);if(n.hasOwnProperty(s)){let m=n[s];Array.isArray(m)||(m=[m],n[s]=m),m.push(h)}else n[s]=h}parseParens(n){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Vv(this.remaining),s=this.remaining[i.length];if("/"!==s&&")"!==s&&";"!==s)throw new Error(`Cannot parse url '${this.url}'`);let h;i.indexOf(":")>-1?(h=i.substr(0,i.indexOf(":")),this.capture(h),this.capture(":")):n&&(h=Xn);const m=this.parseChildren();e[h]=1===Object.keys(m).length?m[Xn]:new Qn([],m),this.consumeOptional("//")}return e}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new Error(`Expected "${n}".`)}}class wT{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const e=this.pathFromRoot(n);return e.length>1?e[e.length-2]:null}children(n){const e=L1(n,this._root);return e?e.children.map(i=>i.value):[]}firstChild(n){const e=L1(n,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(n){const e=z1(n,this._root);return e.length<2?[]:e[e.length-2].children.map(s=>s.value).filter(s=>s!==n)}pathFromRoot(n){return z1(n,this._root).map(e=>e.value)}}function L1(t,n){if(t===n.value)return n;for(const e of n.children){const i=L1(t,e);if(i)return i}return null}function z1(t,n){if(t===n.value)return[n];for(const e of n.children){const i=z1(t,e);if(i.length)return i.unshift(n),i}return[]}class Nu{constructor(n,e){this.value=n,this.children=e}toString(){return`TreeNode(${this.value})`}}function Yf(t){const n={};return t&&t.children.forEach(e=>n[e.value.outlet]=e),n}class CT extends wT{constructor(n,e){super(n),this.snapshot=e,B1(this,n)}toString(){return this.snapshot.toString()}}function ST(t,n){const e=function(t,n){const m=new Uv([],{},{},"",{},Xn,n,null,t.root,-1,{});return new ET("",new Nu(m,[]))}(t,n),i=new xs([new ry("",{})]),s=new xs({}),h=new xs({}),m=new xs({}),S=new xs(""),I=new qf(i,s,m,S,h,Xn,n,e.root);return I.snapshot=e.root,new CT(new Nu(I,[]),e)}class qf{constructor(n,e,i,s,h,m,S,I){this.url=n,this.params=e,this.queryParams=i,this.fragment=s,this.data=h,this.outlet=m,this.component=S,this._futureSnapshot=I}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Kt(n=>Xf(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Kt(n=>Xf(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function DT(t,n="emptyOnly"){const e=t.pathFromRoot;let i=0;if("always"!==n)for(i=e.length-1;i>=1;){const s=e[i],h=e[i-1];if(s.routeConfig&&""===s.routeConfig.path)i--;else{if(h.component)break;i--}}return function(t){return t.reduce((n,e)=>({params:Qt(Qt({},n.params),e.params),data:Qt(Qt({},n.data),e.data),resolve:Qt(Qt({},n.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(e.slice(i))}class Uv{constructor(n,e,i,s,h,m,S,I,F,G,J){this.url=n,this.params=e,this.queryParams=i,this.fragment=s,this.data=h,this.outlet=m,this.component=S,this.routeConfig=I,this._urlSegment=F,this._lastPathIndex=G,this._resolve=J}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Xf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Xf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class ET extends wT{constructor(n,e){super(e),this.url=n,B1(this,e)}toString(){return AT(this._root)}}function B1(t,n){n.value._routerState=t,n.children.forEach(e=>B1(t,e))}function AT(t){const n=t.children.length>0?` { ${t.children.map(AT).join(", ")} } `:"";return`${t.value}${n}`}function V1(t){if(t.snapshot){const n=t.snapshot,e=t._futureSnapshot;t.snapshot=e,Qc(n.queryParams,e.queryParams)||t.queryParams.next(e.queryParams),n.fragment!==e.fragment&&t.fragment.next(e.fragment),Qc(n.params,e.params)||t.params.next(e.params),function(t,n){if(t.length!==n.length)return!1;for(let e=0;e<t.length;++e)if(!Qc(t[e],n[e]))return!1;return!0}(n.url,e.url)||t.url.next(e.url),Qc(n.data,e.data)||t.data.next(e.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function U1(t,n){const e=Qc(t.params,n.params)&&function(t,n){return ep(t,n)&&t.every((e,i)=>Qc(e.parameters,n[i].parameters))}(t.url,n.url);return e&&!(!t.parent!=!n.parent)&&(!t.parent||U1(t.parent,n.parent))}function oy(t,n,e){if(e&&t.shouldReuseRoute(n.value,e.value.snapshot)){const i=e.value;i._futureSnapshot=n.value;const s=function(t,n,e){return n.children.map(i=>{for(const s of e.children)if(t.shouldReuseRoute(i.value,s.value.snapshot))return oy(t,i,s);return oy(t,i)})}(t,n,e);return new Nu(i,s)}{if(t.shouldAttach(n.value)){const h=t.retrieve(n.value);if(null!==h){const m=h.route;return m.value._futureSnapshot=n.value,m.children=n.children.map(S=>oy(t,S)),m}}const i=function(t){return new qf(new xs(t.url),new xs(t.params),new xs(t.queryParams),new xs(t.fragment),new xs(t.data),t.outlet,t.component,t)}(n.value),s=n.children.map(h=>oy(t,h));return new Nu(i,s)}}function Hv(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function ay(t){return"object"==typeof t&&null!=t&&t.outlets}function H1(t,n,e,i,s){let h={};return i&&so(i,(m,S)=>{h[S]=Array.isArray(m)?m.map(I=>`${I}`):`${m}`}),new Qd(e.root===t?n:TT(e.root,t,n),h,s)}function TT(t,n,e){const i={};return so(t.children,(s,h)=>{i[h]=s===n?e:TT(s,n,e)}),new Qn(t.segments,i)}class MT{constructor(n,e,i){if(this.isAbsolute=n,this.numberOfDoubleDots=e,this.commands=i,n&&i.length>0&&Hv(i[0]))throw new Error("Root segment cannot have matrix parameters");const s=i.find(ay);if(s&&s!==hT(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class j1{constructor(n,e,i){this.segmentGroup=n,this.processChildren=e,this.index=i}}function kT(t,n,e){if(t||(t=new Qn([],{})),0===t.segments.length&&t.hasChildren())return jv(t,n,e);const i=function(t,n,e){let i=0,s=n;const h={match:!1,pathIndex:0,commandIndex:0};for(;s<t.segments.length;){if(i>=e.length)return h;const m=t.segments[s],S=e[i];if(ay(S))break;const I=`${S}`,F=i<e.length-1?e[i+1]:null;if(s>0&&void 0===I)break;if(I&&F&&"object"==typeof F&&void 0===F.outlets){if(!PT(I,F,m))return h;i+=2}else{if(!PT(I,{},m))return h;i++}s++}return{match:!0,pathIndex:s,commandIndex:i}}(t,n,e),s=e.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){const h=new Qn(t.segments.slice(0,i.pathIndex),{});return h.children[Xn]=new Qn(t.segments.slice(i.pathIndex),t.children),jv(h,0,s)}return i.match&&0===s.length?new Qn(t.segments,{}):i.match&&!t.hasChildren()?$1(t,n,e):i.match?jv(t,0,s):$1(t,n,e)}function jv(t,n,e){if(0===e.length)return new Qn(t.segments,{});{const i=function(t){return ay(t[0])?t[0].outlets:{[Xn]:t}}(e),s={};return so(i,(h,m)=>{"string"==typeof h&&(h=[h]),null!==h&&(s[m]=kT(t.children[m],n,h))}),so(t.children,(h,m)=>{void 0===i[m]&&(s[m]=h)}),new Qn(t.segments,s)}}function $1(t,n,e){const i=t.segments.slice(0,n);let s=0;for(;s<e.length;){const h=e[s];if(ay(h)){const I=pV(h.outlets);return new Qn(i,I)}if(0===s&&Hv(e[0])){i.push(new ry(t.segments[n].path,IT(e[0]))),s++;continue}const m=ay(h)?h.outlets[Xn]:`${h}`,S=s<e.length-1?e[s+1]:null;m&&S&&Hv(S)?(i.push(new ry(m,IT(S))),s+=2):(i.push(new ry(m,{})),s++)}return new Qn(i,{})}function pV(t){const n={};return so(t,(e,i)=>{"string"==typeof e&&(e=[e]),null!==e&&(n[i]=$1(new Qn([],{}),0,e))}),n}function IT(t){const n={};return so(t,(e,i)=>n[i]=`${e}`),n}function PT(t,n,e){return t==e.path&&Qc(n,e.parameters)}class gV{constructor(n,e,i,s){this.routeReuseStrategy=n,this.futureState=e,this.currState=i,this.forwardEvent=s}activate(n){const e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,n),V1(this.futureState.root),this.activateChildRoutes(e,i,n)}deactivateChildRoutes(n,e,i){const s=Yf(e);n.children.forEach(h=>{const m=h.value.outlet;this.deactivateRoutes(h,s[m],i),delete s[m]}),so(s,(h,m)=>{this.deactivateRouteAndItsChildren(h,i)})}deactivateRoutes(n,e,i){const s=n.value,h=e?e.value:null;if(s===h)if(s.component){const m=i.getContext(s.outlet);m&&this.deactivateChildRoutes(n,e,m.children)}else this.deactivateChildRoutes(n,e,i);else h&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(n,e){this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,e):this.deactivateRouteAndOutlet(n,e)}detachAndStoreRouteSubtree(n,e){const i=e.getContext(n.value.outlet),s=i&&n.value.component?i.children:e,h=Yf(n);for(const m of Object.keys(h))this.deactivateRouteAndItsChildren(h[m],s);if(i&&i.outlet){const m=i.outlet.detach(),S=i.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:m,route:n,contexts:S})}}deactivateRouteAndOutlet(n,e){const i=e.getContext(n.value.outlet),s=i&&n.value.component?i.children:e,h=Yf(n);for(const m of Object.keys(h))this.deactivateRouteAndItsChildren(h[m],s);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(n,e,i){const s=Yf(e);n.children.forEach(h=>{this.activateRoutes(h,s[h.value.outlet],i),this.forwardEvent(new F3(h.value.snapshot))}),n.children.length&&this.forwardEvent(new R3(n.value.snapshot))}activateRoutes(n,e,i){const s=n.value,h=e?e.value:null;if(V1(s),s===h)if(s.component){const m=i.getOrCreateContext(s.outlet);this.activateChildRoutes(n,e,m.children)}else this.activateChildRoutes(n,e,i);else if(s.component){const m=i.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const S=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),m.children.onOutletReAttached(S.contexts),m.attachRef=S.componentRef,m.route=S.route.value,m.outlet&&m.outlet.attach(S.componentRef,S.route.value),V1(S.route.value),this.activateChildRoutes(n,null,m.children)}else{const S=function(t){for(let n=t.parent;n;n=n.parent){const e=n.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig;if(e&&e.component)return null}return null}(s.snapshot),I=S?S.module.componentFactoryResolver:null;m.attachRef=null,m.route=s,m.resolver=I,m.outlet&&m.outlet.activateWith(s,I),this.activateChildRoutes(n,null,m.children)}}else this.activateChildRoutes(n,null,i)}}class G1{constructor(n,e){this.routes=n,this.module=e}}function Rh(t){return"function"==typeof t}function tp(t){return t instanceof Qd}const ly=Symbol("INITIAL_VALUE");function cy(){return Kc(t=>function(...t){const n=o(t),e=te(t),{args:i,keys:s}=ZA(t);if(0===i.length)return V([],n);const h=new Cn(function(t,n,e=as){return i=>{KA(n,()=>{const{length:s}=t,h=new Array(s);let m=s,S=s;for(let I=0;I<s;I++)KA(n,()=>{const F=V(t[I],n);let G=!1;F.subscribe(new vn(i,J=>{h[I]=J,G||(G=!0,S--),S||i.next(e(h.slice()))},()=>{--m||i.complete()}))},i)},i)}}(i,n,s?m=>JA(s,m):as));return e?h.pipe(I1(e)):h}(t.map(n=>n.pipe(q(1),function(...t){const n=o(t);return ni((e,i)=>{(n?ny(t,e,n):ny(t,e)).subscribe(i)})}(ly)))).pipe(tT((n,e)=>{let i=!1;return e.reduce((s,h,m)=>s!==ly?s:(h===ly&&(i=!0),i||!1!==h&&m!==e.length-1&&!tp(h)?s:h),n)},ly),Wr(n=>n!==ly),Kt(n=>tp(n)?n:!0===n),q(1)))}class wV{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new uy,this.attachRef=null}}class uy{constructor(){this.contexts=new Map}onChildOutletCreated(n,e){const i=this.getOrCreateContext(n);i.outlet=e,this.contexts.set(n,i)}onChildOutletDestroyed(n){const e=this.getContext(n);e&&(e.outlet=null,e.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let e=this.getContext(n);return e||(e=new wV,this.contexts.set(n,e)),e}getContext(n){return this.contexts.get(n)||null}}let W1=(()=>{class t{constructor(e,i,s,h,m){this.parentContexts=e,this.location=i,this.resolver=s,this.changeDetector=m,this.activated=null,this._activatedRoute=null,this.activateEvents=new ut,this.deactivateEvents=new ut,this.attachEvents=new ut,this.detachEvents=new ut,this.name=h||Xn,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,i){this.activated=e,this._activatedRoute=i,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,i){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;const m=(i=i||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),S=this.parentContexts.getOrCreateContext(this.name).children,I=new CV(e,S,this.location.injector);this.activated=this.location.createComponent(m,this.location.length,I),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(Ne(uy),Ne(na),Ne(La),function(t){return function(t,n){if("class"===n)return t.classes;if("style"===n)return t.styles;const e=t.attrs;if(e){const i=e.length;let s=0;for(;s<i;){const h=e[s];if(sn(h))break;if(0===h)s+=2;else if("number"==typeof h)for(s++;s<i&&"string"==typeof e[s];)s++;else{if(h===n)return e[s+1];s+=2}}}return null}($i(),t)}("name"),Ne(io))},t.\u0275dir=Rt({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),t})();class CV{constructor(n,e,i){this.route=n,this.childContexts=e,this.parent=i}get(n,e){return n===qf?this.route:n===uy?this.childContexts:this.parent.get(n,e)}}let RT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Jn({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,i){1&e&&Fi(0,"router-outlet")},directives:[W1],encapsulation:2}),t})();function NT(t,n=""){for(let e=0;e<t.length;e++){const i=t[e];SV(i,DV(n,i))}}function SV(t,n){t.children&&NT(t.children,n)}function DV(t,n){return n?t||n.path?t&&!n.path?`${t}/`:!t&&n.path?n.path:`${t}/${n.path}`:"":t}function X1(t){const n=t.children&&t.children.map(X1),e=n?Vs(Qt({},t),{children:n}):Qt({},t);return!e.component&&(n||e.loadChildren)&&e.outlet&&e.outlet!==Xn&&(e.component=RT),e}function ul(t){return t.outlet||Xn}function FT(t,n){const e=t.filter(i=>ul(i)===n);return e.push(...t.filter(i=>ul(i)!==n)),e}const OT={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function $v(t,n,e){var S;if(""===n.path)return"full"===n.pathMatch&&(t.hasChildren()||e.length>0)?Qt({},OT):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const s=(n.matcher||z3)(e,t,n);if(!s)return Qt({},OT);const h={};so(s.posParams,(I,F)=>{h[F]=I.path});const m=s.consumed.length>0?Qt(Qt({},h),s.consumed[s.consumed.length-1].parameters):h;return{matched:!0,consumedSegments:s.consumed,lastChild:s.consumed.length,parameters:m,positionalParamSegments:null!=(S=s.posParams)?S:{}}}function Gv(t,n,e,i,s="corrected"){if(e.length>0&&function(t,n,e){return e.some(i=>Wv(t,n,i)&&ul(i)!==Xn)}(t,e,i)){const m=new Qn(n,function(t,n,e,i){const s={};s[Xn]=i,i._sourceSegment=t,i._segmentIndexShift=n.length;for(const h of e)if(""===h.path&&ul(h)!==Xn){const m=new Qn([],{});m._sourceSegment=t,m._segmentIndexShift=n.length,s[ul(h)]=m}return s}(t,n,i,new Qn(e,t.children)));return m._sourceSegment=t,m._segmentIndexShift=n.length,{segmentGroup:m,slicedSegments:[]}}if(0===e.length&&function(t,n,e){return e.some(i=>Wv(t,n,i))}(t,e,i)){const m=new Qn(t.segments,function(t,n,e,i,s,h){const m={};for(const S of i)if(Wv(t,e,S)&&!s[ul(S)]){const I=new Qn([],{});I._sourceSegment=t,I._segmentIndexShift="legacy"===h?t.segments.length:n.length,m[ul(S)]=I}return Qt(Qt({},s),m)}(t,n,e,i,t.children,s));return m._sourceSegment=t,m._segmentIndexShift=n.length,{segmentGroup:m,slicedSegments:e}}const h=new Qn(t.segments,t.children);return h._sourceSegment=t,h._segmentIndexShift=n.length,{segmentGroup:h,slicedSegments:e}}function Wv(t,n,e){return(!(t.hasChildren()||n.length>0)||"full"!==e.pathMatch)&&""===e.path}function LT(t,n,e,i){return!!(ul(t)===i||i!==Xn&&Wv(n,e,t))&&("**"===t.path||$v(n,t,e).matched)}function zT(t,n,e){return 0===n.length&&!t.children[e]}class hy{constructor(n){this.segmentGroup=n||null}}class BT{constructor(n){this.urlTree=n}}function Xv(t){return new Cn(n=>n.error(new hy(t)))}function VT(t){return new Cn(n=>n.error(new BT(t)))}function kV(t){return new Cn(n=>n.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class RV{constructor(n,e,i,s,h){this.configLoader=e,this.urlSerializer=i,this.urlTree=s,this.config=h,this.allowRedirects=!0,this.ngModule=n.get(Yc)}apply(){const n=Gv(this.urlTree.root,[],[],this.config).segmentGroup,e=new Qn(n.segments,n.children);return this.expandSegmentGroup(this.ngModule,this.config,e,Xn).pipe(Kt(h=>this.createUrlTree(Y1(h),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ph(h=>{if(h instanceof BT)return this.allowRedirects=!1,this.match(h.urlTree);throw h instanceof hy?this.noMatchError(h):h}))}match(n){return this.expandSegmentGroup(this.ngModule,this.config,n.root,Xn).pipe(Kt(s=>this.createUrlTree(Y1(s),n.queryParams,n.fragment))).pipe(Ph(s=>{throw s instanceof hy?this.noMatchError(s):s}))}noMatchError(n){return new Error(`Cannot match any routes. URL Segment: '${n.segmentGroup}'`)}createUrlTree(n,e,i){const s=n.segments.length>0?new Qn([],{[Xn]:n}):n;return new Qd(s,e,i)}expandSegmentGroup(n,e,i,s){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(n,e,i).pipe(Kt(h=>new Qn([],h))):this.expandSegment(n,i,e,i.segments,s,!0)}expandChildren(n,e,i){const s=[];for(const h of Object.keys(i.children))"primary"===h?s.unshift(h):s.push(h);return V(s).pipe(Wf(h=>{const m=i.children[h],S=FT(e,h);return this.expandSegmentGroup(n,S,m,h).pipe(Kt(I=>({segment:I,outlet:h})))}),tT((h,m)=>(h[m.outlet]=m.segment,h),{}),function(t,n){const e=arguments.length>=2;return i=>i.pipe(t?Wr((s,h)=>t(s,h,i)):as,R1(1),e?iT(n):nT(()=>new Nv))}())}expandSegment(n,e,i,s,h,m){return V(i).pipe(Wf(S=>this.expandSegmentAgainstRoute(n,e,i,S,s,h,m).pipe(Ph(F=>{if(F instanceof hy)return fn(null);throw F}))),Kd(S=>!!S),Ph((S,I)=>{if(S instanceof Nv||"EmptyError"===S.name){if(zT(e,s,h))return fn(new Qn([],{}));throw new hy(e)}throw S}))}expandSegmentAgainstRoute(n,e,i,s,h,m,S){return LT(s,e,h,m)?void 0===s.redirectTo?this.matchSegmentAgainstRoute(n,e,s,h,m):S&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,e,i,s,h,m):Xv(e):Xv(e)}expandSegmentAgainstRouteUsingRedirect(n,e,i,s,h,m){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,i,s,m):this.expandRegularSegmentAgainstRouteUsingRedirect(n,e,i,s,h,m)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,e,i,s){const h=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?VT(h):this.lineralizeSegments(i,h).pipe(Ie(m=>{const S=new Qn(m,{});return this.expandSegment(n,S,e,m,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,e,i,s,h,m){const{matched:S,consumedSegments:I,lastChild:F,positionalParamSegments:G}=$v(e,s,h);if(!S)return Xv(e);const J=this.applyRedirectCommands(I,s.redirectTo,G);return s.redirectTo.startsWith("/")?VT(J):this.lineralizeSegments(s,J).pipe(Ie(re=>this.expandSegment(n,e,i,re.concat(h.slice(F)),m,!1)))}matchSegmentAgainstRoute(n,e,i,s,h){if("**"===i.path)return i.loadChildren?(i._loadedConfig?fn(i._loadedConfig):this.configLoader.load(n.injector,i)).pipe(Kt(re=>(i._loadedConfig=re,new Qn(s,{})))):fn(new Qn(s,{}));const{matched:m,consumedSegments:S,lastChild:I}=$v(e,i,s);if(!m)return Xv(e);const F=s.slice(I);return this.getChildConfig(n,i,s).pipe(Ie(J=>{const re=J.module,he=J.routes,{segmentGroup:Se,slicedSegments:ze}=Gv(e,S,F,he),Le=new Qn(Se.segments,Se.children);if(0===ze.length&&Le.hasChildren())return this.expandChildren(re,he,Le).pipe(Kt(Wt=>new Qn(S,Wt)));if(0===he.length&&0===ze.length)return fn(new Qn(S,{}));const et=ul(i)===h;return this.expandSegment(re,Le,he,ze,et?Xn:h,!0).pipe(Kt(Ht=>new Qn(S.concat(Ht.segments),Ht.children)))}))}getChildConfig(n,e,i){return e.children?fn(new G1(e.children,n)):e.loadChildren?void 0!==e._loadedConfig?fn(e._loadedConfig):this.runCanLoadGuards(n.injector,e,i).pipe(Ie(s=>{return s?this.configLoader.load(n.injector,e).pipe(Kt(h=>(e._loadedConfig=h,h))):(t=e,new Cn(n=>n.error(F1(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`))));var t})):fn(new G1([],n))}runCanLoadGuards(n,e,i){const s=e.canLoad;return s&&0!==s.length?fn(s.map(m=>{const S=n.get(m);let I;if((t=S)&&Rh(t.canLoad))I=S.canLoad(e,i);else{if(!Rh(S))throw new Error("Invalid CanLoad guard");I=S(e,i)}var t;return eu(I)})).pipe(cy(),ro(m=>{if(!tp(m))return;const S=F1(`Redirecting to "${this.urlSerializer.serialize(m)}"`);throw S.url=m,S}),Kt(m=>!0===m)):fn(!0)}lineralizeSegments(n,e){let i=[],s=e.root;for(;;){if(i=i.concat(s.segments),0===s.numberOfChildren)return fn(i);if(s.numberOfChildren>1||!s.children[Xn])return kV(n.redirectTo);s=s.children[Xn]}}applyRedirectCommands(n,e,i){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),n,i)}applyRedirectCreatreUrlTree(n,e,i,s){const h=this.createSegmentGroup(n,e.root,i,s);return new Qd(h,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(n,e){const i={};return so(n,(s,h)=>{if("string"==typeof s&&s.startsWith(":")){const S=s.substring(1);i[h]=e[S]}else i[h]=s}),i}createSegmentGroup(n,e,i,s){const h=this.createSegments(n,e.segments,i,s);let m={};return so(e.children,(S,I)=>{m[I]=this.createSegmentGroup(n,S,i,s)}),new Qn(h,m)}createSegments(n,e,i,s){return e.map(h=>h.path.startsWith(":")?this.findPosParam(n,h,s):this.findOrReturn(h,i))}findPosParam(n,e,i){const s=i[e.path.substring(1)];if(!s)throw new Error(`Cannot redirect to '${n}'. Cannot find '${e.path}'.`);return s}findOrReturn(n,e){let i=0;for(const s of e){if(s.path===n.path)return e.splice(i),s;i++}return n}}function Y1(t){const n={};for(const i of Object.keys(t.children)){const h=Y1(t.children[i]);(h.segments.length>0||h.hasChildren())&&(n[i]=h)}return function(t){if(1===t.numberOfChildren&&t.children[Xn]){const n=t.children[Xn];return new Qn(t.segments.concat(n.segments),n.children)}return t}(new Qn(t.segments,n))}class UT{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class Yv{constructor(n,e){this.component=n,this.route=e}}function OV(t,n,e){const i=t._root;return dy(i,n?n._root:null,e,[i.value])}function qv(t,n,e){const i=function(t){if(!t)return null;for(let n=t.parent;n;n=n.parent){const e=n.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig}return null}(n);return(i?i.module.injector:e).get(t)}function dy(t,n,e,i,s={canDeactivateChecks:[],canActivateChecks:[]}){const h=Yf(n);return t.children.forEach(m=>{(function(t,n,e,i,s={canDeactivateChecks:[],canActivateChecks:[]}){const h=t.value,m=n?n.value:null,S=e?e.getContext(t.value.outlet):null;if(m&&h.routeConfig===m.routeConfig){const I=function(t,n,e){if("function"==typeof e)return e(t,n);switch(e){case"pathParamsChange":return!ep(t.url,n.url);case"pathParamsOrQueryParamsChange":return!ep(t.url,n.url)||!Qc(t.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!U1(t,n)||!Qc(t.queryParams,n.queryParams);default:return!U1(t,n)}}(m,h,h.routeConfig.runGuardsAndResolvers);I?s.canActivateChecks.push(new UT(i)):(h.data=m.data,h._resolvedData=m._resolvedData),dy(t,n,h.component?S?S.children:null:e,i,s),I&&S&&S.outlet&&S.outlet.isActivated&&s.canDeactivateChecks.push(new Yv(S.outlet.component,m))}else m&&py(n,S,s),s.canActivateChecks.push(new UT(i)),dy(t,null,h.component?S?S.children:null:e,i,s)})(m,h[m.value.outlet],e,i.concat([m.value]),s),delete h[m.value.outlet]}),so(h,(m,S)=>py(m,e.getContext(S),s)),s}function py(t,n,e){const i=Yf(t),s=t.value;so(i,(h,m)=>{py(h,s.component?n?n.children.getContext(m):null:n,e)}),e.canDeactivateChecks.push(new Yv(s.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,s))}class qV{}function HT(t){return new Cn(n=>n.error(t))}class JV{constructor(n,e,i,s,h,m){this.rootComponentType=n,this.config=e,this.urlTree=i,this.url=s,this.paramsInheritanceStrategy=h,this.relativeLinkResolution=m}recognize(){const n=Gv(this.urlTree.root,[],[],this.config.filter(m=>void 0===m.redirectTo),this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,n,Xn);if(null===e)return null;const i=new Uv([],Object.freeze({}),Object.freeze(Qt({},this.urlTree.queryParams)),this.urlTree.fragment,{},Xn,this.rootComponentType,null,this.urlTree.root,-1,{}),s=new Nu(i,e),h=new ET(this.url,s);return this.inheritParamsAndData(h._root),h}inheritParamsAndData(n){const e=n.value,i=DT(e,this.paramsInheritanceStrategy);e.params=Object.freeze(i.params),e.data=Object.freeze(i.data),n.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(n,e,i){return 0===e.segments.length&&e.hasChildren()?this.processChildren(n,e):this.processSegment(n,e,e.segments,i)}processChildren(n,e){const i=[];for(const h of Object.keys(e.children)){const m=e.children[h],S=FT(n,h),I=this.processSegmentGroup(S,m,h);if(null===I)return null;i.push(...I)}const s=jT(i);return s.sort((n,e)=>n.value.outlet===Xn?-1:e.value.outlet===Xn?1:n.value.outlet.localeCompare(e.value.outlet)),s}processSegment(n,e,i,s){for(const h of n){const m=this.processSegmentAgainstRoute(h,e,i,s);if(null!==m)return m}return zT(e,i,s)?[]:null}processSegmentAgainstRoute(n,e,i,s){if(n.redirectTo||!LT(n,e,i,s))return null;let h,m=[],S=[];if("**"===n.path){const he=i.length>0?hT(i).parameters:{};h=new Uv(i,he,Object.freeze(Qt({},this.urlTree.queryParams)),this.urlTree.fragment,WT(n),ul(n),n.component,n,$T(e),GT(e)+i.length,XT(n))}else{const he=$v(e,n,i);if(!he.matched)return null;m=he.consumedSegments,S=i.slice(he.lastChild),h=new Uv(m,he.parameters,Object.freeze(Qt({},this.urlTree.queryParams)),this.urlTree.fragment,WT(n),ul(n),n.component,n,$T(e),GT(e)+m.length,XT(n))}const I=(t=n).children?t.children:t.loadChildren?t._loadedConfig.routes:[],{segmentGroup:F,slicedSegments:G}=Gv(e,m,S,I.filter(he=>void 0===he.redirectTo),this.relativeLinkResolution);var t;if(0===G.length&&F.hasChildren()){const he=this.processChildren(I,F);return null===he?null:[new Nu(h,he)]}if(0===I.length&&0===G.length)return[new Nu(h,[])];const J=ul(n)===s,re=this.processSegment(I,F,G,J?Xn:s);return null===re?null:[new Nu(h,re)]}}function e5(t){const n=t.value.routeConfig;return n&&""===n.path&&void 0===n.redirectTo}function jT(t){const n=[],e=new Set;for(const i of t){if(!e5(i)){n.push(i);continue}const s=n.find(h=>i.value.routeConfig===h.value.routeConfig);void 0!==s?(s.children.push(...i.children),e.add(s)):n.push(i)}for(const i of e){const s=jT(i.children);n.push(new Nu(i.value,s))}return n.filter(i=>!e.has(i))}function $T(t){let n=t;for(;n._sourceSegment;)n=n._sourceSegment;return n}function GT(t){let n=t,e=n._segmentIndexShift?n._segmentIndexShift:0;for(;n._sourceSegment;)n=n._sourceSegment,e+=n._segmentIndexShift?n._segmentIndexShift:0;return e-1}function WT(t){return t.data||{}}function XT(t){return t.resolve||{}}function q1(t){return Kc(n=>{const e=t(n);return e?V(e).pipe(Kt(()=>n)):fn(n)})}class l5 extends class{shouldDetach(n){return!1}store(n,e){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,e){return n.routeConfig===e.routeConfig}}{}const Z1=new on("ROUTES");class YT{constructor(n,e,i,s){this.injector=n,this.compiler=e,this.onLoadStartListener=i,this.onLoadEndListener=s}load(n,e){if(e._loader$)return e._loader$;this.onLoadStartListener&&this.onLoadStartListener(e);const s=this.loadModuleFactory(e.loadChildren).pipe(Kt(h=>{this.onLoadEndListener&&this.onLoadEndListener(e);const m=h.create(n);return new G1(uT(m.injector.get(Z1,void 0,Xt.Self|Xt.Optional)).map(X1),m)}),Ph(h=>{throw e._loader$=void 0,h}));return e._loader$=new b3(s,()=>new Dn).pipe(eT()),e._loader$}loadModuleFactory(n){return eu(n()).pipe(Ie(e=>e instanceof bD?fn(e):V(this.compiler.compileModuleAsync(e))))}}class u5{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,e){return n}}function h5(t){throw t}function d5(t,n,e){return n.parse("/")}function qT(t,n){return fn(null)}const p5={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},f5={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ba=(()=>{class t{constructor(e,i,s,h,m,S,I){this.rootComponentType=e,this.urlSerializer=i,this.rootContexts=s,this.location=h,this.config=I,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Dn,this.errorHandler=h5,this.malformedUriErrorHandler=d5,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:qT,afterPreactivation:qT},this.urlHandlingStrategy=new u5,this.routeReuseStrategy=new l5,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=m.get(Yc),this.console=m.get(rv);const J=m.get(jn);this.isNgZoneEnabled=J instanceof jn&&jn.isInAngularZone(),this.resetConfig(I),this.currentUrlTree=new Qd(new Qn([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new YT(m,S,re=>this.triggerEvent(new sT(re)),re=>this.triggerEvent(new oT(re))),this.routerState=ST(this.currentUrlTree,this.rootComponentType),this.transitions=new xs({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var e;return null==(e=this.location.getState())?void 0:e.\u0275routerPageId}setupNavigations(e){const i=this.events;return e.pipe(Wr(s=>0!==s.id),Kt(s=>Vs(Qt({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Kc(s=>{let h=!1,m=!1;return fn(s).pipe(ro(S=>{this.currentNavigation={id:S.id,initialUrl:S.currentRawUrl,extractedUrl:S.extractedUrl,trigger:S.source,extras:S.extras,previousNavigation:this.lastSuccessfulNavigation?Vs(Qt({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Kc(S=>{const I=this.browserUrlTree.toString(),F=!this.navigated||S.extractedUrl.toString()!==I||I!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||F)&&this.urlHandlingStrategy.shouldProcessUrl(S.rawUrl))return Zv(S.source)&&(this.browserUrlTree=S.extractedUrl),fn(S).pipe(Kc(J=>{const re=this.transitions.getValue();return i.next(new N1(J.id,this.serializeUrl(J.extractedUrl),J.source,J.restoredState)),re!==this.transitions.getValue()?Ue:Promise.resolve(J)}),function(t,n,e,i){return Kc(s=>function(t,n,e,i,s){return new RV(t,n,e,i,s).apply()}(t,n,e,s.extractedUrl,i).pipe(Kt(h=>Vs(Qt({},s),{urlAfterRedirects:h}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),ro(J=>{this.currentNavigation=Vs(Qt({},this.currentNavigation),{finalUrl:J.urlAfterRedirects})}),function(t,n,e,i,s){return Ie(h=>function(t,n,e,i,s="emptyOnly",h="legacy"){try{const m=new JV(t,n,e,i,s,h).recognize();return null===m?HT(new qV):fn(m)}catch(m){return HT(m)}}(t,n,h.urlAfterRedirects,e(h.urlAfterRedirects),i,s).pipe(Kt(m=>Vs(Qt({},h),{targetSnapshot:m}))))}(this.rootComponentType,this.config,J=>this.serializeUrl(J),this.paramsInheritanceStrategy,this.relativeLinkResolution),ro(J=>{if("eager"===this.urlUpdateStrategy){if(!J.extras.skipLocationChange){const he=this.urlHandlingStrategy.merge(J.urlAfterRedirects,J.rawUrl);this.setBrowserUrl(he,J)}this.browserUrlTree=J.urlAfterRedirects}const re=new A3(J.id,this.serializeUrl(J.extractedUrl),this.serializeUrl(J.urlAfterRedirects),J.targetSnapshot);i.next(re)}));if(F&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:re,extractedUrl:he,source:Se,restoredState:ze,extras:Le}=S,et=new N1(re,this.serializeUrl(he),Se,ze);i.next(et);const Ze=ST(he,this.rootComponentType).snapshot;return fn(Vs(Qt({},S),{targetSnapshot:Ze,urlAfterRedirects:he,extras:Vs(Qt({},Le),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=S.rawUrl,S.resolve(null),Ue}),q1(S=>{const{targetSnapshot:I,id:F,extractedUrl:G,rawUrl:J,extras:{skipLocationChange:re,replaceUrl:he}}=S;return this.hooks.beforePreactivation(I,{navigationId:F,appliedUrlTree:G,rawUrlTree:J,skipLocationChange:!!re,replaceUrl:!!he})}),ro(S=>{const I=new T3(S.id,this.serializeUrl(S.extractedUrl),this.serializeUrl(S.urlAfterRedirects),S.targetSnapshot);this.triggerEvent(I)}),Kt(S=>Vs(Qt({},S),{guards:OV(S.targetSnapshot,S.currentSnapshot,this.rootContexts)})),function(t,n){return Ie(e=>{const{targetSnapshot:i,currentSnapshot:s,guards:{canActivateChecks:h,canDeactivateChecks:m}}=e;return 0===m.length&&0===h.length?fn(Vs(Qt({},e),{guardsResult:!0})):function(t,n,e,i){return V(t).pipe(Ie(s=>function(t,n,e,i,s){const h=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return h&&0!==h.length?fn(h.map(S=>{const I=qv(S,n,s);let F;if(function(t){return t&&Rh(t.canDeactivate)}(I))F=eu(I.canDeactivate(t,n,e,i));else{if(!Rh(I))throw new Error("Invalid CanDeactivate guard");F=eu(I(t,n,e,i))}return F.pipe(Kd())})).pipe(cy()):fn(!0)}(s.component,s.route,e,n,i)),Kd(s=>!0!==s,!0))}(m,i,s,t).pipe(Ie(S=>S&&function(t){return"boolean"==typeof t}(S)?function(t,n,e,i){return V(n).pipe(Wf(s=>ny(function(t,n){return null!==t&&n&&n(new P3(t)),fn(!0)}(s.route.parent,i),function(t,n){return null!==t&&n&&n(new N3(t)),fn(!0)}(s.route,i),function(t,n,e){const i=n[n.length-1],h=n.slice(0,n.length-1).reverse().map(m=>function(t){const n=t.routeConfig?t.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:t,guards:n}:null}(m)).filter(m=>null!==m).map(m=>QA(()=>fn(m.guards.map(I=>{const F=qv(I,m.node,e);let G;if(function(t){return t&&Rh(t.canActivateChild)}(F))G=eu(F.canActivateChild(i,t));else{if(!Rh(F))throw new Error("Invalid CanActivateChild guard");G=eu(F(i,t))}return G.pipe(Kd())})).pipe(cy())));return fn(h).pipe(cy())}(t,s.path,e),function(t,n,e){const i=n.routeConfig?n.routeConfig.canActivate:null;if(!i||0===i.length)return fn(!0);const s=i.map(h=>QA(()=>{const m=qv(h,n,e);let S;if(function(t){return t&&Rh(t.canActivate)}(m))S=eu(m.canActivate(n,t));else{if(!Rh(m))throw new Error("Invalid CanActivate guard");S=eu(m(n,t))}return S.pipe(Kd())}));return fn(s).pipe(cy())}(t,s.route,e))),Kd(s=>!0!==s,!0))}(i,h,t,n):fn(S)),Kt(S=>Vs(Qt({},e),{guardsResult:S})))})}(this.ngModule.injector,S=>this.triggerEvent(S)),ro(S=>{if(tp(S.guardsResult)){const F=F1(`Redirecting to "${this.serializeUrl(S.guardsResult)}"`);throw F.url=S.guardsResult,F}const I=new M3(S.id,this.serializeUrl(S.extractedUrl),this.serializeUrl(S.urlAfterRedirects),S.targetSnapshot,!!S.guardsResult);this.triggerEvent(I)}),Wr(S=>!!S.guardsResult||(this.restoreHistory(S),this.cancelNavigationTransition(S,""),!1)),q1(S=>{if(S.guards.canActivateChecks.length)return fn(S).pipe(ro(I=>{const F=new k3(I.id,this.serializeUrl(I.extractedUrl),this.serializeUrl(I.urlAfterRedirects),I.targetSnapshot);this.triggerEvent(F)}),Kc(I=>{let F=!1;return fn(I).pipe(function(t,n){return Ie(e=>{const{targetSnapshot:i,guards:{canActivateChecks:s}}=e;if(!s.length)return fn(e);let h=0;return V(s).pipe(Wf(m=>function(t,n,e,i){return function(t,n,e,i){const s=Object.keys(t);if(0===s.length)return fn({});const h={};return V(s).pipe(Ie(m=>function(t,n,e,i){const s=qv(t,n,i);return eu(s.resolve?s.resolve(n,e):s(n,e))}(t[m],n,e,i).pipe(ro(S=>{h[m]=S}))),R1(1),Ie(()=>Object.keys(h).length===s.length?fn(h):Ue))}(t._resolve,t,n,i).pipe(Kt(h=>(t._resolvedData=h,t.data=Qt(Qt({},t.data),DT(t,e).resolve),null)))}(m.route,i,t,n)),ro(()=>h++),R1(1),Ie(m=>h===s.length?fn(e):Ue))})}(this.paramsInheritanceStrategy,this.ngModule.injector),ro({next:()=>F=!0,complete:()=>{F||(this.restoreHistory(I),this.cancelNavigationTransition(I,"At least one route resolver didn't emit any value."))}}))}),ro(I=>{const F=new I3(I.id,this.serializeUrl(I.extractedUrl),this.serializeUrl(I.urlAfterRedirects),I.targetSnapshot);this.triggerEvent(F)}))}),q1(S=>{const{targetSnapshot:I,id:F,extractedUrl:G,rawUrl:J,extras:{skipLocationChange:re,replaceUrl:he}}=S;return this.hooks.afterPreactivation(I,{navigationId:F,appliedUrlTree:G,rawUrlTree:J,skipLocationChange:!!re,replaceUrl:!!he})}),Kt(S=>{const I=function(t,n,e){const i=oy(t,n._root,e?e._root:void 0);return new CT(i,n)}(this.routeReuseStrategy,S.targetSnapshot,S.currentRouterState);return Vs(Qt({},S),{targetRouterState:I})}),ro(S=>{this.currentUrlTree=S.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(S.urlAfterRedirects,S.rawUrl),this.routerState=S.targetRouterState,"deferred"===this.urlUpdateStrategy&&(S.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,S),this.browserUrlTree=S.urlAfterRedirects)}),((t,n,e)=>Kt(i=>(new gV(n,i.targetRouterState,i.currentRouterState,e).activate(t),i)))(this.rootContexts,this.routeReuseStrategy,S=>this.triggerEvent(S)),ro({next(){h=!0},complete(){h=!0}}),function(t){return ni((n,e)=>{try{n.subscribe(e)}finally{e.add(t)}})}(()=>{var S;h||m||this.cancelNavigationTransition(s,`Navigation ID ${s.id} is not equal to the current navigation id ${this.navigationId}`),(null==(S=this.currentNavigation)?void 0:S.id)===s.id&&(this.currentNavigation=null)}),Ph(S=>{if(m=!0,function(t){return t&&t[lT]}(S)){const I=tp(S.url);I||(this.navigated=!0,this.restoreHistory(s,!0));const F=new rT(s.id,this.serializeUrl(s.extractedUrl),S.message);i.next(F),I?setTimeout(()=>{const G=this.urlHandlingStrategy.merge(S.url,this.rawUrlTree),J={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Zv(s.source)};this.scheduleNavigation(G,"imperative",null,J,{resolve:s.resolve,reject:s.reject,promise:s.promise})},0):s.resolve(!1)}else{this.restoreHistory(s,!0);const I=new E3(s.id,this.serializeUrl(s.extractedUrl),S);i.next(I);try{s.resolve(this.errorHandler(S))}catch(F){s.reject(F)}}return Ue}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next(Qt(Qt({},this.transitions.value),e))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const i="popstate"===e.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{var S;const s={replaceUrl:!0},h=(null==(S=e.state)?void 0:S.navigationId)?e.state:null;if(h){const I=Qt({},h);delete I.navigationId,delete I.\u0275routerPageId,0!==Object.keys(I).length&&(s.state=I)}const m=this.parseUrl(e.url);this.scheduleNavigation(m,i,h,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){NT(e),this.config=e.map(X1),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,i={}){const{relativeTo:s,queryParams:h,fragment:m,queryParamsHandling:S,preserveFragment:I}=i,F=s||this.routerState.root,G=I?this.currentUrlTree.fragment:m;let J=null;switch(S){case"merge":J=Qt(Qt({},this.currentUrlTree.queryParams),h);break;case"preserve":J=this.currentUrlTree.queryParams;break;default:J=h||null}return null!==J&&(J=this.removeEmptyProps(J)),function(t,n,e,i,s){if(0===e.length)return H1(n.root,n.root,n,i,s);const h=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new MT(!0,0,t);let n=0,e=!1;const i=t.reduce((s,h,m)=>{if("object"==typeof h&&null!=h){if(h.outlets){const S={};return so(h.outlets,(I,F)=>{S[F]="string"==typeof I?I.split("/"):I}),[...s,{outlets:S}]}if(h.segmentPath)return[...s,h.segmentPath]}return"string"!=typeof h?[...s,h]:0===m?(h.split("/").forEach((S,I)=>{0==I&&"."===S||(0==I&&""===S?e=!0:".."===S?n++:""!=S&&s.push(S))}),s):[...s,h]},[]);return new MT(e,n,i)}(e);if(h.toRoot())return H1(n.root,new Qn([],{}),n,i,s);const m=function(t,n,e){if(t.isAbsolute)return new j1(n.root,!0,0);if(-1===e.snapshot._lastPathIndex){const h=e.snapshot._urlSegment;return new j1(h,h===n.root,0)}const i=Hv(t.commands[0])?0:1;return function(t,n,e){let i=t,s=n,h=e;for(;h>s;){if(h-=s,i=i.parent,!i)throw new Error("Invalid number of '../'");s=i.segments.length}return new j1(i,!1,s-h)}(e.snapshot._urlSegment,e.snapshot._lastPathIndex+i,t.numberOfDoubleDots)}(h,n,t),S=m.processChildren?jv(m.segmentGroup,m.index,h.commands):kT(m.segmentGroup,m.index,h.commands);return H1(m.segmentGroup,S,n,i,s)}(F,this.currentUrlTree,e,J,null!=G?G:null)}navigateByUrl(e,i={skipLocationChange:!1}){const s=tp(e)?e:this.parseUrl(e),h=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(h,"imperative",null,i)}navigate(e,i={skipLocationChange:!1}){return function(t){for(let n=0;n<t.length;n++){const e=t[n];if(null==e)throw new Error(`The requested path contains ${e} segment at index ${n}`)}}(e),this.navigateByUrl(this.createUrlTree(e,i),i)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let i;try{i=this.urlSerializer.parse(e)}catch(s){i=this.malformedUriErrorHandler(s,this.urlSerializer,e)}return i}isActive(e,i){let s;if(s=!0===i?Qt({},p5):!1===i?Qt({},f5):i,tp(e))return pT(this.currentUrlTree,e,s);const h=this.parseUrl(e);return pT(this.currentUrlTree,h,s)}removeEmptyProps(e){return Object.keys(e).reduce((i,s)=>{const h=e[s];return null!=h&&(i[s]=h),i},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new iy(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,i,s,h,m){var et,Ze,Ht;if(this.disposed)return Promise.resolve(!1);const S=this.transitions.value,I=Zv(i)&&S&&!Zv(S.source),F=S.rawUrl.toString()===e.toString(),G=S.id===(null==(et=this.currentNavigation)?void 0:et.id);if(I&&F&&G)return Promise.resolve(!0);let re,he,Se;m?(re=m.resolve,he=m.reject,Se=m.promise):Se=new Promise((Wt,gn)=>{re=Wt,he=gn});const ze=++this.navigationId;let Le;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(s=this.location.getState()),Le=s&&s.\u0275routerPageId?s.\u0275routerPageId:h.replaceUrl||h.skipLocationChange?null!=(Ze=this.browserPageId)?Ze:0:(null!=(Ht=this.browserPageId)?Ht:0)+1):Le=0,this.setTransition({id:ze,targetPageId:Le,source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:h,resolve:re,reject:he,promise:Se,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Se.catch(Wt=>Promise.reject(Wt))}setBrowserUrl(e,i){const s=this.urlSerializer.serialize(e),h=Qt(Qt({},i.extras.state),this.generateNgRouterState(i.id,i.targetPageId));this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl?this.location.replaceState(s,"",h):this.location.go(s,"",h)}restoreHistory(e,i=!1){var s,h;if("computed"===this.canceledNavigationResolution){const m=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null==(s=this.currentNavigation)?void 0:s.finalUrl)||0===m?this.currentUrlTree===(null==(h=this.currentNavigation)?void 0:h.finalUrl)&&0===m&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(m)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,i){const s=new rT(e.id,this.serializeUrl(e.extractedUrl),i);this.triggerEvent(s),e.resolve(!1)}generateNgRouterState(e,i){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:i}:{navigationId:e}}}return t.\u0275fac=function(e){Gb()},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();function Zv(t){return"imperative"!==t}class ZT{}class JT{preload(n,e){return fn(null)}}let KT=(()=>{class t{constructor(e,i,s,h){this.router=e,this.injector=s,this.preloadingStrategy=h,this.loader=new YT(s,i,I=>e.triggerEvent(new sT(I)),I=>e.triggerEvent(new oT(I)))}setUpPreloading(){this.subscription=this.router.events.pipe(Wr(e=>e instanceof iy),Wf(()=>this.preload())).subscribe(()=>{})}preload(){const e=this.injector.get(Yc);return this.processRoutes(e,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,i){const s=[];for(const h of i)if(h.loadChildren&&!h.canLoad&&h._loadedConfig){const m=h._loadedConfig;s.push(this.processRoutes(m.module,m.routes))}else h.loadChildren&&!h.canLoad?s.push(this.preloadConfig(e,h)):h.children&&s.push(this.processRoutes(e,h.children));return V(s).pipe($e(),Kt(h=>{}))}preloadConfig(e,i){return this.preloadingStrategy.preload(i,()=>(i._loadedConfig?fn(i._loadedConfig):this.loader.load(e.injector,i)).pipe(Ie(h=>(i._loadedConfig=h,this.processRoutes(h.module,h.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(dt(Ba),dt(sv),dt(Bn),dt(ZT))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})(),Q1=(()=>{class t{constructor(e,i,s={}){this.router=e,this.viewportScroller=i,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof N1?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof iy&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof aT&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,i){this.router.triggerEvent(new aT(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){Gb()},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const np=new on("ROUTER_CONFIGURATION"),QT=new on("ROUTER_FORROOT_GUARD"),v5=[o1,{provide:yT,useClass:_T},{provide:Ba,useFactory:function(t,n,e,i,s,h,m={},S,I){const F=new Ba(null,t,n,e,i,s,uT(h));return S&&(F.urlHandlingStrategy=S),I&&(F.routeReuseStrategy=I),function(t,n){t.errorHandler&&(n.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(n.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(n.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(n.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(n.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(n.urlUpdateStrategy=t.urlUpdateStrategy),t.canceledNavigationResolution&&(n.canceledNavigationResolution=t.canceledNavigationResolution)}(m,F),m.enableTracing&&F.events.subscribe(G=>{var J,re;null==(J=console.group)||J.call(console,`Router Event: ${G.constructor.name}`),console.log(G.toString()),console.log(G),null==(re=console.groupEnd)||re.call(console)}),F},deps:[yT,uy,o1,Bn,sv,Z1,np,[class{},new Js],[class{},new Js]]},uy,{provide:qf,useFactory:function(t){return t.routerState.root},deps:[Ba]},KT,JT,class{preload(n,e){return e().pipe(Ph(()=>fn(null)))}},{provide:np,useValue:{enableTracing:!1}}];function x5(){return new M0("Router",Ba)}let eM=(()=>{class t{constructor(e,i){}static forRoot(e,i){return{ngModule:t,providers:[v5,tM(e),{provide:QT,useFactory:C5,deps:[[Ba,new Js,new Ra]]},{provide:np,useValue:i||{}},{provide:Gf,useFactory:w5,deps:[Jd,[new Bc(s1),new Js],np]},{provide:Q1,useFactory:b5,deps:[Ba,fB,np]},{provide:ZT,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:JT},{provide:M0,multi:!0,useFactory:x5},[ew,{provide:Om,multi:!0,useFactory:A5,deps:[ew]},{provide:nM,useFactory:T5,deps:[ew]},{provide:iE,multi:!0,useExisting:nM}]]}}static forChild(e){return{ngModule:t,providers:[tM(e)]}}}return t.\u0275fac=function(e){return new(e||t)(dt(QT,8),dt(Ba,8))},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({}),t})();function b5(t,n,e){return e.scrollOffset&&n.setOffset(e.scrollOffset),new Q1(t,n,e)}function w5(t,n,e={}){return e.useHash?new ez(t,n):new mA(t,n)}function C5(t){return"guarded"}function tM(t){return[{provide:Rl,multi:!0,useValue:t},{provide:Z1,multi:!0,useValue:t}]}let ew=(()=>{class t{constructor(e){this.injector=e,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Dn}appInitializer(){return this.injector.get(JL,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let i=null;const s=new Promise(S=>i=S),h=this.injector.get(Ba),m=this.injector.get(np);return"disabled"===m.initialNavigation?(h.setUpLocationChangeListener(),i(!0)):"enabled"===m.initialNavigation||"enabledBlocking"===m.initialNavigation?(h.hooks.afterPreactivation=()=>this.initNavigation?fn(null):(this.initNavigation=!0,i(!0),this.resultOfPreactivationDone),h.initialNavigation()):i(!0),s})}bootstrapListener(e){const i=this.injector.get(np),s=this.injector.get(KT),h=this.injector.get(Q1),m=this.injector.get(Ba),S=this.injector.get(ec);e===S.components[0]&&(("enabledNonBlocking"===i.initialNavigation||void 0===i.initialNavigation)&&m.initialNavigation(),s.setUpPreloading(),h.init(),m.resetRootComponentType(S.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return t.\u0275fac=function(e){return new(e||t)(dt(Bn))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();function A5(t){return t.appInitializer.bind(t)}function T5(t){return t.bootstrapListener.bind(t)}const nM=new on("Router Initializer"),k5=[];let I5=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[eM.forRoot(k5)],eM]}),t})();var aa=gr(887);class P5 extends St{constructor(n,e){super()}schedule(n,e=0){return this}}const Jv={setInterval(...t){const{delegate:n}=Jv;return((null==n?void 0:n.setInterval)||setInterval)(...t)},clearInterval(t){const{delegate:n}=Jv;return((null==n?void 0:n.clearInterval)||clearInterval)(t)},delegate:void 0};class iM extends P5{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){if(this.closed)return this;this.state=n;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(s,this.id,e),this}requestAsyncId(n,e,i=0){return Jv.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;Jv.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let s,i=!1;try{this.work(n)}catch(h){i=!0,s=h||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,v(i,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}let tw,R5=1;const Kv={};function rM(t){return t in Kv&&(delete Kv[t],!0)}const N5={setImmediate(t){const n=R5++;return Kv[n]=!0,tw||(tw=Promise.resolve()),tw.then(()=>rM(n)&&t()),n},clearImmediate(t){rM(t)}},{setImmediate:F5,clearImmediate:O5}=N5,Qv={setImmediate(...t){const{delegate:n}=Qv;return((null==n?void 0:n.setImmediate)||F5)(...t)},clearImmediate(t){const{delegate:n}=Qv;return((null==n?void 0:n.clearImmediate)||O5)(t)},delegate:void 0},sM={now:()=>(sM.delegate||Date).now(),delegate:void 0};class fy{constructor(n,e=fy.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,i){return new this.schedulerActionCtor(this,n).schedule(i,e)}}fy.now=sM.now;class oM extends fy{constructor(n,e=fy.now){super(n,e),this.actions=[],this._active=!1,this._scheduled=void 0}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,i){for(;n=e.shift();)n.unsubscribe();throw i}}}const aM=new class extends oM{flush(n){this._active=!0,this._scheduled=void 0;const{actions:e}=this;let i,s=-1;n=n||e.shift();const h=e.length;do{if(i=n.execute(n.state,n.delay))break}while(++s<h&&(n=e.shift()));if(this._active=!1,i){for(;++s<h&&(n=e.shift());)n.unsubscribe();throw i}}}(class extends iM{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,i=0){return null!==i&&i>0?super.requestAsyncId(n,e,i):(n.actions.push(this),n._scheduled||(n._scheduled=Qv.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,e,i=0){if(null!=i&&i>0||null==i&&this.delay>0)return super.recycleAsyncId(n,e,i);0===n.actions.length&&(Qv.clearImmediate(e),n._scheduled=void 0)}});var B5=gr(651),lM=gr.n(B5);const V5=["chart"];let cM=(()=>{class t{constructor(){this.autoUpdateSeries=!0}ngOnInit(){aM.schedule(()=>{this.createElement()})}ngOnChanges(e){aM.schedule(()=>{this.autoUpdateSeries&&0===Object.keys(e).filter(i=>"series"!==i).length?this.updateSeries(this.series,!0):this.createElement()})}ngOnDestroy(){this.chartObj&&this.chartObj.destroy()}createElement(){const e={};this.annotations&&(e.annotations=this.annotations),this.chart&&(e.chart=this.chart),this.colors&&(e.colors=this.colors),this.dataLabels&&(e.dataLabels=this.dataLabels),this.series&&(e.series=this.series),this.stroke&&(e.stroke=this.stroke),this.labels&&(e.labels=this.labels),this.legend&&(e.legend=this.legend),this.fill&&(e.fill=this.fill),this.tooltip&&(e.tooltip=this.tooltip),this.plotOptions&&(e.plotOptions=this.plotOptions),this.responsive&&(e.responsive=this.responsive),this.markers&&(e.markers=this.markers),this.noData&&(e.noData=this.noData),this.xaxis&&(e.xaxis=this.xaxis),this.yaxis&&(e.yaxis=this.yaxis),this.grid&&(e.grid=this.grid),this.states&&(e.states=this.states),this.title&&(e.title=this.title),this.subtitle&&(e.subtitle=this.subtitle),this.theme&&(e.theme=this.theme),this.chartObj&&this.chartObj.destroy(),this.chartObj=new(lM())(this.chartElement.nativeElement,e),this.render()}render(){return this.chartObj.render()}updateOptions(e,i,s,h){return this.chartObj.updateOptions(e,i,s,h)}updateSeries(e,i){this.chartObj.updateSeries(e,i)}appendSeries(e,i){this.chartObj.appendSeries(e,i)}appendData(e){this.chartObj.appendData(e)}toggleSeries(e){return this.chartObj.toggleSeries(e)}showSeries(e){this.chartObj.showSeries(e)}hideSeries(e){this.chartObj.hideSeries(e)}resetSeries(){this.chartObj.resetSeries()}zoomX(e,i){this.chartObj.zoomX(e,i)}toggleDataPointSelection(e,i){this.chartObj.toggleDataPointSelection(e,i)}destroy(){this.chartObj.destroy()}setLocale(e){this.chartObj.setLocale(e)}paper(){this.chartObj.paper()}addXaxisAnnotation(e,i,s){this.chartObj.addXaxisAnnotation(e,i,s)}addYaxisAnnotation(e,i,s){this.chartObj.addYaxisAnnotation(e,i,s)}addPointAnnotation(e,i,s){this.chartObj.addPointAnnotation(e,i,s)}removeAnnotation(e,i){this.chartObj.removeAnnotation(e,i)}clearAnnotations(e){this.chartObj.clearAnnotations(e)}dataURI(){return this.chartObj.dataURI()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Jn({type:t,selectors:[["apx-chart"]],viewQuery:function(e,i){if(1&e&&Zc(V5,7),2&e){let s;hi(s=di())&&(i.chartElement=s.first)}},inputs:{autoUpdateSeries:"autoUpdateSeries",chart:"chart",annotations:"annotations",colors:"colors",dataLabels:"dataLabels",series:"series",stroke:"stroke",labels:"labels",legend:"legend",markers:"markers",noData:"noData",fill:"fill",tooltip:"tooltip",plotOptions:"plotOptions",responsive:"responsive",xaxis:"xaxis",yaxis:"yaxis",grid:"grid",states:"states",title:"title",subtitle:"subtitle",theme:"theme"},features:[In],decls:2,vars:0,consts:[["chart",""]],template:function(e,i){1&e&&Fi(0,"div",null,0)},styles:[""]}),t})();window.ApexCharts=lM();let U5=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[]]}),t})();const H5=["chart"];let uM=(()=>{class t{constructor(){this.data=[],this.setupData()}ngOnChanges(e){this.setupData()}setupData(){this.chartOptions={series:[{name:null!=this.options&&null!=this.options.title?this.options.title.text:"My-series",data:this.data.map(e=>e.y)}],chart:null!=this.options&&null!=this.options.chart?this.options.chart:{height:20*this.data.length,type:"bar"},title:null!=this.options&&null!=this.options.title?this.options.title:{text:"My First Angular Chart"},xaxis:{categories:this.data.map(e=>e.x)},yaxis:{show:!1},plotOptions:null!=this.options&&null!=this.options.plotOptions?this.options.plotOptions:{bar:{barHeight:"100%",distributed:!0,horizontal:!0,dataLabels:{position:"bottom"}}},legend:{show:!1},dataLabels:null!=this.options&&null!=this.options.dataLabels?this.options.dataLabels:{enabled:!0,textAnchor:"start",style:{colors:["#666"]},formatter:function(e,i){return i.w.globals.labels[i.dataPointIndex]+":  "+e},offsetX:0,dropShadow:{enabled:!1}}}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Jn({type:t,selectors:[["app-chart-plug"]],viewQuery:function(e,i){if(1&e&&Zc(H5,5),2&e){let s;hi(s=di())&&(i.chart=s.first)}},inputs:{data:"data",options:"options"},features:[In],decls:2,vars:8,consts:[[1,"h-100","rounded","my-1","bg-trans",2,"text-align","center"],[1,"showChart",3,"series","chart","xaxis","yaxis","title","plotOptions","dataLabels","legend"]],template:function(e,i){1&e&&(vt(0,"div",0),Fi(1,"apx-chart",1),xt()),2&e&&(wt(1),mt("series",i.chartOptions.series)("chart",i.chartOptions.chart)("xaxis",i.chartOptions.xaxis)("yaxis",i.chartOptions.yaxis)("title",i.chartOptions.title)("plotOptions",i.chartOptions.plotOptions)("dataLabels",i.chartOptions.dataLabels)("legend",i.chartOptions.legend))},directives:[cM],styles:[".showChart[_ngcontent-%COMP%]{width:100%;height:100%}"]}),t})();class hM{}class dM{}class Fu{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?this.lazyInit="string"==typeof n?()=>{this.headers=new Map,n.split("\n").forEach(e=>{const i=e.indexOf(":");if(i>0){const s=e.slice(0,i),h=s.toLowerCase(),m=e.slice(i+1).trim();this.maybeSetNormalizedName(s,h),this.headers.has(h)?this.headers.get(h).push(m):this.headers.set(h,[m])}})}:()=>{this.headers=new Map,Object.keys(n).forEach(e=>{let i=n[e];const s=e.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(s,i),this.maybeSetNormalizedName(e,s))})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const e=this.headers.get(n.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,e){return this.clone({name:n,value:e,op:"a"})}set(n,e){return this.clone({name:n,value:e,op:"s"})}delete(n,e){return this.clone({name:n,value:e,op:"d"})}maybeSetNormalizedName(n,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,n)}init(){this.lazyInit&&(this.lazyInit instanceof Fu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(e=>{this.headers.set(e,n.headers.get(e)),this.normalizedNames.set(e,n.normalizedNames.get(e))})}clone(n){const e=new Fu;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Fu?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([n]),e}applyUpdate(n){const e=n.name.toLowerCase();switch(n.op){case"a":case"s":let i=n.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(n.name,e);const s=("a"===n.op?this.headers.get(e):void 0)||[];s.push(...i),this.headers.set(e,s);break;case"d":const h=n.value;if(h){let m=this.headers.get(e);if(!m)return;m=m.filter(S=>-1===h.indexOf(S)),0===m.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,m)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>n(this.normalizedNames.get(e),this.headers.get(e)))}}class j5{encodeKey(n){return pM(n)}encodeValue(n){return pM(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const G5=/%(\d[a-f0-9])/gi,W5={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function pM(t){return encodeURIComponent(t).replace(G5,(n,e)=>{var i;return null!=(i=W5[e])?i:n})}function fM(t){return`${t}`}class Nh{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new j5,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,n){const e=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(s=>{const h=s.indexOf("="),[m,S]=-1==h?[n.decodeKey(s),""]:[n.decodeKey(s.slice(0,h)),n.decodeValue(s.slice(h+1))],I=e.get(m)||[];I.push(S),e.set(m,I)}),e}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(e=>{const i=n.fromObject[e];this.map.set(e,Array.isArray(i)?i:[i])})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const e=this.map.get(n);return e?e[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,e){return this.clone({param:n,value:e,op:"a"})}appendAll(n){const e=[];return Object.keys(n).forEach(i=>{const s=n[i];Array.isArray(s)?s.forEach(h=>{e.push({param:i,value:h,op:"a"})}):e.push({param:i,value:s,op:"a"})}),this.clone(e)}set(n,e){return this.clone({param:n,value:e,op:"s"})}delete(n,e){return this.clone({param:n,value:e,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const e=this.encoder.encodeKey(n);return this.map.get(n).map(i=>e+"="+this.encoder.encodeValue(i)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const e=new Nh({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(n),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const e=("a"===n.op?this.map.get(n.param):void 0)||[];e.push(fM(n.value)),this.map.set(n.param,e);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let i=this.map.get(n.param)||[];const s=i.indexOf(fM(n.value));-1!==s&&i.splice(s,1),i.length>0?this.map.set(n.param,i):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class X5{constructor(){this.map=new Map}set(n,e){return this.map.set(n,e),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}keys(){return this.map.keys()}}function gM(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function mM(t){return"undefined"!=typeof Blob&&t instanceof Blob}function yM(t){return"undefined"!=typeof FormData&&t instanceof FormData}class gy{constructor(n,e,i,s){let h;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==i?i:null,h=s):h=i,h&&(this.reportProgress=!!h.reportProgress,this.withCredentials=!!h.withCredentials,h.responseType&&(this.responseType=h.responseType),h.headers&&(this.headers=h.headers),h.context&&(this.context=h.context),h.params&&(this.params=h.params)),this.headers||(this.headers=new Fu),this.context||(this.context=new X5),this.params){const m=this.params.toString();if(0===m.length)this.urlWithParams=e;else{const S=e.indexOf("?");this.urlWithParams=e+(-1===S?"?":S<e.length-1?"&":"")+m}}else this.params=new Nh,this.urlWithParams=e}serializeBody(){return null===this.body?null:gM(this.body)||mM(this.body)||yM(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof Nh?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||yM(this.body)?null:mM(this.body)?this.body.type||null:gM(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Nh?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){var J;const e=n.method||this.method,i=n.url||this.url,s=n.responseType||this.responseType,h=void 0!==n.body?n.body:this.body,m=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,S=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let I=n.headers||this.headers,F=n.params||this.params;const G=null!=(J=n.context)?J:this.context;return void 0!==n.setHeaders&&(I=Object.keys(n.setHeaders).reduce((re,he)=>re.set(he,n.setHeaders[he]),I)),n.setParams&&(F=Object.keys(n.setParams).reduce((re,he)=>re.set(he,n.setParams[he]),F)),new gy(e,i,h,{params:F,headers:I,context:G,reportProgress:S,responseType:s,withCredentials:m})}}var ss=(()=>((ss=ss||{})[ss.Sent=0]="Sent",ss[ss.UploadProgress=1]="UploadProgress",ss[ss.ResponseHeader=2]="ResponseHeader",ss[ss.DownloadProgress=3]="DownloadProgress",ss[ss.Response=4]="Response",ss[ss.User=5]="User",ss))();class nw{constructor(n,e=200,i="OK"){this.headers=n.headers||new Fu,this.status=void 0!==n.status?n.status:e,this.statusText=n.statusText||i,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class iw extends nw{constructor(n={}){super(n),this.type=ss.ResponseHeader}clone(n={}){return new iw({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class ex extends nw{constructor(n={}){super(n),this.type=ss.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new ex({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class _M extends nw{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function rw(t,n){return{body:n,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let vM=(()=>{class t{constructor(e){this.handler=e}request(e,i,s={}){let h;if(e instanceof gy)h=e;else{let I,F;I=s.headers instanceof Fu?s.headers:new Fu(s.headers),s.params&&(F=s.params instanceof Nh?s.params:new Nh({fromObject:s.params})),h=new gy(e,i,void 0!==s.body?s.body:null,{headers:I,context:s.context,params:F,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const m=fn(h).pipe(Wf(I=>this.handler.handle(I)));if(e instanceof gy||"events"===s.observe)return m;const S=m.pipe(Wr(I=>I instanceof ex));switch(s.observe||"body"){case"body":switch(h.responseType){case"arraybuffer":return S.pipe(Kt(I=>{if(null!==I.body&&!(I.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return I.body}));case"blob":return S.pipe(Kt(I=>{if(null!==I.body&&!(I.body instanceof Blob))throw new Error("Response is not a Blob.");return I.body}));case"text":return S.pipe(Kt(I=>{if(null!==I.body&&"string"!=typeof I.body)throw new Error("Response is not a string.");return I.body}));default:return S.pipe(Kt(I=>I.body))}case"response":return S;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,i={}){return this.request("DELETE",e,i)}get(e,i={}){return this.request("GET",e,i)}head(e,i={}){return this.request("HEAD",e,i)}jsonp(e,i){return this.request("JSONP",e,{params:(new Nh).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,i={}){return this.request("OPTIONS",e,i)}patch(e,i,s={}){return this.request("PATCH",e,rw(s,i))}post(e,i,s={}){return this.request("POST",e,rw(s,i))}put(e,i,s={}){return this.request("PUT",e,rw(s,i))}}return t.\u0275fac=function(e){return new(e||t)(dt(hM))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();class xM{constructor(n,e){this.next=n,this.interceptor=e}handle(n){return this.interceptor.intercept(n,this.next)}}const sw=new on("HTTP_INTERCEPTORS");let Z5=(()=>{class t{intercept(e,i){return i.handle(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const J5=/^\)\]\}',?\n/;let bM=(()=>{class t{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Cn(i=>{const s=this.xhrFactory.build();if(s.open(e.method,e.urlWithParams),e.withCredentials&&(s.withCredentials=!0),e.headers.forEach((he,Se)=>s.setRequestHeader(he,Se.join(","))),e.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const he=e.detectContentTypeHeader();null!==he&&s.setRequestHeader("Content-Type",he)}if(e.responseType){const he=e.responseType.toLowerCase();s.responseType="json"!==he?he:"text"}const h=e.serializeBody();let m=null;const S=()=>{if(null!==m)return m;const he=1223===s.status?204:s.status,Se=s.statusText||"OK",ze=new Fu(s.getAllResponseHeaders()),Le=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(s)||e.url;return m=new iw({headers:ze,status:he,statusText:Se,url:Le}),m},I=()=>{let{headers:he,status:Se,statusText:ze,url:Le}=S(),et=null;204!==Se&&(et=void 0===s.response?s.responseText:s.response),0===Se&&(Se=et?200:0);let Ze=Se>=200&&Se<300;if("json"===e.responseType&&"string"==typeof et){const Ht=et;et=et.replace(J5,"");try{et=""!==et?JSON.parse(et):null}catch(Wt){et=Ht,Ze&&(Ze=!1,et={error:Wt,text:et})}}Ze?(i.next(new ex({body:et,headers:he,status:Se,statusText:ze,url:Le||void 0})),i.complete()):i.error(new _M({error:et,headers:he,status:Se,statusText:ze,url:Le||void 0}))},F=he=>{const{url:Se}=S(),ze=new _M({error:he,status:s.status||0,statusText:s.statusText||"Unknown Error",url:Se||void 0});i.error(ze)};let G=!1;const J=he=>{G||(i.next(S()),G=!0);let Se={type:ss.DownloadProgress,loaded:he.loaded};he.lengthComputable&&(Se.total=he.total),"text"===e.responseType&&!!s.responseText&&(Se.partialText=s.responseText),i.next(Se)},re=he=>{let Se={type:ss.UploadProgress,loaded:he.loaded};he.lengthComputable&&(Se.total=he.total),i.next(Se)};return s.addEventListener("load",I),s.addEventListener("error",F),s.addEventListener("timeout",F),s.addEventListener("abort",F),e.reportProgress&&(s.addEventListener("progress",J),null!==h&&s.upload&&s.upload.addEventListener("progress",re)),s.send(h),i.next({type:ss.Sent}),()=>{s.removeEventListener("error",F),s.removeEventListener("abort",F),s.removeEventListener("load",I),s.removeEventListener("timeout",F),e.reportProgress&&(s.removeEventListener("progress",J),null!==h&&s.upload&&s.upload.removeEventListener("progress",re)),s.readyState!==s.DONE&&s.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(dt(LA))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const ow=new on("XSRF_COOKIE_NAME"),aw=new on("XSRF_HEADER_NAME");class wM{}let Q5=(()=>{class t{constructor(e,i,s){this.doc=e,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=MA(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(dt(Di),dt(zm),dt(ow))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})(),lw=(()=>{class t{constructor(e,i){this.tokenService=e,this.headerName=i}intercept(e,i){const s=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||s.startsWith("http://")||s.startsWith("https://"))return i.handle(e);const h=this.tokenService.getToken();return null!==h&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,h)})),i.handle(e)}}return t.\u0275fac=function(e){return new(e||t)(dt(wM),dt(aw))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})(),e4=(()=>{class t{constructor(e,i){this.backend=e,this.injector=i,this.chain=null}handle(e){if(null===this.chain){const i=this.injector.get(sw,[]);this.chain=i.reduceRight((s,h)=>new xM(s,h),this.backend)}return this.chain.handle(e)}}return t.\u0275fac=function(e){return new(e||t)(dt(dM),dt(Bn))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})(),t4=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:lw,useClass:Z5}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:ow,useValue:e.cookieName}:[],e.headerName?{provide:aw,useValue:e.headerName}:[]]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({providers:[lw,{provide:sw,useExisting:lw,multi:!0},{provide:wM,useClass:Q5},{provide:ow,useValue:"XSRF-TOKEN"},{provide:aw,useValue:"X-XSRF-TOKEN"}]}),t})(),n4=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({providers:[vM,{provide:hM,useClass:e4},bM,{provide:dM,useExisting:bM}],imports:[[t4.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})(),CM=(()=>{class t{constructor(e){this.http=e}getDataCountries(){return this.http.get("countries")}getDataContinets(){return this.http.get("continents")}getDataContinet(e){return this.http.get(`continents/${e}`)}}return t.baseUrl="https://disease.sh/v3/covid-19",t.\u0275fac=function(e){return new(e||t)(dt(vM))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function DM(t,n,e,i){return new(e||(e=Promise))(function(h,m){function S(G){try{F(i.next(G))}catch(J){m(J)}}function I(G){try{F(i.throw(G))}catch(J){m(J)}}function F(G){G.done?h(G.value):function(h){return h instanceof e?h:new e(function(m){m(h)})}(G.value).then(S,I)}F((i=i.apply(t,n||[])).next())})}class TM extends Dn{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(n){const{hasError:e,_hasValue:i,_value:s,thrownError:h,isStopped:m,_isComplete:S}=this;e?n.error(h):(m||S)&&(i&&n.next(s),n.complete())}next(n){this.isStopped||(this._value=n,this._hasValue=!0)}complete(){const{_hasValue:n,_value:e,_isComplete:i}=this;i||(this._isComplete=!0,n&&super.next(e),super.complete())}}const o4=["container"],kM=new on("MapboxApiKey");let IM=(()=>{class t{constructor(e,i){this.zone=e,this.MAPBOX_API_KEY=i,this.mapCreated=new TM,this.mapLoaded=new TM,this.markersToRemove=[],this.popupsToRemove=[],this.imageIdsToRemove=[],this.subscription=new St,this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}setup(e){this.zone.onStable.pipe(Kd()).subscribe(()=>{this.assign(aa,"accessToken",e.accessToken||this.MAPBOX_API_KEY),e.customMapboxApiUrl&&this.assign(aa,"config.API_URL",e.customMapboxApiUrl),this.createMap(e.mapOptions),this.hookEvents(e.mapEvents),this.mapEvents=e.mapEvents,this.mapCreated.next(void 0),this.mapCreated.complete()})}destroyMap(){this.mapInstance&&(this.subscription.unsubscribe(),this.mapInstance.remove())}updateMinZoom(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinZoom(e)})}updateMaxZoom(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxZoom(e)})}updateMinPitch(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinPitch(e)})}updateMaxPitch(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxPitch(e)})}updateRenderWorldCopies(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setRenderWorldCopies(e)})}updateScrollZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.scrollZoom.enable():this.mapInstance.scrollZoom.disable()})}updateDragRotate(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.dragRotate.enable():this.mapInstance.dragRotate.disable()})}updateTouchPitch(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.touchPitch.enable():this.mapInstance.touchPitch.disable()})}updateTouchZoomRotate(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.touchZoomRotate.enable():this.mapInstance.touchZoomRotate.disable()})}updateDoubleClickZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.doubleClickZoom.enable():this.mapInstance.doubleClickZoom.disable()})}updateKeyboard(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.keyboard.enable():this.mapInstance.keyboard.disable()})}updateDragPan(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.dragPan.enable():this.mapInstance.dragPan.disable()})}updateBoxZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.boxZoom.enable():this.mapInstance.boxZoom.disable()})}updateStyle(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setStyle(e)})}updateMaxBounds(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxBounds(e)})}changeCanvasCursor(e){this.mapInstance.getCanvasContainer().style.cursor=e}queryRenderedFeatures(e,i){return this.mapInstance.queryRenderedFeatures(e,i)}panTo(e,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.panTo(e,i)})}move(e,i,s,h,m,S){return this.zone.runOutsideAngular(()=>{this.mapInstance[e](Object.assign(Object.assign({},i),{zoom:null!=s?s:this.mapInstance.getZoom(),center:null!=h?h:this.mapInstance.getCenter(),bearing:null!=m?m:this.mapInstance.getBearing(),pitch:null!=S?S:this.mapInstance.getPitch()}))})}addLayer(e,i,s){this.zone.runOutsideAngular(()=>{Object.keys(e.layerOptions).forEach(h=>{void 0===e.layerOptions[h]&&delete e.layerOptions[h]}),this.mapInstance.addLayer(e.layerOptions,s),i&&((e.layerEvents.layerClick.observers.length||e.layerEvents.click.observers.length)&&this.mapInstance.on("click",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerClick.emit(h),e.layerEvents.click.emit(h)})}),(e.layerEvents.layerDblClick.observers.length||e.layerEvents.dblClick.observers.length)&&this.mapInstance.on("dblclick",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerDblClick.emit(h),e.layerEvents.dblClick.emit(h)})}),(e.layerEvents.layerMouseDown.observers.length||e.layerEvents.mouseDown.observers.length)&&this.mapInstance.on("mousedown",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerMouseDown.emit(h),e.layerEvents.mouseDown.emit(h)})}),(e.layerEvents.layerMouseUp.observers.length||e.layerEvents.mouseUp.observers.length)&&this.mapInstance.on("mouseup",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerMouseUp.emit(h),e.layerEvents.mouseUp.emit(h)})}),(e.layerEvents.layerMouseEnter.observers.length||e.layerEvents.mouseEnter.observers.length)&&this.mapInstance.on("mouseenter",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerMouseEnter.emit(h),e.layerEvents.mouseEnter.emit(h)})}),(e.layerEvents.layerMouseLeave.observers.length||e.layerEvents.mouseLeave.observers.length)&&this.mapInstance.on("mouseleave",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerMouseLeave.emit(h),e.layerEvents.mouseLeave.emit(h)})}),(e.layerEvents.layerMouseMove.observers.length||e.layerEvents.mouseMove.observers.length)&&this.mapInstance.on("mousemove",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerMouseMove.emit(h),e.layerEvents.mouseMove.emit(h)})}),(e.layerEvents.layerMouseOver.observers.length||e.layerEvents.mouseOver.observers.length)&&this.mapInstance.on("mouseover",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerMouseOver.emit(h),e.layerEvents.mouseOver.emit(h)})}),(e.layerEvents.layerMouseOut.observers.length||e.layerEvents.mouseOut.observers.length)&&this.mapInstance.on("mouseout",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerMouseOut.emit(h),e.layerEvents.mouseOut.emit(h)})}),(e.layerEvents.layerContextMenu.observers.length||e.layerEvents.contextMenu.observers.length)&&this.mapInstance.on("contextmenu",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerContextMenu.emit(h),e.layerEvents.contextMenu.emit(h)})}),(e.layerEvents.layerTouchStart.observers.length||e.layerEvents.touchStart.observers.length)&&this.mapInstance.on("touchstart",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerTouchStart.emit(h),e.layerEvents.touchStart.emit(h)})}),(e.layerEvents.layerTouchEnd.observers.length||e.layerEvents.touchEnd.observers.length)&&this.mapInstance.on("touchend",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerTouchEnd.emit(h),e.layerEvents.touchEnd.emit(h)})}),(e.layerEvents.layerTouchCancel.observers.length||e.layerEvents.touchCancel.observers.length)&&this.mapInstance.on("touchcancel",e.layerOptions.id,h=>{this.zone.run(()=>{e.layerEvents.layerTouchCancel.emit(h),e.layerEvents.touchCancel.emit(h)})}))})}removeLayer(e){this.zone.runOutsideAngular(()=>{null!=this.mapInstance.getLayer(e)&&this.mapInstance.removeLayer(e)})}addMarker(e){const i={offset:e.markersOptions.offset,anchor:e.markersOptions.anchor,draggable:!!e.markersOptions.draggable,rotationAlignment:e.markersOptions.rotationAlignment,pitchAlignment:e.markersOptions.pitchAlignment,clickTolerance:e.markersOptions.clickTolerance};e.markersOptions.element.childNodes.length>0&&(i.element=e.markersOptions.element);const s=new aa.Marker(i);return(e.markersEvents.markerDragStart.observers.length||e.markersEvents.dragStart.observers.length)&&s.on("dragstart",m=>{if(m){const{target:S}=m;this.zone.run(()=>{e.markersEvents.markerDragStart.emit(S),e.markersEvents.dragStart.emit(S)})}}),(e.markersEvents.markerDrag.observers.length||e.markersEvents.drag.observers.length)&&s.on("drag",m=>{if(m){const{target:S}=m;this.zone.run(()=>{e.markersEvents.markerDrag.emit(S),e.markersEvents.drag.emit(S)})}}),(e.markersEvents.markerDragEnd.observers.length||e.markersEvents.dragEnd.observers.length)&&s.on("dragend",m=>{if(m){const{target:S}=m;this.zone.run(()=>{e.markersEvents.markerDragEnd.emit(S),e.markersEvents.dragEnd.emit(S)})}}),s.setLngLat(e.markersOptions.feature?e.markersOptions.feature.geometry.coordinates:e.markersOptions.lngLat),this.zone.runOutsideAngular(()=>(s.addTo(this.mapInstance),s))}removeMarker(e){this.markersToRemove.push(e)}createPopup(e,i){return this.zone.runOutsideAngular(()=>{Object.keys(e.popupOptions).forEach(h=>void 0===e.popupOptions[h]&&delete e.popupOptions[h]);const s=new aa.Popup(e.popupOptions);return s.setDOMContent(i),(e.popupEvents.popupClose.observers.length||e.popupEvents.close.observers.length)&&s.on("close",()=>{this.zone.run(()=>{e.popupEvents.popupClose.emit(),e.popupEvents.close.emit()})}),(e.popupEvents.popupOpen.observers.length||e.popupEvents.open.observers.length)&&s.on("open",()=>{this.zone.run(()=>{e.popupEvents.popupOpen.emit(),e.popupEvents.open.emit()})}),s})}addPopupToMap(e,i,s=!1){return this.zone.runOutsideAngular(()=>{s&&e._listeners&&delete e._listeners.open,e.setLngLat(i),e.addTo(this.mapInstance)})}addPopupToMarker(e,i){return this.zone.runOutsideAngular(()=>{e.setPopup(i)})}removePopupFromMap(e,i=!1){i&&e._listeners&&delete e._listeners.close,this.popupsToRemove.push(e)}removePopupFromMarker(e){return this.zone.runOutsideAngular(()=>{e.setPopup(void 0)})}addControl(e,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.addControl(e,i)})}removeControl(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.removeControl(e)})}loadAndAddImage(e,i,s){return DM(this,void 0,void 0,function*(){return this.zone.runOutsideAngular(()=>new Promise((h,m)=>{this.mapInstance.loadImage(i,(S,I)=>{S?m(S):(this.addImage(e,I,s),h())})}))})}addImage(e,i,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.addImage(e,i,s)})}removeImage(e){this.imageIdsToRemove.push(e)}addSource(e,i){return this.zone.runOutsideAngular(()=>{Object.keys(i).forEach(s=>void 0===i[s]&&delete i[s]),this.mapInstance.addSource(e,i)})}getSource(e){return this.mapInstance.getSource(e)}removeSource(e){this.zone.runOutsideAngular(()=>{this.findLayersBySourceId(e).forEach(i=>this.mapInstance.removeLayer(i.id)),this.mapInstance.removeSource(e)})}setAllLayerPaintProperty(e,i){return this.zone.runOutsideAngular(()=>{Object.keys(i).forEach(s=>{this.mapInstance.setPaintProperty(e,s,i[s])})})}setAllLayerLayoutProperty(e,i){return this.zone.runOutsideAngular(()=>{Object.keys(i).forEach(s=>{this.mapInstance.setLayoutProperty(e,s,i[s])})})}setLayerFilter(e,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setFilter(e,i)})}setLayerBefore(e,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.moveLayer(e,i)})}setLayerZoomRange(e,i,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.setLayerZoomRange(e,i||0,s||20)})}fitBounds(e,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitBounds(e,i)})}fitScreenCoordinates(e,i,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitScreenCoordinates(e[0],e[1],i,s)})}applyChanges(){this.zone.runOutsideAngular(()=>{this.removeMarkers(),this.removePopups(),this.removeImages()})}createMap(e){jn.assertNotInAngularZone(),Object.keys(e).forEach(s=>{void 0===e[s]&&delete e[s]}),this.mapInstance=new aa.Map(e),window&&/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)&&this.mapInstance.setStyle(e.style),this.subscription.add(this.zone.onMicrotaskEmpty.subscribe(()=>this.applyChanges()))}removeMarkers(){for(const e of this.markersToRemove)e.remove();this.markersToRemove=[]}removePopups(){for(const e of this.popupsToRemove)e.remove();this.popupsToRemove=[]}removeImages(){for(const e of this.imageIdsToRemove)this.mapInstance.removeImage(e);this.imageIdsToRemove=[]}findLayersBySourceId(e){const i=this.mapInstance.getStyle().layers;return null==i?[]:i.filter(s=>"source"in s&&s.source===e)}hookEvents(e){this.mapInstance.on("load",i=>{this.mapLoaded.next(void 0),this.mapLoaded.complete(),this.zone.run(()=>{e.mapLoad.emit(i.target),e.load.emit(i.target)})}),(e.mapResize.observers.length||e.resize.observers.length)&&this.mapInstance.on("resize",i=>this.zone.run(()=>{e.mapResize.emit(i),e.resize.emit(i)})),(e.mapRemove.observers.length||e.remove.observers.length)&&this.mapInstance.on("remove",i=>this.zone.run(()=>{e.mapRemove.emit(i),e.remove.emit(i)})),(e.mapMouseDown.observers.length||e.mouseDown.observers.length)&&this.mapInstance.on("mousedown",i=>this.zone.run(()=>{e.mapMouseDown.emit(i),e.mouseDown.emit(i)})),(e.mapMouseUp.observers.length||e.mouseUp.observers.length)&&this.mapInstance.on("mouseup",i=>this.zone.run(()=>{e.mapMouseUp.emit(i),e.mouseUp.emit(i)})),(e.mapMouseMove.observers.length||e.mouseMove.observers.length)&&this.mapInstance.on("mousemove",i=>this.zone.run(()=>{e.mapMouseMove.emit(i),e.mouseMove.emit(i)})),(e.mapClick.observers.length||e.click.observers.length)&&this.mapInstance.on("click",i=>this.zone.run(()=>{e.mapClick.emit(i),e.click.emit(i)})),(e.mapDblClick.observers.length||e.dblClick.observers.length)&&this.mapInstance.on("dblclick",i=>this.zone.run(()=>{e.mapDblClick.emit(i),e.dblClick.emit(i)})),(e.mapMouseOver.observers.length||e.mouseOver.observers.length)&&this.mapInstance.on("mouseover",i=>this.zone.run(()=>{e.mapMouseOver.emit(i),e.mouseOver.emit(i)})),(e.mapMouseOut.observers.length||e.mouseOut.observers.length)&&this.mapInstance.on("mouseout",i=>this.zone.run(()=>{e.mapMouseOut.emit(i),e.mouseOut.emit(i)})),(e.mapContextMenu.observers.length||e.contextMenu.observers.length)&&this.mapInstance.on("contextmenu",i=>this.zone.run(()=>{e.mapContextMenu.emit(i),e.contextMenu.emit(i)})),(e.mapTouchStart.observers.length||e.touchStart.observers.length)&&this.mapInstance.on("touchstart",i=>this.zone.run(()=>{e.mapTouchStart.emit(i),e.touchStart.emit(i)})),(e.mapTouchEnd.observers.length||e.touchEnd.observers.length)&&this.mapInstance.on("touchend",i=>this.zone.run(()=>{e.mapTouchEnd.emit(i),e.touchEnd.emit(i)})),(e.mapTouchMove.observers.length||e.touchMove.observers.length)&&this.mapInstance.on("touchmove",i=>this.zone.run(()=>{e.mapTouchMove.emit(i),e.touchMove.emit(i)})),(e.mapTouchCancel.observers.length||e.touchCancel.observers.length)&&this.mapInstance.on("touchcancel",i=>this.zone.run(()=>{e.mapTouchCancel.emit(i),e.touchCancel.emit(i)})),(e.mapWheel.observers.length||e.wheel.observers.length)&&this.mapInstance.on("wheel",i=>this.zone.run(()=>{e.mapWheel.emit(i),e.wheel.emit(i)})),e.moveStart.observers.length&&this.mapInstance.on("movestart",i=>this.zone.run(()=>e.moveStart.emit(i))),e.move.observers.length&&this.mapInstance.on("move",i=>this.zone.run(()=>e.move.emit(i))),e.moveEnd.observers.length&&this.mapInstance.on("moveend",i=>this.zone.run(()=>e.moveEnd.emit(i))),(e.mapDragStart.observers.length||e.dragStart.observers.length)&&this.mapInstance.on("dragstart",i=>this.zone.run(()=>{e.mapDragStart.emit(i),e.dragStart.emit(i)})),(e.mapDrag.observers.length||e.drag.observers.length)&&this.mapInstance.on("drag",i=>this.zone.run(()=>{e.mapDrag.emit(i),e.drag.emit(i)})),(e.mapDragEnd.observers.length||e.dragEnd.observers.length)&&this.mapInstance.on("dragend",i=>this.zone.run(()=>{e.mapDragEnd.emit(i),e.dragEnd.emit(i)})),e.zoomStart.observers.length&&this.mapInstance.on("zoomstart",i=>this.zone.run(()=>e.zoomStart.emit(i))),e.zoomEvt.observers.length&&this.mapInstance.on("zoom",i=>this.zone.run(()=>e.zoomEvt.emit(i))),e.zoomEnd.observers.length&&this.mapInstance.on("zoomend",i=>this.zone.run(()=>e.zoomEnd.emit(i))),e.rotateStart.observers.length&&this.mapInstance.on("rotatestart",i=>this.zone.run(()=>e.rotateStart.emit(i))),e.rotate.observers.length&&this.mapInstance.on("rotate",i=>this.zone.run(()=>e.rotate.emit(i))),e.rotateEnd.observers.length&&this.mapInstance.on("rotateend",i=>this.zone.run(()=>e.rotateEnd.emit(i))),e.pitchStart.observers.length&&this.mapInstance.on("pitchstart",i=>this.zone.run(()=>e.pitchStart.emit(i))),e.pitchEvt.observers.length&&this.mapInstance.on("pitch",i=>this.zone.run(()=>e.pitchEvt.emit(i))),e.pitchEnd.observers.length&&this.mapInstance.on("pitchend",i=>this.zone.run(()=>e.pitchEnd.emit(i))),e.boxZoomStart.observers.length&&this.mapInstance.on("boxzoomstart",i=>this.zone.run(()=>e.boxZoomStart.emit(i))),e.boxZoomEnd.observers.length&&this.mapInstance.on("boxzoomend",i=>this.zone.run(()=>e.boxZoomEnd.emit(i))),e.boxZoomCancel.observers.length&&this.mapInstance.on("boxzoomcancel",i=>this.zone.run(()=>e.boxZoomCancel.emit(i))),e.webGlContextLost.observers.length&&this.mapInstance.on("webglcontextlost",i=>this.zone.run(()=>e.webGlContextLost.emit(i))),e.webGlContextRestored.observers.length&&this.mapInstance.on("webglcontextrestored",i=>this.zone.run(()=>e.webGlContextRestored.emit(i))),e.render.observers.length&&this.mapInstance.on("render",i=>this.zone.run(()=>e.render.emit(i))),(e.mapError.observers.length||e.error.observers.length)&&this.mapInstance.on("error",i=>this.zone.run(()=>{e.mapError.emit(i),e.error.emit(i)})),e.data.observers.length&&this.mapInstance.on("data",i=>this.zone.run(()=>e.data.emit(i))),e.styleData.observers.length&&this.mapInstance.on("styledata",i=>this.zone.run(()=>e.styleData.emit(i))),e.sourceData.observers.length&&this.mapInstance.on("sourcedata",i=>this.zone.run(()=>e.sourceData.emit(i))),e.dataLoading.observers.length&&this.mapInstance.on("dataloading",i=>this.zone.run(()=>e.dataLoading.emit(i))),e.styleDataLoading.observers.length&&this.mapInstance.on("styledataloading",i=>this.zone.run(()=>e.styleDataLoading.emit(i))),e.sourceDataLoading.observers.length&&this.mapInstance.on("sourcedataloading",i=>this.zone.run(()=>e.sourceDataLoading.emit(i))),e.styleImageMissing.observers.length&&this.mapInstance.on("styleimagemissing",i=>this.zone.run(()=>e.styleImageMissing.emit(i))),e.idle.observers.length&&this.mapInstance.on("idle",i=>this.zone.run(()=>e.idle.emit(i)))}assign(e,i,s){if("string"==typeof i&&(i=i.split(".")),i.length>1){const h=i.shift();this.assign(e[h]="[object Object]"===Object.prototype.toString.call(e[h])?e[h]:{},i,s)}else e[i[0]]=s}}return t.\u0275fac=function(e){return new(e||t)(dt(jn),dt(kM,8))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();function h4(t,n,e){console.warn(`[ngx-mapbox-gl]: ${t}: ${n} is deprecated, please use ${e} instead.`)}let d4=(()=>{class t{constructor(e){this.MapService=e,this.movingMethod="flyTo",this.mapResize=new ut,this.mapRemove=new ut,this.mapMouseDown=new ut,this.mapMouseUp=new ut,this.mapMouseMove=new ut,this.mapClick=new ut,this.mapDblClick=new ut,this.mapMouseOver=new ut,this.mapMouseOut=new ut,this.mapContextMenu=new ut,this.mapTouchStart=new ut,this.mapTouchEnd=new ut,this.mapTouchMove=new ut,this.mapTouchCancel=new ut,this.mapWheel=new ut,this.moveStart=new ut,this.move=new ut,this.moveEnd=new ut,this.mapDragStart=new ut,this.mapDrag=new ut,this.mapDragEnd=new ut,this.zoomStart=new ut,this.zoomEvt=new ut,this.zoomEnd=new ut,this.rotateStart=new ut,this.rotate=new ut,this.rotateEnd=new ut,this.pitchStart=new ut,this.pitchEvt=new ut,this.pitchEnd=new ut,this.boxZoomStart=new ut,this.boxZoomEnd=new ut,this.boxZoomCancel=new ut,this.webGlContextLost=new ut,this.webGlContextRestored=new ut,this.mapLoad=new ut,this.idle=new ut,this.render=new ut,this.mapError=new ut,this.data=new ut,this.styleData=new ut,this.sourceData=new ut,this.dataLoading=new ut,this.styleDataLoading=new ut,this.sourceDataLoading=new ut,this.styleImageMissing=new ut,this.resize=new ut,this.remove=new ut,this.mouseDown=new ut,this.mouseUp=new ut,this.mouseMove=new ut,this.click=new ut,this.dblClick=new ut,this.mouseOver=new ut,this.mouseOut=new ut,this.contextMenu=new ut,this.touchStart=new ut,this.touchEnd=new ut,this.touchMove=new ut,this.touchCancel=new ut,this.wheel=new ut,this.dragStart=new ut,this.drag=new ut,this.dragEnd=new ut,this.load=new ut,this.error=new ut}get mapInstance(){return this.MapService.mapInstance}ngAfterViewInit(){this.warnDeprecatedOutputs(),this.MapService.setup({accessToken:this.accessToken,customMapboxApiUrl:this.customMapboxApiUrl,mapOptions:{collectResourceTiming:this.collectResourceTiming,container:this.mapContainer.nativeElement,crossSourceCollisions:this.crossSourceCollisions,fadeDuration:this.fadeDuration,minZoom:this.minZoom,maxZoom:this.maxZoom,minPitch:this.minPitch,maxPitch:this.maxPitch,style:this.style,hash:this.hash,interactive:this.interactive,bearingSnap:this.bearingSnap,pitchWithRotate:this.pitchWithRotate,clickTolerance:this.clickTolerance,attributionControl:this.attributionControl,logoPosition:this.logoPosition,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,refreshExpiredTiles:this.refreshExpiredTiles,maxBounds:this.maxBounds,scrollZoom:this.scrollZoom,boxZoom:this.boxZoom,dragRotate:this.dragRotate,dragPan:this.dragPan,keyboard:this.keyboard,doubleClickZoom:this.doubleClickZoom,touchPitch:this.touchPitch,touchZoomRotate:this.touchZoomRotate,trackResize:this.trackResize,center:this.center,zoom:this.zoom,bearing:this.bearing,pitch:this.pitch,renderWorldCopies:this.renderWorldCopies,maxTileCacheSize:this.maxTileCacheSize,localIdeographFontFamily:this.localIdeographFontFamily,transformRequest:this.transformRequest,bounds:this.bounds?this.bounds:this.fitBounds,fitBoundsOptions:this.fitBoundsOptions,antialias:this.antialias,locale:this.locale},mapEvents:this}),this.cursorStyle&&this.MapService.changeCanvasCursor(this.cursorStyle)}ngOnDestroy(){this.MapService.destroyMap()}ngOnChanges(e){return DM(this,void 0,void 0,function*(){yield this.MapService.mapCreated$.toPromise(),e.cursorStyle&&!e.cursorStyle.isFirstChange()&&this.MapService.changeCanvasCursor(e.cursorStyle.currentValue),e.minZoom&&!e.minZoom.isFirstChange()&&this.MapService.updateMinZoom(e.minZoom.currentValue),e.maxZoom&&!e.maxZoom.isFirstChange()&&this.MapService.updateMaxZoom(e.maxZoom.currentValue),e.minPitch&&!e.minPitch.isFirstChange()&&this.MapService.updateMinPitch(e.minPitch.currentValue),e.maxPitch&&!e.maxPitch.isFirstChange()&&this.MapService.updateMaxPitch(e.maxPitch.currentValue),e.renderWorldCopies&&!e.renderWorldCopies.isFirstChange()&&this.MapService.updateRenderWorldCopies(e.renderWorldCopies.currentValue),e.scrollZoom&&!e.scrollZoom.isFirstChange()&&this.MapService.updateScrollZoom(e.scrollZoom.currentValue),e.dragRotate&&!e.dragRotate.isFirstChange()&&this.MapService.updateDragRotate(e.dragRotate.currentValue),e.touchPitch&&!e.touchPitch.isFirstChange()&&this.MapService.updateTouchPitch(e.touchPitch.currentValue),e.touchZoomRotate&&!e.touchZoomRotate.isFirstChange()&&this.MapService.updateTouchZoomRotate(e.touchZoomRotate.currentValue),e.doubleClickZoom&&!e.doubleClickZoom.isFirstChange()&&this.MapService.updateDoubleClickZoom(e.doubleClickZoom.currentValue),e.keyboard&&!e.keyboard.isFirstChange()&&this.MapService.updateKeyboard(e.keyboard.currentValue),e.dragPan&&!e.dragPan.isFirstChange()&&this.MapService.updateDragPan(e.dragPan.currentValue),e.boxZoom&&!e.boxZoom.isFirstChange()&&this.MapService.updateBoxZoom(e.boxZoom.currentValue),e.style&&!e.style.isFirstChange()&&this.MapService.updateStyle(e.style.currentValue),e.maxBounds&&!e.maxBounds.isFirstChange()&&this.MapService.updateMaxBounds(e.maxBounds.currentValue),e.fitBounds&&e.fitBounds.currentValue&&!e.fitBounds.isFirstChange()&&this.MapService.fitBounds(e.fitBounds.currentValue,this.fitBoundsOptions),e.fitScreenCoordinates&&e.fitScreenCoordinates.currentValue&&((this.center||this.zoom||this.pitch||this.fitBounds)&&e.fitScreenCoordinates.isFirstChange()&&console.warn("[ngx-mapbox-gl] center / zoom / pitch / fitBounds inputs are being overridden by fitScreenCoordinates input"),this.MapService.fitScreenCoordinates(e.fitScreenCoordinates.currentValue,this.bearing?this.bearing[0]:0,this.movingOptions)),!this.centerWithPanTo||!e.center||e.center.isFirstChange()||e.zoom||e.bearing||e.pitch?(e.center&&!e.center.isFirstChange()||e.zoom&&!e.zoom.isFirstChange()||e.bearing&&!e.bearing.isFirstChange()&&!e.fitScreenCoordinates||e.pitch&&!e.pitch.isFirstChange())&&this.MapService.move(this.movingMethod,this.movingOptions,e.zoom&&this.zoom?this.zoom[0]:void 0,e.center?this.center:void 0,e.bearing&&this.bearing?this.bearing[0]:void 0,e.pitch&&this.pitch?this.pitch[0]:void 0):this.MapService.panTo(this.center,this.panToOptions)})}warnDeprecatedOutputs(){const e=h4.bind(void 0,t.name);this.resize.observers.length&&e("resize","mapResize"),this.remove.observers.length&&e("remove","mapRemove"),this.mouseDown.observers.length&&e("mouseDown","mapMouseDown"),this.mouseUp.observers.length&&e("mouseUp","mapMouseUp"),this.mouseMove.observers.length&&e("mouseMove","mapMouseMove"),this.click.observers.length&&e("click","mapClick"),this.dblClick.observers.length&&e("dblClick","mapDblClick"),this.mouseOver.observers.length&&e("mouseOver","mapMouseOver"),this.mouseOut.observers.length&&e("mouseOut","mapMouseOut"),this.contextMenu.observers.length&&e("contextMenu","mapContextMenu"),this.touchStart.observers.length&&e("touchStart","mapTouchStart"),this.touchEnd.observers.length&&e("touchEnd","mapTouchEnd"),this.touchMove.observers.length&&e("touchMove","mapTouchMove"),this.touchCancel.observers.length&&e("touchCancel","mapTouchCancel"),this.wheel.observers.length&&e("wheel","mapWheel"),this.dragStart.observers.length&&e("dragStart","mapDragStart"),this.drag.observers.length&&e("drag","mapDrag"),this.dragEnd.observers.length&&e("dragEnd","mapDragEnd"),this.load.observers.length&&e("load","mapLoad"),this.error.observers.length&&e("error","mapError")}}return t.\u0275fac=function(e){return new(e||t)(Ne(IM))},t.\u0275cmp=Jn({type:t,selectors:[["mgl-map"]],viewQuery:function(e,i){if(1&e&&Zc(o4,7),2&e){let s;hi(s=di())&&(i.mapContainer=s.first)}},inputs:{accessToken:"accessToken",collectResourceTiming:"collectResourceTiming",crossSourceCollisions:"crossSourceCollisions",customMapboxApiUrl:"customMapboxApiUrl",fadeDuration:"fadeDuration",hash:"hash",refreshExpiredTiles:"refreshExpiredTiles",failIfMajorPerformanceCaveat:"failIfMajorPerformanceCaveat",bearingSnap:"bearingSnap",interactive:"interactive",pitchWithRotate:"pitchWithRotate",clickTolerance:"clickTolerance",attributionControl:"attributionControl",logoPosition:"logoPosition",maxTileCacheSize:"maxTileCacheSize",localIdeographFontFamily:"localIdeographFontFamily",preserveDrawingBuffer:"preserveDrawingBuffer",trackResize:"trackResize",transformRequest:"transformRequest",bounds:"bounds",antialias:"antialias",locale:"locale",minZoom:"minZoom",maxZoom:"maxZoom",minPitch:"minPitch",maxPitch:"maxPitch",scrollZoom:"scrollZoom",dragRotate:"dragRotate",touchPitch:"touchPitch",touchZoomRotate:"touchZoomRotate",doubleClickZoom:"doubleClickZoom",keyboard:"keyboard",dragPan:"dragPan",boxZoom:"boxZoom",style:"style",center:"center",maxBounds:"maxBounds",zoom:"zoom",bearing:"bearing",pitch:"pitch",fitBoundsOptions:"fitBoundsOptions",renderWorldCopies:"renderWorldCopies",movingMethod:"movingMethod",movingOptions:"movingOptions",fitBounds:"fitBounds",fitScreenCoordinates:"fitScreenCoordinates",centerWithPanTo:"centerWithPanTo",panToOptions:"panToOptions",cursorStyle:"cursorStyle"},outputs:{mapResize:"mapResize",mapRemove:"mapRemove",mapMouseDown:"mapMouseDown",mapMouseUp:"mapMouseUp",mapMouseMove:"mapMouseMove",mapClick:"mapClick",mapDblClick:"mapDblClick",mapMouseOver:"mapMouseOver",mapMouseOut:"mapMouseOut",mapContextMenu:"mapContextMenu",mapTouchStart:"mapTouchStart",mapTouchEnd:"mapTouchEnd",mapTouchMove:"mapTouchMove",mapTouchCancel:"mapTouchCancel",mapWheel:"mapWheel",moveStart:"moveStart",move:"move",moveEnd:"moveEnd",mapDragStart:"mapDragStart",mapDrag:"mapDrag",mapDragEnd:"mapDragEnd",zoomStart:"zoomStart",zoomEvt:"zoomEvt",zoomEnd:"zoomEnd",rotateStart:"rotateStart",rotate:"rotate",rotateEnd:"rotateEnd",pitchStart:"pitchStart",pitchEvt:"pitchEvt",pitchEnd:"pitchEnd",boxZoomStart:"boxZoomStart",boxZoomEnd:"boxZoomEnd",boxZoomCancel:"boxZoomCancel",webGlContextLost:"webGlContextLost",webGlContextRestored:"webGlContextRestored",mapLoad:"mapLoad",idle:"idle",render:"render",mapError:"mapError",data:"data",styleData:"styleData",sourceData:"sourceData",dataLoading:"dataLoading",styleDataLoading:"styleDataLoading",sourceDataLoading:"sourceDataLoading",styleImageMissing:"styleImageMissing",resize:"resize",remove:"remove",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseMove:"mouseMove",click:"click",dblClick:"dblClick",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchMove:"touchMove",touchCancel:"touchCancel",wheel:"wheel",dragStart:"dragStart",drag:"drag",dragEnd:"dragEnd",load:"load",error:"error"},features:[ti([IM]),In],decls:2,vars:0,consts:[["container",""]],template:function(e,i){1&e&&Fi(0,"div",null,0)},styles:["[_nghost-%COMP%] {\n        display: block;\n      }\n      div[_ngcontent-%COMP%] {\n        height: 100%;\n        width: 100%;\n      }"],changeDetection:0}),t})();const p4=new on("MapboxApiKey");let f4=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:kM,useValue:e.accessToken},{provide:p4,useValue:e.geocoderAccessToken||e.accessToken}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa]]}),t})(),PM=(()=>{class t{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return t.\u0275fac=function(e){return new(e||t)(Ne(to),Ne(Nn))},t.\u0275dir=Rt({type:t}),t})(),ip=(()=>{class t extends PM{}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Jr(t)))(i||t)}}(),t.\u0275dir=Rt({type:t,features:[Hi]}),t})();const oo=new on("NgValueAccessor"),y4={provide:oo,useExisting:Q(()=>uw),multi:!0},v4=new on("CompositionEventMode");let uw=(()=>{class t extends PM{constructor(e,i,s){super(e,i),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=Jc()?Jc().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",null==e?"":e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return t.\u0275fac=function(e){return new(e||t)(Ne(to),Ne(Nn),Ne(v4,8))},t.\u0275dir=Rt({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&qt("input",function(h){return i._handleInput(h.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(h){return i._compositionEnd(h.target.value)})},features:[ti([y4]),Hi]}),t})();const ao=new on("NgValidators"),Oh=new on("NgAsyncValidators");function jM(t){return null!=t}function $M(t){const n=Sm(t)?V(t):t;return H_(n),n}function GM(t){let n={};return t.forEach(e=>{n=null!=e?Qt(Qt({},n),e):n}),0===Object.keys(n).length?null:n}function WM(t,n){return n.map(e=>e(t))}function XM(t){return t.map(n=>function(t){return!t.validate}(n)?n:e=>n.validate(e))}function hw(t){return null!=t?function(t){if(!t)return null;const n=t.filter(jM);return 0==n.length?null:function(e){return GM(WM(e,n))}}(XM(t)):null}function dw(t){return null!=t?function(t){if(!t)return null;const n=t.filter(jM);return 0==n.length?null:function(e){return function(...t){const n=te(t),{args:e,keys:i}=ZA(t),s=new Cn(h=>{const{length:m}=e;if(!m)return void h.complete();const S=new Array(m);let I=m,F=m;for(let G=0;G<m;G++){let J=!1;Ei(e[G]).subscribe(new vn(h,re=>{J||(J=!0,F--),S[G]=re},()=>I--,void 0,()=>{(!I||!J)&&(F||h.next(i?JA(i,S):S),h.complete())}))}});return n?s.pipe(I1(n)):s}(WM(e,n).map($M)).pipe(Kt(GM))}}(XM(t)):null}function ZM(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function pw(t){return t?Array.isArray(t)?t:[t]:[]}function nx(t,n){return Array.isArray(t)?t.includes(n):t===n}function QM(t,n){const e=pw(n);return pw(t).forEach(s=>{nx(e,s)||e.push(s)}),e}function ek(t,n){return pw(n).filter(e=>!nx(t,e))}class tk{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=hw(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=dw(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class la extends tk{get formDirective(){return null}get path(){return null}}class Lh extends tk{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let ik=(()=>{class t extends class{constructor(n){this._cd=n}is(n){var e,i,s;return"submitted"===n?!!(null==(e=this._cd)?void 0:e.submitted):!!(null==(s=null==(i=this._cd)?void 0:i.control)?void 0:s[n])}}{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(Ne(Lh,2))},t.\u0275dir=Rt({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&An("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[Hi]}),t})();function yy(t,n){(function(t,n){const e=function(t){return t._rawValidators}(t);null!==n.validator?t.setValidators(ZM(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const i=function(t){return t._rawAsyncValidators}(t);null!==n.asyncValidator?t.setAsyncValidators(ZM(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const s=()=>t.updateValueAndValidity();ox(n._rawValidators,s),ox(n._rawAsyncValidators,s)})(t,n),n.valueAccessor.writeValue(t.value),function(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&rk(t,n)})}(t,n),function(t,n){const e=(i,s)=>{n.valueAccessor.writeValue(i),s&&n.viewToModelUpdate(i)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&rk(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function(t,n){if(n.valueAccessor.setDisabledState){const e=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function ox(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function rk(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function lx(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}const _y="VALID",cx="INVALID",Jf="PENDING",vy="DISABLED";function vw(t){return(bw(t)?t.validators:t)||null}function ak(t){return Array.isArray(t)?hw(t):t||null}function xw(t,n){return(bw(n)?n.asyncValidators:t)||null}function lk(t){return Array.isArray(t)?dw(t):t||null}function bw(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class ww{constructor(n,e){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=n,this._rawAsyncValidators=e,this._composedValidatorFn=ak(this._rawValidators),this._composedAsyncValidatorFn=lk(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===_y}get invalid(){return this.status===cx}get pending(){return this.status==Jf}get disabled(){return this.status===vy}get enabled(){return this.status!==vy}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._rawValidators=n,this._composedValidatorFn=ak(n)}setAsyncValidators(n){this._rawAsyncValidators=n,this._composedAsyncValidatorFn=lk(n)}addValidators(n){this.setValidators(QM(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(QM(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(ek(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(ek(n,this._rawAsyncValidators))}hasValidator(n){return nx(this._rawValidators,n)}hasAsyncValidator(n){return nx(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=Jf,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=vy,this.errors=null,this._forEachChild(i=>{i.disable(Vs(Qt({},n),{onlySelf:!0}))}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Vs(Qt({},n),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=_y,this._forEachChild(i=>{i.enable(Vs(Qt({},n),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors(Vs(Qt({},n),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===_y||this.status===Jf)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?vy:_y}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=Jf,this._hasOwnPendingAsyncValidator=!0;const e=$M(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){return function(t,n,e){if(null==n||(Array.isArray(n)||(n=n.split(".")),Array.isArray(n)&&0===n.length))return null;let i=t;return n.forEach(s=>{i=i instanceof Cw?i.controls.hasOwnProperty(s)?i.controls[s]:null:i instanceof N4&&i.at(s)||null}),i}(this,n)}getError(n,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new ut,this.statusChanges=new ut}_calculateStatus(){return this._allControlsDisabled()?vy:this.errors?cx:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Jf)?Jf:this._anyControlsHaveStatus(cx)?cx:_y}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_isBoxedValue(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){bw(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class ux extends ww{constructor(n=null,e,i){super(vw(e),xw(i,e)),this._onChange=[],this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=null,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){lx(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){lx(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){this._isBoxedValue(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}}class Cw extends ww{constructor(n,e,i){super(vw(e),xw(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,i={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){this._checkAllValuesPresent(n),Object.keys(n).forEach(i=>{this._throwIfControlMissing(i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((i,s)=>{i.reset(n[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,i)=>(n[i]=e instanceof ux?e.value:e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_throwIfControlMissing(n){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[n])throw new Error(`Cannot find form control with name: ${n}.`)}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&n(i,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const e of Object.keys(this.controls)){const i=this.controls[e];if(this.contains(e)&&n(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(n,e,i)=>((e.enabled||this.disabled)&&(n[i]=e.value),n))}_reduceChildren(n,e){let i=n;return this._forEachChild((s,h)=>{i=e(i,s,h)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(n){this._forEachChild((e,i)=>{if(void 0===n[i])throw new Error(`Must supply a value for form control with name: '${i}'.`)})}}class N4 extends ww{constructor(n,e,i){super(vw(e),xw(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[n]}push(n,e={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(n,e,i={}){this.controls.splice(n,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),e&&(this.controls.splice(n,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,e={}){this._checkAllValuesPresent(n),n.forEach((i,s)=>{this._throwIfControlMissing(s),this.at(s).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(n.forEach((i,s)=>{this.at(s)&&this.at(s).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n=[],e={}){this._forEachChild((i,s)=>{i.reset(n[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(n=>n instanceof ux?n.value:n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_syncPendingControls(){let n=this.controls.reduce((e,i)=>!!i._syncPendingControls()||e,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_throwIfControlMissing(n){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(n))throw new Error(`Cannot find form control at index ${n}`)}_forEachChild(n){this.controls.forEach((e,i)=>{n(e,i)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(e=>e.enabled&&n(e))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_checkAllValuesPresent(n){this._forEachChild((e,i)=>{if(void 0===n[i])throw new Error(`Must supply a value for form control at index: ${i}.`)})}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}}const L4={provide:Lh,useExisting:Q(()=>Dw)},hk=(()=>Promise.resolve(null))();let Dw=(()=>{class t extends Lh{constructor(e,i,s,h){super(),this.control=new ux,this._registered=!1,this.update=new ut,this._parent=e,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=function(t,n){if(!n)return null;let e,i,s;return Array.isArray(n),n.forEach(h=>{h.constructor===uw?e=h:function(t){return Object.getPrototypeOf(t.constructor)===ip}(h)?i=h:s=h}),s||i||e||null}(0,h)}ngOnChanges(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),function(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function(t,n){return[...n.path,t]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){yy(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){hk.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1})})}_updateDisabled(e){const i=e.isDisabled.currentValue,s=""===i||i&&"false"!==i;hk.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable()})}}return t.\u0275fac=function(e){return new(e||t)(Ne(la,9),Ne(ao,10),Ne(Oh,10),Ne(oo,10))},t.\u0275dir=Rt({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ti([L4]),Hi,In]}),t})(),pk=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({}),t})();const Y4={provide:oo,useExisting:Q(()=>hx),multi:!0};function xk(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let hx=(()=>{class t extends ip{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const i=this._getOptionId(e);null==i&&this.setProperty("selectedIndex",-1);const s=xk(i,e);this.setProperty("value",s)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Jr(t)))(i||t)}}(),t.\u0275dir=Rt({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,i){1&e&&qt("change",function(h){return i.onChange(h.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[ti([Y4]),Hi]}),t})(),Mw=(()=>{class t{constructor(e,i,s){this._element=e,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(xk(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(Ne(Nn),Ne(to),Ne(hx,9))},t.\u0275dir=Rt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const Z4={provide:oo,useExisting:Q(()=>kw),multi:!0};function bk(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let kw=(()=>{class t extends ip{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const s=e.map(h=>this._getOptionId(h));i=(h,m)=>{h._setSelected(s.indexOf(m.toString())>-1)}}else i=(s,h)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const s=[];if(void 0!==i.selectedOptions){const h=i.selectedOptions;for(let m=0;m<h.length;m++){const S=h.item(m),I=this._getOptionValue(S.value);s.push(I)}}else{const h=i.options;for(let m=0;m<h.length;m++){const S=h.item(m);if(S.selected){const I=this._getOptionValue(S.value);s.push(I)}}}this.value=s,e(s)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Jr(t)))(i||t)}}(),t.\u0275dir=Rt({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,i){1&e&&qt("change",function(h){return i.onChange(h.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[ti([Z4]),Hi]}),t})(),Iw=(()=>{class t{constructor(e,i,s){this._element=e,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(bk(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(bk(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(Ne(Nn),Ne(to),Ne(kw,9))},t.\u0275dir=Rt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})(),o6=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[pk]]}),t})(),Ik=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[o6]}),t})();function a6(t,n){if(1&t&&(vt(0,"option",10),Yi(1),xt()),2&t){const e=n.$implicit;mt("value",e),wt(1),ea(e)}}function l6(t,n){if(1&t&&(vt(0,"option",10),Yi(1),xt()),2&t){const e=n.$implicit;mt("value",e.value),wt(1),ea(e.text)}}const Pk=function(t){return{text:t}},Rk=function(){return{position:"bottom"}},c6=function(t){return{horizontal:!0,distributed:!0,barHeight:"85%",dataLabels:t}},Nk=function(t){return{bar:t}},Fk=function(t,n){return{title:t,plotOptions:n}};function u6(t,n){if(1&t&&(vt(0,"div",11),Fi(1,"app-chart-plug",12),xt()),2&t){const e=Nt();wt(1),mt("data",e.chart.list)("options",Wd(9,Fk,qc(2,Pk,"Others list "+e.form.field.selection_type),qc(7,Nk,qc(5,c6,K_(4,Rk)))))}}function h6(t,n){1&t&&(vt(0,"div",13),Fi(1,"app-chart-plug"),xt())}const d6=function(t){return{horizontal:!0,distributed:!0,barHeight:"90%",dataLabels:t}};function p6(t,n){if(1&t&&(vt(0,"div",14),Fi(1,"app-chart-plug",12),xt()),2&t){const e=Nt();wt(1),mt("data",e.chart.general)("options",Wd(9,Fk,qc(2,Pk,"Top 10 "+e.form.field.selection_type),qc(7,Nk,qc(5,d6,K_(4,Rk)))))}}const f6=function(){return[2]};let Ok=(()=>{class t{constructor(e){this.apiService=e,this.fitBound=new aa.LngLatBounds,this.map={center:new aa.LngLat(-74.5,40),fitBound:new aa.LngLatBounds,markers:[]},this.continents=[],this.countries=[],this.form={field:{selection_continent:"",selection_type:"active"},options:{selection_continent:[],selection_type:[{value:"active",text:"Active"},{value:"cases",text:"Cases"},{value:"critical",text:"Critical"},{value:"deaths",text:"Deaths"},{value:"recovered",text:"Recovered"},{value:"tests",text:"Tests"},{value:"todayCases",text:"Today Cases"},{value:"todayDeaths",text:"Today Deaths"},{value:"todayRecovered",text:"Today Recovered"}]}},this.chart={general:[],list:[]}}ngOnInit(){}callDataContinents(){let e=this.apiService.getDataCountries(),i=this.apiService.getDataContinets();e.subscribe({next:s=>{this.countries=s},error:s=>console.error("Observer got an error: "+s),complete:()=>{i.subscribe({next:s=>{this.continents=s},error:s=>console.error("Observer got an error: "+s),complete:()=>{this.form.options.selection_continent=this.continents.map(s=>s.continent),this.form.field.selection_continent=this.continents[0].continent,this.continent=this.continents[0],this.focusMap()}})}})}focusMap(){let e=new aa.LngLatBounds;this.countries.filter(i=>this.continent.countries.findIndex(s=>s==i.country)>=0).map(i=>new aa.LngLat(i.countryInfo.long,i.countryInfo.lat)).forEach(i=>{e.extend(i)}),this.baseMap.fitBounds(e,{padding:{left:100,right:300,top:100,bottom:300}}),this.setDataGeneral()}findTypeInfo(e){let i=Object.keys(e).findIndex(s=>s.toLowerCase()==this.form.field.selection_type.toLowerCase());return Object.values(e)[i]}setDataGeneral(){this.map.markers.forEach(h=>h.remove());let i=this.countries.filter(h=>this.continent.countries.findIndex(m=>m==h.country)>=0).filter(h=>this.findTypeInfo(h)>0).sort((h,m)=>this.findTypeInfo(h)<this.findTypeInfo(m)?1:-1),s=i.splice(0,10);this.chart.general=s.map(h=>({x:h.country,y:this.findTypeInfo(h)})),this.chart.list=i.map(h=>({x:h.country,y:this.findTypeInfo(h)})),s.forEach(h=>{const m=new aa.Marker({color:"red"}).setLngLat(new aa.LngLat(h.countryInfo.long,h.countryInfo.lat)).addTo(this.baseMap);this.map.markers.push(m)}),i.forEach(h=>{const m=new aa.Marker({color:"blue"}).setLngLat(new aa.LngLat(h.countryInfo.long,h.countryInfo.lat)).addTo(this.baseMap);this.map.markers.push(m)})}chooseContinent(){this.continent=this.continents.find(e=>e.continent==this.form.field.selection_continent),this.focusMap()}chooseCountry(e){}loadMap(e){this.baseMap=e,this.callDataContinents()}getLatLng(e){let i=this.countries.find(s=>s.country==e);return new aa.LngLat(i.countryInfo.long,i.countryInfo.lat)}}return t.\u0275fac=function(e){return new(e||t)(Ne(CM))},t.\u0275cmp=Jn({type:t,selectors:[["app-covid"]],features:[ti([uM])],decls:12,vars:12,consts:[[1,"position-relative","w-100","h-100"],[3,"zoom","center","load"],[1,"position-absolute","p-2",2,"top","0","right","0","width","20%","height","100%"],[1,"h-100","d-flex","bd-highlight","flex-column"],[1,"bd-highlight","w-100"],["id","",1,"form-control",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["class","bd-highlight flex-fill w-100",4,"ngIf"],["class","position-absolute bg-danger","style","top: 0;right:0;bottom: 0;",4,"ngIf"],["class","position-absolute p-2","style","width:80%;left:0;bottom: 0;",4,"ngIf"],[3,"value"],[1,"bd-highlight","flex-fill","w-100"],[3,"data","options"],[1,"position-absolute","bg-danger",2,"top","0","right","0","bottom","0"],[1,"position-absolute","p-2",2,"width","80%","left","0","bottom","0"]],template:function(e,i){1&e&&(vt(0,"div",0),vt(1,"mgl-map",1),qt("load",function(h){return i.loadMap(h)}),xt(),vt(2,"div",2),vt(3,"div",3),vt(4,"div",4),vt(5,"select",5),qt("ngModelChange",function(h){return i.form.field.selection_continent=h})("change",function(){return i.chooseContinent()}),kt(6,a6,2,2,"option",6),xt(),vt(7,"select",5),qt("ngModelChange",function(h){return i.form.field.selection_type=h})("change",function(){return i.chooseContinent()}),kt(8,l6,2,2,"option",6),xt(),xt(),kt(9,u6,2,12,"div",7),xt(),xt(),kt(10,h6,2,0,"div",8),kt(11,p6,2,12,"div",9),xt()),2&e&&(wt(1),function(t){Kl(vS,lP,t,!1)}("mapbox://styles/mapbox/streets-v9"),mt("zoom",K_(11,f6))("center",i.map.center),wt(4),mt("ngModel",i.form.field.selection_continent),wt(1),mt("ngForOf",i.form.options.selection_continent),wt(1),mt("ngModel",i.form.field.selection_type),wt(1),mt("ngForOf",i.form.options.selection_type),wt(1),mt("ngIf",i.chart.list.length),wt(1),mt("ngIf",!1),wt(1),mt("ngIf",i.baseMap&&i.continent))},directives:[d4,hx,ik,Dw,za,sa,Mw,Iw,uM],styles:["mgl-map[_ngcontent-%COMP%]{height:100vh;width:100%}"]}),t})(),g6=(()=>{class t{constructor(){this.title="etiqa"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Jn({type:t,selectors:[["app-root"]],features:[ti([Ok])],decls:7,vars:0,consts:[["role","main",1,"content-fluid"],["id","clouds","xmlns","http://www.w3.org/2000/svg","width","2611.084","height","485.677","viewBox","0 0 2611.084 485.677"],["id","Path_39","data-name","Path 39","d","M2379.709,863.793c10-93-77-171-168-149-52-114-225-105-264,15-75,3-140,59-152,133-30,2.83-66.725,9.829-93.5,26.25-26.771-16.421-63.5-23.42-93.5-26.25-12-74-77-130-152-133-39-120-212-129-264-15-54.084-13.075-106.753,9.173-138.488,48.9-31.734-39.726-84.4-61.974-138.487-48.9-52-114-225-105-264,15a162.027,162.027,0,0,0-103.147,43.044c-30.633-45.365-87.1-72.091-145.206-58.044-52-114-225-105-264,15-75,3-140,59-152,133-53,5-127,23-130,83-2,42,35,72,70,86,49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33,61.112,8.015,113.854-5.72,150.492-29.764a165.62,165.62,0,0,0,110.861-3.236c47,94,178,113,251,33,31.385,4.116,60.563,2.495,86.487-3.311,25.924,5.806,55.1,7.427,86.488,3.311,73,80,204,61,251-33a165.625,165.625,0,0,0,120,0c51,13,108,15,157-5a147.188,147.188,0,0,0,33.5-18.694,147.217,147.217,0,0,0,33.5,18.694c49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33C2446.709,1093.793,2554.709,922.793,2379.709,863.793Z","transform","translate(142.69 -634.312)","fill","#eee"]],template:function(e,i){1&e&&(vt(0,"div",0),Fi(1,"app-covid"),en.lFrame.currentNamespace=xo,vt(2,"svg",1),vt(3,"title"),Yi(4,"Gray Clouds Background"),xt(),Fi(5,"path",2),xt(),xt(),en.lFrame.currentNamespace=null,Fi(6,"router-outlet"))},directives:[Ok,W1],styles:["",'[_nghost-%COMP%] {\n    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n    font-size: 14px;\n    color: #333;\n    box-sizing: border-box;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n\n  h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%] {\n    margin: 8px 0;\n  }\n\n  p[_ngcontent-%COMP%] {\n    margin: 0;\n  }\n\n  .spacer[_ngcontent-%COMP%] {\n    flex: 1;\n  }\n\n  .toolbar[_ngcontent-%COMP%] {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 60px;\n    display: flex;\n    align-items: center;\n    background-color: #1976d2;\n    color: white;\n    font-weight: 600;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n    margin: 0 16px;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   #twitter-logo[_ngcontent-%COMP%] {\n    height: 40px;\n    margin: 0 8px;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   #youtube-logo[_ngcontent-%COMP%] {\n    height: 40px;\n    margin: 0 16px;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   #twitter-logo[_ngcontent-%COMP%]:hover, .toolbar[_ngcontent-%COMP%]   #youtube-logo[_ngcontent-%COMP%]:hover {\n    opacity: 0.8;\n  }\n\n  .content[_ngcontent-%COMP%] {\n    display: flex;\n    \n    \n    max-width: 960px;\n    flex-direction: column;\n    align-items: center;\n  }\n\n  svg.material-icons[_ngcontent-%COMP%] {\n    height: 24px;\n    width: auto;\n  }\n\n  svg.material-icons[_ngcontent-%COMP%]:not(:last-child) {\n    margin-right: 8px;\n  }\n\n  .card[_ngcontent-%COMP%]   svg.material-icons[_ngcontent-%COMP%]   path[_ngcontent-%COMP%] {\n    fill: #888;\n  }\n\n  .card-container[_ngcontent-%COMP%] {\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: center;\n    margin-top: 16px;\n  }\n\n  .card[_ngcontent-%COMP%] {\n    all: unset;\n    border-radius: 4px;\n    border: 1px solid #eee;\n    background-color: #fafafa;\n    height: 40px;\n    width: 200px;\n    margin: 0 8px 16px;\n    padding: 16px;\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    align-items: center;\n    transition: all 0.2s ease-in-out;\n    line-height: 24px;\n  }\n\n  .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:not(:last-child) {\n    margin-right: 0;\n  }\n\n  .card.card-small[_ngcontent-%COMP%] {\n    height: 16px;\n    width: 168px;\n  }\n\n  .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:not(.highlight-card) {\n    cursor: pointer;\n  }\n\n  .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:not(.highlight-card):hover {\n    transform: translateY(-3px);\n    box-shadow: 0 4px 17px rgba(0, 0, 0, 0.35);\n  }\n\n  .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:not(.highlight-card):hover   .material-icons[_ngcontent-%COMP%]   path[_ngcontent-%COMP%] {\n    fill: rgb(105, 103, 103);\n  }\n\n  .card.highlight-card[_ngcontent-%COMP%] {\n    background-color: #1976d2;\n    color: white;\n    font-weight: 600;\n    border: none;\n    width: auto;\n    min-width: 30%;\n    position: relative;\n  }\n\n  .card.card.highlight-card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\n    margin-left: 60px;\n  }\n\n  svg#rocket[_ngcontent-%COMP%] {\n    width: 80px;\n    position: absolute;\n    left: -10px;\n    top: -24px;\n  }\n\n  svg#rocket-smoke[_ngcontent-%COMP%] {\n    height: calc(100vh - 95px);\n    position: absolute;\n    top: 10px;\n    right: 180px;\n    z-index: -10;\n  }\n\n  a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:visited, a[_ngcontent-%COMP%]:hover {\n    color: #1976d2;\n    text-decoration: none;\n  }\n\n  a[_ngcontent-%COMP%]:hover {\n    color: #125699;\n  }\n\n  .terminal[_ngcontent-%COMP%] {\n    position: relative;\n    width: 80%;\n    max-width: 600px;\n    border-radius: 6px;\n    padding-top: 45px;\n    margin-top: 8px;\n    overflow: hidden;\n    background-color: rgb(15, 15, 16);\n  }\n\n  .terminal[_ngcontent-%COMP%]::before {\n    content: "\\2022 \\2022 \\2022";\n    position: absolute;\n    top: 0;\n    left: 0;\n    height: 4px;\n    background: rgb(58, 58, 58);\n    color: #c2c3c4;\n    width: 100%;\n    font-size: 2rem;\n    line-height: 0;\n    padding: 14px 0;\n    text-indent: 4px;\n  }\n\n  .terminal[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%] {\n    font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;\n    color: white;\n    padding: 0 1rem 1rem;\n    margin: 0;\n  }\n\n  .circle-link[_ngcontent-%COMP%] {\n    height: 40px;\n    width: 40px;\n    border-radius: 40px;\n    margin: 8px;\n    background-color: white;\n    border: 1px solid #eeeeee;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    cursor: pointer;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\n    transition: 1s ease-out;\n  }\n\n  .circle-link[_ngcontent-%COMP%]:hover {\n    transform: translateY(-0.25rem);\n    box-shadow: 0px 3px 15px rgba(0, 0, 0, 0.2);\n  }\n\n  footer[_ngcontent-%COMP%] {\n    margin-top: 8px;\n    display: flex;\n    align-items: center;\n    line-height: 20px;\n  }\n\n  footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    display: flex;\n    align-items: center;\n  }\n\n  .github-star-badge[_ngcontent-%COMP%] {\n    color: #24292e;\n    display: flex;\n    align-items: center;\n    font-size: 12px;\n    padding: 3px 10px;\n    border: 1px solid rgba(27,31,35,.2);\n    border-radius: 3px;\n    background-image: linear-gradient(-180deg,#fafbfc,#eff3f6 90%);\n    margin-left: 4px;\n    font-weight: 600;\n  }\n\n  .github-star-badge[_ngcontent-%COMP%]:hover {\n    background-image: linear-gradient(-180deg,#f0f3f6,#e6ebf1 90%);\n    border-color: rgba(27,31,35,.35);\n    background-position: -.5em;\n  }\n\n  .github-star-badge[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%] {\n    height: 16px;\n    width: 16px;\n    margin-right: 4px;\n  }\n\n  svg#clouds[_ngcontent-%COMP%] {\n    position: fixed;\n    bottom: -160px;\n    left: -230px;\n    z-index: -10;\n    width: 1920px;\n  }\n\n  \n  @media screen and (max-width: 767px) {\n    .card-container[_ngcontent-%COMP%]    > *[_ngcontent-%COMP%]:not(.circle-link), .terminal[_ngcontent-%COMP%] {\n      width: 100%;\n    }\n\n    .card[_ngcontent-%COMP%]:not(.highlight-card) {\n      height: 16px;\n      margin: 8px 0;\n    }\n\n    .card.highlight-card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\n      margin-left: 72px;\n    }\n\n    svg#rocket-smoke[_ngcontent-%COMP%] {\n      right: 120px;\n      transform: rotate(-5deg);\n    }\n  }\n\n  @media screen and (max-width: 575px) {\n    svg#rocket-smoke[_ngcontent-%COMP%] {\n      display: none;\n      visibility: hidden;\n    }\n  }']}),t})();const m6=["addListener","removeListener"],y6=["addEventListener","removeEventListener"],_6=["on","off"];function zs(t,n,e,i){if(Vn(e)&&(i=e,e=void 0),i)return zs(t,n,e).pipe(I1(i));const[s,h]=function(t){return Vn(t.addEventListener)&&Vn(t.removeEventListener)}(t)?y6.map(m=>S=>t[m](n,S,e)):function(t){return Vn(t.addListener)&&Vn(t.removeListener)}(t)?m6.map(Lk(t,n)):function(t){return Vn(t.on)&&Vn(t.off)}(t)?_6.map(Lk(t,n)):[];if(!s&&Oo(t))return Ie(m=>zs(m,n,e))(Ei(t));if(!s)throw new TypeError("Invalid event target");return new Cn(m=>{const S=(...I)=>m.next(1<I.length?I:I[0]);return s(S),()=>h(S)})}function Lk(t,n){return e=>i=>t[e](n,i)}const w6=new oM(iM);const{isArray:S6}=Array;function Bk(t){return 1===t.length&&S6(t[0])?t[0]:t}function px(...t){const n=te(t),e=Bk(t);return e.length?new Cn(i=>{let s=e.map(()=>[]),h=e.map(()=>!1);i.add(()=>{s=h=null});for(let m=0;!i.closed&&m<e.length;m++)Ei(e[m]).subscribe(new vn(i,S=>{if(s[m].push(S),s.every(I=>I.length)){const I=s.map(F=>F.shift());i.next(n?n(...I):I),s.some((F,G)=>!F.length&&h[G])&&i.complete()}},()=>{h[m]=!0,!s[m].length&&i.complete()}));return()=>{s=h=null}}):Ue}function Ir(t){return ni((n,e)=>{Ei(t).subscribe(new vn(e,()=>e.complete(),Ds)),!e.closed&&n.subscribe(e)})}function Fw(...t){const n=te(t);return ni((e,i)=>{const s=t.length,h=new Array(s);let m=t.map(()=>!1),S=!1;for(let I=0;I<s;I++)Ei(t[I]).subscribe(new vn(i,F=>{h[I]=F,!S&&!m[I]&&(m[I]=!0,(S=m.every(as))&&(m=null))},Ds));e.subscribe(new vn(i,I=>{if(S){const F=[I,...h];i.next(n?n(...F):F)}}))})}new Cn(Ds);const Kf=["*"],_U=["dialog"];function zh(t){return null!=t}function eg(t){return(t||document.body).getBoundingClientRect()}"undefined"!=typeof Element&&!Element.prototype.closest&&(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest=function(t){let n=this;if(!document.documentElement.contains(n))return null;do{if(n.matches(t))return n;n=n.parentElement||n.parentNode}while(null!==n&&1===n.nodeType);return null});const Wk={animation:!0,transitionTimerDelayMs:5};let Bs=(()=>{class t{constructor(){this.animation=Wk.animation}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Ft({factory:function(){return new t},token:t,providedIn:"root"}),t})();const kH=()=>{},{transitionTimerDelayMs:IH}=Wk,wy=new Map,bs=(t,n,e,i)=>{let s=i.context||{};const h=wy.get(n);if(h)switch(i.runningTransition){case"continue":return Ue;case"stop":t.run(()=>h.transition$.complete()),s=Object.assign(h.context,s),wy.delete(n)}const m=e(n,i.animation,s)||kH;if(!i.animation||"none"===window.getComputedStyle(n).transitionProperty)return t.run(()=>m()),fn(void 0).pipe(function(t){return n=>new Cn(e=>n.subscribe(m=>t.run(()=>e.next(m)),m=>t.run(()=>e.error(m)),()=>t.run(()=>e.complete())))}(t));const S=new Dn,I=new Dn,F=S.pipe(function(...t){return n=>ny(n,fn(...t))}(!0));wy.set(n,{transition$:S,complete:()=>{I.next(),I.complete()},context:s});const G=function(t){const{transitionDelay:n,transitionDuration:e}=window.getComputedStyle(t);return 1e3*(parseFloat(n)+parseFloat(e))}(n);return t.runOutsideAngular(()=>{const J=zs(n,"transitionend").pipe(Ir(F),Wr(({target:he})=>he===n));(function(...t){return 1===(t=Bk(t)).length?Ei(t[0]):new Cn(function(t){return n=>{let e=[];for(let i=0;e&&!n.closed&&i<t.length;i++)e.push(Ei(t[i]).subscribe(new vn(n,s=>{if(e){for(let h=0;h<e.length;h++)h!==i&&e[h].unsubscribe();e=null}n.next(s)})))}}(t))})(function(t=0,n,e=w6){let i=-1;return null!=n&&(at(n)?e=n:i=n),new Cn(s=>{let h=function(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;h<0&&(h=0);let m=0;return e.schedule(function(){s.closed||(s.next(m++),0<=i?this.schedule(void 0,i):s.complete())},h)})}(G+IH).pipe(Ir(F)),J,I).pipe(Ir(F)).subscribe(()=>{wy.delete(n),t.run(()=>{m(),S.next(),S.complete()})})}),S.asObservable()};let Jk=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa]]}),t})(),Kk=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa]]}),t})(),eI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({}),t})(),iI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa]]}),t})(),rI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({}),t})();var $n=(()=>{return(t=$n||($n={}))[t.Tab=9]="Tab",t[t.Enter=13]="Enter",t[t.Escape=27]="Escape",t[t.Space=32]="Space",t[t.PageUp=33]="PageUp",t[t.PageDown=34]="PageDown",t[t.End=35]="End",t[t.Home=36]="Home",t[t.ArrowLeft=37]="ArrowLeft",t[t.ArrowUp=38]="ArrowUp",t[t.ArrowRight=39]="ArrowRight",t[t.ArrowDown=40]="ArrowDown",$n;var t})();"undefined"!=typeof navigator&&navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));const cI=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function uI(t){const n=Array.from(t.querySelectorAll(cI)).filter(e=>-1!==e.tabIndex);return[n[0],n[n.length-1]]}new class{getAllStyles(n){return window.getComputedStyle(n)}getStyle(n,e){return this.getAllStyles(n)[e]}isStaticPositioned(n){return"static"===(this.getStyle(n,"position")||"static")}offsetParent(n){let e=n.offsetParent||document.documentElement;for(;e&&e!==document.documentElement&&this.isStaticPositioned(e);)e=e.offsetParent;return e||document.documentElement}position(n,e=!0){let i,s={width:0,height:0,top:0,bottom:0,left:0,right:0};if("fixed"===this.getStyle(n,"position"))i=n.getBoundingClientRect(),i={top:i.top,bottom:i.bottom,left:i.left,right:i.right,height:i.height,width:i.width};else{const h=this.offsetParent(n);i=this.offset(n,!1),h!==document.documentElement&&(s=this.offset(h,!1)),s.top+=h.clientTop,s.left+=h.clientLeft}return i.top-=s.top,i.bottom-=s.top,i.left-=s.left,i.right-=s.left,e&&(i.top=Math.round(i.top),i.bottom=Math.round(i.bottom),i.left=Math.round(i.left),i.right=Math.round(i.right)),i}offset(n,e=!0){const i=n.getBoundingClientRect(),s_top=window.pageYOffset-document.documentElement.clientTop,s_left=window.pageXOffset-document.documentElement.clientLeft;let h={height:i.height||n.offsetHeight,width:i.width||n.offsetWidth,top:i.top+s_top,bottom:i.bottom+s_top,left:i.left+s_left,right:i.right+s_left};return e&&(h.height=Math.round(h.height),h.width=Math.round(h.width),h.top=Math.round(h.top),h.bottom=Math.round(h.bottom),h.left=Math.round(h.left),h.right=Math.round(h.right)),h}positionElements(n,e,i,s){const[h="top",m="center"]=i.split("-"),S=s?this.offset(n,!1):this.position(n,!1),I=this.getAllStyles(e),F=parseFloat(I.marginTop),G=parseFloat(I.marginBottom),J=parseFloat(I.marginLeft),re=parseFloat(I.marginRight);let he=0,Se=0;switch(h){case"top":he=S.top-(e.offsetHeight+F+G);break;case"bottom":he=S.top+S.height;break;case"left":Se=S.left-(e.offsetWidth+J+re);break;case"right":Se=S.left+S.width}switch(m){case"top":he=S.top;break;case"bottom":he=S.top+S.height-e.offsetHeight;break;case"left":Se=S.left;break;case"right":Se=S.left+S.width-e.offsetWidth;break;case"center":"top"===h||"bottom"===h?Se=S.left+S.width/2-e.offsetWidth/2:he=S.top+S.height/2-e.offsetHeight/2}e.style.transform=`translate(${Math.round(Se)}px, ${Math.round(he)}px)`;const ze=e.getBoundingClientRect(),Le=document.documentElement,et=window.innerHeight||Le.clientHeight,Ze=window.innerWidth||Le.clientWidth;return ze.left>=0&&ze.top>=0&&ze.right<=Ze&&ze.bottom<=et}},new Date(1882,10,12),new Date(2174,10,25);let xI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa,Ik]]}),t})(),SI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({}),t})(),DI=(()=>{class t{constructor(e){this._ngbConfig=e,this.backdrop=!0,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(e){this._animation=e}}return t.\u0275fac=function(e){return new(e||t)(dt(Bs))},t.\u0275prov=Ft({factory:function(){return new t(dt(Bs))},token:t,providedIn:"root"}),t})();class lp{constructor(n,e,i){this.nodes=n,this.viewRef=e,this.componentRef=i}}const Tj=()=>{};let EI=(()=>{class t{constructor(e){this._document=e}compensate(){const e=this._getWidth();return this._isPresent(e)?this._adjustBody(e):Tj}_adjustBody(e){const i=this._document.body,s=i.style.paddingRight,h=parseFloat(window.getComputedStyle(i)["padding-right"]);return i.style["padding-right"]=`${h+e}px`,()=>i.style["padding-right"]=s}_isPresent(e){const i=this._document.body.getBoundingClientRect();return window.innerWidth-(i.left+i.right)>=e-.1*e}_getWidth(){const e=this._document.createElement("div");e.className="modal-scrollbar-measure";const i=this._document.body;i.appendChild(e);const s=e.getBoundingClientRect().width-e.clientWidth;return i.removeChild(e),s}}return t.\u0275fac=function(e){return new(e||t)(dt(Di))},t.\u0275prov=Ft({factory:function(){return new t(dt(Di))},token:t,providedIn:"root"}),t})(),Mj=(()=>{class t{constructor(e,i){this._el=e,this._zone=i}ngOnInit(){this._zone.onStable.asObservable().pipe(q(1)).subscribe(()=>{bs(this._zone,this._el.nativeElement,(e,i)=>{i&&eg(e),e.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return bs(this._zone,this._el.nativeElement,({classList:e})=>e.remove("show"),{animation:this.animation,runningTransition:"stop"})}}return t.\u0275fac=function(e){return new(e||t)(Ne(Nn),Ne(jn))},t.\u0275cmp=Jn({type:t,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1050"],hostVars:6,hostBindings:function(e,i){2&e&&(Zl("modal-backdrop"+(i.backdropClass?" "+i.backdropClass:"")),An("show",!i.animation)("fade",i.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},decls:0,vars:0,template:function(e,i){},encapsulation:2}),t})();class AI{close(n){}dismiss(n){}}class kj{constructor(n,e,i,s){this._windowCmptRef=n,this._contentRef=e,this._backdropCmptRef=i,this._beforeDismiss=s,this._closed=new Dn,this._dismissed=new Dn,this._hidden=new Dn,n.instance.dismissEvent.subscribe(h=>{this.dismiss(h)}),this.result=new Promise((h,m)=>{this._resolve=h,this._reject=m}),this.result.then(null,()=>{})}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(Ir(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(Ir(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}close(n){this._windowCmptRef&&(this._closed.next(n),this._resolve(n),this._removeModalElements())}_dismiss(n){this._dismissed.next(n),this._reject(n),this._removeModalElements()}dismiss(n){if(this._windowCmptRef)if(this._beforeDismiss){const e=this._beforeDismiss();e&&e.then?e.then(i=>{!1!==i&&this._dismiss(n)},()=>{}):!1!==e&&this._dismiss(n)}else this._dismiss(n)}_removeModalElements(){const n=this._windowCmptRef.instance.hide(),e=this._backdropCmptRef?this._backdropCmptRef.instance.hide():fn(void 0);n.subscribe(()=>{const{nativeElement:i}=this._windowCmptRef.location;i.parentNode.removeChild(i),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),e.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:i}=this._backdropCmptRef.location;i.parentNode.removeChild(i),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),px(n,e).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var Ty=(()=>{return(t=Ty||(Ty={}))[t.BACKDROP_CLICK=0]="BACKDROP_CLICK",t[t.ESC=1]="ESC",Ty;var t})();let Ij=(()=>{class t{constructor(e,i,s){this._document=e,this._elRef=i,this._zone=s,this._closed$=new Dn,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new ut,this.shown=new Dn,this.hidden=new Dn}dismiss(e){this.dismissEvent.emit(e)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe(q(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:e}=this._elRef,i={animation:this.animation,runningTransition:"stop"},m=px(bs(this._zone,e,()=>e.classList.remove("show"),i),bs(this._zone,this._dialogEl.nativeElement,()=>{},i));return m.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),m}_show(){const e={animation:this.animation,runningTransition:"continue"};px(bs(this._zone,this._elRef.nativeElement,(h,m)=>{m&&eg(h),h.classList.add("show")},e),bs(this._zone,this._dialogEl.nativeElement,()=>{},e)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:e}=this._elRef;this._zone.runOutsideAngular(()=>{zs(e,"keydown").pipe(Ir(this._closed$),Wr(s=>s.which===$n.Escape)).subscribe(s=>{this.keyboard?requestAnimationFrame(()=>{s.defaultPrevented||this._zone.run(()=>this.dismiss(Ty.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let i=!1;zs(this._dialogEl.nativeElement,"mousedown").pipe(Ir(this._closed$),ro(()=>i=!1),Kc(()=>zs(e,"mouseup").pipe(Ir(this._closed$),q(1))),Wr(({target:s})=>e===s)).subscribe(()=>{i=!0}),zs(e,"click").pipe(Ir(this._closed$)).subscribe(({target:s})=>{e===s&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!i&&this._zone.run(()=>this.dismiss(Ty.BACKDROP_CLICK))),i=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:e}=this._elRef;if(!e.contains(document.activeElement)){const i=e.querySelector("[ngbAutofocus]"),s=uI(e)[0];(i||s||e).focus()}}_restoreFocus(){const e=this._document.body,i=this._elWithFocus;let s;s=i&&i.focus&&e.contains(i)?i:e,this._zone.runOutsideAngular(()=>{setTimeout(()=>s.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&bs(this._zone,this._elRef.nativeElement,({classList:e})=>(e.add("modal-static"),()=>e.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}}return t.\u0275fac=function(e){return new(e||t)(Ne(Di),Ne(Nn),Ne(jn))},t.\u0275cmp=Jn({type:t,selectors:[["ngb-modal-window"]],viewQuery:function(e,i){if(1&e&&Zc(_U,7),2&e){let s;hi(s=di())&&(i._dialogEl=s.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(e,i){2&e&&(ai("aria-modal",!0)("aria-labelledby",i.ariaLabelledBy)("aria-describedby",i.ariaDescribedBy),Zl("modal d-block"+(i.windowClass?" "+i.windowClass:"")),An("fade",i.animation))},inputs:{backdrop:"backdrop",keyboard:"keyboard",animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",centered:"centered",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:Kf,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(e,i){1&e&&(function(t){const n=bt()[16][6];if(!n.projection){const i=n.projection=Rn(t?t.length:1,null),s=i.slice();let h=n.child;for(;null!==h;){const m=t?K2(h,t):0;null!==m&&(s[m]?s[m].projectionNext=h:i[m]=h,s[m]=h),h=h.next}}}(),vt(0,"div",0,1),vt(2,"div",2),function(t,n=0,e){const i=bt(),s=zn(),h=Rs(s,20+t,16,null,e||null);null===h.projection&&(h.projection=n),eh(),64!=(64&h.flags)&&function(t,n,e){x_(n[11],0,n,e,y_(t,e,n),v_(e.parent||n[6],e,n))}(s,i,h)}(3),xt(),xt()),2&e&&Zl("modal-dialog"+(i.size?" modal-"+i.size:"")+(i.centered?" modal-dialog-centered":"")+(i.scrollable?" modal-dialog-scrollable":"")+(i.modalDialogClass?" "+i.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}"],encapsulation:2}),t})(),TI=(()=>{class t{constructor(e,i,s,h,m,S){this._applicationRef=e,this._injector=i,this._document=s,this._scrollBar=h,this._rendererFactory=m,this._ngZone=S,this._activeWindowCmptHasChanged=new Dn,this._ariaHiddenValues=new Map,this._backdropAttributes=["animation","backdropClass"],this._modalRefs=[],this._windowAttributes=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","keyboard","scrollable","size","windowClass","modalDialogClass"],this._windowCmpts=[],this._activeInstances=new ut,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const I=this._windowCmpts[this._windowCmpts.length-1];((t,n,e,i=!1)=>{t.runOutsideAngular(()=>{const s=zs(n,"focusin").pipe(Ir(e),Kt(h=>h.target));zs(n,"keydown").pipe(Ir(e),Wr(h=>h.which===$n.Tab),Fw(s)).subscribe(([h,m])=>{const[S,I]=uI(n);(m===S||m===n)&&h.shiftKey&&(I.focus(),h.preventDefault()),m===I&&!h.shiftKey&&(S.focus(),h.preventDefault())}),i&&zs(n,"click").pipe(Ir(e),Fw(s),Kt(h=>h[1])).subscribe(h=>h.focus())})})(this._ngZone,I.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(I.location.nativeElement)}})}open(e,i,s,h){const m=h.container instanceof HTMLElement?h.container:zh(h.container)?this._document.querySelector(h.container):this._document.body,S=this._rendererFactory.createRenderer(null,null),I=this._scrollBar.compensate(),F=()=>{this._modalRefs.length||(S.removeClass(this._document.body,"modal-open"),this._revertAriaHidden())};if(!m)throw new Error(`The specified modal container "${h.container||"body"}" was not found in the DOM.`);const G=new AI,J=this._getContentRef(e,h.injector||i,s,G,h);let re=!1!==h.backdrop?this._attachBackdrop(e,m):void 0,he=this._attachWindowComponent(e,m,J),Se=new kj(he,J,re,h.beforeDismiss);return this._registerModalRef(Se),this._registerWindowCmpt(he),Se.result.then(I,I),Se.result.then(F,F),G.close=ze=>{Se.close(ze)},G.dismiss=ze=>{Se.dismiss(ze)},this._applyWindowOptions(he.instance,h),1===this._modalRefs.length&&S.addClass(this._document.body,"modal-open"),re&&re.instance&&(this._applyBackdropOptions(re.instance,h),re.changeDetectorRef.detectChanges()),he.changeDetectorRef.detectChanges(),Se}get activeInstances(){return this._activeInstances}dismissAll(e){this._modalRefs.forEach(i=>i.dismiss(e))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(e,i){let h=e.resolveComponentFactory(Mj).create(this._injector);return this._applicationRef.attachView(h.hostView),i.appendChild(h.location.nativeElement),h}_attachWindowComponent(e,i,s){let m=e.resolveComponentFactory(Ij).create(this._injector,s.nodes);return this._applicationRef.attachView(m.hostView),i.appendChild(m.location.nativeElement),m}_applyWindowOptions(e,i){this._windowAttributes.forEach(s=>{zh(i[s])&&(e[s]=i[s])})}_applyBackdropOptions(e,i){this._backdropAttributes.forEach(s=>{zh(i[s])&&(e[s]=i[s])})}_getContentRef(e,i,s,h,m){return s?s instanceof ji?this._createFromTemplateRef(s,h):function(t){return"string"==typeof t}(s)?this._createFromString(s):this._createFromComponent(e,i,s,h,m):new lp([])}_createFromTemplateRef(e,i){const h=e.createEmbeddedView({$implicit:i,close(m){i.close(m)},dismiss(m){i.dismiss(m)}});return this._applicationRef.attachView(h),new lp([h.rootNodes],h)}_createFromString(e){const i=this._document.createTextNode(`${e}`);return new lp([[i]])}_createFromComponent(e,i,s,h,m){const S=e.resolveComponentFactory(s),I=Bn.create({providers:[{provide:AI,useValue:h}],parent:i}),F=S.create(I),G=F.location.nativeElement;return m.scrollable&&G.classList.add("component-host-scrollable"),this._applicationRef.attachView(F.hostView),new lp([[G]],F.hostView,F)}_setAriaHidden(e){const i=e.parentElement;i&&e!==this._document.body&&(Array.from(i.children).forEach(s=>{s!==e&&"SCRIPT"!==s.nodeName&&(this._ariaHiddenValues.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}),this._setAriaHidden(i))}_revertAriaHidden(){this._ariaHiddenValues.forEach((e,i)=>{e?i.setAttribute("aria-hidden",e):i.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(e){const i=()=>{const s=this._modalRefs.indexOf(e);s>-1&&(this._modalRefs.splice(s,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(e),this._activeInstances.emit(this._modalRefs),e.result.then(i,i)}_registerWindowCmpt(e){this._windowCmpts.push(e),this._activeWindowCmptHasChanged.next(),e.onDestroy(()=>{const i=this._windowCmpts.indexOf(e);i>-1&&(this._windowCmpts.splice(i,1),this._activeWindowCmptHasChanged.next())})}}return t.\u0275fac=function(e){return new(e||t)(dt(ec),dt(Bn),dt(Di),dt(EI),dt(Nf),dt(jn))},t.\u0275prov=Ft({factory:function(){return new t(dt(ec),dt(ei),dt(Di),dt(EI),dt(Nf),dt(jn))},token:t,providedIn:"root"}),t})(),Pj=(()=>{class t{constructor(e,i,s,h){this._moduleCFR=e,this._injector=i,this._modalStack=s,this._config=h}open(e,i={}){const s=Object.assign(Object.assign(Object.assign({},this._config),{animation:this._config.animation}),i);return this._modalStack.open(this._moduleCFR,this._injector,e,s)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(e){this._modalStack.dismissAll(e)}hasOpenModals(){return this._modalStack.hasOpenModals()}}return t.\u0275fac=function(e){return new(e||t)(dt(La),dt(Bn),dt(TI),dt(DI))},t.\u0275prov=Ft({factory:function(){return new t(dt(La),dt(ei),dt(TI),dt(DI))},token:t,providedIn:"root"}),t})(),MI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({providers:[Pj]}),t})(),RI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa]]}),t})(),UI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa]]}),t})(),$I=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa]]}),t})(),GI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa]]}),t})(),WI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa]]}),t})(),ZI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa]]}),t})(),JI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa]]}),t})(),KI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({}),t})();new on("live announcer delay",{providedIn:"root",factory:function(){return 100}});let t2=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[[oa]]}),t})();const g8=[Jk,Kk,eI,iI,rI,xI,SI,MI,RI,UI,$I,GI,WI,ZI,JI,KI,t2];let m8=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t}),t.\u0275inj=kn({imports:[g8,Jk,Kk,eI,iI,rI,xI,SI,MI,RI,UI,$I,GI,WI,ZI,JI,KI,t2]}),t})(),y8=(()=>{class t{constructor(){}intercept(e,i){const s=e.clone({url:`${CM.baseUrl}/${e.url}`});return i.handle(s)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})(),_8=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ln({type:t,bootstrap:[g6]}),t.\u0275inj=kn({providers:[{provide:sw,useClass:y8,multi:!0}],imports:[[r3,oa,I5,U5,f4.withConfig({accessToken:"pk.eyJ1IjoicnVzaGlkaSIsImEiOiJja3c3bmxkNm4wem9rMm5yaG1rM3BqdHFiIn0.wKthApkGq1SYb831UZafMQ"}),m8,Ik,n4]]}),t})();(function(){if(hE)throw new Error("Cannot enable prod mode after platform setup.");uE=!1})(),n3().bootstrapModule(_8).catch(t=>console.error(t))}},os=>{os(os.s=147)}]);